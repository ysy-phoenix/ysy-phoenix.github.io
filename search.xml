<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>《图论导引》chap2习题解答</title>
      <link href="2021/09193858.html"/>
      <url>2021/09193858.html</url>
      
        <content type="html"><![CDATA[<h1 id="《图论导引》chap2习题解答"><a href="#《图论导引》chap2习题解答" class="headerlink" title="《图论导引》chap2习题解答"></a>《图论导引》chap2习题解答</h1><h2 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h2><p>设有$n$个度数为$4$​的顶点，由<br>$$<br>\epsilon(G)=\nu(G)-1=9+3+n-1<br>$$</p><p>$$<br>\sum deg(v)=9\times1 +3\times3+4\times n=2\epsilon(G)<br>$$</p><p>解得$n=2$。</p><p>非同构的无向树共有$9$棵，类似高中画同分异构体:</p><p>$4-3-3-3-4\qquad 1$种</p><p>$4-3-3-4\qquad 2$种</p><p>$4-3-4\qquad 4$种</p><p>$4-4\qquad 2$种</p><h2 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h2><p>设有$n_1$个树叶，由<br>$$<br>\epsilon(G)=\nu(G)-1=\sum^k_{i=1}n_i-1<br>$$</p><p>$$<br>\sum deg(v)=9\sum_{i=1}^kn_i\times i=2\epsilon(G)<br>$$</p><p>解得$n_1=\sum^k_{i=2}n_i\times(i-2)+2$</p><h2 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h2><p>由$\epsilon(G)=\nu(G)-1$，得$\sum deg(v)=2\epsilon(G)=2\nu(G)-2$。由于只有两片树叶，故余下的$n-2$个顶点的度数和为$2n-4$，而它们之中每个顶点度数至少为$2$，故剩下的每个顶点度数都为$2$，综上，这样的图只能为一条轨道。</p><p>本题也可以数学归纳法，不赘述。</p><h2 id="T4"><a href="#T4" class="headerlink" title="T4"></a>T4</h2><p>假设至多有$s(&lt;n)$​片树叶，则$\sum deg(v)=2\epsilon(G)=2\nu(G)-2\geq2(\nu(G)-s-1)+n+s$​，从而得到$s\geq n$​，矛盾！故假设不成立，至少有$n$片树叶。</p><h2 id="T5"><a href="#T5" class="headerlink" title="T5"></a>T5</h2><p>必要性：对每个连通片$G_i$（是树）,有$\epsilon_i=\nu_i-1$，累加有$\epsilon=\sum \epsilon_i=\sum \nu_i-1=\nu-\omega$</p><p>充分性：首先，对每个连通片有$\epsilon_i\geq\nu_i-1$，从而$\epsilon=\sum \epsilon_i\geq\sum \nu_i-1=\nu-\omega$，而现在$\epsilon=\nu-\omega$，则对每个连通片等号都得成立，那么每个连通片都是树（定理$2.1(4)$），从而$G$是森林。</p><h2 id="T6"><a href="#T6" class="headerlink" title="T6"></a>T6</h2><p>首先，$\nu(G)=1$或$2$时显然成立。下考虑$\nu(G)\geq3$情形。</p><p>显然，树叶不可能是中心，考虑进行如下操作，依次删除树叶结点及与之关联的边，直至剩下的结点不是树叶结点，最后只可能是两种情况：</p><p>若只剩下一个顶点，说明该树只有一个中心。</p><p>若不剩任何顶点，前一步必然是$K_2$，则说明该树有两个中心，且相邻。</p><p>以下说明每次删除树叶后的原图的中心还是中心。</p><p>由中心定义，其离心率最小，而删除树叶后，会导致所有点的离心率要么不变，要么$-1$，而中心的离心率必然$-1$（以其为一段端点的最长轨道末端必然是树叶，否则与最长轨道矛盾），从而其离心率依然最小，仍为中心。</p><p>另法：考虑最长轨道$v_0v_1\cdots v_k$，若$k$为偶数，$v_{k/2}$是唯一中心；若$k$为奇数，$v_{(k\pm1)/2}$是两相邻中心。</p><p>以$k$为偶数为例，显然$l(v_{k/2})=k/2,$否则与最长轨道矛盾！易知最长轨道上的其它点都不可能是中心；而考虑其它任意点$u$不在最长轨道上，必定与最长轨道上点连通，从而也不可能是中心。​</p><h2 id="T7"><a href="#T7" class="headerlink" title="T7"></a>T7</h2><p>对$k$作归纳。</p><p>$k=1,2$显然成立。</p><p>假设$k-1$时成立，考虑$k$时情形，在其中一棵树取两片树叶$u、v$，$P(u,v)$为他们之间唯一轨道，则$G-P(u,v)$显然满足$k-1$阶情形，由归纳假设有$k-1$条无公共边的轨道，且每条边都在这些轨道上，加回$P(u,v)$依然成立，证毕。</p><h2 id="T8"><a href="#T8" class="headerlink" title="T8"></a>T8</h2><p>必要性：$\sum_i d_i=2\epsilon=2(\nu-1)$</p><p>充分性：$\sum_i d_i$为偶数表明一定可图化（奇度顶点有偶数个，它们之间两两一组，互相连一边至化为偶度顶点，然后其余全部用环来实现）。然后根据该度数序列构作图，若连通，则结论显然成立。否则构作连通分支最少（不妨设为$\omega$）的图$G$，由$\epsilon=\nu-1$，则必定存在连通分支有圈（否则都无圈，图变为森林，$\epsilon=\nu-\omega$，矛盾）。从圈$C$中取$e=u_1v_1$，并从另一连通分支中取$e_2=u_2v_2$，构作图$G_1=G-e_1-e_2+u_1v_2+u_2v_1$，显然图$G_1$与$G$的度数序列一样，并且将那两个连通片连通，若$G_1$连通，则成立，否则还可以继续上述操作，并且能在有限步终止，最终能构作出树来。</p><h2 id="T9"><a href="#T9" class="headerlink" title="T9"></a>T9</h2><p>对$k$作归纳。</p><p>$k=1,2$时显然成立。</p><p>假设$k(\geq2)$​时成立，考虑$k+1$​个顶点的树。不妨$u$​是树叶，其相邻点为$v$​，则$T-u$​是$k$​个顶点的树，由归纳假设，$G(\delta(G)\geq k&gt; k-1)$​中有与$T-u$​同构的子图$F$​，设$v_1$​为同构意义下与$v$对应的点，则$deg(v_1)\geq\delta(G) \geq k$​，而在$T-u$中$deg(v)\leq k-1$，从而在图$G$中必有一点$w$不在$F$中，则易知$F+vw$与$T$同构。证毕。</p><h2 id="T10"><a href="#T10" class="headerlink" title="T10"></a>T10</h2><p>$$<br>\epsilon(G)=\nu(G)-1=m+n-1<br>$$</p><p>$$<br>\sum deg(v)=4m+n=2\epsilon(G)<br>$$<br>解得$n=2m+2$</p><h2 id="T11"><a href="#T11" class="headerlink" title="T11"></a>T11</h2><p>$12$个，用$Cayley$递推容易出错，不如直接考虑删两条边，但不能把$Y(|Y|=3)$上任意一点所连两条边同时删去，即为$\tbinom{6}{2}-3=12$。</p><h2 id="T12"><a href="#T12" class="headerlink" title="T12"></a>T12</h2><p>首先算前几项，有$W_3=16,W_4=45,W_5=121$​。</p><p>利用$Cayley$​可以<strong>艰难</strong>得到$n\geq6$​时，$W_n=4W_{n-1}+4W_{n-2}+W_{n-3}$​。（图略）</p><p>解得特征根为$1,\frac{3\pm\sqrt{5}}{2}$。利用前三项最终解得<br>$$<br>W_n=(\frac{3+\sqrt{5}}{2})^n+(\frac{3-\sqrt{5}}{2})^n-2<br>$$</p><h2 id="T13"><a href="#T13" class="headerlink" title="T13"></a>T13</h2><p>首先由$\tau(K_\nu)=\nu^{\nu-2}$​​，而$K_\nu$​所有生成树的总边数为$(\nu-1)\times \nu^{\nu-2}$​，而每一条边在每一颗生成树中只出现一次，从而每条边出现了$(\nu-1)\times \nu^{\nu-2}/(\nu(\nu-1)/2)=2\nu^{\nu-3}$​次，减去含有改边的生成树即得$\nu^{\nu-2}-2\nu^{\nu-3}=(\nu-2)\nu^{\nu-3}$​</p><h2 id="T14"><a href="#T14" class="headerlink" title="T14"></a>T14</h2><p>使用对应算法即可。以下为$matlab$​求解，图略。</p><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clc<span class="token punctuation">,</span> clear<span class="token punctuation">,</span> close all<span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>s<span class="token operator">=</span><span class="token function">cellstr</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token function">int2str</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>G<span class="token operator">=</span><span class="token function">graph</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>s<span class="token punctuation">,</span><span class="token string">'upper'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> p<span class="token operator">=</span><span class="token function">plot</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span><span class="token string">'EdgeLabel'</span><span class="token punctuation">,</span>G<span class="token punctuation">.</span>Edges<span class="token punctuation">.</span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>T<span class="token operator">=</span><span class="token function">minspantree</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span><span class="token string">'Method'</span><span class="token punctuation">,</span><span class="token string">'sparse'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%利用图论工具箱求最小生成树</span>L<span class="token operator">=</span><span class="token function">sum</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>Edges<span class="token punctuation">.</span>Weight<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">highlight</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>T<span class="token punctuation">)</span><span class="token comment">%Kruskal算法</span>A<span class="token operator">=</span>a<span class="token punctuation">;</span>A <span class="token operator">=</span> <span class="token function">sparse</span><span class="token punctuation">(</span>A<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">A</span><span class="token punctuation">(</span>A<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> Inf<span class="token punctuation">;</span>B <span class="token operator">=</span> <span class="token function">sparse</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>link <span class="token operator">=</span> <span class="token function">graphallshortestpaths</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token string">'directed'</span><span class="token punctuation">,</span> false<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> Inf <span class="token comment">%如果不连通，则和无穷大</span>    ind <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>A<span class="token operator">==</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ind2sub</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> ind<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%寻找最短边</span>    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>Inf <span class="token comment">%判断是否连通</span>            <span class="token function">B</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">A</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">A</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span>Inf<span class="token punctuation">;</span> <span class="token comment">%取差集</span>        <span class="token keyword">end</span>    <span class="token keyword">end</span>    link <span class="token operator">=</span> <span class="token function">graphallshortestpaths</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token string">'directed'</span><span class="token punctuation">,</span> false<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>B<span class="token comment">%Prim算法</span>M<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">;</span>a<span class="token operator">=</span>a<span class="token operator">+</span>a<span class="token operator">'</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>a<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span>M<span class="token punctuation">;</span>T<span class="token operator">=</span><span class="token function">myprim</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>L<span class="token operator">=</span><span class="token function">sum</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">L</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">function</span> <span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">myprim</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">%a为传入的每个点的距离矩阵</span>    result<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%用result（3×n）矩阵来表示，第一行表示起点，第二行表示终点，第三行表示权值</span>    p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>tb<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token function">size</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">~=</span><span class="token function">length</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>        temp<span class="token operator">=</span><span class="token function">a</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>tb<span class="token punctuation">)</span><span class="token punctuation">;</span>temp<span class="token operator">=</span><span class="token function">temp</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        d<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">[</span>jb<span class="token punctuation">,</span>kb<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>tb<span class="token punctuation">)</span> <span class="token operator">==</span> d<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token number">j</span><span class="token operator">=</span><span class="token function">p</span><span class="token punctuation">(</span>jb<span class="token punctuation">)</span><span class="token punctuation">;</span>k<span class="token operator">=</span><span class="token function">tb</span><span class="token punctuation">(</span>kb<span class="token punctuation">)</span><span class="token punctuation">;</span>        result<span class="token operator">=</span><span class="token punctuation">[</span>result<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">j</span><span class="token punctuation">;</span>k<span class="token punctuation">;</span>d<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>p<span class="token operator">=</span><span class="token punctuation">[</span>p<span class="token punctuation">,</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">tb</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>tb<span class="token operator">==</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">end</span><span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-out" data-language="out"><code class="language-out">L &#x3D;    22T &#x3D;     1     4     2     3     6     5     8     8     4     2     3     6     5     8     9     7     2     3     4     3     1     3     2     4ans &#x3D;    22B &#x3D;   (4,1)        2   (3,2)        4   (4,2)        3   (6,3)        3   (6,5)        1   (8,5)        3   (8,7)        4   (9,8)        2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="T15"><a href="#T15" class="headerlink" title="T15"></a>T15</h2><p>考虑对森林中的每棵树求最小生成树，复杂度多乘一个系数$\omega$</p><h2 id="T16"><a href="#T16" class="headerlink" title="T16"></a>T16</h2><p>（1）</p><p>$1.$在图中找一个圈。</p><p>$2.$去掉该圈中权值最大的边，但要保持图仍为连通。</p><p>$3.$重复$1、2$过程，直至图中无圈（但仍保持连通），得到最小生成树。</p><p>（2）以下仅作正确性说明。首先最后得到的是连通无圈图，也就是树，记为$T$​；其次，每次去掉的都是权值最大的边（贪心），类似教材$Prim$​算法的证明，若还有权值和更小的树$T^*$​，考虑第一条不在$T$​中的边$e$​，中间某步必定将$e$​去掉，说明$e$​权值大，从而矛盾，故得到的即为最小生成树。</p><p>（3）不考虑优化存储方式，大约$O(\nu^3)$</p><h2 id="T17"><a href="#T17" class="headerlink" title="T17"></a>T17</h2><p>必要性：由定义，有且仅有根入度为$0$。</p><p>充分性：由于有且仅有一点入度为$0$，则其余点的入度必定都$\geq1$。而由$\sum deg^+(v)=\epsilon(G)=\nu(G)-1\geq0+1\times(\nu(G)-1)$，从而等号成立，其余点入度为$1$，该有向树为有根树。</p><h2 id="T18"><a href="#T18" class="headerlink" title="T18"></a>T18</h2><p>对$i$作归纳</p><p>$1.i=1$时显然成立。</p><p>$2.$​假设$i$​时成立，有$L_i=I_i+2i$​，对于$i+1$​情形，考虑删去一片树叶的父节点$v$​（是分支点）下的树叶，变为$i$​情形（刚才的分支点变为了树叶），而$L_{i+1}=L_{i}-L(v)+2(L(v)+1)$​,$I_{i+1}=I_i+L(v)$。从而$L_{i+1}=I_{i+1}+2(i+1)$成立。</p><h2 id="T19"><a href="#T19" class="headerlink" title="T19"></a>T19</h2><p>记$i$为分支点数目。​</p><p>法一：$\nu = t+i$，$\epsilon=2i=\nu-1$，从而$\epsilon=2t-2$。</p><p>法二：$\sum deg(v)=2\epsilon=2+3(i-1)+t,\nu=t+i=\epsilon+1$，从而$\epsilon=2t-2$。</p><p>法三：对$i$作归纳，类似上一题，不赘述。</p><h2 id="T20"><a href="#T20" class="headerlink" title="T20"></a>T20</h2><p>画$Huffman$树，不赘述，图略。</p><h2 id="T21"><a href="#T21" class="headerlink" title="T21"></a>T21</h2><p>$matlab$​求解如下</p><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clear<span class="token punctuation">;</span> clc<span class="token punctuation">;</span>str <span class="token operator">=</span> <span class="token string">'abcde'</span><span class="token punctuation">;</span>len <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>symbols <span class="token operator">=</span> <span class="token function">cell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>p <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>len    symbols<span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.20</span><span class="token punctuation">;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.10</span><span class="token punctuation">;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0.30</span><span class="token punctuation">;</span><span class="token comment">%根据符号集symbols和概率数组p计算Huffman编码词典</span><span class="token punctuation">[</span>dict<span class="token punctuation">,</span> avglen<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">huffmandict</span><span class="token punctuation">(</span>symbols<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%计算平均码长</span>code_len <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>len    <span class="token function">code_len</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">numel</span><span class="token punctuation">(</span><span class="token function">cell2mat</span><span class="token punctuation">(</span><span class="token function">dict</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span>max_len <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>code_len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%打印字典表</span><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>len    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'`%s` : '</span><span class="token punctuation">,</span> <span class="token function">str</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'%d '</span><span class="token punctuation">,</span> dict<span class="token punctuation">&#123;</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">end</span><span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'平均码长 : %f\n'</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>p<span class="token operator">*</span>code_len<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-out" data-language="out"><code class="language-out">&#96;a&#96; : 1 1 &#96;b&#96; : 1 0 1 &#96;c&#96; : 1 0 0 &#96;d&#96; : 0 1 &#96;e&#96; : 0 0 平均码长 : 2.250000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="T22"><a href="#T22" class="headerlink" title="T22"></a>T22</h2><p>以下只说明三件事。</p><p>$1.$考虑构造过程，首先$w_1$一定有兄弟。</p><p>2.$w_1$深度一定最深（树高），否则与其权值最小矛盾。</p><p>$3.$对于任一$Huffman$树，若$w_2$不是$w_1$兄弟，则必然有多个值等于$w_1$的，交换同一层的即可。</p><h2 id="T23"><a href="#T23" class="headerlink" title="T23"></a>T23</h2><p>设$T_n$是$n$片树叶的最优树，合并$w_1+w_2$为一片树叶得到$T_{n-1}^{‘}$</p><p>设$T_{n-1}$是$n-1$片树叶的最优树，展开$w_1+w_2$为两片树叶得到$T{n}^{‘}$</p><p>$WPL(T_n)=WPL(T^{‘}_{n-1})+w_1+w_2$</p><p>$WPL(T^{‘}<em>n)=WPL(T</em>{n-1})+w_1+w_2$</p><p>$WPL(T_n)\leq WPL(T_n^{‘}),WPL(T_{n-1})\leq WPL(T^{‘}_{n-1})$</p><p>从而$WPL(T_n)=WPL(T_n^{‘}),WPL(T_{n-1})=WPL(T_{n-1}^{‘})$</p><p>从而最优树展开或合并得到的依然是最优树，进而对$Huffman$​树的树叶数进行归纳即可（$Huffman$​树合并或展开也还是$Huffman$​树）。</p><h2 id="T24"><a href="#T24" class="headerlink" title="T24"></a>T24</h2><p>（1）若不同，不妨$p_1$最小，为$(\frac{1}{2})^{t}$，而其余概率之和必定为$p_1$的偶数倍，再加上$p_1$综合为$p_1$的奇数倍，不可能为$1$，矛盾！</p><p>（2）实际上即证$p_i$​概率对应的深度为$-lg\ p_i$​。对$n$作​归纳即可（每次合并最小的两个至$n-1$阶情形）。</p><h2 id="T25"><a href="#T25" class="headerlink" title="T25"></a>T25</h2><p>连通图必有生成树，树至少有两片树叶，删这两点仍连通。</p><h2 id="T26"><a href="#T26" class="headerlink" title="T26"></a>T26</h2><p>至多$2$​次。首先拿出两个称重，如果平衡，拿出另外两个，轻的是伪币； 如果不平衡，那么轻的是伪币。</p><h2 id="T27"><a href="#T27" class="headerlink" title="T27"></a>T27</h2><p>若至少一段不是树叶，不妨设为$v$，则$v$至少还和一点$u$相连，又由于树无圈，则$u$不在最长轨道上，那么原最长轨道加上$vu$必然是一条更长轨道，矛盾​！</p>]]></content>
      
      
      <categories>
          
          <category> 图论 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《图论导引》chap1习题解答</title>
      <link href="2021/091152247.html"/>
      <url>2021/091152247.html</url>
      
        <content type="html"><![CDATA[<h1 id="《图论导引》chap1习题解答"><a href="#《图论导引》chap1习题解答" class="headerlink" title="《图论导引》chap1习题解答"></a>《图论导引》chap1习题解答</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>本系列为中国科学技术大学《图论导引》课后习题解答，本人能力不高，水平有限，出现错漏在所难免，欢迎各位大佬指正。</p><h1 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h1><p>考虑简单图边数最多的情况，即完全图情形，此时任意两顶点之间都有一条边相连，故对任意简单图G，有$\epsilon(G)\leq\epsilon(K_{\nu(G)})=\tbinom{\nu(G)}{2}$</p><h2 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h2><p>（1）由定义中”一一映射“（双射）知$|V(G)|=|V(H)|$，即$\nu(G)=\nu(H)$，同理，$\epsilon(G)=\epsilon(H)$。</p><p>（2）反例易举，从略。</p><h2 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h2><p>共12个，从变数考虑：0、1、5、6条边各1个，2、4条边各2个，3条边4个。图略。</p><h2 id="T4"><a href="#T4" class="headerlink" title="T4"></a>T4</h2><p>构作图$G=(V,E)$，其中$V$为人员集合，每个人作为一个顶点，两顶点间有边当且仅当两人是朋友，这样，对每个人$v$来说，朋友数就是其在图中的度数$deg(v)$​。假设任意两个人的朋友数不同，即任意两个顶点的度数不同，则度数序列只能为$n-1,n-2,\cdots,1,0$。其中$n-1$表明图中没有孤立点，但是$0$表示图中有一个孤立点，矛盾！故假设不成立，得证。</p><h2 id="T5"><a href="#T5" class="headerlink" title="T5"></a>T5</h2><p>构作图$G=(V,E)$，其中$V$为人员集合，每个人作为一个顶点，两顶点间有边当且仅当两人是认识，则原题等价于，若$\nu(G)=2n,\forall v \in V(G),deg(v)\geq n\geq2$，则图中存在长度至少为$4$的圈。</p><p>若图为完全图，则显然成立。否则，必定存在两点$v_1,v_2$不相邻，而$deg(v_1)+deg(v_2)\geq2n$，故余下的$2n-2$个顶点中必定有两个点$v_3,v_4$与$v_1,v_2$都相邻，考虑圈$v_1v_3v_2v_4v_1$即符合题意。</p><h2 id="T6"><a href="#T6" class="headerlink" title="T6"></a>T6</h2><p>考虑进行标号，以下顺序自上而下，自左而右。对于左图，$A，DCB，EF，GH，IJ$。对于右图，$A，DCB，JHE，IGF$。图略。</p><h2 id="T7"><a href="#T7" class="headerlink" title="T7"></a>T7</h2><p>（1）由二分图定义及乘法原理，不妨设二分图划分为$V(G)=X\cup Y ,|X|=m,|Y|=n$，则所有的边必定一端在$X$中，另一端在$Y$中，而$\forall x \in X,deg(x)=n$，从而$\epsilon(G)=mn$。</p><p>（2）结合上一小题结论有，$\epsilon(G)=mn$，而$\nu(G)=m+n$，利用基本不等式立得$\epsilon(G)\leq\frac{\nu^2(G)}{4}$。$(mn\leq \frac{(m+n)^2}{4})$</p><h2 id="T8"><a href="#T8" class="headerlink" title="T8"></a>T8</h2><p>记$V^{‘}$中顶点度数为奇数的顶点集合为$V_o$，顶点度数为偶数的顶点集合为$V_e$。现考虑$V^{‘}$中顶点度数之和，有<br>$$<br>\sum_{v\in V^{‘}}deg(v) = \sum_{v\in V_o}deg(v) + \sum_{v\in V_e}deg(v)<br>$$<br>易知$\sum_{v\in V_e}deg(v)$为偶数。</p><p>若$|V_o|$为偶数，则$\sum_{v\in V_e}deg(v)$为偶数，进而$\sum_{v\in V^{‘}}deg(v)$为偶数。考虑边对度数的贡献。若边的两端点都在$V^{‘}$中，则每条边对度数贡献为2，设这样的边有$l$条；若边的一个端点在$V^{‘}$中，另一端点在$V(G)-V^{‘}$中，由题意，这样的边有$k$个，则$2l+k=\sum_{v\in V^{‘}}deg(v)$，从而$k$为偶数。</p><p>同理，若$|V_o|$为奇数，有$2l+k=\sum_{v\in V^{‘}}deg(v)$​为奇数，从而，$k$为奇数。</p><h2 id="T9"><a href="#T9" class="headerlink" title="T9"></a>T9</h2><p>设$P(u,v)=v_0v_1\cdots v_k$​​为$G$​​中最长轨道，则除$v_1$​​外，$u(v_0)$​​在图中还有一个相邻点$w$​​​，则$w$​只能在$P(u,v)$​上，否则$P(u,v)+uw$​是比$P(u,v)$​还长的轨道，矛盾！又由于$\forall v \in V(G)，deg(v)=2$​，则$w$​只能是$v$，否则$deg(w)=3$，矛盾！从而$P(u,v)+uv$构成一个圈。而$P(u,v)$一定包含图中所有点，否则与连通图（圈外点为孤立点）或者$deg(v)=2$（圈外点与圈上除$u,v$外的点相连）​条件或最长轨道（圈外点与$u,v$相连）矛盾​！综上，该图是一个圈。</p><h2 id="T10"><a href="#T10" class="headerlink" title="T10"></a>T10</h2><p>（1）由同构，$\epsilon(G)=\epsilon(G^c)$；由补图定义，$\epsilon(G)+\epsilon(G^c)=\epsilon(K_{|\nu(g|})\equiv\frac{\nu(G)(\nu(G)-1)}{2}$，从而$\epsilon(G)=\epsilon(G^c)=\frac{\nu(G)(\nu(G)-1)}{4}$</p><p>进而有$\nu(G)\equiv 0或1\ mod\ 4$。（$\nu(G)$和$\nu(G)-1$不可能同时$\equiv 0\ mod\ 2$）</p><p>（2）1个，五角星</p><h2 id="T11"><a href="#T11" class="headerlink" title="T11"></a>T11</h2><p>构造完全二分图$K_{2,2}$​​​，不妨$X=\{a,b\},Y=\{c,d\}$​​​。若与$k$​​维超立方体子图同构，不妨$a$​​与$b$​​第$i$​​位不同，$a$​​与$c$​​第$j$​​​位不同，$b$​​与$d$​​第$k$​​位不同（都只有一位不同），这里$i、j、k$​​互不相同，则$c$​​与$d$​第$j、k$​位不同，不可能相连，矛盾！故不可能同构。</p><h2 id="T12"><a href="#T12" class="headerlink" title="T12"></a>T12</h2><p>由题，考虑$n=2$​，若导出子图相同的边数为$0$，易知$G$为零图，从而$G\cong K^c_{\nu(G)}$；若导出子图相同边数为$1$，则$G$为完全图，从而$G\cong K_{\nu(G)}$。</p><h2 id="T13"><a href="#T13" class="headerlink" title="T13"></a>T13</h2><p>由<br>$$<br>\delta(G)\times\nu(G)\leq\sum_{v\in\nu(G)}deg(v)=2\epsilon(G)\leq\Delta(G)\times\nu(G)<br>$$<br>立得<br>$$<br>\delta(G)\leq\frac{2\epsilon(G)}{\nu(G)}\leq\Delta(G)<br>$$</p><h2 id="T14"><a href="#T14" class="headerlink" title="T14"></a>T14</h2><p>（1）$7&gt;6=7-1$；两个$6$与$1$矛盾。</p><p>（2）设$V^{‘}$为度数前$k$大的顶点构成的集合，考虑$V^{‘}$中顶点度数和的最大值。考察边的贡献，</p><p>若边两端点都在$V^{‘}$​​中，最多贡献度数$k(k-1)$$;$</p><p>若边一端点在$V^{‘}$​​中，另一端点在$V(G)-V^{‘}$​​中，考虑$V(G)-V^{‘}$​​中的任一顶点$d_i(k+1\leq i\leq n)$​​，由其引出的边对$V^{‘}$​​中顶点度数和的贡献最多为$min\{k,d_i\}$​​，总和为$\sum_{i=k+1}^{n}min\{k,d_i\}$​​。</p><p>综上有$\sum_{i=1}^{k}d_i\leq k(k-1)+\sum_{i=k+1}^{n}min\{k,d_i\}。$​​</p><h2 id="T15"><a href="#T15" class="headerlink" title="T15"></a>T15</h2><p>不妨设$V(H)=X\cup Y$​​是$G$​​的具有最多边数的二分生成子图。这样的$H$​​可看成$G$​​​删除若干条边所得。下证$\forall x\in X,d_{X}(x)\leq d_H(x)$​​​。其中$d_{X}(x)$​​表式在原来图$G$​​的$X$​​中与$x$​关联的边数。</p><p>假设$\exists x_0 \in X,s.t. d_{X}(x_0)&gt;d_H(x_0)$​​​，考虑新划分$X_1=X \setminus \{x_0\},Y_1=Y\cup \{x_0\}，H_1=X_1\cup Y_1$​​​ ,这样对图$H_1$​​​来说，$G$​​​中$x$​​​与$X_1$​​​之间的边会保留，与$Y$​​​之间的边会删除，则$\epsilon(H_1)=\epsilon(H)+d_{X}(x_0)-d_H(x_0)&gt;\epsilon(H)$​​​，与$H$​​​是具有最多边数的二分生成子图矛盾！故假设不成立。同理$\forall y\in Y,d_{Y}(y)\leq d_H(y)$​​​。</p><p>故对$x\in X$，有$d_G(x)=d_X(x)+d_H(x)\leq2d_H(x);$对$y\in Y$，有$d_G(y)=d_Y(y)+d_H(y)\leq2d_H(y)$。从而对$\forall u\in V(G)=V(H),d_H(u)\geq d_G(u)/2$​。</p><h2 id="T16"><a href="#T16" class="headerlink" title="T16"></a>T16</h2><p>原题等价于证明最长轨道长度大于等于$k$。考虑最长轨道$P(u,v)=v_0v_1\cdots v_l$，假设$l&lt;k$，由于$deg(v_0)\geq\delta(G)\geq k$，则$v_0$除与$v_1$外还和至少$k-1$个点相邻，若这$k-1$个点有一个不在$P(u,v)$上，与最长轨道矛盾；若全在$P(u,v)$上，与$l&lt;k$矛盾！综上，假设不成立，$l\geq k$。</p><h2 id="T17"><a href="#T17" class="headerlink" title="T17"></a>T17</h2><p>必要性：由$G$连通，考虑$V(G)$的任意划分$V^{‘}$与$V(G)-V^{‘}$，考虑$\forall u\in V^{‘},v\in V(G)-V^{‘}$，则$u、v$之间存在一条轨道，进而在轨道上必定存在相继的两点$v_1、v_2,s.t.\ v_1\in V^{‘},v_2\in V(G)-V^{‘}$，则边$v_1v_2$​满足条件。</p><p>充分性，对于$\forall u、v\in V(G)$，可用如下方法找到连接它们的轨道。初始令$V={u}$。</p><p>令$V^{‘}$为$V(G)-V$中所有与$V$中点相邻的点的集合，由条件知$V^{‘}$非空，令$V=V\cup V^{‘}$，注意到这样的$V$始终是一个连通片，若$v\in V$，则$u、v$连通，终止；否则，重复执行本步，每执行一次$V$都会扩大，从而可知会在有限步终止，证毕。</p><h2 id="T18"><a href="#T18" class="headerlink" title="T18"></a>T18</h2><p>假设$G$​不是连通图，则$G$​可以分为$w(w\geq2)$​个连通片。设第$i$​个连通片顶点数为$p_i(\geq1)$​，有$\sum_{i=1}^wp_i=\nu(G)$​；边数为$\epsilon_i$​，易知$\epsilon_i\leq p_i(p_i-1)/2$​，从而<br>$$<br>\begin{aligned}<br>\epsilon(G) &amp;=\sum_{i=1}^w\epsilon_i\leq\sum_{i=1}^wp_i(p_i-1)/2 \newline<br>&amp;=\sum_{i=1}^wp_i^2/2+\nu(G)/2=((\sum_{i=1}^wp_i)^2-2\sum_{1\leq i&lt;j\leq w}p_ip_j)/2-\nu(G)/2\newline&amp;=\nu(G)(\nu(G)-1)/2-\sum_{1\leq i&lt;j\leq w}p_ip_j<br>\end{aligned}<br>$$<br>注意到<br>$$<br>\sum_{1\leq i&lt;j\leq w}p_ip_j\geq p_1p_2+p_2p_3+\cdots p_wp_1\geq \nu(G)-1<br>$$<br>从而<br>$$<br>\epsilon(G)\leq (\nu(G)-1)(\nu(G)-2)/2=\tbinom{\nu(G)-1}{2}<br>$$<br>与题设矛盾！故假设不成立，从而$G$​是连通图。</p><h2 id="T19"><a href="#T19" class="headerlink" title="T19"></a>T19</h2><p>（1）设$e=uv$，若$u、v$之间还有其他轨道，则$w(G-e)=w(G)$；否则，$w(G-e)=w(G)+1$。</p><p>综上，$w(G)\leq w(G-e)\leq w(G)+1$。</p><p>（2）顶点度数序列为3,1,1,1的图，去掉度数为3的顶点就不成立。</p><h2 id="T20"><a href="#T20" class="headerlink" title="T20"></a>T20</h2><p>考虑$G-v$中任意一个连通片，则在$G$中该连通片与$v$之间有偶数条边连接，否则与推论$1.1$矛盾（度为奇数的顶点将有奇数个）。进而$G$与该连通片至少有两条边相连，从而$w(G-v)\geq deg(v)/2$。</p><h2 id="T21"><a href="#T21" class="headerlink" title="T21"></a>T21</h2><p>假设存在两条无公共顶点的最长轨道$P_1、P_2$​，设长度为$n$​，易知$n\geq3$​，分别考虑两条轨道上除两端点外的两点$u,v$​，由连通可知它们之间存在轨道，设长度为$l(l\geq1)$​。设$u$​将$P_1$​分为长度为$a$​和$n-a$​两部分，$v$将$P_2$分为长度为$b$和$n-b$​的两部分​，显然有<br>$$<br>max\{a,n-a\}+max\{n,n-b\}+l\geq n+l\geq n+1<br>$$<br>这与$P_1、P_2$​是最长轨道矛盾！故假设不成立，存在公共顶点。</p><h2 id="T22"><a href="#T22" class="headerlink" title="T22"></a>T22</h2><p>由题可知$\nu(G)\geq3$，且$\Delta(G)\geq2$。</p><p>假若不然，$\forall u、v、w,$若$uv,vw\in E(G),$则$\ uw\in E(G)(*)$​</p><p>现任取$v_i、v_j$，由连通，知$u、v$之间存在轨道$P(v_i,v_j)=v_iv_{i_1}\cdots v_{i_k}v_j$。由$(*)$，$v_i$与$v_{i_1}$、$v_{i_1}$与$v_{i_2}$​相相邻，从而$v_i$与$v_{i_2}$相邻，不断迭代可知，$v_i$与$v_j$​​相邻，由$v_i、v_j$的任意性，知$G$是完全图，矛盾！故假设不成立。</p><h2 id="T23"><a href="#T23" class="headerlink" title="T23"></a>T23</h2><p>若该行迹是一个圈，得证。否则找从起点出发后第一个在行迹上重复的顶点记为$w$​​​，利用行迹无重边的性质，一定存在从起点到该点的至少两条轨道，则构成一个圈，若$e$​​​在该圈上，得证，否则，删除图中该圈​除$w$​​外的所有顶点及关联的边，将$w$​作为起点（也是终点），依然满足题目性质，继续重复刚才的操作，且能在有限步终止，最终$e$​一定在某个圈上​​​。</p><h2 id="T24"><a href="#T24" class="headerlink" title="T24"></a>T24</h2><p>题目描述感觉有误，应当是长至少为$\delta(G)+1$的圈。</p><p>不妨设$G$​连通，否则只需要考虑其一个连通片即可。设$P(u,v)=v_0v_1\cdots v_k$为其最长轨道，则$v_0$只与$P(u,v)$上的点相邻，且至少有$\delta(G)$个顶点与之相邻，记为$u_1,\cdots,u_{\delta(G)}$（按照与$v_0$的距离递增的顺序），则$v_0v_1\cdots u_{\delta(G)}v_0$为圈，且长度至少为$\delta(G)+1$，得证。</p><h2 id="T25"><a href="#T25" class="headerlink" title="T25"></a>T25</h2><p>（1）对顶点数$\nu(G)$进行归纳</p><p>1.$\nu(G)=3$时，显然成立（三角形）。</p><p>2.假设$\nu(G)&lt;k$​时成立，当$\nu(G)=k$​​时，若存在$v,s.t.\ deg(v)\leq1$​，则删去该点及与之关联的边，就降至$k-1$​阶情形，由归纳假设知成立。若$\forall v,deg(v)\geq2$​，$\delta(G)\geq2$​，由例$1.8$​知有圈。</p><p>综合$1、2$知成立。</p><p>另解（利用第二章树的知识）</p><p>不妨假设$G$连通，否则必然能找到一个满足条件的连通片进行讨论。考虑删去一些边（至少会删一条）至$\epsilon(G)=\nu(G)-1$，由定理$2.1(4)$和$(6)$知，这样的图是树，再加一条边即恰好含一个圈，得证。</p><p>（2）对顶点数$\nu(G)$进行归纳，首先注意到$\nu(G)(\nu(G)-1)/2\geq\epsilon(G)\geq\nu(G)+4$，得$\nu(G)\geq5$。</p><p>1.$\nu(G)=5$​时，$\epsilon(G)\geq9$​，即相当于$K_5$至多删一条边，经验证，显然成立。</p><p>2.假设$\nu(G)&lt;k$时成立，当$\nu(G)=k$时，$\epsilon(G)\geq\nu(G)+4&gt;\nu(G)$，由$(1)$知必有圈。</p><p>若$G$中存在长度为3或4的圈$C$,则，删去圈$C$的所有边依然满足$\epsilon(G)\geq\nu(G)$，仍然有圈，且与$C$无公共边，成立。</p><p>否则，所有圈长度大于等于5（无三角形或四边形）。</p><p>若$\exists v,s.t.\ deg(v)\leq1$​，删除此点及与之关联的一条边即降为$k-1$阶情形，由归纳假设知存在两个无公共边的圈，再加回来也不破坏，成立。</p><p>若$\exists v,s.t.\ deg(v)=2$，设与之相邻两点$v_1、v_2$，由于无三角形，则$v_1$与$v_2$不相邻，考虑删去$v$及$vv_1、vv_2$，加上$v_1v_2$，降至$k-1$阶情形，由归纳假设知存在两个无公共边的圈，若$v_1v_2$在圈中，将其替换回$vv_1、vv_2$依然满足；若不在圈中，加回来显然满足。</p><p>若$\forall v,deg(v)\geq3$，以下考虑$\epsilon(G)=\nu(G)+4$情形，若$\epsilon(G)&gt;\nu(G)+4$，删边即可，最后加回去不改变性质。</p><p>易知$\delta(G)\geq3$，从而$\sum deg(v)=2\epsilon(G)\geq3\nu(G)$，结合$\epsilon(G)=\nu(G)+4$，得$\nu(G)\leq8$。下证此情形必定存在三角形或四边形，从而不可能。</p><p>易知$G$​中有圈，设$C$​为圈长最短的圈，则圈中点除了圈上的边之外不会有其他边，否则与圈长最短矛盾。设圈长为$r$。</p><p>若$r=\nu(G)$，由于$\epsilon(G)=\nu(G)+4$，必定存在其他边，矛盾！</p><p>若$r=\nu(G)-1$，由$\forall v,deg(v)\geq3$，则只能是圈上每一点都与圈外那一点相连，从而存在三角形，矛盾！</p><p>若$r\leq\nu(G)-2$，而$r\geq5$。从而$\nu(G)=7$或$8$。</p><p>若$\nu(G)=7$，则$\epsilon(G)=11$$，r$只能为$5$，圈上有$5$条边，圈外$2$点至多连$1$条边，故圈外必有一点至少与圈上点有三条边，必存在三角形，矛盾！</p><p>若$\nu(G)=8$，则$\epsilon(G)=12$。</p><p>若$r=5$​​，圈上有$5$条边，则圈外$3$点至多有$2$​条边，必有一点至少与圈上点有两条边，从而必定存在四边形，矛盾！</p><p>若$r=6$，圈上有$6$条边，圈外$2$点至多连$1$条边，则圈外必有一点至少与圈上点有三条边，必存在四边形，矛盾！</p><p>综上，证毕。</p><h2 id="T26"><a href="#T26" class="headerlink" title="T26"></a>T26</h2><p>利用$Dijkstra$​​算法即可。以下有多条的只列举一条。</p><p>$c_2:c_1\rightarrow c_6\rightarrow c_2,35$​</p><p>$c_3:c_1\rightarrow c_5\rightarrow c_3,45$​</p><p>$c_4:c_1\rightarrow c_6\rightarrow c_4,35$</p><p>$c_5:c_1\rightarrow c_5,25$</p><p>$c_6:c_1\rightarrow c_6,10$​</p><p>彩蛋：</p><p>以下为使用$matlab$​​进行计算的代码，分别是利用$Dijkstra$​​求单源最短路、$Dijkstra$​​求距离矩阵和$Floyd$​​算法求距离矩阵。</p><p>特别地，$T28$和$T29$建模之后都可以使用软件求解。</p><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clc<span class="token punctuation">,</span> clear<span class="token punctuation">,</span> close all<span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">55</span><span class="token punctuation">;</span>s<span class="token operator">=</span><span class="token function">cellstr</span><span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token function">int2str</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%顶点字符串</span>G<span class="token operator">=</span><span class="token function">graph</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>s<span class="token punctuation">,</span><span class="token string">'Upper'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">%利用邻接矩阵的上三角元素构造无向图</span><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">6</span>    <span class="token punctuation">[</span>p<span class="token punctuation">,</span>d<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">shortestpath</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token comment">%求最短路径和最短距离</span><span class="token keyword">end</span>d <span class="token operator">=</span> <span class="token function">distances</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span><span class="token string">'Method'</span><span class="token punctuation">,</span><span class="token string">'positive'</span><span class="token punctuation">)</span> <span class="token comment">%反复调用Dijkstra算法求最短矩阵</span>n<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> b<span class="token operator">=</span>a<span class="token operator">+</span>a<span class="token operator">'</span><span class="token punctuation">;</span>  <span class="token comment">%构造完整的邻接矩阵</span><span class="token function">b</span><span class="token punctuation">(</span>b<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token keyword">inf</span><span class="token punctuation">;</span> <span class="token comment">%把零元素换成inf</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">%把对角线元素换成0</span><span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n        <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n            <span class="token keyword">if</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">b</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span>                <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">b</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">end</span>        <span class="token keyword">end</span>    <span class="token keyword">end</span><span class="token keyword">end</span>b  <span class="token comment">%显示两两顶点之间的最短距离</span><span class="token comment">%[p,d]=shortestpath(G,1,3) %求最短路径和最短距离</span><span class="token comment">%h=plot(G,'EdgeLabel',G.Edges.Weight);  %画无向图</span><span class="token comment">%highlight(h,p,'EdgeColor','r','LineWidth',2) %最短路径加粗</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>以下为$matlab$命令行结果输出。</p><pre class="line-numbers language-out" data-language="out"><code class="language-out">p &#x3D;     1     6     2d &#x3D;    35p &#x3D;     1     5     4     3d &#x3D;    45p &#x3D;     1     5     4d &#x3D;    35p &#x3D;     1     5d &#x3D;    25p &#x3D;     1     6d &#x3D;    10d &#x3D;     0    35    45    35    25    10    35     0    15    20    30    25    45    15     0    10    20    35    35    20    10     0    10    25    25    30    20    10     0    35    10    25    35    25    35     0b &#x3D;     0    35    45    35    25    10    35     0    15    20    30    25    45    15     0    10    20    35    35    20    10     0    10    25    25    30    20    10     0    35    10    25    35    25    35     0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="T27"><a href="#T27" class="headerlink" title="T27"></a>T27</h2><p>人、羊、狼、菜在岸上（岸的一边）一共有$2^4=16$​中可能，其中排除狼羊菜、羊菜、狼羊、人、人狼、人羊这$6$​种可能，还剩$10$​种，每种可能为$1$​个顶点，两顶点有边当且仅当两种情形可以通过一次运送转变，原题等价于求人样狼菜到空的一条最短路。可用$Dijkstra$​算法。本题比较简单，事实上画出图就可以立刻求得。有两条登场路线。</p><p>1.人羊狼菜$\rightarrow$狼菜$\rightarrow$人狼菜$\rightarrow$狼$\rightarrow$人狼羊$\rightarrow$羊$\rightarrow$人羊$\rightarrow$空</p><p>2.人羊狼菜$\rightarrow$狼菜$\rightarrow$人狼菜$\rightarrow$菜$\rightarrow$人羊菜$\rightarrow$羊$\rightarrow$人羊$\rightarrow$空</p><p>事实上有两条这件事情也可以从狼和菜的地位是相同的这一点看出来。</p><h2 id="T28"><a href="#T28" class="headerlink" title="T28"></a>T28</h2><p>设$x_1、x_2、x_3$​分别表示$8、5、3$​升瓶子中的酒量，则$x_1+x_2+x_3=8$​，$x_1\leq8,x_2\leq5,x_3\leq3$​，可能的组合一共有$(3+1)\times(5+1)=24$​种，每种情形表示一个顶点，两顶点之间有边当且仅当可以通过一次倒酒转化，原题等价与求$(8,0,0)\rightarrow(4,4,0)$​的最短路。可用$Dijkstra$​算法。</p><p>$(8,0,0)\rightarrow(3,5,0)\rightarrow(3,2,3)\rightarrow(6,2,0)\rightarrow(6,0,2)\rightarrow(1,5,2)\rightarrow(1,4,3)\rightarrow(4,4,0)$</p><h2 id="T29"><a href="#T29" class="headerlink" title="T29"></a>T29</h2><p>假设至多只有一个度为$1$​的顶点，由连通图知没有度为$0$​的顶点，则$\sum deg(v)=2\epsilon(G)\geq2\nu(G)-1$，由于$\epsilon(G)$是整数，易知$\epsilon(G)\geq\nu(G)$，与$\epsilon(G)&lt;\nu(G)$矛盾！故至少有两个度数为$1$​的顶点。</p><p>当然本题也可以用数学归纳法，不赘述。</p>]]></content>
      
      
      <categories>
          
          <category> 图论 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto Page3</title>
      <link href="2021/090224456.html"/>
      <url>2021/090224456.html</url>
      
        <content type="html"><![CDATA[<h1 id="Crypto-Page3"><a href="#Crypto-Page3" class="headerlink" title="Crypto Page3"></a>Crypto Page3</h1><h2 id="浪里淘沙"><a href="#浪里淘沙" class="headerlink" title="浪里淘沙"></a>浪里淘沙</h2><p>txt里是大量的英文单词，且中间还没有空格，考虑题目给的一串数字4、8、11、15、16猜测字频有关，这里可以用word（doge）进行统计。找到题目要求的组合成字符串即可得到flag。确实是浪里淘沙。</p><h2 id="NPUCTF2020-这是什么觅马"><a href="#NPUCTF2020-这是什么觅马" class="headerlink" title="[NPUCTF2020]这是什么觅马"></a>[NPUCTF2020]这是什么觅马</h2><p>附件用winhex打开发现是zip压缩文件。</p><p>修改拓展名解压得到一张图片（主体是日历）。</p><p>图片底部内容如下</p><pre class="line-numbers language-out" data-language="out"><code class="language-out">F1 W1 S22 S21 T12 S11 W1 S13<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>不难想到T1=TUE，T2=THU，S1=SAT，S2=SUN，其它开头无二义性对应星期。</p><p>然后从日历中找对应数字，在对应26个英文字母即为flag。</p><h2 id="AFCTF2018-Vigenere"><a href="#AFCTF2018-Vigenere" class="headerlink" title="[AFCTF2018]Vigenère"></a>[AFCTF2018]Vigenère</h2><p>老规矩，维吉尼亚上在线网站。</p><h2 id="BJDCTF2020-easyrsa"><a href="#BJDCTF2020-easyrsa" class="headerlink" title="[BJDCTF2020]easyrsa"></a>[BJDCTF2020]easyrsa</h2><p>由加密脚本得<br>$$<br>z=\frac{1}{arctan^{‘}(p)}-\frac{1}{artanh^{‘}(q)}=(p^2+1)-(1-q^2)=p^2+q^2<br>$$<br>接下来就很容易了，不难得到$p+q$和$p-q$从而分解$n$。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> iroot<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesc <span class="token operator">=</span> <span class="token number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span>z <span class="token operator">=</span> <span class="token number">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span>n <span class="token operator">=</span> <span class="token number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span>p_plus_q <span class="token operator">=</span> iroot<span class="token punctuation">(</span>z <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>p_sub_q <span class="token operator">=</span> iroot<span class="token punctuation">(</span>z <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>p_plus_q <span class="token operator">+</span> p_sub_q<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>q <span class="token operator">=</span> <span class="token punctuation">(</span>p_plus_q <span class="token operator">-</span> p_sub_q<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="NCTF2019-babyRSA"><a href="#NCTF2019-babyRSA" class="headerlink" title="[NCTF2019]babyRSA"></a>[NCTF2019]babyRSA</h2><p>本题关键是求$n$​，给了$d$，估算一下$k=(e*d-1)/n$的范围对$k$​进行爆破就可以​​了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> prevprime<span class="token punctuation">,</span> nextprime<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdme <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> <span class="token number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>c <span class="token operator">=</span> <span class="token number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span>e_d_1 <span class="token operator">=</span> e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span>p <span class="token operator">=</span> <span class="token number">0</span>q <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> k <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> e_d_1 <span class="token operator">%</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        p <span class="token operator">=</span> prevprime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>e_d_1 <span class="token operator">//</span> k<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        q <span class="token operator">=</span> nextprime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> k <span class="token operator">==</span> e_d_1<span class="token punctuation">:</span>            <span class="token keyword">break</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qm <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ACTF新生赛2020-crypto-rsa3"><a href="#ACTF新生赛2020-crypto-rsa3" class="headerlink" title="[ACTF新生赛2020]crypto-rsa3"></a>[ACTF新生赛2020]crypto-rsa3</h2><p>标准RSA。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span>c <span class="token operator">=</span> <span class="token number">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span>p <span class="token operator">=</span> <span class="token number">13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179231</span>q <span class="token operator">=</span> <span class="token number">13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179293</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="AFCTF2018-你能看出这是什么加密么"><a href="#AFCTF2018-你能看出这是什么加密么" class="headerlink" title="[AFCTF2018]你能看出这是什么加密么"></a>[AFCTF2018]你能看出这是什么加密么</h2><p>标准RSA。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesp <span class="token operator">=</span> <span class="token number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span>q <span class="token operator">=</span> <span class="token number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>c <span class="token operator">=</span> <span class="token number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="AFCTF2018-可怜的RSA"><a href="#AFCTF2018-可怜的RSA" class="headerlink" title="[AFCTF2018]可怜的RSA"></a>[AFCTF2018]可怜的RSA</h2><p>会读enc和key格式文件就行。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_OAEP<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSAf <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'public.key'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>pub <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>f<span class="token punctuation">)</span>n <span class="token operator">=</span> pub<span class="token punctuation">.</span>ne <span class="token operator">=</span> pub<span class="token punctuation">.</span>ep <span class="token operator">=</span> <span class="token number">3133337</span>q <span class="token operator">=</span> <span class="token number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span>d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 需要将mpz转成int</span>key_info <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_info<span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>key <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>c <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>f<span class="token punctuation">)</span>flag <span class="token operator">=</span> key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ACTF新生赛2020-crypto-classic0"><a href="#ACTF新生赛2020-crypto-classic0" class="headerlink" title="[ACTF新生赛2020]crypto-classic0"></a>[ACTF新生赛2020]crypto-classic0</h2><p>压缩包密码是生日猜测是八位数字，爆破即可，然后看加密脚本逆过来解密即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cipher'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token builtin">str</span> <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">^</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="鸡藕椒盐味"><a href="#鸡藕椒盐味" class="headerlink" title="鸡藕椒盐味"></a>鸡藕椒盐味</h2><p>知识点是奇偶校验位（题目谐音）和汉明码，有点偏，具体问度娘。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlibc <span class="token operator">=</span> <span class="token string">"110110100000"</span>md <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>md<span class="token punctuation">.</span>update<span class="token punctuation">(</span>c<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> md<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="RoarCTF2019-babyRSA"><a href="#RoarCTF2019-babyRSA" class="headerlink" title="[RoarCTF2019]babyRSA"></a>[RoarCTF2019]babyRSA</h2><p>关键是利用威尔逊定理。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> next_prime<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">def</span> <span class="token function">get_prime</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>    cnt <span class="token operator">=</span> A <span class="token operator">-</span> B    ret <span class="token operator">=</span> A <span class="token operator">-</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> cnt<span class="token punctuation">)</span><span class="token punctuation">:</span>        ret <span class="token operator">=</span> <span class="token punctuation">(</span>ret <span class="token operator">*</span> invert<span class="token punctuation">(</span>A <span class="token operator">-</span> i<span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> A    <span class="token keyword">return</span> next_prime<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>A1 <span class="token operator">=</span> <span class="token number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span>B1 <span class="token operator">=</span> <span class="token number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span>A2 <span class="token operator">=</span> <span class="token number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span>B2 <span class="token operator">=</span> <span class="token number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span>n <span class="token operator">=</span> <span class="token number">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span>c <span class="token operator">=</span> <span class="token number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span>p <span class="token operator">=</span> get_prime<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> B1<span class="token punctuation">)</span>q <span class="token operator">=</span> get_prime<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> B2<span class="token punctuation">)</span>r <span class="token operator">=</span> n <span class="token operator">//</span> p <span class="token operator">//</span> qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x1001</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="RoarCTF2019-RSA"><a href="#RoarCTF2019-RSA" class="headerlink" title="[RoarCTF2019]RSA"></a>[RoarCTF2019]RSA</h2><p>不难估计$x$和$y$范围不大，直接爆破即可，从而分解$n$​。（事实上由于$p$和$q$相差不大可以直接分解）</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> next_prime<span class="token punctuation">,</span> iroot<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesA <span class="token operator">=</span> <span class="token number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span>n <span class="token operator">=</span> <span class="token number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span>c <span class="token operator">=</span> <span class="token number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> y <span class="token operator">%</span> x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">%</span> x<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2019</span> <span class="token operator">+</span> y <span class="token operator">**</span> <span class="token number">316</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> x        <span class="token keyword">if</span> tmp <span class="token operator">==</span> A<span class="token punctuation">:</span>            q <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>n <span class="token operator">//</span> x <span class="token operator">//</span> y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>p <span class="token operator">=</span> n <span class="token operator">//</span> qe <span class="token operator">=</span> <span class="token number">65537</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="网鼎杯-2020-青龙组-boom"><a href="#网鼎杯-2020-青龙组-boom" class="headerlink" title="[网鼎杯 2020 青龙组]boom"></a>[网鼎杯 2020 青龙组]boom</h2><p>cmd打开不会闪退（doge），当然也可以录屏回看，en5oy x=74,y=68,z=31 x=89721561</p><h2 id="WUSTCTF2020-B-se"><a href="#WUSTCTF2020-B-se" class="headerlink" title="[WUSTCTF2020]B@se"></a>[WUSTCTF2020]B@se</h2><p>少了四位爆破即可，注意写一个自己的base64解密函数，因为替代表不一样</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertools<span class="token keyword">def</span> <span class="token function">My_base64_decode</span><span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>    bin_str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> inputs<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">!=</span> <span class="token string">'='</span><span class="token punctuation">:</span>            x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>            bin_str<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'&#123;:0>6&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print(bin_str)</span>    outputs <span class="token operator">=</span> <span class="token string">""</span>    nums <span class="token operator">=</span> inputs<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> bin_str<span class="token punctuation">:</span>        temp_list <span class="token operator">=</span> bin_str<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>        temp_str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp_list<span class="token punctuation">)</span>        <span class="token comment"># print(temp_str)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            temp_str <span class="token operator">=</span> temp_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> nums <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            outputs <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp_str<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        bin_str <span class="token operator">=</span> bin_str<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>outputs<span class="token punctuation">)</span>h <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'j'</span><span class="token punctuation">,</span> <span class="token string">'u'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">]</span>h1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>itertools<span class="token punctuation">.</span>permutations<span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> h1<span class="token punctuation">:</span>    m <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    s <span class="token operator">=</span> <span class="token string">"JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs"</span> <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token string">"kxyz012789+/"</span>    input_str <span class="token operator">=</span> <span class="token string">"MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD=="</span>    My_base64_decode<span class="token punctuation">(</span>input_str<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="救世捷径"><a href="#救世捷径" class="headerlink" title="救世捷径"></a>救世捷径</h2><p>单源最短路，Dijkstra算法。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">find</span><span class="token punctuation">(</span>present<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># present->list</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>present<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'25'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># end</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>present<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>present<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    s <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>present<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>lst<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># next country</span>            tmp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>lst<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token builtin">min</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">32</span>  <span class="token comment"># set very big</span>    tmp_s <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> l <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">min</span> <span class="token operator">></span> find<span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">(</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token builtin">min</span> <span class="token operator">=</span> find<span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">(</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># find the shortest</span>            tmp_s <span class="token operator">=</span> find<span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s <span class="token operator">+=</span> present<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> tmp_s    <span class="token keyword">return</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'save_world.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>l1 <span class="token operator">=</span> content<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span>l1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lst <span class="token operator">=</span> lst<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>find<span class="token punctuation">(</span>lst<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="AFCTF2018-Single"><a href="#AFCTF2018-Single" class="headerlink" title="[AFCTF2018]Single"></a>[AFCTF2018]Single</h2><p>直接上在线网站。</p><h2 id="RSA-amp-what"><a href="#RSA-amp-what" class="headerlink" title="RSA &amp; what"></a>RSA &amp; what</h2><p>按加密脚本逆推，涉及共模攻击，base64。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token punctuation">,</span> b64encode<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> a <span class="token operator">//</span> b            a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">)</span>    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> m<span class="token keyword">def</span> <span class="token function">get_base64_diff_value</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">:</span>    base64chars <span class="token operator">=</span> <span class="token string">b'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>    res <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">solve_stego</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    line <span class="token operator">=</span> <span class="token string">b''</span>    bin_str <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        k <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token string">b'\n'</span><span class="token punctuation">:</span>            steg_line <span class="token operator">=</span> line            norm_line <span class="token operator">=</span> b64encode<span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># print(b64decode(line))</span>            <span class="token comment"># print(steg_line, norm_line)</span>            diff <span class="token operator">=</span> get_base64_diff_value<span class="token punctuation">(</span>steg_line<span class="token punctuation">,</span> norm_line<span class="token punctuation">)</span>            <span class="token comment"># print(diff)</span>            pads_num <span class="token operator">=</span> steg_line<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">b'='</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> diff<span class="token punctuation">:</span>                bin_str <span class="token operator">+=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span>pads_num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span>pads_num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                bin_str <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token operator">*</span> pads_num <span class="token operator">*</span> <span class="token number">2</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>goflag<span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">)</span>            line <span class="token operator">=</span> <span class="token string">b''</span>            <span class="token keyword">continue</span>        line <span class="token operator">+=</span> k<span class="token keyword">def</span> <span class="token function">goflag</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">:</span>    res_str <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        res_str <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res_strc1 <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span><span class="token punctuation">,</span>    <span class="token number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span><span class="token punctuation">,</span>    <span class="token number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span><span class="token punctuation">,</span>    <span class="token number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span><span class="token punctuation">,</span>    <span class="token number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span><span class="token punctuation">,</span>    <span class="token number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span><span class="token punctuation">]</span>c2 <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span><span class="token punctuation">,</span>    <span class="token number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span><span class="token punctuation">,</span>    <span class="token number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span><span class="token punctuation">,</span>    <span class="token number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span><span class="token punctuation">,</span>    <span class="token number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span><span class="token punctuation">,</span>    <span class="token number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span><span class="token punctuation">]</span>N <span class="token operator">=</span> <span class="token number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span>e1 <span class="token operator">=</span> <span class="token number">1697</span>e2 <span class="token operator">=</span> <span class="token number">599</span><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">b''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">str</span> <span class="token operator">+=</span> long_to_bytes<span class="token punctuation">(</span>same_n_attack<span class="token punctuation">(</span>N<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>solve_stego<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WUSTCTF2020-大数计算"><a href="#WUSTCTF2020-大数计算" class="headerlink" title="[WUSTCTF2020]大数计算"></a>[WUSTCTF2020]大数计算</h2><p>对应解四个部分即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2021</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">*=</span> i    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">></span> <span class="token number">10</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> a <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">**</span> <span class="token number">7</span><span class="token punctuation">)</span>part1 <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1315</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    b <span class="token operator">*=</span> <span class="token number">520</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">></span> <span class="token number">10</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> b <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">**</span> <span class="token number">7</span><span class="token punctuation">)</span>part2 <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token number">80538738812075974</span> <span class="token operator">+</span> <span class="token number">80435758145817515</span> <span class="token operator">+</span> <span class="token number">12602123297335631</span>part3 <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>d <span class="token operator">=</span> <span class="token number">520</span> <span class="token operator">*</span> <span class="token number">1314</span>part4 <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> <span class="token string">'&#123;0&#125;-&#123;1&#125;-&#123;2&#125;-&#123;3&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>part1<span class="token punctuation">,</span> part2<span class="token punctuation">,</span> part3<span class="token punctuation">,</span> part4<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="HDCTF2019-together"><a href="#HDCTF2019-together" class="headerlink" title="[HDCTF2019]together"></a>[HDCTF2019]together</h2><p>共模攻击</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token keyword">from</span> binascii <span class="token keyword">import</span> b2a_hex<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> a <span class="token operator">//</span> b            a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">)</span>    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> m<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'myflag1'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    flag1 <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    flag1 <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span>c1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>b2a_hex<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'myflag2'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    flag2 <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    flag2 <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>flag2<span class="token punctuation">)</span>c2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>b2a_hex<span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>e1 <span class="token operator">=</span> <span class="token number">2333</span>e2 <span class="token operator">=</span> <span class="token number">23333</span>N <span class="token operator">=</span> <span class="token number">0x75A8B8AA2AD2950E9AED4BE34618DFBEABB8CBA832685CC94F45173330100624846CCF90F3C2DB75BA5AF4B39CAEF1175AB9F898794EAC6082A4F766F7CB280B16F6980B38DDA811761324D619513B3CBE65877ACF51FC70405A8347C121207E71F8E6FCAE39647ED2231D306DD53849257BC306E997A502867012249D1691F5DC11D6AF06539F3F808939343DDE09301A761AE12C1C969076C502BC5A971E10ABCB366547BC94373F37A57DDC43858DB29BAAAAAD0E6867885EA3757403008C164E9C7AFA39B3C65089A151DDD8C06C64271086F9255ADB8ACF82182F8FA252930A187961635BC2A85C761330F85C896314B3FDAE4EFEF7E0A8C93B8854BFC3</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>same_n_attack<span class="token punctuation">(</span>N<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="MRCTF2020-babyRSA"><a href="#MRCTF2020-babyRSA" class="headerlink" title="[MRCTF2020]babyRSA"></a>[MRCTF2020]babyRSA</h2><p>看加密脚本容易解出$p$和$q$。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> sympy <span class="token keyword">import</span> prevprime<span class="token punctuation">,</span> nextprime<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesP_p <span class="token operator">=</span> <span class="token number">206027926847308612719677572554991143421</span>P_factor <span class="token operator">=</span> <span class="token number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span>Q_1 <span class="token operator">=</span> <span class="token number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span>Q_2 <span class="token operator">=</span> <span class="token number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span>sub_Q <span class="token operator">=</span> <span class="token number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span>Ciphertext <span class="token operator">=</span> <span class="token number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span>e <span class="token operator">=</span> <span class="token number">65537</span>lst_p <span class="token operator">=</span> <span class="token punctuation">[</span>P_p<span class="token punctuation">]</span>pre <span class="token operator">=</span> P_p<span class="token builtin">next</span> <span class="token operator">=</span> P_p<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    pre <span class="token operator">=</span> prevprime<span class="token punctuation">(</span>pre<span class="token punctuation">)</span>    lst_p<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">next</span> <span class="token operator">=</span> nextprime<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">)</span>    lst_p<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">)</span>phi <span class="token operator">=</span> <span class="token number">1</span>n <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">*=</span> lst_p<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    phi <span class="token operator">*=</span> <span class="token punctuation">(</span>lst_p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>P <span class="token operator">=</span> nextprime<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>P_factor<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>Q <span class="token operator">=</span> nextprime<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>sub_Q<span class="token punctuation">,</span> Q_2<span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span><span class="token punctuation">)</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>P <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>N <span class="token operator">=</span> P <span class="token operator">*</span> Qm <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>Ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="坏蛋是雷宾"><a href="#坏蛋是雷宾" class="headerlink" title="坏蛋是雷宾"></a>坏蛋是雷宾</h2><p>加密算法和这位老牌刺客同名，知是$Rabin$密码，有校验值判断具体是四个中的哪一个，校验码根据说明是放在明文后一起加密的，最后md5时要去掉。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">import</span> hashlibn <span class="token operator">=</span> <span class="token number">523798549</span>p <span class="token operator">=</span> <span class="token number">10663</span>q <span class="token operator">=</span> <span class="token number">49123</span>e <span class="token operator">=</span> <span class="token number">2</span>c <span class="token operator">=</span> <span class="token number">162853095</span>inv_p <span class="token operator">=</span> invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>inv_q <span class="token operator">=</span> invert<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>mp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>mq <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token punctuation">(</span>inv_p <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">+</span> inv_q <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span> <span class="token operator">%</span> nb <span class="token operator">=</span> n <span class="token operator">-</span> ac <span class="token operator">=</span> <span class="token punctuation">(</span>inv_p <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">-</span> inv_q <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span> <span class="token operator">%</span> nd <span class="token operator">=</span> n <span class="token operator">-</span> ccheck <span class="token operator">=</span> <span class="token string">'110001'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">==</span> check<span class="token punctuation">:</span>        m <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        md <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>        md<span class="token punctuation">.</span>update<span class="token punctuation">(</span>m<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        flag <span class="token operator">=</span> md<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag&#123;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="网鼎杯-2020-青龙组-you-raise-me-up"><a href="#网鼎杯-2020-青龙组-you-raise-me-up" class="headerlink" title="[网鼎杯 2020 青龙组]you_raise_me_up"></a>[网鼎杯 2020 青龙组]you_raise_me_up</h2><p>离散对数问题。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> discrete_log<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesm <span class="token operator">=</span> <span class="token number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span>c <span class="token operator">=</span> <span class="token number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>discrete_log<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token number">512</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BJDCTF2020-Polybius"><a href="#BJDCTF2020-Polybius" class="headerlink" title="[BJDCTF2020]Polybius"></a>[BJDCTF2020]Polybius</h2><p>$hint$​为base64，内容如下：The length of this plaintext: 14。</p><p>密码体制如题为$Polybius$。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertools<span class="token keyword">def</span> <span class="token function">gen_cheese_map</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> use_Q<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> upper<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    k <span class="token operator">=</span> k<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    k0 <span class="token operator">=</span> <span class="token string">""</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> k<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">for</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">if</span> use_Q <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> upper <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">25</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k0<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">:</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">polybius_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"ADFGX"</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">,</span>upper<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> c<span class="token punctuation">:</span>        i <span class="token operator">=</span> name<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        j <span class="token operator">=</span> name<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        r <span class="token operator">+=</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>    <span class="token keyword">return</span> rs <span class="token operator">=</span> <span class="token string">"aeoiu"</span>name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>cipher <span class="token operator">=</span> <span class="token string">"ouauuuoooeeaaiaeauieuooeeiea"</span>c<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>permutations<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 找出所有全排列</span>    name<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> name<span class="token punctuation">:</span>    ans <span class="token operator">=</span> polybius_decode<span class="token punctuation">(</span>c<span class="token punctuation">,</span> name<span class="token operator">=</span>i<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> ans<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> ans <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WUSTCTF2020-情书"><a href="#WUSTCTF2020-情书" class="headerlink" title="[WUSTCTF2020]情书"></a>[WUSTCTF2020]情书</h2><p>简单的RSA。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>c <span class="token operator">=</span> <span class="token string">"0156 0821 1616 0041 0140 2130 1616 0793"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>N <span class="token operator">=</span> <span class="token number">2537</span>e <span class="token operator">=</span> <span class="token number">13</span>d <span class="token operator">=</span> <span class="token number">937</span>p <span class="token operator">=</span> <span class="token number">43</span>q <span class="token operator">=</span> <span class="token number">59</span>phi_N <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="UTCTF2020-basic-crypto"><a href="#UTCTF2020-basic-crypto" class="headerlink" title="[UTCTF2020]basic-crypto"></a>[UTCTF2020]basic-crypto</h2><p>考察编码和古典密码的基本功，一步步解密即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'attachment.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    s <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b' '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>encoding <span class="token operator">=</span> <span class="token string">'TmV3IGNoYWxsZW5nZSEgQ2FuIHlvdSBmaWd1cmUgb3V0IHdoYXQncyBnb2luZyBvbiBoZXJlPyBJdCBsb29rcyBsaWtlIHRoZSBsZXR0ZXJzIGFyZSBzaGlmdGVkIGJ5IHNvbWUgY29uc3RhbnQuIChoaW50OiB5b3UgbWlnaHQgd2FudCB0byBzdGFydCBsb29raW5nIHVwIFJvbWFuIHBlb3BsZSkuCmt2YnNxcmQsIGl5ZSdibyBrdnd5Y2QgZHJvYm8hIFh5ZyBweWIgZHJvIHBzeGt2IChreG4gd2tpbG8gZHJvIHJrYm5vY2QuLi4pIHprYmQ6IGsgY2VsY2RzZGVkc3l4IG1zenJvYi4gU3ggZHJvIHB5dnZ5Z3N4cSBkb2hkLCBTJ2ZvIGRrdW94IHdpIHdvY2NrcW8ga3huIGJvenZrbW9uIG9mb2JpIGt2enJrbG9kc20gbXJrYmttZG9iIGdzZHIgayBteWJib2N6eXhub3htbyBkeSBrIG5zcHBvYm94ZCBtcmtia21kb2IgLSB1eHlneCBrYyBrIGNlbGNkc2RlZHN5eCBtc3pyb2IuIE1reCBpeWUgcHN4biBkcm8gcHN4a3YgcHZrcT8gcnN4ZDogR28gdXh5ZyBkcmtkIGRybyBwdmtxIHNjIHF5c3hxIGR5IGxvIHlwIGRybyBweWJ3a2QgZWRwdmtxey4uLn0gLSBncnNtciB3b2t4YyBkcmtkIHNwIGl5ZSBjb28gZHJrZCB6a2Rkb2J4LCBpeWUgdXh5ZyBncmtkIGRybyBteWJib2N6eXhub3htb2MgcHliIGUsIGQsIHAsIHYgaywga3huIHEga2JvLiBJeWUgbWt4IHpieWxrbHZpIGd5YnUgeWVkIGRybyBib3drc3hzeHEgbXJrYmttZG9iYyBsaSBib3p2a21zeHEgZHJvdyBreG4gc3hwb2Jic3hxIG15d3d5eCBneWJuYyBzeCBkcm8gT3hxdnNjciB2a3hxZWtxby4gS3h5ZHJvYiBxYm9rZCB3b2RyeW4gc2MgZHkgZWNvIHBib2Flb3htaSBreGt2aWNzYzogZ28gdXh5ZyBkcmtkICdvJyBjcnlnYyBleiB3eWNkIHlwZG94IHN4IGRybyBrdnpya2xvZCwgY3kgZHJrZCdjIHpieWxrbHZpIGRybyB3eWNkIG15d3d5eCBtcmtia21kb2Igc3ggZHJvIGRvaGQsIHB5dnZ5Z29uIGxpICdkJywga3huIGN5IHl4LiBZeG1vIGl5ZSB1eHlnIGsgcG9nIG1ya2JrbWRvYmMsIGl5ZSBta3ggc3hwb2IgZHJvIGJvY2QgeXAgZHJvIGd5Ym5jIGxrY29uIHl4IG15d3d5eCBneWJuYyBkcmtkIGNyeWcgZXogc3ggZHJvIE94cXZzY3Igdmt4cWVrcW8uCnJnaG54c2RmeXNkdGdodSEgcWdmIGlzYWsgY3RodHVpa2UgZGlrIHprbnRoaGt4IHJ4cWxkZ254c2xpcSByaXN5eWtobmsuIGlreGsgdHUgcyBjeXNuIGNneCBzeXkgcWdmeCBpc3hlIGtjY2d4ZHU6IGZkY3lzbntoMHZfZGk0ZHVfdmk0ZF90X3I0eXlfcnhxbGQwfS4gcWdmIHZ0eXkgY3RoZSBkaXNkIHMgeWdkIGdjIHJ4cWxkZ254c2xpcSB0dSBwZnVkIHpmdHlldGhuIGdjYyBkaXR1IHVneGQgZ2MgenN1dHIgYmhndnlrZW5rLCBzaGUgdGQgeGtzeXlxIHR1IGhnZCB1ZyB6c2Ugc2Nka3ggc3l5LiBpZ2xrIHFnZiBraHBncWtlIGRpayByaXN5eWtobmsh'</span><span class="token keyword">print</span><span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>encoding<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''10alright, you're almost there! now for the final (and maybe the hardest...) part: a substitution cipher. in the following text, i've taken my message and replaced every alphabetic character with a correspondence to a different character - known as a substitution cipher. can you find the final flag? hint: we know that the flag is going to be of the format utflag&#123;...&#125; - which means that if you see that pattern, you know what the correspondences for u, t, f, l a, and g are. you can probably work out the remaining characters by replacing them and inferring common words in the english language. another great method is to use frequency analysis: we know that 'e' shows up most often in the alphabet, so that's probably the most common character in the text, followed by 't', and so on. once you know a few characters, you can infer the rest of the words based on common words that show up in the english language.hwxdnitvoitjwxk! gwv yiqa sjxjkyau tya padjxxan hngbtwdnibyg hyiooaxda. yana jk i soid swn ioo gwvn yinu asswntk: vtsoid&#123;x0l_ty4tk_ly4t_j_h4oo_hngbt0&#125;. gwv ljoo sjxu tyit i owt ws hngbtwdnibyg jk fvkt pvjoujxd wss tyjk kwnt ws pikjh rxwloauda, ixu jt naioog jk xwt kw piu istan ioo. ywba gwv axfwgau tya hyiooaxda!congratulations! you have finished the beginner cryptography challenge. here is a flag for all your hard efforts: utflag&#123;n0w_th4ts_wh4t_i_c4ll_crypt0&#125;. you will find that a lot of cryptography is just building off this sort of basic knowledge, and it really is not so bad after all. hope you enjoyed the challenge!'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WUSTCTF2020-dp-leaking-1s-very-d-angerous"><a href="#WUSTCTF2020-dp-leaking-1s-very-d-angerous" class="headerlink" title="[WUSTCTF2020]dp_leaking_1s_very_d@angerous"></a>[WUSTCTF2020]dp_leaking_1s_very_d@angerous</h2><p>$dp$泄露</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span>gcd<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span>c <span class="token operator">=</span> <span class="token number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span>dp <span class="token operator">=</span> <span class="token number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span>p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> e <span class="token operator">*</span> dp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BJDCTF2020-编码与调制"><a href="#BJDCTF2020-编码与调制" class="headerlink" title="[BJDCTF2020]编码与调制"></a>[BJDCTF2020]编码与调制</h2><p>曼标准彻斯特。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesnum <span class="token operator">=</span> <span class="token number">0x424A447B4469664D616E63686573746572636F64657D</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ACTF新生赛2020-crypto-classic1"><a href="#ACTF新生赛2020-crypto-classic1" class="headerlink" title="[ACTF新生赛2020]crypto-classic1"></a>[ACTF新生赛2020]crypto-classic1</h2><p>压缩包密码根据$hint$​是键盘码，$xdfv$​包围$c$​，依次类推</p><p>维吉尼亚密码放在线网站无果，考虑经典维吉尼亚密码解密，脚本如下。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>s1 <span class="token operator">=</span> <span class="token string">'ACTF'</span>s2 <span class="token operator">=</span> <span class="token string">'SRLU'</span>key <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">+=</span> s<span class="token punctuation">[</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>find<span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> s<span class="token punctuation">.</span>find<span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>cipher <span class="token operator">=</span> <span class="token string">'SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;'</span>key <span class="token operator">=</span> <span class="token string">'SP'</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> s<span class="token punctuation">:</span>        flag <span class="token operator">+=</span> cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> s<span class="token punctuation">[</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>find<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">-</span> s<span class="token punctuation">.</span>find<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># flag要小写</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="NPUCTF2020-Classical-Cipher"><a href="#NPUCTF2020-Classical-Cipher" class="headerlink" title="[NPUCTF2020]Classical Cipher"></a>[NPUCTF2020]Classical Cipher</h2><p>压缩包密码上$quipqiup$​爆破，要用$clue$。</p><p>变形猪圈密码。</p><h2 id="EasyProgram"><a href="#EasyProgram" class="headerlink" title="EasyProgram"></a>EasyProgram</h2><p>不难发现加解密过程是可逆的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">key <span class="token operator">=</span> <span class="token string">"whoami"</span>s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>i <span class="token operator">=</span> <span class="token number">0</span>j <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token string">""</span>flagx <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span>         <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span>         <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">]</span><span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    x <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>flagx<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">^</span> s<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="NPUCTF2020-EzRSA"><a href="#NPUCTF2020-EzRSA" class="headerlink" title="[NPUCTF2020]EzRSA"></a>[NPUCTF2020]EzRSA</h2><p>关键是去猜$gcd(p-1,q-1)$，最后的结果是8。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> lcm<span class="token punctuation">,</span> iroot<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> sympy <span class="token keyword">import</span> Symbol<span class="token punctuation">,</span> solven <span class="token operator">=</span> <span class="token number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span>gift <span class="token operator">=</span> <span class="token number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span>c <span class="token operator">=</span> <span class="token number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span>e <span class="token operator">=</span> <span class="token number">54722</span>phi <span class="token operator">=</span> gift <span class="token operator">*</span> <span class="token number">8</span>x <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>y <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span>x <span class="token operator">*</span> y <span class="token operator">-</span> n<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> gift <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token keyword">assert</span> p <span class="token operator">*</span> q <span class="token operator">==</span> n<span class="token keyword">assert</span> gift <span class="token operator">==</span> lcm<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>m_mid <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>m_mid<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="AFCTF2018-BASE"><a href="#AFCTF2018-BASE" class="headerlink" title="[AFCTF2018]BASE"></a>[AFCTF2018]BASE</h2><p>base套娃。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b16decode<span class="token punctuation">,</span>b32decode<span class="token punctuation">,</span>b64decode<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag_encode.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> flag <span class="token keyword">in</span> f<span class="token punctuation">:</span>        find <span class="token operator">=</span> <span class="token boolean">False</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                flag <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                <span class="token keyword">pass</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                flag <span class="token operator">=</span> b32decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                <span class="token keyword">pass</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                flag <span class="token operator">=</span> b16decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                <span class="token keyword">pass</span>            <span class="token keyword">if</span> <span class="token string">"&#123;"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>                find <span class="token operator">=</span> <span class="token boolean">True</span>                <span class="token keyword">break</span>        <span class="token keyword">if</span> find<span class="token punctuation">:</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto Page2</title>
      <link href="2021/090240777.html"/>
      <url>2021/090240777.html</url>
      
        <content type="html"><![CDATA[<h1 id="Crypto-Page2"><a href="#Crypto-Page2" class="headerlink" title="Crypto Page2"></a>Crypto Page2</h1><h2 id="robomunication"><a href="#robomunication" class="headerlink" title="robomunication"></a>robomunication</h2><p>摩斯密码，需要听声音记录。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s<span class="token operator">=</span><span class="token string">'.... . .-.. .-.. --- .-- .... .- - .. ... - .... . -.- . -.-- .. - .. ... -... --- --- .--. -... . . .--.'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Dangerous-RSA"><a href="#Dangerous-RSA" class="headerlink" title="Dangerous RSA"></a>Dangerous RSA</h2><p>根据题目$e$很小，小指数明文爆破。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> iroot<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesn <span class="token operator">=</span> <span class="token number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span>e <span class="token operator">=</span> <span class="token number">0x3</span>c <span class="token operator">=</span> <span class="token number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Cipher"><a href="#Cipher" class="headerlink" title="Cipher"></a>Cipher</h2><p>公平的玩吧意为playfair，</p><p>可以用在线网站<a href="http://rumkin.com/tools/cipher/playfair.php">http://rumkin.com/tools/cipher/playfair.php</a></p><p>也可以用自己写的脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gen_cheese_map</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> use_Q<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> upper<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    k <span class="token operator">=</span> k<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    k0 <span class="token operator">=</span> <span class="token string">""</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> k<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">for</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">if</span> use_Q <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> upper <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">25</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k0<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">:</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">_playfair_2char</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                ai <span class="token operator">=</span> i                aj <span class="token operator">=</span> j            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                bi <span class="token operator">=</span> i                bj <span class="token operator">=</span> j    <span class="token keyword">if</span> ai <span class="token operator">==</span> bi<span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        bxi <span class="token operator">=</span> bi        axj <span class="token operator">=</span> <span class="token punctuation">(</span>aj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxj <span class="token operator">=</span> <span class="token punctuation">(</span>bj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">elif</span> aj <span class="token operator">==</span> bj<span class="token punctuation">:</span>        axj <span class="token operator">=</span> aj        bxj <span class="token operator">=</span> bj        axi <span class="token operator">=</span> <span class="token punctuation">(</span>ai <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxi <span class="token operator">=</span> <span class="token punctuation">(</span>bi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        axj <span class="token operator">=</span> bj        bxi <span class="token operator">=</span> bi        bxj <span class="token operator">=</span> aj    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">[</span>axi<span class="token punctuation">]</span><span class="token punctuation">[</span>axj<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">map</span><span class="token punctuation">[</span>bxi<span class="token punctuation">]</span><span class="token punctuation">[</span>bxj<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">playfair_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> m<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    tmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>            tmp <span class="token operator">+=</span> i    m <span class="token operator">=</span> tmp    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    m0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    idx <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> m<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">2</span>        <span class="token keyword">elif</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"X"</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"X"</span><span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">if</span> idx <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"X"</span><span class="token punctuation">:</span>                m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"X"</span><span class="token punctuation">)</span>                idx <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m0<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_playfair_2char<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">_playfair_2char_decode</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                ai <span class="token operator">=</span> i                aj <span class="token operator">=</span> j            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                bi <span class="token operator">=</span> i                bj <span class="token operator">=</span> j    <span class="token keyword">if</span> ai <span class="token operator">==</span> bi<span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        bxi <span class="token operator">=</span> bi        axj <span class="token operator">=</span> <span class="token punctuation">(</span>aj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxj <span class="token operator">=</span> <span class="token punctuation">(</span>bj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">elif</span> aj <span class="token operator">==</span> bj<span class="token punctuation">:</span>        axj <span class="token operator">=</span> aj        bxj <span class="token operator">=</span> bj        axi <span class="token operator">=</span> <span class="token punctuation">(</span>ai <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxi <span class="token operator">=</span> <span class="token punctuation">(</span>bi <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        axj <span class="token operator">=</span> bj        bxi <span class="token operator">=</span> bi        bxj <span class="token operator">=</span> aj    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">[</span>axi<span class="token punctuation">]</span><span class="token punctuation">[</span>axj<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">map</span><span class="token punctuation">[</span>bxi<span class="token punctuation">]</span><span class="token punctuation">[</span>bxj<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">playfair_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_playfair_2char_decode<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>r<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token string">"Dncnoqqfliqrpgeklwmppu"</span>k <span class="token operator">=</span> <span class="token string">"playfair"</span>c <span class="token operator">=</span> c<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>lst_c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    lst_c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>playfair_decode<span class="token punctuation">(</span>lst_c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="HDCTF2019-basic-rsa"><a href="#HDCTF2019-basic-rsa" class="headerlink" title="[HDCTF2019]basic rsa"></a>[HDCTF2019]basic rsa</h2><p>基本的rsa解密</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertp <span class="token operator">=</span> <span class="token number">262248800182277040650192055439906580479</span>q <span class="token operator">=</span> <span class="token number">262854994239322828547925595487519915551</span>e <span class="token operator">=</span> <span class="token number">65533</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qd <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token number">27565231154623519221597938803435789010285480123476977081867877272451638645710</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="达芬奇密码"><a href="#达芬奇密码" class="headerlink" title="达芬奇密码"></a>达芬奇密码</h2><p>不难发现有一个斐波那契数列，对应地去找索引即可。</p><p>特别地，注意有两个1要特殊处理。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">num <span class="token operator">=</span> <span class="token string">'1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711'</span>flag <span class="token operator">=</span> <span class="token string">'36968853882116725547342176952286'</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>lst_num <span class="token operator">=</span> num<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>Fibonacci <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> lst_num<span class="token punctuation">]</span>Fibonacci<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>lst_num<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span>lst_num<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>Fibonacci<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>ans <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ans <span class="token operator">+=</span> flag<span class="token punctuation">[</span>index<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> ans <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="GUET-CTF2019-BabyRSA"><a href="#GUET-CTF2019-BabyRSA" class="headerlink" title="[GUET-CTF2019]BabyRSA"></a>[GUET-CTF2019]BabyRSA</h2><p>已知$(p+1)(q+1)$和$p+q$求$n=pq$即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytespaq <span class="token operator">=</span> <span class="token number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span>p_q <span class="token operator">=</span> <span class="token number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span>e <span class="token operator">=</span> <span class="token number">0xe6b1bee47bd63f615c7d0a43c529d219</span>d <span class="token operator">=</span> <span class="token number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span>enc_flag <span class="token operator">=</span> <span class="token number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span>n <span class="token operator">=</span> p_q <span class="token operator">-</span> paq <span class="token operator">-</span> <span class="token number">1</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="GXYCTF2019-CheckIn"><a href="#GXYCTF2019-CheckIn" class="headerlink" title="[GXYCTF2019]CheckIn"></a>[GXYCTF2019]CheckIn</h2><p>两次解码，Base64和ROT47.</p><h2 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h2><p>一看N和e都很大，估算一下可以用维纳攻击求出d。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlibd<span class="token operator">=</span><span class="token number">8920758995414587152829426558580025657357328745839747693739591820283538307445</span>flag <span class="token operator">=</span> <span class="token string">"flag&#123;"</span> <span class="token operator">+</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'L'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="RSA5"><a href="#RSA5" class="headerlink" title="RSA5"></a>RSA5</h2><p>给了多组从c，n，尝试公约模数分解。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>n0 <span class="token operator">=</span> <span class="token number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span>c0 <span class="token operator">=</span> <span class="token number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span>n1 <span class="token operator">=</span> <span class="token number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span>c1 <span class="token operator">=</span> <span class="token number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span>n2 <span class="token operator">=</span> <span class="token number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span>c2 <span class="token operator">=</span> <span class="token number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span>n3 <span class="token operator">=</span> <span class="token number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span>c3 <span class="token operator">=</span> <span class="token number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span>n4 <span class="token operator">=</span> <span class="token number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span>c4 <span class="token operator">=</span> <span class="token number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span>n5 <span class="token operator">=</span> <span class="token number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span>c5 <span class="token operator">=</span> <span class="token number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span>n6 <span class="token operator">=</span> <span class="token number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span>c6 <span class="token operator">=</span> <span class="token number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span>n7 <span class="token operator">=</span> <span class="token number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span>c7 <span class="token operator">=</span> <span class="token number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span>n8 <span class="token operator">=</span> <span class="token number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span>c8 <span class="token operator">=</span> <span class="token number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span>n9 <span class="token operator">=</span> <span class="token number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span>c9 <span class="token operator">=</span> <span class="token number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span>n10 <span class="token operator">=</span> <span class="token number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span>c10 <span class="token operator">=</span> <span class="token number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span>n11 <span class="token operator">=</span> <span class="token number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span>c11 <span class="token operator">=</span> <span class="token number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span>n12 <span class="token operator">=</span> <span class="token number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span>c12 <span class="token operator">=</span> <span class="token number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span>n13 <span class="token operator">=</span> <span class="token number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span>c13 <span class="token operator">=</span> <span class="token number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span>n14 <span class="token operator">=</span> <span class="token number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span>c14 <span class="token operator">=</span> <span class="token number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span>n15 <span class="token operator">=</span> <span class="token number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span>c15 <span class="token operator">=</span> <span class="token number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span>n16 <span class="token operator">=</span> <span class="token number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span>c16 <span class="token operator">=</span> <span class="token number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span>n17 <span class="token operator">=</span> <span class="token number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span>c17 <span class="token operator">=</span> <span class="token number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span>n18 <span class="token operator">=</span> <span class="token number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span>c18 <span class="token operator">=</span> <span class="token number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span>n19 <span class="token operator">=</span> <span class="token number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span>c19 <span class="token operator">=</span> <span class="token number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>c0<span class="token punctuation">,</span> n0<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c3<span class="token punctuation">,</span> n3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c4<span class="token punctuation">,</span> n4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c5<span class="token punctuation">,</span> n5<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c6<span class="token punctuation">,</span> n6<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c7<span class="token punctuation">,</span> n7<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c8<span class="token punctuation">,</span> n8<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c9<span class="token punctuation">,</span> n9<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c10<span class="token punctuation">,</span> n10<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">(</span>c11<span class="token punctuation">,</span> n11<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c12<span class="token punctuation">,</span> n12<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c13<span class="token punctuation">,</span> n13<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c14<span class="token punctuation">,</span> n14<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c15<span class="token punctuation">,</span> n15<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c16<span class="token punctuation">,</span> n16<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c17<span class="token punctuation">,</span> n17<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c18<span class="token punctuation">,</span> n18<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c19<span class="token punctuation">,</span> n19<span class="token punctuation">)</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token number">0</span>q <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> gcd<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> t <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> t            q <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">//</span> p            phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>            m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="密码学的心声"><a href="#密码学的心声" class="headerlink" title="密码学的心声"></a>密码学的心声</h2><p>根据简谱，三个一位八进制转ASCⅡ码即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">166</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span>s <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> lst<span class="token punctuation">:</span>    s <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">"flag&#123;"</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BJDCTF2020-这是base"><a href="#BJDCTF2020-这是base" class="headerlink" title="[BJDCTF2020]这是base??"></a>[BJDCTF2020]这是base??</h2><p>base表进行了替换，根据base原理写一个对应的解码程序即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'J'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'K'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">'M'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">'U'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">'V'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span> <span class="token string">'B'</span><span class="token punctuation">,</span>        <span class="token number">13</span><span class="token punctuation">:</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">:</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">:</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">:</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">:</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">:</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">:</span> <span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">:</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">:</span> <span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">:</span> <span class="token string">'Q'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">:</span> <span class="token string">'I'</span><span class="token punctuation">,</span>        <span class="token number">25</span><span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">:</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">:</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">:</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">:</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">:</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">:</span> <span class="token string">'j'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">:</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">:</span> <span class="token string">'l'</span><span class="token punctuation">,</span>        <span class="token number">37</span><span class="token punctuation">:</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">:</span> <span class="token string">'W'</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">:</span> <span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">:</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">:</span> <span class="token string">'Z'</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">:</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">:</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">:</span> <span class="token string">'6'</span><span class="token punctuation">,</span>        <span class="token number">49</span><span class="token punctuation">:</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">:</span> <span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">:</span> <span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">:</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">:</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">:</span> <span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">:</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">:</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">:</span> <span class="token string">'t'</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">:</span> <span class="token string">'u'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">:</span> <span class="token string">'v'</span><span class="token punctuation">,</span>        <span class="token number">61</span><span class="token punctuation">:</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">:</span> <span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">:</span> <span class="token string">'='</span><span class="token punctuation">&#125;</span>new_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>v <span class="token punctuation">:</span> k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token string">''</span>    p1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span>    p2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">:</span>        str_p1 <span class="token operator">=</span> s<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">bin</span><span class="token punctuation">(</span>new_dict<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> str_p1<span class="token punctuation">]</span>        tmp_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>tmp_str<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp_res<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> p2<span class="token punctuation">:</span>        str_p2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">*</span>p1<span class="token punctuation">:</span><span class="token punctuation">]</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">bin</span><span class="token punctuation">(</span>new_dict<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> str_p2<span class="token punctuation">]</span>        tmp_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>tmp_str<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp_res<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> reschipertext<span class="token operator">=</span><span class="token string">'FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw'</span><span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>chipertext<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="传感器"><a href="#传感器" class="headerlink" title="传感器"></a>传感器</h2><p>根据提示曼联，应该是曼彻斯特编码，可以上网找现成工具，也可以用脚本。</p><p>803.2曼彻斯特，每8位反序。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cipher<span class="token operator">=</span><span class="token string">'5555555595555A65556AA696AA6666666955'</span><span class="token keyword">def</span> <span class="token function">iee</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp<span class="token operator">=</span><span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token operator">+</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>        tmp<span class="token operator">=</span>tmp<span class="token operator">+</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>    plain<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span><span class="token operator">+</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span>iee<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="rot"><a href="#rot" class="headerlink" title="rot"></a>rot</h2><p>先用rot13发现flag少了4位，再看还有一个md5，猜测是最终的flag的md5.考虑直接进行爆破，大约一分钟能出结果。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">def</span> <span class="token function">brute</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    w <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    w0 <span class="token operator">=</span> w<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>w0 <span class="token operator">==</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span>s <span class="token operator">=</span> <span class="token string">'83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112'</span>lst <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> lst<span class="token punctuation">:</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">"flag&#123;www_shiyanbar_com_is_very_good_"</span>m <span class="token operator">=</span> <span class="token string">'38e4c352809e150186920aac37190cbc'</span>brute<span class="token punctuation">(</span>flag<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="NCTF2019-childRSA"><a href="#NCTF2019-childRSA" class="headerlink" title="[NCTF2019]childRSA"></a>[NCTF2019]childRSA</h2><p>sieve_base里有前10000个素数，由加密程序知p-1为这10000个素数里若干个素数乘积，考虑费马小定理<br>$$<br>a^{(p-1)}\equiv 1\ mod\ p<br>$$</p><p>$$<br>a^{(p-1)}-1=kp<br>$$</p><p>计算$a^{(p-1)}$的时候可以对n取模，效果一样。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> sieve_base <span class="token keyword">as</span> primes<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdmn <span class="token operator">=</span> <span class="token number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span>c <span class="token operator">=</span> <span class="token number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>p <span class="token operator">=</span> <span class="token number">0</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> primes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>gcd<span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> gcd<span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>            <span class="token keyword">break</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="NCTF2019-Keyboard"><a href="#NCTF2019-Keyboard" class="headerlink" title="[NCTF2019]Keyboard"></a>[NCTF2019]Keyboard</h2><p>首先不难发现秘文里只有键盘第一行的字母，显然是对应键盘上面这一行上面的数字，然后根据九键有几个数对应第几个字母，如o对应9，三个9表示第三个字母y。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">cipher<span class="token operator">=</span><span class="token string">"ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee"</span>base<span class="token operator">=</span><span class="token string">" qwertyuiop"</span>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token string">"abc"</span><span class="token punctuation">,</span><span class="token string">"def"</span><span class="token punctuation">,</span><span class="token string">"ghi"</span><span class="token punctuation">,</span><span class="token string">"jkl"</span><span class="token punctuation">,</span><span class="token string">"mno"</span><span class="token punctuation">,</span><span class="token string">"pqrs"</span><span class="token punctuation">,</span><span class="token string">"tuv"</span><span class="token punctuation">,</span><span class="token string">"wxyz"</span><span class="token punctuation">]</span><span class="token keyword">for</span> part <span class="token keyword">in</span> cipher<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s<span class="token operator">=</span>base<span class="token punctuation">.</span>index<span class="token punctuation">(</span>part<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    count<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">[</span>count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="这是什么"><a href="#这是什么" class="headerlink" title="这是什么"></a>这是什么</h2><p>中间一串字符由$<a href=""></a>!+$​​组成，判断是jsfuck，上解码网站<a href="http://codertab.com/JsUnFuck">http://codertab.com/JsUnFuck</a></p><h2 id="MRCTF2020-古典密码知多少"><a href="#MRCTF2020-古典密码知多少" class="headerlink" title="[MRCTF2020]古典密码知多少"></a>[MRCTF2020]古典密码知多少</h2><p>蓝色的字符为猪圈密码，橙色为其变种圣堂武士密码，黑色的字符是标准银河字母。</p><p>还有一个参考一位博主才知道。</p><blockquote><p>我的世界附魔台里面的文字<br><a href="https://img-blog.csdnimg.cn/2020121820252937.png"><img src="https://img-blog.csdnimg.cn/2020121820252937.png" alt="在这里插入图片描述"></a></p></blockquote><p><a href="https://img-blog.csdnimg.cn/img_convert/23bccf07462f06cad7ff78f9f1e07ec9.png"><img src="https://img-blog.csdnimg.cn/img_convert/23bccf07462f06cad7ff78f9f1e07ec9.png" alt="银河密码"></a><br>最后得到FGCPFLIRTUASYON 栅栏数3</p><h2 id="HDCTF2019-bbbbbbrsa"><a href="#HDCTF2019-bbbbbbrsa" class="headerlink" title="[HDCTF2019]bbbbbbrsa"></a>[HDCTF2019]bbbbbbrsa</h2><p>密文是base32加密，注意要反过来再解密，e需要爆破一下（给了范围）,剩下就是标准RSA。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invertp <span class="token operator">=</span> <span class="token number">177077389675257695042507998165006460849</span>n <span class="token operator">=</span> <span class="token number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span>c <span class="token operator">=</span> <span class="token string">"==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM"</span>c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">for</span> e <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">70000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>        m <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b'flag'</span> <span class="token keyword">in</span> m<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BJDCTF2020-RSA"><a href="#BJDCTF2020-RSA" class="headerlink" title="[BJDCTF2020]RSA"></a>[BJDCTF2020]RSA</h2><p>爆破出e即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytesc1 <span class="token operator">=</span> <span class="token number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span>n1 <span class="token operator">=</span> <span class="token number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span>c2 <span class="token operator">=</span> <span class="token number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span>c3 <span class="token operator">=</span> <span class="token number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span>n2 <span class="token operator">=</span> <span class="token number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span>q <span class="token operator">=</span> gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>p1 <span class="token operator">=</span> n1 <span class="token operator">//</span> qp2 <span class="token operator">=</span> n2 <span class="token operator">//</span> qphi1 <span class="token operator">=</span> <span class="token punctuation">(</span>p1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>phi2 <span class="token operator">=</span> <span class="token punctuation">(</span>p2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>m3 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token string">b"BJD"</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">)</span>m2 <span class="token operator">=</span> <span class="token number">294</span>e <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">294</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> n1<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> i        <span class="token keyword">break</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi1<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WUSTCTF2020-佛说：只能四天"><a href="#WUSTCTF2020-佛说：只能四天" class="headerlink" title="[WUSTCTF2020]佛说：只能四天"></a>[WUSTCTF2020]佛说：只能四天</h2><p>新约佛论禅+社会主义核心价值观+四位栅栏+3位恺撒+base32</p><h2 id="MRCTF2020-天干地支-甲子"><a href="#MRCTF2020-天干地支-甲子" class="headerlink" title="[MRCTF2020]天干地支+甲子"></a>[MRCTF2020]天干地支+甲子</h2><p>注意要+60</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> lst<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="BJDCTF2020-rsa-output"><a href="#BJDCTF2020-rsa-output" class="headerlink" title="[BJDCTF2020]rsa_output"></a>[BJDCTF2020]rsa_output</h2><p>共模攻击</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertn1 <span class="token operator">=</span> <span class="token number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>e1 <span class="token operator">=</span> <span class="token number">2767</span>n2 <span class="token operator">=</span> <span class="token number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>e2 <span class="token operator">=</span> <span class="token number">3659</span>message1 <span class="token operator">=</span> <span class="token number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span>message2 <span class="token operator">=</span> <span class="token number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> a <span class="token operator">//</span> b            a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">)</span>    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> m<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>same_n_attack<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> message1<span class="token punctuation">,</span> message2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="MRCTF2020-vigenere"><a href="#MRCTF2020-vigenere" class="headerlink" title="[MRCTF2020]vigenere"></a>[MRCTF2020]vigenere</h2><p>上<a href="https://www.guballa.de/vigenere-solver%E7%A0%B4%E8%A7%A3%E3%80%82">https://www.guballa.de/vigenere-solver破解。</a></p><h2 id="MRCTF2020-keyboard"><a href="#MRCTF2020-keyboard" class="headerlink" title="[MRCTF2020]keyboard"></a>[MRCTF2020]keyboard</h2><p>比之前那道还简单一点，源文件末尾应该少了一个3。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"def"</span><span class="token punctuation">,</span> <span class="token string">"ghi"</span><span class="token punctuation">,</span> <span class="token string">"jkl"</span><span class="token punctuation">,</span> <span class="token string">"mno"</span><span class="token punctuation">,</span> <span class="token string">"pqrs"</span><span class="token punctuation">,</span> <span class="token string">"tuv"</span><span class="token punctuation">,</span> <span class="token string">"wxyz"</span><span class="token punctuation">]</span>cipher <span class="token operator">=</span> <span class="token triple-quoted-string string">'''666622444555337446666633'''</span><span class="token keyword">for</span> part <span class="token keyword">in</span> cipher<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>part<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BJDCTF2020-signin"><a href="#BJDCTF2020-signin" class="headerlink" title="[BJDCTF2020]signin"></a>[BJDCTF2020]signin</h2><p>签到题</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytess <span class="token operator">=</span> <span class="token string">'424a447b57653163306d655f74345f424a444354467d'</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ACTF新生赛2020-crypto-rsa0"><a href="#ACTF新生赛2020-crypto-rsa0" class="headerlink" title="[ACTF新生赛2020]crypto-rsa0"></a>[ACTF新生赛2020]crypto-rsa0</h2><p>这题首先要解决一个伪加密（这不应该算MISC里的么），然后就是正常的RSA。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertp <span class="token operator">=</span> <span class="token number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span>q <span class="token operator">=</span> <span class="token number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span>c <span class="token operator">=</span> <span class="token number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qe <span class="token operator">=</span> <span class="token number">65537</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="GWCTF-2019-BabyRSA"><a href="#GWCTF-2019-BabyRSA" class="headerlink" title="[GWCTF 2019]BabyRSA"></a>[GWCTF 2019]BabyRSA</h2><p>注意其中的关系式如下<br>$$<br>c_1=F_1+F_2<br>$$</p><p>$$<br>c_2=F_1^3+F_2^3<br>$$</p><p>不难得到<br>$$<br>F_1\times F_2=(c_1^3-c_2)/(3c_1)<br>$$<br>之后构造一元二次方程解$F_1,F_2$即可</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> iroot<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesN <span class="token operator">=</span> <span class="token number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span>m1 <span class="token operator">=</span> <span class="token number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span>m2 <span class="token operator">=</span> <span class="token number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span>p <span class="token operator">=</span> <span class="token number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span>q <span class="token operator">=</span> <span class="token number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m2<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>f1_mul_f2 <span class="token operator">=</span> <span class="token punctuation">(</span>c1 <span class="token operator">**</span> <span class="token number">3</span> <span class="token operator">-</span> c2<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> c1<span class="token punctuation">)</span>delta <span class="token operator">=</span> c1 <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> f1_mul_f2t <span class="token operator">=</span> iroot<span class="token punctuation">(</span>delta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>f1 <span class="token operator">=</span> <span class="token punctuation">(</span>c1 <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>f2 <span class="token operator">=</span> <span class="token punctuation">(</span>c1 <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> long_to_bytes<span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WUSTCTF2020-babyrsa"><a href="#WUSTCTF2020-babyrsa" class="headerlink" title="[WUSTCTF2020]babyrsa"></a>[WUSTCTF2020]babyrsa</h2><p>标准RSA解密</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesc <span class="token operator">=</span> <span class="token number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span>n <span class="token operator">=</span> <span class="token number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span>e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">189239861511125143212536989589123569301</span>q <span class="token operator">=</span> <span class="token number">386123125371923651191219869811293586459</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="RSA4"><a href="#RSA4" class="headerlink" title="RSA4"></a>RSA4</h2><p>给了三组数据，猜测是广播攻击，同时注意观察，数字都是5以下，应该是5进制</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> iroot<span class="token punctuation">,</span> gcd<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesn1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>c1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>n2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>c2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>n3 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>c3 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">broadcast_attack</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        lastx<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> b<span class="token punctuation">:</span>            a<span class="token punctuation">,</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> b<span class="token punctuation">,</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">,</span> a<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">chinese_remainder_theorem</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>        N <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">for</span> a<span class="token punctuation">,</span> n <span class="token keyword">in</span> items<span class="token punctuation">:</span>            N <span class="token operator">*=</span> n        result <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> a<span class="token punctuation">,</span> n <span class="token keyword">in</span> items<span class="token punctuation">:</span>            m <span class="token operator">=</span> N <span class="token operator">//</span> n            r<span class="token punctuation">,</span> s<span class="token punctuation">,</span> d <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>n<span class="token punctuation">,</span> m<span class="token punctuation">)</span>            <span class="token keyword">if</span> d <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>                N <span class="token operator">=</span> N <span class="token operator">//</span> n                <span class="token keyword">continue</span>            result <span class="token operator">+=</span> a <span class="token operator">*</span> s <span class="token operator">*</span> m        <span class="token keyword">return</span> result <span class="token operator">%</span> N    x <span class="token operator">=</span> chinese_remainder_theorem<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    m <span class="token operator">=</span> iroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> mdata<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>c3<span class="token punctuation">,</span>n3<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>broadcast_attack<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="SameMod"><a href="#SameMod" class="headerlink" title="SameMod"></a>SameMod</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertn <span class="token operator">=</span> <span class="token number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span>e1 <span class="token operator">=</span> <span class="token number">773</span>e2 <span class="token operator">=</span> <span class="token number">839</span>message1 <span class="token operator">=</span> <span class="token number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span>message2 <span class="token operator">=</span> <span class="token number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span><span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> a <span class="token operator">//</span> b            a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">)</span>    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> mres <span class="token operator">=</span> same_n_attack<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> message1<span class="token punctuation">,</span> message2<span class="token punctuation">)</span>result <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>        c <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        i <span class="token operator">+=</span> <span class="token number">3</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        c <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        i <span class="token operator">+=</span> <span class="token number">2</span>    flag <span class="token operator">+=</span> c<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="一张谍报"><a href="#一张谍报" class="headerlink" title="一张谍报"></a>一张谍报</h2><p>注意谍报中的内容，找出其中关键的三段内容，相应地寻找索引，flag是老王说的暗号。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">strs1 <span class="token operator">=</span> <span class="token string">"今天上午，朝歌区梆子公司决定，在每天三更天不亮免费在各大小区门口设卡为全城提供二次震耳欲聋的敲更提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的符号是前进。为此，全区老人都蹲在该公司东边树丛合力抵制，不给公司人员放行，场面混乱。李罗鹰住进朝歌区五十年了，人称老鹰头，几年孙子李虎南刚从东北当猎户回来，每月还寄回来几块鼹鼠干。李罗鹰当年遇到的老婆是朝歌一枝花，所以李南虎是长得非常秀气的一个汉子。李罗鹰表示：无论梆子公司做的对错，反正不能打扰他孙子睡觉，子曰：‘睡觉乃人之常情’。梆子公司这是连菩萨睡觉都不放过啊。李南虎表示：梆子公司智商捉急，小心居民猴急跳墙！这三伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，更有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李南虎仍旧表示爷爷年纪大了，睡不好对身体不好。"</span>strs2 <span class="token operator">=</span> <span class="token string">"喵天上午，汪歌区哞叽公司决定，在每天八哇天不全免费在各大小区门脑设卡为全城提供双次震耳欲聋的敲哇提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的编号是前进。为此，全区眠人都足在该公司流边草丛合力抵制，不给公司人员放行，场面混乱。李罗鸟住进汪歌区五十年了，人称眠鸟顶，几年孙叽李熬值刚从流北当屁户回来，每月还寄回来几块报信干。李罗鸟当年遇到的眠婆是汪歌一枝花，所以李值熬是长得非常秀气的一个汉叽。李罗鸟表示：无论哞叽公司做的对错，反正不能打扰他孙叽睡觉，叽叶：‘睡觉乃人之常情’。哞叽公司这是连衣服睡觉都不放过啊。李值熬表示：哞叽公司智商捉急，小心居民猴急跳墙！这八伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，哇有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李值熬仍旧表示爷爷年纪大了，睡不好对身体不好。"</span>strs3 <span class="token operator">=</span> <span class="token string">"喵汪哞叽双哇顶，眠鸟足屁流脑，八哇报信断流脑全叽，眠鸟进北脑上草，八枝遇孙叽，孙叽对熬编叶：值天衣服放鸟捉猴顶。鸟对：北汪罗汉伏熬乱天门。合编放行，卡编扯呼。人离烧草，报信归洞，孙叽找爷爷。"</span><span class="token builtin">str</span><span class="token punctuation">(</span>strs1<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"gbk"</span><span class="token punctuation">,</span> <span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token builtin">str</span><span class="token punctuation">(</span>strs2<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"gbk"</span><span class="token punctuation">,</span> <span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token builtin">str</span><span class="token punctuation">(</span>strs3<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"gbk"</span><span class="token punctuation">,</span> <span class="token string">"ignore"</span><span class="token punctuation">)</span>res <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>strs3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>strs2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> strs3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> strs2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> strs1<span class="token punctuation">[</span>j<span class="token punctuation">]</span>            <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="yxx"><a href="#yxx" class="headerlink" title="yxx"></a>yxx</h2><p>类似异性相吸，异或即可</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token string">"lovelovelovelovelovelovelovelove"</span>b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span>     <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto Page1</title>
      <link href="2021/090240457.html"/>
      <url>2021/090240457.html</url>
      
        <content type="html"><![CDATA[<h1 id="Crypto-Page1"><a href="#Crypto-Page1" class="headerlink" title="Crypto Page1"></a>Crypto Page1</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本系列为BUUOJ简明题解，各知识点参见之前文章，这一部分主要在暑假完工，还有一份寒假入门时的学习笔记，部分内容与博客重叠，也放一个<a href="http://home.ustc.edu.cn/~ysy007/paper/crypto.pdf">链接</a></p><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p>题目是一串md5密文</p><pre class="line-numbers language-out" data-language="out"><code class="language-out">e00cf25ad42683b3df678c61f42c6bda<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>利用在线我网站<a href="https://www.cmd5.com/">https://www.cmd5.com/</a></p><h2 id="Url编码"><a href="#Url编码" class="headerlink" title="Url编码"></a>Url编码</h2><p>题目是一串url编码，涉及urlencode。</p><pre class="line-numbers language-out" data-language="out"><code class="language-out">%66%6c%61%67%7b%61%6e%64%20%31%3d%31%7d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="一眼就解密"><a href="#一眼就解密" class="headerlink" title="一眼就解密"></a>一眼就解密</h2><pre class="line-numbers language-out" data-language="out"><code class="language-out">ZmxhZ3tUSEVfRkxBR19PRl9USElTX1NUUklOR30&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意到最后的等号，猜测是base64</p><h2 id="看我回旋踢"><a href="#看我回旋踢" class="headerlink" title="看我回旋踢"></a>看我回旋踢</h2><p>注意到题目提示：回旋踢，以及观察密文猜测是ROT13（回旋）</p><h2 id="摩丝"><a href="#摩丝" class="headerlink" title="摩丝"></a>摩丝</h2><p>题目提示很明显是摩斯密码，利用在线工具或之前写的解密函数即可，不赘述。</p><h2 id="password"><a href="#password" class="headerlink" title="password"></a>password</h2><pre class="line-numbers language-out" data-language="out"><code class="language-out">姓名：张三 生日：19900315key格式为key&#123;xxxxxxxxxx&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>括号里为十个字符，盲猜就是姓名(首字母缩写)+生日数字。</p><h2 id="变异凯撒"><a href="#变异凯撒" class="headerlink" title="变异凯撒"></a>变异凯撒</h2><pre class="line-numbers language-out" data-language="out"><code class="language-out">加密密文：afZ_r9VYfScOeO_UL^RWUc格式：flag&#123; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>题目都说了是变异凯撒，观察前四个afZ_与flag相差为5、6、7、8，容易猜测是公差为1的等差数列。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'afZ_r9VYfScOeO_UL^RWUc'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="Quoted-printable"><a href="#Quoted-printable" class="headerlink" title="Quoted-printable"></a>Quoted-printable</h2><p>题目即为编码格式，利用在线网站即可。</p><h2 id="Rabbit"><a href="#Rabbit" class="headerlink" title="Rabbit"></a>Rabbit</h2><p>题目即为编码格式，利用在线网站即可。</p><h2 id="篱笆墙的影子"><a href="#篱笆墙的影子" class="headerlink" title="篱笆墙的影子"></a>篱笆墙的影子</h2><p>看题目知是栅栏密码，栏数为13。</p><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>求d。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertp <span class="token operator">=</span> <span class="token number">473398607161</span>q <span class="token operator">=</span> <span class="token number">4511491</span>e <span class="token operator">=</span> <span class="token number">17</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="丢失的MD5"><a href="#丢失的MD5" class="headerlink" title="丢失的MD5"></a>丢失的MD5</h2><p>题目脚本直接运行即可。</p><h2 id="Alice与Bob"><a href="#Alice与Bob" class="headerlink" title="Alice与Bob"></a>Alice与Bob</h2><p>按题目操作即可</p><h2 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h2><p>标准rsa解密，答案只需要数字</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertp <span class="token operator">=</span> <span class="token number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span>q <span class="token operator">=</span> <span class="token number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span>e <span class="token operator">=</span> <span class="token number">65537</span>c <span class="token operator">=</span> <span class="token number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="大帝的密码武器"><a href="#大帝的密码武器" class="headerlink" title="大帝的密码武器"></a>大帝的密码武器</h2><p>大帝显然是恺撒，FRPHEVGL位移13，变为SECURITY，对密文进行同样操作即可。</p><h2 id="Windows系统密码"><a href="#Windows系统密码" class="headerlink" title="Windows系统密码"></a>Windows系统密码</h2><p>观察形式应该是md5，试过去ctf第二条解密为flag。</p><h2 id="信息化时代的步伐"><a href="#信息化时代的步伐" class="headerlink" title="信息化时代的步伐"></a>信息化时代的步伐</h2><p>中文电码，利用在线网站即可。</p><h2 id="传统知识-古典密码"><a href="#传统知识-古典密码" class="headerlink" title="传统知识+古典密码"></a>传统知识+古典密码</h2><p>传统知识：天干地支，将题目中的年份对应1-60数字：28 30 23 8 17 10 16 30，注意题目中“信的背面还写有+甲子”，说明要加六十： 88 90 83 68 77 70 76 90；对应ASCⅡ码得  XZSDMFLZ</p><p>古典密码：栅栏密码+凯撒密码，爆破观察有意义的明文即可。</p><h2 id="凯撒？替换？呵呵"><a href="#凯撒？替换？呵呵" class="headerlink" title="凯撒？替换？呵呵!"></a>凯撒？替换？呵呵!</h2><p>显然不是恺撒密码，替换密码直接上<a href="https://quipqiup.com/%EF%BC%8C%E5%89%8D%E5%9B%9B%E4%B8%AA%E5%AD%97%E6%AF%8D%E4%B8%BAflag%E4%BD%9C%E4%B8%BAclue%E3%80%82">https://quipqiup.com/，前四个字母为flag作为clue。</a></p><h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><p>$d_p、d_q$泄露，上脚本。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> inversep <span class="token operator">=</span> <span class="token number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span>q <span class="token operator">=</span> <span class="token number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span>dp <span class="token operator">=</span> <span class="token number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span>dq <span class="token operator">=</span> <span class="token number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span>c <span class="token operator">=</span> <span class="token number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qa1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> dp<span class="token punctuation">,</span> p<span class="token punctuation">)</span>a2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> dq<span class="token punctuation">,</span> q<span class="token punctuation">)</span>b1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>b2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token punctuation">(</span>a1 <span class="token operator">*</span> b1 <span class="token operator">*</span> q <span class="token operator">+</span> a2 <span class="token operator">*</span> b2 <span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="萌萌哒的八戒"><a href="#萌萌哒的八戒" class="headerlink" title="萌萌哒的八戒"></a>萌萌哒的八戒</h2><p>根据题目容易判断是猪圈密码。</p><h2 id="old-fashion"><a href="#old-fashion" class="headerlink" title="old-fashion"></a>old-fashion</h2><p>上<a href="https://quipqiup.com/%E7%88%86%E7%A0%B4">https://quipqiup.com/爆破</a></p><h2 id="权限获得第一步"><a href="#权限获得第一步" class="headerlink" title="权限获得第一步"></a>权限获得第一步</h2><p>md5，选第二条。</p><h2 id="世上无难事"><a href="#世上无难事" class="headerlink" title="世上无难事"></a>世上无难事</h2><p>上<a href="https://quipqiup.com/%E7%88%86%E7%A0%B4">https://quipqiup.com/爆破</a></p><h2 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h2><p>共模攻击。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> a <span class="token operator">//</span> b            a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">)</span>    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> mc1 <span class="token operator">=</span> <span class="token number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span>n <span class="token operator">=</span> <span class="token number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span>e1 <span class="token operator">=</span> <span class="token number">11187289</span>c2 <span class="token operator">=</span> <span class="token number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span>e2 <span class="token operator">=</span> <span class="token number">9647291</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>same_n_attack<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><p>$d_p$泄露，以下利用两种方法。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> gcd<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span>dp <span class="token operator">=</span> <span class="token number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span>p <span class="token operator">=</span> <span class="token number">0</span>c <span class="token operator">=</span> <span class="token number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span>t <span class="token operator">=</span> e <span class="token operator">*</span> dp <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> t <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token punctuation">(</span>t <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> t <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">break</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> e <span class="token operator">*</span> dp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="异性相吸"><a href="#异性相吸" class="headerlink" title="异性相吸"></a>异性相吸</h2><p>从题目不难猜出是异或。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> xorkey <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"key.txt"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>cipher <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"密文.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>xor<span class="token punctuation">(</span>key<span class="token punctuation">,</span> cipher<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="还原大师"><a href="#还原大师" class="headerlink" title="还原大师"></a>还原大师</h2><p>简单的爆破</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlibs0 <span class="token operator">=</span> <span class="token string">'TASC?O3RJMV?WDJKX?ZM'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s1 <span class="token operator">=</span> s0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> s0<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> s1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            s3 <span class="token operator">=</span> s2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">+</span> s2<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            s <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>s3<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 大小写</span>            <span class="token keyword">if</span> <span class="token string">'E903'</span> <span class="token keyword">in</span> s<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA"></a>RSA</h2><p>涉及key和enc的读取，p和q可以直接分解。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">import</span> rsar <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pub.key'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>pub <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>r<span class="token punctuation">)</span>n <span class="token operator">=</span> pub<span class="token punctuation">.</span>ne <span class="token operator">=</span> pub<span class="token punctuation">.</span>ep <span class="token operator">=</span> <span class="token number">285960468890451637935629440372639283459</span>q <span class="token operator">=</span> <span class="token number">304008741604601924494328155975272418463</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>key <span class="token operator">=</span> rsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.enc"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>rsa<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>f<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Unencode"><a href="#Unencode" class="headerlink" title="Unencode"></a>Unencode</h2><p>编码方式为Uuencode，利用在线网站即可。</p><h2 id="AFCTF2018-Morse"><a href="#AFCTF2018-Morse" class="headerlink" title="[AFCTF2018]Morse"></a>[AFCTF2018]Morse</h2><p>先用摩斯密码得到一串十六进制字符串，再转换即为flag。</p><h2 id="RSAROLL"><a href="#RSAROLL" class="headerlink" title="RSAROLL"></a>RSAROLL</h2><p>简单的RSA解密。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> inverts <span class="token operator">=</span> <span class="token triple-quoted-string string">'''70479679275221115227470416418414022368270835483295235263072905459788476483295235459788476663551792475206804459788476428313374475206804459788476425392137704796792458265677341524652483295235534149509425392137428313374425392137341524652458265677263072905483295235828509797341524652425392137475206804428313374483295235475206804459788476306220148'''</span>lst <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>n <span class="token operator">=</span> <span class="token number">920139713</span>e <span class="token operator">=</span> <span class="token number">19</span>p <span class="token operator">=</span> <span class="token number">18443</span>q <span class="token operator">=</span> <span class="token number">49891</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> c <span class="token keyword">in</span> lst<span class="token punctuation">:</span>    t <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>非对称加密</title>
      <link href="2021/090265116.html"/>
      <url>2021/090265116.html</url>
      
        <content type="html"><![CDATA[<h1 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h1><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>在介绍RSA之前，默认已经掌握了一些基本的数论知识！</p><h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><h4 id="公钥与私钥的产生"><a href="#公钥与私钥的产生" class="headerlink" title="公钥与私钥的产生"></a>公钥与私钥的产生</h4><ol><li>随机选择两个不同大质数 $p$ 和 $q$，计算 $N=p×q$</li><li>根据欧拉函数，求得$ φ(N)=φ(p)φ(q)=(p−1)(q−1)$</li><li>选择一个小于 $φ(N)$​ 的整数 e，使 $e$​ 和$ φ(N)$​ 互质。并求得 $e$​ 关于 $φ(N)$​ 的模逆元d，有 $ed≡1(mod\ φ(N))$​</li></ol><p>此时，$(N,e)$是公钥，$(N,d)$ 是私钥。</p><h4 id="消息加密"><a href="#消息加密" class="headerlink" title="消息加密"></a>消息加密</h4><p>首先需要将消息 以一个双方约定好的格式转化为一个小于 $N$，且与 $N$ 互质的整数 $m$。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：<br>$$<br>m^e≡c\ (\ mod\ N)<br>$$</p><h4 id="消息解密"><a href="#消息解密" class="headerlink" title="消息解密"></a>消息解密</h4><p>利用密钥$d$进行解密。<br>$$<br>c^d≡m\ (\ mod\ N)<br>$$</p><h4 id="正确性证明"><a href="#正确性证明" class="headerlink" title="正确性证明"></a>正确性证明</h4><p>即要证$m^{ed}≡m\ mod\ N$，已知$ed≡1\ mod\ ϕ(N)$，那么$ ed=kϕ(N)+1$，即需要证明</p><p>$m^{kϕ(N)+1}≡m\ mod\ N$</p><p>这里我们分两种情况证明</p><p>第一种情况 $gcd(m,N)=1$，那么 $m^{ϕ(N)}≡1\ mod\ N$,因此原式成立。</p><p>第二种情况 $gcd(m,N)≠1$，那么 $m$ 必然是$ p$ 或者$ q$ 的倍数，并且 $m$ 小于$ N$。我们假设<br>$$<br>m=xp<br>$$<br>那么 $x$必然小于 $q$，又由于 $q$ 是素数。那么<br>$$<br>m^{ϕ(q)}≡1\ mod\ q<br>$$<br>进而<br>$$<br>m^{kϕ(N)}=m^{k(p−1)(q−1)}=(m^{ϕ(q)})^{k(p−1)}≡1\ mod\ q<br>$$<br>那么<br>$$<br>m^{kϕ(N)+1}=m+uqm<br>$$<br>进而<br>$$<br>m^{kϕ(N)+1}=m+uqxp=m+uxN<br>$$<br>所以原式成立。</p><h3 id="RSA攻击相关"><a href="#RSA攻击相关" class="headerlink" title="RSA攻击相关"></a>RSA攻击相关</h3><h4 id="直接模数分解"><a href="#直接模数分解" class="headerlink" title="直接模数分解"></a>直接模数分解</h4><p>破解RSA的难点主要在于分解n，如果题中的n是可以直接分解的，一般用以下两种方法，一是用神器yafu分解，二是一个比较好的分解网站<a href="http://factordb.com/index.php%E3%80%82%E8%8B%A5%E4%BB%A5%E4%B8%8A%E4%B8%A4%E4%B8%AA%E9%83%BD%E6%97%A0%E6%B3%95%E5%88%86%E8%A7%A3n%EF%BC%8C%E9%82%A3%E4%B9%88%E8%BF%99%E9%A2%98%E8%82%AF%E5%AE%9A%E6%98%AF%E7%94%A8%E5%85%B6%E5%AE%83%E6%96%B9%E6%B3%95%E3%80%82%E4%B8%8B%E9%9D%A2%E7%BB%99%E5%87%BA%E6%A0%87%E5%87%86%E7%9A%84RSA%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B%E3%80%82">http://factordb.com/index.php。若以上两个都无法分解n，那么这题肯定是用其它方法。下面给出标准的RSA解密过程。</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> modinvn <span class="token operator">=</span> <span class="token number">41376961156168948196303384218941117367850019509202049026037168194982219784159</span>e <span class="token operator">=</span> <span class="token number">65537</span>c <span class="token operator">=</span> <span class="token number">4161293100530874836836422603625206824589693933040432789074054165274087272587</span><span class="token comment"># from yafu</span>p <span class="token operator">=</span> <span class="token number">130451115685568383270871808144053983073</span>q <span class="token operator">=</span> <span class="token number">317183651045971246384245233153006206783</span><span class="token comment"># calc</span>d <span class="token operator">=</span> modinv<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag(rsa_256bit_brute)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="公约模数分解"><a href="#公约模数分解" class="headerlink" title="公约模数分解"></a>公约模数分解</h4><p>如果Alice和Bob之间进行了两次消息传递过程，且Bob不小心在两次通信中生成的大素数有一个是相同的，那么可以通过对两次通信的n求公约数进而分解两次通信的n。</p><h4 id="其它模数分解"><a href="#其它模数分解" class="headerlink" title="其它模数分解"></a>其它模数分解</h4><p>有的时候题目中会给出一些其它信息来辅助分解n。举个例子，有一题在提供了(n,e,c)的同时，还给出了npp的值，npp的值为$(p+1)(q+1)$。那么构造一个方程:$x^2-(p+q)x+p\times q=0$，此方程中(p+q)的值和pq的值都可以通过npp和n转化得到，而此方程的两个根即为p和q的值。</p><h4 id="小指数明文爆破"><a href="#小指数明文爆破" class="headerlink" title="小指数明文爆破"></a>小指数明文爆破</h4><p>如果Bob使用的e太小了，比如$e=3$，且Alice要传给Bob的明文也很小，比如就几个字节，那么由c=$m^e\ mod\ m$​​​，e=3，m很小，n很大，所以可能发生$m^e&lt;n$，那么此时c=$m^3$​​​，直接对c开三次方根即可得到m。当然这是一种极端的情况。如果$m^3&gt;n$但是没有超过太多，即$k\times n&lt;m^3&lt;(k+1)\times n$，且k是可以爆破大小的，则可以通过关系式$k\times n+c=m^3$​​​​来爆破明文。</p><h4 id="d-p、d-q-泄露"><a href="#d-p、d-q-泄露" class="headerlink" title="$d_p、d_q$泄露"></a>$d_p、d_q$泄露</h4><p>$$<br>d_p\equiv d\ mod\ p-1<br>$$</p><p>$$<br>d_q\equiv d\ mod\ q-1<br>$$</p><p>所谓$d_p、d_q$​泄露就是虽然知道N的分解，但不知道$e$​（也就不知道$d$），但是知道$d_p$​和$d_q$​可以通过计算得到明文$m$，这里需要用到中国剩余定理。</p><p>将$d$写成<br>$$<br>d=k(p-1)+d_p<br>$$<br>则<br>$$<br>m\equiv c^d\equiv c^{k(p-1)+d_p}\equiv c^{d_p}\ mod\ p<br>$$<br>同理<br>$$<br>m\equiv c^d\equiv c^{d_q}\ mod\ q<br>$$<br>对上两式利用中国剩余定理可得模$n$唯一解<br>$$<br>m\equiv a_1\times b_1\times p+a_2\times b_2\times q\ mod\ n<br>$$<br>其中<br>$$<br>a_1=c^{d_p}\ mod\ p<br>$$</p><p>$$<br>a_2=c^{d_q}\ mod\ q<br>$$</p><p>$$<br>qb_1\equiv 1\ mod\ p<br>$$</p><p>$$<br>pb_2\equiv 1\ mod\ q<br>$$</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> inversep <span class="token operator">=</span> q <span class="token operator">=</span> dp <span class="token operator">=</span> dq <span class="token operator">=</span> c <span class="token operator">=</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qa1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> dp<span class="token punctuation">,</span> p<span class="token punctuation">)</span>a2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> dq<span class="token punctuation">,</span> q<span class="token punctuation">)</span>b1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>b2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token punctuation">(</span>a1 <span class="token operator">*</span> b1 <span class="token operator">*</span> q <span class="token operator">+</span> a2 <span class="token operator">*</span> b2 <span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="d-p-泄露"><a href="#d-p-泄露" class="headerlink" title="$d_p$泄露"></a>$d_p$泄露</h4><p>$d_p$​​泄露是只知道一个$d_p$​​（或$d_q$​​）,但是知道e，在<strong>e不太大的情况下</strong>可以通过枚举来分解n。</p><p>已知<br>$$<br>d_p\equiv d\ mod\ p-1<br>$$</p><p>$$<br>ed\equiv 1\ mod\ (p-1)(q-1)<br>$$</p><p>则<br>$$<br>ed_p\equiv ed \equiv 1\ mod\ p-1<br>$$<br>写成<br>$$<br>ed_p=k(p-1)+1<br>$$<br>则<br>$$<br>k=(ed_p-1)/(p-1)&lt;e<br>$$<br>只需枚举$k$，便能得到$p$。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> n <span class="token operator">=</span> dp <span class="token operator">=</span> p <span class="token operator">=</span> <span class="token number">0</span>c <span class="token operator">=</span> t <span class="token operator">=</span> e <span class="token operator">*</span> dp <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> t <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token punctuation">(</span>t <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> t <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">break</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上述方法在$e$​比较大时，枚举的时间复杂度就很高，事实上利用费马小定理有很巧妙的解法。<br>$$<br>a^{p-1}\equiv 1\ mod\ p<br>$$<br>而<br>$$<br>ed_p=k(p-1)+1<br>$$<br>则<br>$$<br>a^{ed_p-1}\equiv a^{k(p-1)}\equiv 1\ mod\ p<br>$$<br>写成<br>$$<br>a^{ed_p-1}=sp+1<br>$$<br>记<br>$$<br>b\equiv a^{ed_p-1}\equiv sp+1\equiv \ mod\ n<br>$$</p><p>$$<br>b=sp+1-tn<br>$$</p><p>从而<br>$$<br>p=gcd(b-1,n)=gcd(sp-tn,n)=gcd(sp,pq)<br>$$</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> gcd<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> n <span class="token operator">=</span> dp <span class="token operator">=</span> c <span class="token operator">=</span> p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> e <span class="token operator">*</span> dp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Rabin密码体制"><a href="#Rabin密码体制" class="headerlink" title="Rabin密码体制"></a>Rabin密码体制</h4><p>$Rabin$​密码与$RSA$​类似，取$e=2$​，且$p\equiv q\equiv 3\ mod\ 4$​​，下面是解密过程。</p><p>首先由加密过程$c\equiv m^2\ mod\ n$​​​，得$c\equiv m^2\ mod\ p$​​​和$c\equiv m^2\ mod\ q$​​​​，则$c$​​是模$p$​​和$q$​​​的二次剩余。利用二次剩余的欧拉判别法​<br>$$<br>c^{\frac{p-1}{2}}\equiv 1\ mod\ p<br>$$<br>回代<br>$$<br>m^2\equiv c*c^{\frac{p-1}{2}}\equiv c^{\frac{p+1}{2}}\ mod\ p<br>$$<br>开方得<br>$$<br>m\equiv \pm c^{\frac{p+1}{4}}\ mod \ p<br>$$<br>有<br>$$<br>m_1 \equiv c^{\frac{p+1}{4}}\ mod \ p<br>$$</p><p>$$<br>m_2 \equiv (p-c^{\frac{p+1}{4}}) \ mod \ p<br>$$</p><p>对$q$同理可得<br>$$<br>m_3 \equiv c^{\frac{q + 1}{4}}\ mod \ q<br>$$</p><p>$$<br>m_4 \equiv (q - c^{\frac{q + 1}{4}}) \ mod \ q<br>$$</p><p>然后从模$p$和模$q$的式子中各取一个，有四种可能，用四次中国剩余定理可以得到四个$m$​，明文为其中的一个。​</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertn <span class="token operator">=</span> p <span class="token operator">=</span> q <span class="token operator">=</span> e <span class="token operator">=</span> <span class="token number">2</span>c <span class="token operator">=</span> inv_p <span class="token operator">=</span> invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>inv_q <span class="token operator">=</span> invert<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>mp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>mq <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token punctuation">(</span>inv_p <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">+</span> inv_q <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span> <span class="token operator">%</span> nb <span class="token operator">=</span> n <span class="token operator">-</span> ac <span class="token operator">=</span> <span class="token punctuation">(</span>inv_p <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">-</span> inv_q <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span> <span class="token operator">%</span> nd <span class="token operator">=</span> n <span class="token operator">-</span> c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="LLL-attack"><a href="#LLL-attack" class="headerlink" title="LLL-attack"></a>LLL-attack</h4><p>如果Bob使用的e是3，同时Alice习惯性地在密文前面附上了一句众所周知的问候语，也就是说明，密文的一部分已经泄露，或者Bob不小心泄露了生成的p或者q的一部分，又或者Bob泄露了明文的部分bit。那么在泄露的信息长度足够的时候，可以通过Coppersmith method的方法求得明文。</p><p>假设已知m的一部分为base，此时可以使用LLLattack的方法进行攻击。目前GitHub上提供给了进行LLLattack的sage代码，地址为<a href="https://github.com/mimoo/RSA-and-LLL-attacks%E3%80%82">https://github.com/mimoo/RSA-and-LLL-attacks。</a></p><p>如遇到这类题，可以使用sage-online解决，修改LLLattack的源代码进行攻击。<br>以上方法同样适用p泄露了三分之二的情况。给出的代码在泄漏的字节略小于三分之二时也是可以接受的，在条件合适的情况下，1024bit的p只泄露了576bit的情况下也可以成功破解，链接地址为<a href="http://inaz2.hatenablog.com/entries/2016/01/20%E3%80%82">http://inaz2.hatenablog.com/entries/2016/01/20。</a></p><h4 id="Wiener-Attack-amp-​-Boneh-Durfee-Attack"><a href="#Wiener-Attack-amp-​-Boneh-Durfee-Attack" class="headerlink" title="Wiener Attack &amp;​ Boneh Durfee Attack"></a>Wiener Attack &amp;​ Boneh Durfee Attack</h4><p>上两节的情况都是Bob选取的e太小造成的。如果Bob选择的e很大，但产生的d太小，也会被成功攻击。这就是RSA Wiener Attack。</p><p>一般来说，如果e很大，远远超过了65537，那么基本确定就是Wiener Attack。在GitHub上也有成功攻击的脚本，地址为<a href="https://github.com/pablocelayes/rsa-wiener-attack%E3%80%82">https://github.com/pablocelayes/rsa-wiener-attack。</a></p><p>下面简单介绍Wiener Attack的原理。其成功的前提是$d&lt;\frac{1}{3}n^{\frac{1}{4}}$</p><p>首先介绍连分数，对于任意一个整数都能展开成连分数<br>$$<br>x=a_0+\frac{1}{a_1+\frac{1}{a_2+\frac{1}{a_3+\frac{1}{\cdot}}}}<br>$$<br>在对一个分数展开成连分数的时候，事实上就是在对分子分母不断做辗转相除法，因此很快能得出一个结论：对于任意有理数(两个整数的比)的连分数永远是有限的。这很简单，对于两个数辗转相除，最终会停在两个数的最大公约数上，对于无理数也能连分数展开，例如π，e，无理数连分数展开是无限的。</p><p>对于连分数，我们观察每一个分母，它后面加的那一项都小于1,所以相比$a_i$是一个非常小的数，如果我们把第i个分母后面的分数全部略去，我们称这个分数为这个连分数第$i$个渐进分数，显然$i$越大离$x$越接近，并且由于约去了分母前$n-1$个渐进分数都是小于$x$​的。比如祖冲之发现圆周率的疏率和密率22 / 7与355 / 113 就是π连分数展开的两个渐进分数。</p><p>回到RSA，从下式开始<br>$$<br>ed-1=k\phi(n)<br>$$<br>变形<br>$$<br>\frac{e}{\phi(n)}-\frac{k}{d}=\frac{1}{d\phi(n)}<br>$$<br>考虑到$\phi(n)\approx n$<br>$$<br>\frac{e}{n}-\frac{k}{d}=\frac{1}{d\phi(n)}<br>$$<br>$d\phi(n)$是一个很大的数，所以不难发现$\frac{e}{n}$略大于$\frac{k}{d}$</p><p>为啥要这么写呢，因为e和n是我们是知道的，所以我们计算出e/N后，比它略小的k/d怎么出来呢，计算e/N的连分数展开，依次算出这个分数每一个渐进分数，由于e/N 略大于k/d，wiener证明了，该攻击能精确的覆盖k/d。</p><p>最终我们能算出$\phi(n)$​从而最终分解n，当然在那个过程中也是直接得到d。</p><h4 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h4><p>Bob为了省事，在两次通信中使用了相同的n，而Alice是对相同的m加密。这时，Cat可以不计算d而直接计算m的值。</p><p>通过扩展欧几里得算法可以得到$(s_1,s_2),st$<br>$$<br>e_1s_1+e_2s_2=1<br>$$<br>而由<br>$$<br>m^{e_1}≡c_1\ (\ mod\ N)<br>$$</p><p>$$<br>m^{e_2}≡c_2\ (\ mod\ N)<br>$$</p><p>则<br>$$<br>c_1^{s_1}e_2^{s_2}\equiv m^{e_1s_1+e_2s_2}\equiv m\ mod\ n<br>$$<br>特别地，注意$s_1、s_2$中有一个人是负的，需要作一点转换。不妨$s_1$是负的，则<br>$$<br>c_1^{s_1}\equiv (c_1^{-1})^{-s_1}\ mod\ n<br>$$<br>其中$c_1^{-1}$为模逆元，而$-s_1&gt;0$。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> a <span class="token operator">//</span> b            a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">)</span>    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> m<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="广播攻击"><a href="#广播攻击" class="headerlink" title="广播攻击"></a>广播攻击</h4><p>Bob不仅多次选择的加密指数低（例如3或其它较小的素数），而且这几次加密过程，加密的信息都是相同的，那么由：<br>$$<br>c_1\equiv m^e\ mod\ n_1<br>$$</p><p>$$<br>c_2\equiv m^e\ mod\ n_2<br>$$</p><p>$$<br>c_3\equiv m^e\ mod\ n_3<br>$$</p><p>那么通过中国剩余定理，可以计算出一个数$c_x$为：<br>$$<br>c_x\equiv m^3\ mod\ n_1n_2n_3<br>$$<br>然后对$c_x$开三次方即可得到m。Python代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> iroot<span class="token keyword">def</span> <span class="token function">broadcast_attack</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>        lastx<span class="token punctuation">,</span> lasty <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">while</span> b<span class="token punctuation">:</span>            a<span class="token punctuation">,</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">=</span>b<span class="token punctuation">,</span><span class="token builtin">divmod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>            x<span class="token punctuation">,</span> lastx <span class="token operator">=</span> lastx <span class="token operator">-</span> q <span class="token operator">*</span> x<span class="token punctuation">,</span> x            y<span class="token punctuation">,</span> lasty <span class="token operator">=</span> lasty <span class="token operator">-</span> q <span class="token operator">*</span> y<span class="token punctuation">,</span> y        <span class="token keyword">return</span> <span class="token punctuation">(</span>lastx<span class="token punctuation">,</span> lasty<span class="token punctuation">,</span>a<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">chinese_remainder_theorem</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>        N <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">for</span> a<span class="token punctuation">,</span> n <span class="token keyword">in</span> items<span class="token punctuation">:</span>            N <span class="token operator">*=</span> n        result <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> a<span class="token punctuation">,</span> n <span class="token keyword">in</span> items<span class="token punctuation">:</span>            m <span class="token operator">=</span> N <span class="token operator">//</span> n            r<span class="token punctuation">,</span>s<span class="token punctuation">,</span>d<span class="token operator">=</span>extended_gcd<span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span>            <span class="token keyword">if</span> d<span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">:</span>                N<span class="token operator">=</span>N<span class="token operator">//</span>n                <span class="token keyword">continue</span>            result <span class="token operator">+=</span> a <span class="token operator">*</span> s <span class="token operator">*</span> m        <span class="token keyword">return</span> result <span class="token operator">%</span> N    x <span class="token operator">=</span> chinese_remainder_theorem<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    m <span class="token operator">=</span> iroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> m<span class="token comment"># 其中data=[(c1,n1),(c2,n2),(c3,n3)]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="相关消息攻击"><a href="#相关消息攻击" class="headerlink" title="相关消息攻击"></a>相关消息攻击</h4><p>当Alice使用同一对公钥对两个具有某种线性关系的消息$M_1$​和$M_2$​进行加密，并将加密后的消息$C_1$​、$C_2$​发送给Bob时，我们可以获得对应的消息$M_1$​与$M_2$​、这里假设模数为N，两者之间的线性关系为$M_1=a\times M_2+b$​，那么当e=3时可以得到：<br>$$<br>M_2=\frac{2a^3bC^2-b^4+C_1b}{aC_1-a^4C_2+2ab^3}=\frac{bC_1+2a^3C_2-b^3}{aC_1-a^3C_2+2b^3}<br>$$</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">def</span> <span class="token function">relate_message_attack</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    b3 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    part1 <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>c1 <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> c2 <span class="token operator">-</span> b3<span class="token punctuation">)</span> <span class="token operator">%</span> n    part2 <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token punctuation">(</span>c1 <span class="token operator">-</span> c2 <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> b3<span class="token punctuation">)</span> <span class="token operator">%</span> n    part2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>part2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">return</span> part1 <span class="token operator">*</span> part2 <span class="token operator">%</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分组密码</title>
      <link href="2021/090244648.html"/>
      <url>2021/090244648.html</url>
      
        <content type="html"><![CDATA[<h1 id="分组密码"><a href="#分组密码" class="headerlink" title="分组密码"></a>分组密码</h1><h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><h3 id="基本加解密"><a href="#基本加解密" class="headerlink" title="基本加解密"></a>基本加解密</h3><p><img src="https://ctf-wiki.org/crypto/blockcipher/figure/aes_details.jpg" alt="img"></p><p>如上为图解。</p><p>AddRoundKey</p><p>每一块与密钥块或Keyschedule之后的密钥块进行异或运算。</p><p>SubBytes</p><p>通过替换表（S-Box）进行字节替换</p><p>ShiftRows</p><p>正向行移位第一行不变，第二行循环左移1位，第三行循环左移2位，第四行循环左移3位。</p><p>MixColumns</p><p>与特定矩阵进行左乘，此处乘法和加法有定义。</p><p><img src="https://ctf-wiki.org/crypto/blockcipher/figure/aes_enc_dec.png" alt="img"></p><p>如上是加解密全过程。</p><p>实际上，交换逆向行移位和逆向字节代替并不影响结果；交换轮密钥加和逆向列混淆并不影响结果，关键在于可以把异或看成域上的多项式加法，其次多项式中乘法对加法具有分配律。</p><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><h3 id="基本加解密-1"><a href="#基本加解密-1" class="headerlink" title="基本加解密"></a>基本加解密</h3><p><img src="https://ctf-wiki.org/crypto/blockcipher/figure/des.gif" alt="img"></p><h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p>我们可以考虑一下每一轮的加密过程</p><p>$L_{i+1}=R_i$​</p><p>$R_{i+1}=L_i⊕F(R_i,K_i)$</p><p>那么在最后的 Permutation 之前，对应的密文为$(R_{n+1},L_{n+1})$。</p><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>那么解密如何解密呢？首先我们可以把密文先进行逆置换，那么就可以得到最后一轮的输出。我们这时考虑每一轮</p><p>$R_i=L_{i+1}$</p><p>$L_i=R_{i+1}⊕F(L_{i+1},K_i)$</p><p>因此，$(L_0,R_0)$ 就是加密时第一次置换后的明文。我们只需要再执行逆置换就可以获得明文了。</p><p>可以看出，DES 加解密使用同一套逻辑，只是密钥使用的顺序不一致。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hash函数</title>
      <link href="2021/09023969.html"/>
      <url>2021/09023969.html</url>
      
        <content type="html"><![CDATA[<h1 id="Hash函数"><a href="#Hash函数" class="headerlink" title="Hash函数"></a>Hash函数</h1><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><h3 id="基本描述"><a href="#基本描述" class="headerlink" title="基本描述"></a>基本描述</h3><p>MD5 的输入输出如下</p><ul><li>输入：任意长的消息，512 比特长的分组。</li><li>输出：128 比特的消息摘要。</li></ul><p>MD5算法的原理可简要的叙述为：MD5码以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组级联后将生成一个128位散列值。</p><p>总体流程如下图所示，每次的运算都由前一轮的128位结果值和当前的512bit值进行运算 。</p><p>其底层实现较为复杂（sigh）</p><p>此外，有时候我们获得到的 md5 是 16 位的，其实那 16 位是 32 位 md5 的长度，是从 32 位 md5 值来的。是将 32 位 md5 去掉前八位，去掉后八位得到的。</p><p>一般来说，我们可以通过函数的初始化来判断是不是 MD5 函数。一般来说，如果一个函数有如下四个初始化的变量，可以猜测该函数为 MD5 函数，因为这是 MD5 函数的初始化 IV。</p><pre class="line-numbers language-none"><code class="language-none">0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="破解"><a href="#破解" class="headerlink" title="破解"></a>破解</h3><p>目前可以说 md5 已经基本被攻破了，一般的 MD5 的碰撞都可以在如下网上获取到</p><ul><li><a href="http://www.cmd5.com/">http://www.cmd5.com/</a></li><li><a href="http://www.ttmd5.com/">http://www.ttmd5.com/</a></li><li><a href="http://pmd5.com/">http://pmd5.com/</a></li><li><a href="https://www.win.tue.nl/hashclash/fastcoll_v1.0.0.5.exe.zip">https://www.win.tue.nl/hashclash/fastcoll_v1.0.0.5.exe.zip</a> (生成指定前缀的 md5 碰撞)</li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古典密码</title>
      <link href="2021/090233205.html"/>
      <url>2021/090233205.html</url>
      
        <content type="html"><![CDATA[<h1 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h1><h2 id="移位密码"><a href="#移位密码" class="headerlink" title="移位密码"></a>移位密码</h2><h3 id="简单移位密码"><a href="#简单移位密码" class="headerlink" title="简单移位密码"></a>简单移位密码</h3><p>密码和编码最大的区别是多了一个密钥k，一般用m代表明文，c代表密文。</p><p>移位密码是将明文根据密钥进行了位置的变换而得到的密文，举个例子：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">m <span class="token operator">=</span> <span class="token string">"flag&#123;easy_easy_crypto&#125;"</span>k <span class="token operator">=</span> <span class="token string">"3124"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>首先以k的长度切分m如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token punctuation">&#123;</span>eas y_ea sy_c rypt o<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后按照密钥3124的顺序对每一部分密钥进行变化：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">lafg ea<span class="token punctuation">&#123;</span>s _eya y_sc yprt <span class="token punctuation">&#125;</span>o<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>所以密文为lafgea{s_eyay_scyprt}o</p><p>再说攻击策略，一般有两种：爆破和语义分析，爆破首先爆破字段长度然后爆破顺序，具体此处不细叙。</p><p>Python加密解密代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">shift_encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp_c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> l  <span class="token comment"># 初始化列表</span>        <span class="token keyword">if</span> i <span class="token operator">+</span> l <span class="token operator">></span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_m <span class="token operator">=</span> m<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_m <span class="token operator">=</span> m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> l<span class="token punctuation">]</span>        <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_c<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp_m<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span>        c <span class="token operator">+=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span>    <span class="token keyword">return</span> c<span class="token keyword">def</span> <span class="token function">shift_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp_m <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> l        <span class="token keyword">if</span> i <span class="token operator">+</span> l <span class="token operator">></span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_c <span class="token operator">=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>            use <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                use<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            use<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp_m<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span> <span class="token operator">=</span> tmp_c<span class="token punctuation">[</span>use<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>                  <span class="token comment"># index返回第一个匹配的索引位置</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_c <span class="token operator">=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> l<span class="token punctuation">]</span>            <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp_m<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span> <span class="token operator">=</span> tmp_c<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>        m <span class="token operator">+=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span>    <span class="token keyword">return</span> mm <span class="token operator">=</span> <span class="token string">"flag&#123;easy_easy_crypto&#125;"</span>k <span class="token operator">=</span> <span class="token string">"3124"</span>c <span class="token operator">=</span> shift_encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>shift_decrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># lafgea&#123;s_eyay_scyprt&#125;o</span><span class="token comment"># flag&#123;easy_easy_crypto&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="云影密码"><a href="#云影密码" class="headerlink" title="云影密码"></a>云影密码</h3><p>云影密码仅包含01248五个数字，其中0用于分割，其余数字用于做加和操作之后转换为明文，Python解码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">c01248_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    l<span class="token operator">=</span>c<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span>    origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>    r<span class="token operator">=</span><span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>        tmp<span class="token operator">=</span><span class="token number">0</span>        <span class="token keyword">for</span> num <span class="token keyword">in</span> i<span class="token punctuation">:</span>            tmp<span class="token operator">+=</span><span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>        r<span class="token operator">+=</span>origin<span class="token punctuation">[</span>tmp<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> r<span class="token keyword">print</span><span class="token punctuation">(</span>c01248_decode<span class="token punctuation">(</span><span class="token string">"8842101220480224404014224202480122"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># welldone</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h3><p>栅栏密码密钥只有一个数字k，表示栅栏长度，将加密的明文分成k个一组，然后取每组的一个字符依次连接，拼接而成就是密文。样例如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">m <span class="token operator">=</span> <span class="token string">"flag&#123;zhalan_mima_hahaha&#125;"</span>k <span class="token operator">=</span> <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>首先每4个分一组  </p><pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token punctuation">&#123;</span>zha lan_ mima _hah aha<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后依次取出每组的第一个字符组成一组，再依次取出第2个、第3个、第4个：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">f<span class="token punctuation">&#123;</span>lm_alzaihhahnmaaga_ah<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>而栅栏密码的解密方法就是加密的逆过程，Python加解密代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">zhalan_encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>    chip<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token operator">+</span>k<span class="token operator">>=</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_m<span class="token operator">=</span>m<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_m<span class="token operator">=</span>m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span>        chip<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span>    c<span class="token operator">=</span><span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> tmp_m <span class="token keyword">in</span> chip<span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token operator">&lt;</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span><span class="token punctuation">:</span>                c<span class="token operator">+=</span>tmp_m<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> c<span class="token keyword">def</span> <span class="token function">zhalan_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>    l<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>    partnum<span class="token operator">=</span>l<span class="token operator">//</span>k    <span class="token keyword">if</span> l<span class="token operator">%</span>k<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>        partnum<span class="token operator">+=</span><span class="token number">1</span>    m<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span><span class="token operator">*</span>l    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token punctuation">,</span>partnum<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">+</span> partnum<span class="token operator">>=</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_c<span class="token operator">=</span>c<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_c<span class="token operator">=</span>c<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span>partnum<span class="token punctuation">]</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            m<span class="token punctuation">[</span>j<span class="token operator">*</span>k<span class="token operator">+</span>i<span class="token operator">//</span>partnum<span class="token punctuation">]</span><span class="token operator">=</span>tmp_c<span class="token punctuation">[</span>j<span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>m<span class="token punctuation">)</span>m<span class="token operator">=</span><span class="token string">"flag&#123;zhalan_mima_hahaha&#125;"</span>k<span class="token operator">=</span><span class="token number">4</span>c<span class="token operator">=</span>zhalan_encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>zhalan_decrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># f&#123;lm_alzaihhahnmaaga_ah&#125;</span><span class="token comment"># flag&#123;zhalan_mima_hahaha&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="替代密码"><a href="#替代密码" class="headerlink" title="替代密码"></a>替代密码</h2><h3 id="单表替代密码"><a href="#单表替代密码" class="headerlink" title="单表替代密码"></a>单表替代密码</h3><h4 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h4><p>凯撒密码通过将字母移动一定的位数来实现加密和解密，明文中所有的字母都在字母表上向后(或向前)按照一个固定的数目移动偏移后被替换成密文。因此，位数就是凯撒密码加密和解密的密钥因为只考虑可见字符，并且都是ASCⅡ码，所以128是模数。而只对凯撒密码的爆破就是爆破密钥K。具体见以下代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">caesar_encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">caesar_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">caesar_brute</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> match_str<span class="token punctuation">)</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> caesar_decrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span>        <span class="token keyword">if</span> match_str <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    <span class="token keyword">return</span> resultm <span class="token operator">=</span> <span class="token string">"flag&#123;kaisamima&#125;"</span>k <span class="token operator">=</span> <span class="token number">3</span>c <span class="token operator">=</span> caesar_encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>caesar_decrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>c1 <span class="token operator">=</span> <span class="token string">"39.4H/?BA2,0.2@.?J"</span><span class="token keyword">print</span><span class="token punctuation">(</span>caesar_brute<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">"flag&#123;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># iodj~ndlvdplpd </span><span class="token comment"># flag&#123;kaisamima&#125;</span><span class="token comment"># ['flag&#123;kaisamima&#125;']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>事实上，以上并不是一般的凯撒密码，一般的凯撒密码只对字母作变换。具体实现大同小异，不赘述。</p><h4 id="ROT13"><a href="#ROT13" class="headerlink" title="ROT13"></a>ROT13</h4><p>在凯撒密码中有一种特例，当k=13，并且只用于大小写英文字母的时候，称之为ROT13.而且值得注意的是ROT13的加密和解密函数是一样的（因为英文字母只有26个，+13和-13效果一样）。</p><p>另外ROT13通常会作用在MD5，flag等字符串上，MD5中的字符只有“ABCDEF”，对应的ROT13为”NOPQRS”,flag对应的是”SYNT”,如果看到这些就可以识别出是ROT13，样例如下</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">def <span class="token function">rot13</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i in m<span class="token operator">:</span>        <span class="token keyword">if</span> <span class="token function">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span>            r <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">-</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        elif <span class="token function">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> in <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span>            r <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">-</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token operator">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> rc <span class="token operator">=</span> <span class="token string">"2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824"</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">rot13</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">rot13</span><span class="token punctuation">(</span><span class="token function">rot13</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span>codecs<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token string">"rot13"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">iodj</span><span class="token expression"><span class="token operator">~</span>ndlvdplpd </span></span><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">flag</span><span class="token expression"><span class="token punctuation">&#123;</span>kaisamima<span class="token punctuation">&#125;</span></span></span># <span class="token punctuation">[</span><span class="token string">'flag&#123;kaisamima&#125;'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>还有其他ROT，有在线网站<a href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php%E3%80%82">https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php。</a></p><h4 id="埃特巴什码"><a href="#埃特巴什码" class="headerlink" title="埃特巴什码"></a>埃特巴什码</h4><p>埃特巴什码的替代表不是通过移位得到的，而是通过对称获得的。其通过将字母表的位置完全镜面对称后获得字母的替代表，然后进行加密。Python代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">atabsh_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    alphabet<span class="token operator">=</span><span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    Origin<span class="token operator">=</span>alphabet<span class="token operator">+</span>alphabet<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    TH_A<span class="token operator">=</span>alphabet<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    TH_a<span class="token operator">=</span>alphabet<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    TH<span class="token operator">=</span>TH_A<span class="token operator">+</span>TH_a    r<span class="token operator">=</span><span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        tmp<span class="token operator">=</span>Origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token keyword">if</span> tmp<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r<span class="token operator">+=</span>TH<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r<span class="token operator">+=</span>i    <span class="token keyword">return</span> rm<span class="token operator">=</span><span class="token string">"flag&#123;ok_atabsh_flag&#125;"</span>c<span class="token operator">=</span>atabsh_encode<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>atabsh_encode<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment"># uozt&#123;lp_zgzyhs_uozt&#125;</span><span class="token comment"># flag&#123;ok_atabsh_flag&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="经典单表替代密码"><a href="#经典单表替代密码" class="headerlink" title="经典单表替代密码"></a>经典单表替代密码</h4><p>经典单表替代密码就是用一个替代表对每一个位置的字符进行查表替换。因为是单表替换，所以没有替代表时，爆破的难度会比较高，一般来说会给出一段具有足够语言意义的密文，然后使用词频统计的方法进行攻击。在有替代表的情况下的加解密代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">substitution_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> k<span class="token punctuation">[</span>origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">substitution_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">if</span> k<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> origin<span class="token punctuation">[</span>k<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> rm <span class="token operator">=</span> <span class="token string">"flag&#123;good_good_study&#125;"</span>k <span class="token operator">=</span> <span class="token string">"zugxjitlrkywdhfbnvosepmacq"</span>c <span class="token operator">=</span> substitution_encode<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>substitution_decode<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># iwzt&#123;tffx_tffx_osexc&#125;</span><span class="token comment"># flag&#123;good_good_study&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="培根密码"><a href="#培根密码" class="headerlink" title="培根密码"></a>培根密码</h4><p>培根密码一般使用两种不同的字体代表密文，密文的内容不是关键所在，关键是字体。使用AB代表两种字体，五个一组，表示密文，明密文对应表如下所示</p><table><thead><tr><th>a</th><th>AAAAA</th><th>g</th><th>AABBA</th><th>n</th><th>ABBAA</th><th>t</th><th>BAABA</th></tr></thead><tbody><tr><td>b</td><td>AAAAB</td><td>h</td><td>AABBB</td><td>o</td><td>ABBAB</td><td>u-v</td><td>BAABB</td></tr><tr><td>c</td><td>AAABA</td><td>i-j</td><td>ABAAA</td><td>p</td><td>ABBBA</td><td>w</td><td>BABAA</td></tr><tr><td>d</td><td>AAABB</td><td>j</td><td>ABAAB</td><td>q</td><td>ABBBB</td><td>x</td><td>BABAB</td></tr><tr><td>e</td><td>AABAA</td><td>k</td><td>ABABA</td><td>r</td><td>BAAAA</td><td>y</td><td>BABBA</td></tr><tr><td>f</td><td>AABAB</td><td>l</td><td>ABABB</td><td>s</td><td>BAAAB</td><td>z</td><td>BABBB</td></tr></tbody></table><p>也可以使用在线工具解密：<a href="http://rumkin.com/tools/cipher/baconian.php">http://rumkin.com/tools/cipher/baconian.php</a></p><h4 id="图形密码"><a href="#图形密码" class="headerlink" title="图形密码"></a>图形密码</h4><p>猪圈密码和跳舞的小人都是典型的图形替代密码，图形替代是通过将明文用图形替代以实现加密。猪圈密码使用不同的格子来表示不同的字母；跳舞的小人源自《福尔摩斯探案集》，是使用小人图案来表示不同的字母，同时用举旗子来表示单词结束。具体此处不细说，遇到可在网上查找对应表。</p><p>以下给图形密码做一些简单列举，遇到了直接对应搜索即可。</p><h5 id="猪圈密码"><a href="#猪圈密码" class="headerlink" title="猪圈密码"></a>猪圈密码</h5><h5 id="猪圈密码变种圣堂武士密码"><a href="#猪圈密码变种圣堂武士密码" class="headerlink" title="猪圈密码变种圣堂武士密码"></a>猪圈密码变种圣堂武士密码</h5><h5 id="跳舞的小人"><a href="#跳舞的小人" class="headerlink" title="跳舞的小人"></a>跳舞的小人</h5><h5 id="我的世界附魔台"><a href="#我的世界附魔台" class="headerlink" title="我的世界附魔台"></a>我的世界附魔台</h5><h5 id="标准银河字母"><a href="#标准银河字母" class="headerlink" title="标准银河字母"></a>标准银河字母</h5><h4 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h4><p>仿射密码替代表的生成方式依据：$c=am+b\ mod\ n$，其中m为明文对应字母得到的数字，n为字符数量，c为密文，a和b为密钥。在拥有密钥的情况下，解密只需要求出a关于n的逆元即可，即$m=invert(a)\times(c-b)\ mod\ n$,关于逆元会在后面叙述，此处略过。</p><p>因为明密文空间一样，所以n很容易得知。那么在没有密钥的情况下，一般有以下几种思路：第一种是爆破，在密钥空间小的情况下可以这么做；第二种因为仿射密码也是单表替代密码的特例，字母也是一一对应的，所以也可以使用词频统计进行攻击；第三种是已知明文攻击，如果我们知道了任意两个字符的明密文对，那么我们可以推理出密钥ab。具体实现如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">def</span> <span class="token function">affine_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> origin<span class="token punctuation">[</span><span class="token punctuation">(</span>a <span class="token operator">*</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">affine_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> <span class="token string">""</span>    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>    ai <span class="token operator">=</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">if</span> origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> origin<span class="token punctuation">[</span><span class="token punctuation">(</span>ai <span class="token operator">*</span> <span class="token punctuation">(</span>origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">affine_guessab</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> m2<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    x1 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>    x2 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>m2<span class="token punctuation">)</span>    y1 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c1<span class="token punctuation">)</span>    y2 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c2<span class="token punctuation">)</span>    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>    dxi <span class="token operator">=</span> invert<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">if</span> x1 <span class="token operator">-</span> x2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        dxi <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>    a <span class="token operator">=</span> dxi <span class="token operator">*</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> y2<span class="token punctuation">)</span> <span class="token operator">%</span> n    b <span class="token operator">=</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> a <span class="token operator">*</span> x1<span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token string">"affinecipher"</span>a <span class="token operator">=</span> <span class="token number">5</span>b <span class="token operator">=</span> <span class="token number">8</span>c <span class="token operator">=</span> affine_encode<span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>affine_decode<span class="token punctuation">(</span>c<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>affine_guessab<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'h'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ihhwvcswfrcp</span><span class="token comment"># affinecipher</span><span class="token comment"># (mpz(5), mpz(8))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="多表替代密码"><a href="#多表替代密码" class="headerlink" title="多表替代密码"></a>多表替代密码</h3><h4 id="棋盘密码"><a href="#棋盘密码" class="headerlink" title="棋盘密码"></a>棋盘密码</h4><p>Playfair、Polybius和Nihilist均属于棋盘类密码。此类密码的密钥为1个5×5的棋盘。棋盘的生成符合如下条件：顺序随意；不得出现重复字母；i和j可视为同一字（也有讲q去除的，以保证总数为25个）。生成棋盘后，不同的加密方式使用了不同的转换方式。生成棋盘代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gen_cheese_map</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> use_Q<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> upper<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    k <span class="token operator">=</span> k<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    k0 <span class="token operator">=</span> <span class="token string">""</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> k<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">for</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">if</span> use_Q <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> upper <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">25</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k0<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">:</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">print</span><span class="token punctuation">(</span>gen_cheese_map<span class="token punctuation">(</span><span class="token string">"helloword"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ['HELOW', 'RDABC', 'FGIKM', 'NPQST', 'UVXYZ']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Playfair根据明文的位置去寻找新的字母。首先将明文字母两两一组进行切分，并按照如下规则进行加密。</p><p>1）若两个字母不同行也不同列，则需要在矩阵中找出另外两个字母（第一个字母对应行优先），使这四个字母成为一个长方形的四个角。</p><p>2）若两个字母同行，则取这两个字母右方的字母（若字母在最右方则取最左方的字母）。</p><p>3）若两个字母同列，则取这两个字母下方的字母（若字母在最下方则取最上方的字母）。</p><p>变换、加密和解密代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_playfair_2char</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                ai <span class="token operator">=</span> i                aj <span class="token operator">=</span> j            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                bi <span class="token operator">=</span> i                bj <span class="token operator">=</span> j    <span class="token keyword">if</span> ai <span class="token operator">==</span> bi<span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        bxi <span class="token operator">=</span> bi        axj <span class="token operator">=</span> <span class="token punctuation">(</span>aj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxj <span class="token operator">=</span> <span class="token punctuation">(</span>bj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">elif</span> aj <span class="token operator">==</span> bj<span class="token punctuation">:</span>        axj <span class="token operator">=</span> aj        bxj <span class="token operator">=</span> bj        axi <span class="token operator">=</span> <span class="token punctuation">(</span>ai <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxi <span class="token operator">=</span> <span class="token punctuation">(</span>bi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        axj <span class="token operator">=</span> bj        bxi <span class="token operator">=</span> bi        bxj <span class="token operator">=</span> aj    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">[</span>axi<span class="token punctuation">]</span><span class="token punctuation">[</span>axj<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">map</span><span class="token punctuation">[</span>bxi<span class="token punctuation">]</span><span class="token punctuation">[</span>bxj<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">playfair_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> m<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    tmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>            tmp <span class="token operator">+=</span> i    m <span class="token operator">=</span> tmp    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    m0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    idx <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> m<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">2</span>        <span class="token keyword">elif</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"X"</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"X"</span><span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">if</span> idx <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"X"</span><span class="token punctuation">:</span>                m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"X"</span><span class="token punctuation">)</span>                idx <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m0<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_playfair_2char<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">_playfair_2char_decode</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                ai <span class="token operator">=</span> i                aj <span class="token operator">=</span> j            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                bi <span class="token operator">=</span> i                bj <span class="token operator">=</span> j    <span class="token keyword">if</span> ai <span class="token operator">==</span> bi<span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        bxi <span class="token operator">=</span> bi        axj <span class="token operator">=</span> <span class="token punctuation">(</span>aj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxj <span class="token operator">=</span> <span class="token punctuation">(</span>bj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">elif</span> aj <span class="token operator">==</span> bj<span class="token punctuation">:</span>        axj <span class="token operator">=</span> aj        bxj <span class="token operator">=</span> bj        axi <span class="token operator">=</span> <span class="token punctuation">(</span>ai <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxi <span class="token operator">=</span> <span class="token punctuation">(</span>bi <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        axj <span class="token operator">=</span> bj        bxi <span class="token operator">=</span> bi        bxj <span class="token operator">=</span> aj    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">[</span>axi<span class="token punctuation">]</span><span class="token punctuation">[</span>axj<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">map</span><span class="token punctuation">[</span>bxi<span class="token punctuation">]</span><span class="token punctuation">[</span>bxj<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">playfair_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_playfair_2char_decode<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>r<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token string">"Hide the gold in the tree stump"</span>k <span class="token operator">=</span> <span class="token string">"playfairexample"</span>c <span class="token operator">=</span> playfair_encode<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>playfair_decode<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ['BM', 'OD', 'ZB', 'XD', 'NA', 'BE', 'KU', 'DM', 'UI', 'XM', 'MO', 'UV', 'IF']</span><span class="token comment"># HIDETHEGOLDINTHETREXESTUMP</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>playfair也有在线网站<a href="http://rumkin.com/tools/cipher/playfair.php">http://rumkin.com/tools/cipher/playfair.php</a></p><p>Polybius密码相对简单一点（Nihilist原理相同），只用棋盘的坐标作为密文，可能不一定是数字，坐标可以用字母表示，解密也是参照map去寻找对应的明文，代码如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">polybius_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"ADFGX"</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> m<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> x<span class="token punctuation">:</span>                    r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>name<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> name<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">polybius_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"ADFGX"</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> c<span class="token punctuation">:</span>        i <span class="token operator">=</span> name<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        j <span class="token operator">=</span> name<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        r <span class="token operator">+=</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>    <span class="token keyword">return</span> rm <span class="token operator">=</span> <span class="token string">"helloworld"</span>k <span class="token operator">=</span> <span class="token string">"abcd"</span>c <span class="token operator">=</span> polybius_encode<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>polybius_decode<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ['DF', 'AX', 'FA', 'FA', 'FG', 'XD', 'FG', 'GD', 'FA', 'AG']</span><span class="token comment"># HELLOWORLD</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a>维吉尼亚密码</h4><p>凯撒密码是单表替代密码，其只使用了一个替代表，维吉尼亚密码则是标准的多表替代密码。</p><p>\normalsize 首先，多表替代密码的密钥不再是固定不变的，而是随着位置发生改变的。在维吉尼亚密码中，根据密钥的字母来选择。比如密钥是LOVE，那么明文会没四组一个循环，使用的密钥如表所示</p><table><thead><tr><th>L-LMNOPQRSTUVWXYZABCDEFGHIJK</th></tr></thead><tbody><tr><td>O-OPQRSTUVWXYZABCDEFGHIJKLMN</td></tr><tr><td>V-VWXYZABCDEFGHIJKLMNOPQRSTU</td></tr><tr><td>E-EFGHIJKLMNOPQRSTUVWXYZABCD</td></tr></tbody></table><p>明文的第一个位置用L加密，二三四用OVE，到第五个位置回到L，一般情况下，维吉尼亚密码的破解必须依靠爆破+词频统计的方法来进行，这里有一个破解网站：<a href="http://www.quipqiup.com/index.php%EF%BC%88%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8%E5%8F%82%E8%A7%81%E7%BD%91%E7%AB%99%E8%AF%B4%E6%98%8E%EF%BC%89">http://www.quipqiup.com/index.php（具体使用参见网站说明）</a></p><p>对于自己破解维吉尼亚密码来说，其实也是词频统计，因为间隔密钥长度地字符使用的替代表是相同的。所以，如果密文长度足够长，并且知道密钥长度，是可以通过词频统计的方法进行破解的。</p><p>关于密钥的长度，可以使用卡西斯基试验和弗里德曼试验来获取，卡西斯基试验是类似于the这样的常用单词，如果使用了重复的密钥加密，那么两个相同的连续串的间隔将是密钥长度的倍数。获取这样的值并计算最大公约数，就可以得到密钥长度。</p><p>其它破解网站</p><p><a href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a></p><h4 id="希尔密码"><a href="#希尔密码" class="headerlink" title="希尔密码"></a>希尔密码</h4><p>希尔密码是运用基本矩阵原理的替换密码，由Lester S.Hill在1929年发明。将每个字母当作二十六进制数字：A=0，B=1，C=2,依次类推。将一串字母当成你、维向量，与一个n×n的矩阵相乘，再将得出的结果模26。注意，用作加密的矩阵（即密钥）在$Z_{26}^n$​中必须是可逆的，否则就不可能译码。只有矩阵的行列式与26互质才是可逆的。例如明文act：<br>$$<br>\begin{bmatrix}<br>0  \newline<br>2  \newline<br>19<br>\end{bmatrix}<br>$$<br>密钥：<br>$$<br>\begin{bmatrix}<br>6 &amp; 24 &amp; 1 \newline<br>13 &amp; 16 &amp; 10 \newline<br>20 &amp; 17 &amp; 15<br>\end{bmatrix}<br>$$<br>加密过程为：<br>$$<br>\begin{bmatrix}<br>6 &amp; 24 &amp; 1 \newline<br>13 &amp; 16 &amp; 10 \newline<br>20 &amp; 17 &amp; 15<br>\end{bmatrix}<br>$$<br>加密过程为：<br>$$<br>\begin{bmatrix}<br>6 &amp; 24 &amp; 1 \newline<br>13 &amp; 16 &amp; 10 \newline<br>20 &amp; 17 &amp; 15<br>\end{bmatrix}<br>\begin{bmatrix}<br>0  \newline<br>2  \newline<br>19<br>\end{bmatrix}<br>\equiv<br>\begin{bmatrix}<br>67  \newline<br>222  \newline<br>319<br>\end{bmatrix}<br>\equiv<br>\begin{bmatrix}<br>15  \newline<br>14  \newline<br>7<br>\end{bmatrix}<br>$$<br>所以密文为POH</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编码</title>
      <link href="2021/090254115.html"/>
      <url>2021/090254115.html</url>
      
        <content type="html"><![CDATA[<h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><h2 id="hex"><a href="#hex" class="headerlink" title="hex"></a>hex</h2><p>hex是将信息转化为16进制,密码学中大部分操作都是进行数学计算的过程。我们无法直接对字符串进行数学计算，所以需要将字符串转换为数字。可以通过hex编码的方式进行转换，将原始的字符串转化为十六进制字符串，再进行进一步的数学计算。以下为demon。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'flag'</span>s_by <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">'UTF-8'</span><span class="token punctuation">)</span>  <span class="token comment"># 转换成编码</span><span class="token keyword">print</span><span class="token punctuation">(</span>s_by<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>s_by<span class="token punctuation">)</span><span class="token punctuation">)</span>s_str <span class="token operator">=</span> s_by<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 转换成16进制字符串</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s_int <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>s_str<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>  <span class="token comment"># 转换成10进制整数</span><span class="token keyword">print</span><span class="token punctuation">(</span>s_int<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>s_int<span class="token punctuation">)</span><span class="token punctuation">)</span>s_hex <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>s_int<span class="token punctuation">)</span>  <span class="token comment"># 转换成16进制字符串，也可以直接+0x</span><span class="token keyword">print</span><span class="token punctuation">(</span>s_hex<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>s_hex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 对单字符可以直接用ord函数</span>num <span class="token operator">=</span> <span class="token number">584734024210391580014049650557280915516226103165</span>num_str <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>num_str<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>num_str<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># hex结果是字符串</span>num_hex <span class="token operator">=</span> num_str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># 截取第三个到最后</span><span class="token keyword">print</span><span class="token punctuation">(</span>num_hex<span class="token punctuation">)</span>  <span class="token comment">#若有L，则[2:-1]截取到倒数第二个字符串，前闭后开</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num_hex<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> num_hex<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">"flag&#123;this_is_a_flag&#125;"</span><span class="token punctuation">,</span> <span class="token string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''b'flag' &lt;class 'bytes'>&lt;class 'str'> &lt;class 'type'>1718378855 &lt;class 'int'>0x666c6167 &lt;class 'str'>970x666c61677b746869735f69735f615f666c61677d &lt;class 'str'>666c61677b746869735f69735f615f666c61677dflag&#123;this_is_a_flag&#125;584734024210391580014049650557280915516226103165flag&#123;this_is_a_flag&#125;'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="urlencode"><a href="#urlencode" class="headerlink" title="urlencode"></a>urlencode</h2><p>urlencode主要用于浏览器和网站之间的数据交换，这种编码是在特殊字符的hex基础上，每个字符前置一个“%”，demon如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse<span class="token keyword">print</span><span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span><span class="token string">'flag&#123;url_encode_1234_!@#$&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#quote处理字符转义，在特殊字符hex的基础上，每个字符前置一个%</span>d<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'bibi@flappypig,club'</span><span class="token punctuation">,</span><span class="token string">'flag'</span><span class="token punctuation">:</span><span class="token string">'flag&#123;url_encode_1234_!@#$&#125;'</span><span class="token punctuation">&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''flag%7Burl_encode_1234_%21%40%23%24%7Dname=bibi%40flappypig%2Cclub&amp;flag=flag%7Burl_encode_1234_%21%40%23%24%7Dquote对字符串进行url编码，可以使用unquote函数进行解码urlencode函数对字典模式的键值对进行url编码'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="morsecode"><a href="#morsecode" class="headerlink" title="morsecode"></a>morsecode</h2><p>摩斯电码由长音和短音构成的，使用“.”表示短音，“-”表示长音，“/”表示分隔符，解码可以用在线工具列举如下：<br><a href="https://www.atool99.com/morse.php">https://www.atool99.com/morse.php</a><br><a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx">http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx</a><br><a href="http://www.bejson.com/enc/morse/">http://www.bejson.com/enc/morse/</a><br><a href="https://www.jb51.net/tools/morse.htm">https://www.jb51.net/tools/morse.htm</a><br>如果碰到摩斯电码与MISC音频题结合起来出题，求稳可以用Cool Edit进行编辑，可以明显观察长音和短音，（自信听力好可以直接听）然后将电码抄录，最后解码。用python进行解码的code如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">alphabet_to_morse <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"A"</span><span class="token punctuation">:</span> <span class="token string">".-"</span><span class="token punctuation">,</span>    <span class="token string">"B"</span><span class="token punctuation">:</span> <span class="token string">"-.-."</span><span class="token punctuation">,</span>    <span class="token string">"C"</span><span class="token punctuation">:</span> <span class="token string">"-.-."</span><span class="token punctuation">,</span>    <span class="token string">"D"</span><span class="token punctuation">:</span> <span class="token string">"-.."</span><span class="token punctuation">,</span>    <span class="token string">"E"</span><span class="token punctuation">:</span> <span class="token string">"."</span><span class="token punctuation">,</span>    <span class="token string">"F"</span><span class="token punctuation">:</span> <span class="token string">"..-."</span><span class="token punctuation">,</span>    <span class="token string">"G"</span><span class="token punctuation">:</span> <span class="token string">"--."</span><span class="token punctuation">,</span>    <span class="token string">"H"</span><span class="token punctuation">:</span> <span class="token string">"...."</span><span class="token punctuation">,</span>    <span class="token string">"I"</span><span class="token punctuation">:</span> <span class="token string">".."</span><span class="token punctuation">,</span>    <span class="token string">"J"</span><span class="token punctuation">:</span> <span class="token string">".---"</span><span class="token punctuation">,</span>    <span class="token string">"K"</span><span class="token punctuation">:</span> <span class="token string">"-.-"</span><span class="token punctuation">,</span>    <span class="token string">"L"</span><span class="token punctuation">:</span> <span class="token string">".-.."</span><span class="token punctuation">,</span>    <span class="token string">"M"</span><span class="token punctuation">:</span> <span class="token string">"--"</span><span class="token punctuation">,</span>    <span class="token string">"N"</span><span class="token punctuation">:</span> <span class="token string">"-."</span><span class="token punctuation">,</span>    <span class="token string">"O"</span><span class="token punctuation">:</span> <span class="token string">"---"</span><span class="token punctuation">,</span>    <span class="token string">"P"</span><span class="token punctuation">:</span> <span class="token string">".--."</span><span class="token punctuation">,</span>    <span class="token string">"Q"</span><span class="token punctuation">:</span> <span class="token string">"--.-"</span><span class="token punctuation">,</span>    <span class="token string">"R"</span><span class="token punctuation">:</span> <span class="token string">".-."</span><span class="token punctuation">,</span>    <span class="token string">"S"</span><span class="token punctuation">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span>    <span class="token string">"T"</span><span class="token punctuation">:</span> <span class="token string">"-"</span><span class="token punctuation">,</span>    <span class="token string">"U"</span><span class="token punctuation">:</span> <span class="token string">"..-"</span><span class="token punctuation">,</span>    <span class="token string">"V"</span><span class="token punctuation">:</span> <span class="token string">"...-"</span><span class="token punctuation">,</span>    <span class="token string">"W"</span><span class="token punctuation">:</span> <span class="token string">".--"</span><span class="token punctuation">,</span>    <span class="token string">"X"</span><span class="token punctuation">:</span> <span class="token string">"-..-"</span><span class="token punctuation">,</span>    <span class="token string">"Y"</span><span class="token punctuation">:</span> <span class="token string">"-.--"</span><span class="token punctuation">,</span>    <span class="token string">"Z"</span><span class="token punctuation">:</span> <span class="token string">"--.."</span><span class="token punctuation">,</span>    <span class="token string">"0"</span><span class="token punctuation">:</span> <span class="token string">"-----"</span><span class="token punctuation">,</span>    <span class="token string">"1"</span><span class="token punctuation">:</span> <span class="token string">".----"</span><span class="token punctuation">,</span>    <span class="token string">"2"</span><span class="token punctuation">:</span> <span class="token string">"..---"</span><span class="token punctuation">,</span>    <span class="token string">"3"</span><span class="token punctuation">:</span> <span class="token string">"...--"</span><span class="token punctuation">,</span>    <span class="token string">"4"</span><span class="token punctuation">:</span> <span class="token string">"....-"</span><span class="token punctuation">,</span>    <span class="token string">"5"</span><span class="token punctuation">:</span> <span class="token string">"....."</span><span class="token punctuation">,</span>    <span class="token string">"6"</span><span class="token punctuation">:</span> <span class="token string">"-...."</span><span class="token punctuation">,</span>    <span class="token string">"7"</span><span class="token punctuation">:</span> <span class="token string">"--..."</span><span class="token punctuation">,</span>    <span class="token string">"8"</span><span class="token punctuation">:</span> <span class="token string">"---.."</span><span class="token punctuation">,</span>    <span class="token string">"9"</span><span class="token punctuation">:</span> <span class="token string">"----."</span><span class="token punctuation">,</span>    <span class="token string">"."</span><span class="token punctuation">:</span> <span class="token string">".-.-.-"</span><span class="token punctuation">,</span>    <span class="token string">","</span><span class="token punctuation">:</span> <span class="token string">"--..--"</span><span class="token punctuation">,</span>    <span class="token string">":"</span><span class="token punctuation">:</span> <span class="token string">"---..."</span><span class="token punctuation">,</span>    <span class="token string">";"</span><span class="token punctuation">:</span> <span class="token string">"-.-.-."</span><span class="token punctuation">,</span>    <span class="token string">"?"</span><span class="token punctuation">:</span> <span class="token string">"..--.."</span><span class="token punctuation">,</span>    <span class="token string">"-"</span><span class="token punctuation">:</span> <span class="token string">"-....-"</span><span class="token punctuation">,</span>    <span class="token string">"_"</span><span class="token punctuation">:</span> <span class="token string">"..--.-"</span><span class="token punctuation">,</span>    <span class="token string">"("</span><span class="token punctuation">:</span> <span class="token string">"-.--."</span><span class="token punctuation">,</span>    <span class="token string">")"</span><span class="token punctuation">:</span> <span class="token string">"-.--.-"</span><span class="token punctuation">,</span>    <span class="token string">"="</span><span class="token punctuation">:</span> <span class="token string">"-...-"</span><span class="token punctuation">,</span>    <span class="token string">"+"</span><span class="token punctuation">:</span> <span class="token string">".-.-."</span><span class="token punctuation">,</span>    <span class="token string">"/"</span><span class="token punctuation">:</span> <span class="token string">"-..-."</span><span class="token punctuation">,</span>    <span class="token string">"@"</span><span class="token punctuation">:</span> <span class="token string">".--.-."</span><span class="token punctuation">,</span>    <span class="token string">"$"</span><span class="token punctuation">:</span> <span class="token string">"...-..-"</span><span class="token punctuation">,</span>    <span class="token string">"&amp;"</span><span class="token punctuation">:</span> <span class="token string">"...."</span><span class="token punctuation">,</span>    <span class="token string">"'"</span><span class="token punctuation">:</span> <span class="token string">".----."</span><span class="token punctuation">,</span>    <span class="token string">"!"</span><span class="token punctuation">:</span> <span class="token string">"-.-.--"</span><span class="token punctuation">,</span>    <span class="token string">'"'</span><span class="token punctuation">:</span> <span class="token string">".-..-."</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>morse_to_alphabet <span class="token operator">=</span> <span class="token punctuation">&#123;</span>v<span class="token punctuation">:</span> k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> alphabet_to_morse<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">_morseremoveunusablecharacters</span><span class="token punctuation">(</span>uncorrected_string<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> char<span class="token punctuation">:</span> char <span class="token keyword">in</span> alphabet_to_morse<span class="token punctuation">,</span>     uncorrected_string<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''filter() 函数用于过滤序列，过滤掉不符合条件的元素，返回由符合条件元素组成的新列表function -- 判断函数。iterable -- 可迭代对象匿名函数lambda：是指一类无需定义标识符（函数名）的函数或子程序。lambda 函数可以接收任意多个参数 (包括可选参数) 并且返回单个表达式的值。'''</span><span class="token keyword">def</span> <span class="token function">morseencode</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    :param decoded:    :return:    """</span>    morsestring <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    decoded <span class="token operator">=</span> _morseremoveunusablecharacters<span class="token punctuation">(</span>decoded<span class="token punctuation">)</span>    decoded <span class="token operator">=</span> decoded<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    words <span class="token operator">=</span> decoded<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>        letters <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span>        morseword <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>            morseletter <span class="token operator">=</span> alphabet_to_morse<span class="token punctuation">[</span>letter<span class="token punctuation">]</span>            morseword<span class="token punctuation">.</span>append<span class="token punctuation">(</span>morseletter<span class="token punctuation">)</span>        word <span class="token operator">=</span> <span class="token string">"/"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>morseword<span class="token punctuation">)</span>        morsestring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>morsestring<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">morsedecode</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    :param encoded:    :return:    """</span>    characterstring <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    words <span class="token operator">=</span> encoded<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>        letters <span class="token operator">=</span> word<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>        characterword <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>            characterletter <span class="token operator">=</span> morse_to_alphabet<span class="token punctuation">[</span>letter<span class="token punctuation">]</span>            characterword<span class="token punctuation">.</span>append<span class="token punctuation">(</span>characterletter<span class="token punctuation">)</span>        word <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>characterword<span class="token punctuation">)</span>        characterstring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>characterstring<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="jsfuck"><a href="#jsfuck" class="headerlink" title="jsfuck"></a>jsfuck</h2><p>jsfuck仅使用6个字符“()+[]!”就可以书写任意的Javascript代码，可以在下面两个网站解码：</p><p><a href="http://www.jsfuck.com/">http://www.jsfuck.com/</a></p><p><a href="https://utf-8.jp/public/jsfuck.html">https://utf-8.jp/public/jsfuck.html</a></p><p><a href="http://codertab.com/JsUnFuck">http://codertab.com/JsUnFuck</a></p><h2 id="uuencode"><a href="#uuencode" class="headerlink" title="uuencode"></a>uuencode</h2><p>uuencode是一种将二进制文本转化为可见字符文本的一种编码，编码之后出现的是ASC码32-95的字符，也就是没有小写字母，还是比较容易识别的。也有在线解码网站：<a href="https://www.qqxiuzi.cn/bianma/uuencode.php">https://www.qqxiuzi.cn/bianma/uuencode.php</a></p><h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><p>Crypto一定要提到大名鼎鼎的base家族，如base64、base32、base16等，还有一些可能不太熟悉的，如base36、base58、base62、base85、base91、base92。其中base16就是hex，也就是用16个字符去表示256个字符（4bit的内容去表示16bit的内容），如果用更多的字符就也就是后面的base32、base64。<br>那么如何识别base家族呢，首先看结尾有没有补位的“=”如果有就一定是，没有再看对应的字母是不是在base家族对应的字符集上。下面列举base家族对应的字符集</p><table><thead><tr><th>base</th><th>字符集</th></tr></thead><tbody><tr><td>base16</td><td>0-9,A-F共16个以及补位的“=”</td></tr><tr><td>base32</td><td>A-Z,2-7共32个以及补位的“=”</td></tr><tr><td>base64</td><td>a-z,0-9,A-F,+,/共64个以及补位的“=”</td></tr></tbody></table><p>下面举个base64例子说明它是如何将3个字符用4个字符进行表示的</p><table><thead><tr><th>A                              S                         T</th></tr></thead><tbody><tr><td>65                            83                       84</td></tr><tr><td>01000001            01010011            01010100</td></tr><tr><td>010000           010101           001101         010100</td></tr><tr><td>16                      21                    13                 20</td></tr></tbody></table><p>如上所示，先将找字符对应的asc码，再转化为二进制，然后6bit一组切分，将6bit组成的数字转化为十进制，最后查表得到字符。其它如base32也是进行类似操作。</p><p>至于没有列举的（不太常见的）可以自行查阅字符集，有些题目可能就是会用多种base进行多次编码，相应的也需要多次解码，所以判断在哪一次用了那种编码就十分重要，下面是一个非常好用的在线解码网站(对ctf来说都很好用)，能进行base家族的多种编码解码<a href="http://ctf.ssleye.com/%E3%80%82">http://ctf.ssleye.com/。</a></p><p>最后Python demon如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64s <span class="token operator">=</span> <span class="token string">'flag'</span>s_by <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">'UTF-8'</span><span class="token punctuation">)</span>  <span class="token comment"># 转换成编码</span><span class="token keyword">print</span><span class="token punctuation">(</span>s_by<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>s_by<span class="token punctuation">)</span><span class="token punctuation">)</span>s_base64_by <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>s_by<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s_base64_by<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>s_base64_by<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 类型还是编码</span>s_base64 <span class="token operator">=</span> s_base64_by<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>s_base64<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>s_base64<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># decode变为字符串</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b16encode<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span> <span class="token string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b32encode<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span> <span class="token string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span> <span class="token string">'UTF-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b16decode<span class="token punctuation">(</span><span class="token string">"666C6167"</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b32decode<span class="token punctuation">(</span><span class="token string">"MZWGCZY="</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 结果为编码</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span><span class="token string">"ZmxhZw=="</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 结果为编码</span><span class="token triple-quoted-string string">'''b'flag' &lt;class 'bytes'>b'ZmxhZw==' &lt;class 'bytes'>ZmxhZw== &lt;class 'str'>666C6167MZWGCZY=ZmxhZw==b'flag'b'flag'b'flag''''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Quoted-printable"><a href="#Quoted-printable" class="headerlink" title="Quoted-printable"></a>Quoted-printable</h2><p><a href="http://web.chacuo.net/charsetquotedprintable/">http://web.chacuo.net/charsetquotedprintable/</a></p><p><a href="http://www.mxcz.net/tools/quotedprintable.aspx">http://www.mxcz.net/tools/quotedprintable.aspx</a></p><h2 id="Rabbit"><a href="#Rabbit" class="headerlink" title="Rabbit"></a>Rabbit</h2><p><a href="http://tool.chinaz.com/Tools/TextEncrypt.aspx">http://tool.chinaz.com/Tools/TextEncrypt.aspx</a></p><h2 id="中文电码"><a href="#中文电码" class="headerlink" title="中文电码"></a>中文电码</h2><p><a href="http://code.mcdvisa.com/">http://code.mcdvisa.com/</a></p><h2 id="曼彻斯特编码"><a href="#曼彻斯特编码" class="headerlink" title="曼彻斯特编码"></a>曼彻斯特编码</h2><p>网上有现成工具。</p><h2 id="社会主义核心价值观编码"><a href="#社会主义核心价值观编码" class="headerlink" title="社会主义核心价值观编码"></a>社会主义核心价值观编码</h2><p><a href="https://atool.vip/corevalue/">https://atool.vip/corevalue/</a></p><h2 id="新约佛论禅"><a href="#新约佛论禅" class="headerlink" title="新约佛论禅"></a>新约佛论禅</h2><p><a href="http://hi.pcmoe.net/buddha.html">http://hi.pcmoe.net/buddha.html</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wiener Attack</title>
      <link href="2021/081919318.html"/>
      <url>2021/081919318.html</url>
      
        <content type="html"><![CDATA[<h1 id="Wiener-Attack"><a href="#Wiener-Attack" class="headerlink" title="Wiener Attack"></a>Wiener Attack</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>又到了每周四的没有碧蓝航线玩好无聊时间，维纳攻击的脚本自己曾经写过，但是遇到大整数的时候会发生错误，前天拜读了z2333大佬的维纳攻击详解之后，正好今天无事，找来那两篇论文，再推导一遍，重新整理了一下，突然解决了之前的bug（doge）。</p><p>以下内容默认掌握一定RSA基础及相关数论知识。</p><h2 id="Wiener-Attack简介（太长不看版）"><a href="#Wiener-Attack简介（太长不看版）" class="headerlink" title="Wiener Attack简介（太长不看版）"></a>Wiener Attack简介（太长不看版）</h2><p>我们从RSA的私钥开始<br>$$<br>ed-1=k\varphi(n)<br>$$<br>变形<br>$$<br>\frac{e}{\varphi(n)}-\frac{k}{d}=\frac{1}{d\varphi(n)}<br>$$<br>考虑到$\varphi(n)=(p-1)(q-1)\approx pq=n$​）<br>$$<br>\mid \frac{e}{n}-\frac{k}{d} \mid=\frac{1}{d\varphi(n)}<br>$$<br>$d\phi(n)$是一个很大的数，所以不难由上式得到$\frac{e}{n}$接近$\frac{k}{d}$</p><p>为啥要这么写呢，因为$e$和$n$是我们是知道的，所以我们计算出$\frac{e}{n}$后，$\frac{k}{d}$怎么出来呢，计算$\frac{e}{n}$的连分数展开，依次算出这个分数每一个渐进分数，由于$\frac{e}{n}$接近$\frac{k}{d}$，$wiener$证明了，该攻击能精确的覆盖$\frac{k}{d}$，前提是$d&lt;\frac{1}{3}n^{\frac{1}{4}}$。</p><p>最终我们能算出$\phi(n)$从而最构造如下二次方程<br>$$<br>x^2-(p+q)x+pq=x^2-(n-\varphi(n)+1)x+n=0<br>$$<br>最终解得两根$p、q$。</p><h2 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h2><h3 id="维纳攻击基本原理"><a href="#维纳攻击基本原理" class="headerlink" title="维纳攻击基本原理"></a>维纳攻击基本原理</h3><p>维纳攻击通常被描述成如下形式</p><p>如果$p&lt;q&lt;2p,e&lt;n,d&lt;\frac{1}{3}n^\frac{1}{4}，$​​那么$d$​是$\frac{e}{n}$连分数展开的一个分母。​​</p><p>从如下最基本的式子开始<br>$$<br>ed\equiv 1\ (mod\ \varphi(n))<br>$$<br>则$\exists k\in Z,st\ ed-k\varphi(n)=1$​。现在$\varphi(n)\approx n$​隐含$\frac{k}{d}\approx\frac{e}{n}$​。更精确些，我们有$n-3\sqrt{n}&lt;\varphi(n)&lt;n$​以及<br>$$<br>\mid \frac{k}{d}-\frac{e}{n} \mid &lt;\frac{3k}{d\sqrt{n}} &lt;\frac{1}{2d^2}(*)<br>$$<br>先证$n-3\sqrt{n}&lt;\varphi(n)&lt;n$。不等式的​​右边显然成立，左边可化简成<br>$$<br>pq-3\sqrt{pq}&lt;pq-(p+q)+1<br>$$</p><p>$$<br>\iff p-3\sqrt{pq}+q&lt;1<br>$$</p><p>$$<br>\iff \frac{p}{q}-3\sqrt{\frac{p}{q}}+1&lt;\frac{1}{q}<br>$$</p><p>令$t=\frac{p}{q}&lt;\in(\frac{1}{2},1)$​,<br>$$<br>\iff (t-\frac{3}{2})^2 (\in(\frac{1}{4},1))&lt; \frac{5}{4}+\frac{1}{q}<br>$$<br>再看$(*)$式<br>$$<br>\mid \frac{k}{d}-\frac{e}{n} \mid = \mid \frac{k}{d}-\frac{e}{\varphi(n)}\frac{\varphi(n)}{n}\mid<br>$$<br>利用<br>$$<br>\frac{e}{\varphi(n)}-\frac{k}{d}=\frac{1}{d\varphi(n)}<br>$$<br>有<br>$$<br>\mid \frac{k}{d}-\frac{e}{n} \mid = \mid \frac{k}{d}-(\frac{k}{d}+\frac{1}{d\varphi(n)})\frac{\varphi(n)}{n}\ \mid=\mid \frac{k}{d}(1-\frac{\varphi(n)}{n}-\frac{1}{kn}) \mid<br>$$<br>而由$n-3\sqrt{n}&lt;\varphi(n)&lt;n$​知$1-\frac{3}{\sqrt{n}}&lt;\frac{\varphi(n)}{n}&lt;1$​，从而<br>$$<br>\mid \frac{k}{d}-\frac{e}{n} \mid &lt; \mid \frac{k}{d}\frac{3}{\sqrt{n}} \mid =\frac{3k}{d\sqrt{n}}<br>$$<br>由$RSA$原理知，$ed=k\varphi(n)+1&gt;k\varphi(n)$且$e&lt;\varphi(n)$，从而$k&lt;d&lt;\frac{1}{3}n^{\frac{1}{4}}$​，故<br>$$<br>\mid \frac{k}{d}-\frac{e}{n} \mid &lt;\frac{3k}{d\sqrt{n}} &lt; \frac{1}{dn^{\frac{1}{4}}}&lt;\frac{1}{2d^2}<br>$$<br>由勒让德理论$(Legendre’s\ theorem)$​​​，若$|\alpha-\frac{a}{b}|&lt;\frac{1}{2b^2}$​​​，其中$\alpha $​​​为分数，$a、b$为不互质的正整数，那么$\frac{a}{b}$​为$\alpha$的一个收敛分数。</p><p>以下为勒让德理论的证明。</p><h3 id="勒让德理论"><a href="#勒让德理论" class="headerlink" title="勒让德理论"></a>勒让德理论</h3><p>在证明前首先证明两个定理</p><h4 id="定理1"><a href="#定理1" class="headerlink" title="定理1"></a>定理1</h4><p><strong>连分数提供了实数$\alpha$和整数序列$a_0,a_1,\cdots,(a_i\geq1,i&gt;0)$​​之间的一一映射。整数序列终止当且仅当$\alpha$是一个有理数，此时$\alpha=[a_0;a_1,\cdots,a_n],a_n&gt;1$​​。</strong></p><p>连分数表示为以下形式<br>$$<br>a_0 + \frac {1}{a_1 + \frac {1}{a_2 + \frac {1}{… + \frac {1}{a_n}}}}<br>$$<br>通常也写成$a_0+\frac{1}{a_1+}\frac{1}{a_2+}\cdots\frac{1}{a_n}$​或者$[a_0;a_1,a_2,\cdots,a_n]$。其中$a_0 \in Z$，$a_1,\cdots,a_n$​是正整数，通常认为$a_n&gt;1$​​。显然任何有限连分数都表示一个有理数。相反地，如果$(b_0,r_0)=1$​那么由辗转相除法可以得到<br>$$<br>b_0=a_0r_0+r_1,\ \  0\leq r_1&lt;r_0<br>$$</p><p>$$<br>r_0=a_1r_1+r_2,\ \  0\leq r_2&lt;r_1<br>$$</p><p>$$<br>r_1=a_2r_2+r_3,\ \  0\leq r_3&lt;r_2<br>$$</p><p>$$<br>\cdots<br>$$</p><p>上述过程必定在有限步终止于<br>$$<br>r_{n-1}=a_nr_n<br>$$<br>现在<br>$$<br>\begin{aligned}<br>    \frac{b_0}{r_0}<br>    &amp;= a_0+\frac{r_1}{r_0}=a_0+\frac{1}{\frac{r_0}{r_1}}\newline<br>    &amp;= a_0+\frac{a_1}{\frac{r_2}{r_1}}\newline<br>    &amp;= [a_0;a_1,a_2,\cdots,a_n]<br>\end{aligned}<br>$$<br>这个过程表明了有理数$\frac{b_0}{r_0}$​和有限序列$a_0,a_1,\cdots,a_n(a_1\geq1,\cdots,a_{n-1}\geq1,a_n&gt;1)$​​​之间一一对应的关系。</p><p>在证明无理数情形前，先证明两个引理</p><h5 id="引理1"><a href="#引理1" class="headerlink" title="引理1"></a>引理1</h5><p>考虑<br>$$<br>p_{-2}=0,p_{-1}=1,p_m=a_mp_{m-1}+p_{m-2}\ \ (m\geq0)<br>$$</p><p>$$<br>q_{-2}=1,q_{-1}=0,q_m=a_mq_{m-1}+q_{m-2}\ \ (m\geq0)<br>$$</p><p>那么$p_m$​和$q_m$​是以$a_0,\cdots,a_m$​为系数的多项式，它们具有如下关系<br>$$<br>p_mq_{m-1}-p_{m-1}q_m=(-1)^{m-1}\ \ (m\geq-1)<br>$$<br>以下用归纳法证明。对于$m=-1$和$m=0$显然成立，假设对$m-1$成立，那么<br>$$<br>\begin{aligned}<br>    p_mq_{m-1}-p_{m-1}q_m<br>    &amp;= (a_mp_{m-1}+p_{m-2})q_{m-1}-p_{m-1}(a_mq_{m-1}+q_{m-2})\newline<br>    &amp;= -(p_{m-1}q_{m-2}-p_{m-2}q_{m-1})=-(-1)^{m-2}\newline<br>    &amp;= (-1)^{m-1}<br>\end{aligned}<br>$$</p><h5 id="引理2"><a href="#引理2" class="headerlink" title="引理2"></a>引理2</h5><p>$$<br>[a_0;a_1,a_2,\cdots,a_m]=\frac{p_m}{q_m}\ \ (m\geq0)<br>$$</p><p>对$m=0$来说是显然的，假设对$m-1$成立，那么<br>$$<br>\begin{aligned}<br>    \left[a_0;a_1,a_2,\cdots,a_m\right]<br>    &amp;= \left[a_0;a_1,\cdots,a_{m-1}+\frac{1}{a_m}\right]\newline<br>    &amp;= \frac{p_{m-1}^{‘}}{q_{m-1}^{‘}}\newline<br>    &amp;= \frac{(a_m-1+\frac{1}{a_m})p_{m-2}+p_{m-3}}{(a_m-1+\frac{1}{a_m})q_{m-2}+q_{m-3}}\newline<br>    &amp;= \frac{a_{m}(a_{m-1}p_{m-2}+p_{m-3})+p_{m-2}}{a_{m}(a_{m-1}q_{m-2}+q_{m-3})+q_{m-2}}\newline<br>    &amp;= \frac{a_mp_{m-1}+p_{m-2}}{a_mq_{m-1}+q_{m-2}}\newline<br>    &amp;= \frac{p_m}{q_m}<br>\end{aligned}<br>$$<br>其中，$p_{m-1}^{‘}$和$q_{m-1}^{‘}$以$a_0,a_1,\cdots,a_{m-2},a_{m-1}+\frac{1}{a_m}$为多项式系数。</p><p>假设$\alpha$是一个无理数。令$a_0=[\alpha],\alpha=a_0+\frac{1}{\alpha_1}$，那么$\alpha_1&gt;1$；令$a_1=[\alpha_1],\alpha_1=a_1+\frac{1}{\alpha_2}$，重复上述过程，我们得到$\alpha=[a_0;a_1,a_2,\cdots,a_{n-1},\alpha_n]$​，这里定义了整数序列$a_0,a_1&gt;0,a_2&gt;0,\cdots$，实数序列$\alpha_1,\alpha_2,\cdots&gt;1$​，以及相应的整数$p_n,q_n$。下证$\frac{p_n}{q_n}\rightarrow\alpha$</p><p>首先观察<br>$$<br>\begin{aligned}<br>    \frac{p_n}{q_n}<br>    &amp;= a_0+\sum_{m=1}^{n}\left(\frac{p_m}{q_m}-\frac{p_{m-1}}{q_{m-1}}\right)\newline<br>    &amp;= a_0+\sum_{m-1}^{n}\frac{(-1)^{m-1}}{q_{m-1}q_m}<br>\end{aligned}<br>$$<br>$q_i&gt;0(i\geq1)$​​并且严格单调递增$(q_m-q_{m-1}=(a_m-1)q_m-1+q_{m-2}&gt;0)$​​，因此$q_i\rightarrow \infin$​​（事实上$q_i\geq f_i$​​，$f_i$​​为斐波那契数列，这由递推式易知，从而$q_i&gt; c^i,c&gt;1$​​）。因此​​，由莱布尼茨判别法知级数收敛，从而$\frac{p_n}{q_n}$​收敛。并且<br>$$<br>\alpha=\frac{p_{n+1}}{q_{n+1}}=\frac{\alpha_{n+1}p_n+p_{n-1}}{\alpha_{n+1}q_n+q_{n-1}}<br>$$<br>因此<br>$$<br>\alpha-\frac{p_n}{q_n}=\frac{q_np_{n-1}-p_nq_{n-1}}{q_n(\alpha_{n+1}q_n+q_{n-1})}=\frac{(-1)^n}{q_n(\alpha_{n+1}q_n+q_{n-1})}<br>$$<br>由上可知$\alpha$收敛，即$\lim_{n\rightarrow \infin} p_n/q_n=\alpha$，写成<br>$$<br>\alpha=\alpha=[a_0;a_1,a_2,\cdots].<br>$$<br>相反地，对于整数序列，反过去构造即对应一个无理数。</p><p>综上证毕</p><h4 id="定理2"><a href="#定理2" class="headerlink" title="定理2"></a>定理2</h4><p>$||q_1\alpha||&gt;||q_2\alpha||&gt;\cdots,$当$0&lt;q&lt;q_n,$有$||q\alpha||\geq||q_{n-1}\alpha||$</p><p>首先记号$||\theta||=\underset{n\in \mathbb{Z}}{min}|\theta-n|,\theta\in R$</p><p>由<br>$$<br>\alpha-\frac{p_n}{q_n}=\frac{q_np_{n-1}-p_nq_{n-1}}{q_n(\alpha_{n+1}q_n+q_{n-1})}=\frac{(-1)^n}{q_n(\alpha_{n+1}q_n+q_{n-1})}<br>$$<br>得<br>$$<br>||q_n\alpha||=|q_n\alpha-p_n|=\frac{1}{\alpha_{n+1}q_n+q_{n-1}}<br>$$<br>$||q_n\alpha||$​单调递减等价于$\alpha_{n+1}q_n+q_{n-1}$​单调递增<br>$$<br>\alpha_{n+1}q_n+q_{n-1}\geq q_n+q_{n-1}=a_nq_{n-1}+q_{n-2}+q_{n-1}=(a_n+1)q_{n-1}+q_{n-2}&gt;\alpha_nq_{n-1}+q_{n-2}<br>$$<br>前半部分证毕。</p><p>现假设$0&lt;q&lt;q_n$，首先证明一个引理</p><h5 id="引理3"><a href="#引理3" class="headerlink" title="引理3"></a>引理3</h5><p>对$\forall$整数$p、q,$$\exists$整数$x、y$使得<br>$$<br>q=q_nx+q_{n-1}y,<br>$$</p><p>$$<br>p=p_nx+p_{n-1}y.<br>$$</p><p>注意到写成矩阵形式<br>$$<br>\left(<br>\begin{matrix}<br>q  \newline<br>p<br>\end{matrix}<br>\right)<br>=<br>\left(<br>\begin{matrix}<br>q_n &amp; q_{n-1}  \newline<br>p_n &amp; p_{n-1}<br>\end{matrix}<br>\right)<br>\left(<br>\begin{matrix}<br>x  \newline<br>y<br>\end{matrix}<br>\right)<br>$$<br>系数矩阵行列式为$p_{n-1}q_n-p_nq_{n-1}=(-1)^n$​，因此$p、q$为整数等价于$x、y$​为整数。</p><p>①$x=0,$则$q\alpha-p=y(q_{n-1}\alpha-p_{n-1}),$从而$|q\alpha-p|=|y||q_{n-1}\alpha|\geq|q_{n-1}\alpha|$​</p><p>②$y=0,$​则$q=q_nx\geq q_n,$矛盾！</p><p>③$x,y\neq0$，由$0&lt;q=q_nx+q_{n-1}y&lt;q_n$易知$xy$异号。而$q_n\alpha-p_n=\frac{(-1)^n}{\alpha_{n+1}q_n+q_{n-1}}$,$q_{n-1}\alpha-p_{n-1}=\frac{(-1)^{n-1}}{\alpha_nq_{n-1}+q_{n-2}}$,因此$q_n\alpha-p_n$与$q_{n-1}\alpha-p_{n-1}$异号，从而$(q_n\alpha-p_n)x$与$(q_{n-1}\alpha-p_{n-1})y$​同号。因此<br>$$<br>\begin{aligned}<br>    ||q\alpha||=|q\alpha-p|<br>    &amp;=|(q_n\alpha-p_n)x-(q_{n-1}\alpha-p_n)y|\newline<br>    &amp;=|(q_n\alpha-p_n)||x|+|(q_{n-1}\alpha-p_n)||y|\newline<br>    &amp;=||q_n\alpha|||x|+||q_{n-1}\alpha|||y|\geq||q_n\alpha||<br>\end{aligned}<br>$$<br>综上，证毕。</p><h4 id="Legendre"><a href="#Legendre" class="headerlink" title="Legendre"></a>Legendre</h4><p>若$|\alpha-\frac{p}{q}|&lt;\frac{1}{2q^2}$​，且$(p,q)=1$，那么$\exists n,st\ q_n=q$</p><p>选取$n，st\ q_n\leq q &lt; q_{n+1}$​，由于$pq_n-qp_n=q(\alpha q_n-p_n)-q_n(q\alpha-p)$​，有三角不等式<br>$$<br>|pq_n-qp_n|\leq q||q_n\alpha||+q_n||q\alpha||<br>$$<br>由定理2知$||q_n\alpha||\leq||q\alpha||$​，从而<br>$$<br>|pq_n-qp_n|\leq q||q\alpha||+q||q\alpha||=2q^2|\alpha-\frac{p}{q}|&lt;1<br>$$<br>因此$pq_n-qp_n=0$，而$(p_n,q_n)=(p,q)=1$，因此$q=q_n$。证毕。</p><h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><p>简单分析可以知道维纳攻击的时间复杂度是$O(logn)$,关键就在于辗转相除法法那一步。​</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> iroot<span class="token keyword">def</span> <span class="token function">continuedFraction</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">while</span> y<span class="token punctuation">:</span>        ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x <span class="token operator">//</span> y<span class="token punctuation">)</span>        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> x <span class="token operator">%</span> y    <span class="token keyword">return</span> ret<span class="token keyword">def</span> <span class="token function">cal</span><span class="token punctuation">(</span>fraction<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">list</span> <span class="token operator">=</span> fraction    <span class="token builtin">list</span><span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> <span class="token number">0</span>    k <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">:</span>        d<span class="token punctuation">,</span> k <span class="token operator">=</span> k<span class="token punctuation">,</span> x <span class="token operator">*</span> k <span class="token operator">+</span> d    <span class="token keyword">return</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getFraction</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    fraction <span class="token operator">=</span> continuedFraction<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>    length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>fraction<span class="token punctuation">)</span>    ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">:</span>        ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cal<span class="token punctuation">(</span>fraction<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ret<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>    delta <span class="token operator">=</span> iroot<span class="token punctuation">(</span>b <span class="token operator">*</span> b <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> a <span class="token operator">*</span> c<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">+</span> delta<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">-</span> delta<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">wienerAttack</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    ret <span class="token operator">=</span> getFraction<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">in</span> ret<span class="token punctuation">:</span>        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">continue</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">continue</span>        phi <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k        p<span class="token punctuation">,</span> q <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">(</span>n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>        <span class="token keyword">if</span> p <span class="token operator">*</span> q <span class="token operator">==</span> n<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>            <span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week12</title>
      <link href="2021/080843073.html"/>
      <url>2021/080843073.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week12KMP"><a href="#Week12KMP" class="headerlink" title="Week12KMP"></a>Week12KMP</h1><h2 id="串的模式匹配（KMP）"><a href="#串的模式匹配（KMP）" class="headerlink" title="串的模式匹配（KMP）"></a>串的模式匹配（KMP）</h2><h3 id="什么是串"><a href="#什么是串" class="headerlink" title="什么是串"></a>什么是串</h3><p>线性存储的 组数据 一组数据（默 是字符 认是字符）  </p><p>特殊操作集</p><ul><li>求串的长度</li><li>比较两串是否相等</li><li>两串相接</li><li>求子串</li><li>插入子串</li><li>匹配子串</li><li>删除子串  </li></ul><h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>给定一段文本，从中找出某个指定的关键字。</p><p>例如从一本 Thomas Love Peacock 写于十九世纪的小说《 Headlong Hall 》 中找到那个最长的单词</p><p>或者从古希腊喜剧《 Assemblywomen 》 中找到一道菜的名字</p><p>给定一段文本： $string = s_0s_1 …… s_{n-1}$</p><p>给定一个模式：$ pattern = p_0p_1 …… p_{m-1}$  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">PatternMatch</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pattern<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="简单实现"><a href="#简单实现" class="headerlink" title="简单实现"></a>简单实现</h3><h4 id="方法1：-C的库函数-strstr"><a href="#方法1：-C的库函数-strstr" class="headerlink" title="方法1： C的库函数 strstr"></a>方法1： C的库函数 strstr</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token comment">//char *strstr(char *string, char *pattern);</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>Position<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"This is a simple example."</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> pattern<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"simple"</span><span class="token punctuation">;</span>    Position p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> NotFound<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Not Found.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$strlen(string)=n,strlen(pattern)=m$,下同</p><p>$T<br>= O(n·m)  $</p><h3 id="简单改进"><a href="#简单改进" class="headerlink" title="简单改进"></a>简单改进</h3><h4 id="方法2：从末尾开始比"><a href="#方法2：从末尾开始比" class="headerlink" title="方法2：从末尾开始比"></a>方法2：从末尾开始比</h4><p>改了个寂寞</p><h3 id="大师改进"><a href="#大师改进" class="headerlink" title="大师改进"></a>大师改进</h3><h4 id="方法3：-KMP（-Knuth、-Morris、-Pratt-）-算法"><a href="#方法3：-KMP（-Knuth、-Morris、-Pratt-）-算法" class="headerlink" title="方法3： KMP（ Knuth、 Morris、 Pratt ） 算法"></a>方法3： KMP（ Knuth、 Morris、 Pratt ） 算法</h4><p>$T = O(n+m)  $<br>$$<br>match(j)=\left\{<br>\begin{aligned}<br>    &amp;满足p_0\cdots p_i=p_{j-i}\cdots p_j的最大i(&lt;j)  \newline<br>    &amp;-1\ 如果这样的i不存在<br>\end{aligned}<br>\right.<br>$$</p><h3 id="KMP算法实现"><a href="#KMP算法实现" class="headerlink" title="KMP算法实现"></a>KMP算法实现</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NotFound</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"This is a simple example."</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> pattern<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"simple"</span><span class="token punctuation">;</span>    Position p <span class="token operator">=</span> <span class="token function">KMP</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> NotFound<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Not Found.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> string <span class="token operator">+</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Position <span class="token function">KMP</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*O(n)*/</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*O(m)*/</span>    <span class="token keyword">int</span> s<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token operator">*</span>match<span class="token punctuation">;</span>        match <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">BuildMatch</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> match<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*Tm=o(?)*/</span>    s <span class="token operator">=</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>s <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> p <span class="token operator">&lt;</span> m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">/*O(n)*/</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>string<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">==</span> pattern<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> s<span class="token operator">++</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>         <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> p <span class="token operator">=</span> match<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> s<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> m<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>s <span class="token operator">-</span> m<span class="token punctuation">)</span> <span class="token operator">:</span> NotFound<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$T = O(n+m+T_m)$  </p><h3 id="BuildMatch-的实现"><a href="#BuildMatch-的实现" class="headerlink" title="BuildMatch 的实现"></a>BuildMatch 的实现</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>$1+2+\cdots+\frac{j+1}{2}+\cdots+j=O(j^2)$</p><p>$T_m = O( m^3 )$​   <strong>Bad!</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">BuildMatch</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>pattern<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>match<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*O(m)*/</span>    match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> <span class="token operator">&lt;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">/*O(m)*/</span>        i <span class="token operator">=</span> match<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> pattern<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> i <span class="token operator">=</span> match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> pattern<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> match<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> match<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$i$ 回退的总次数不会超过 $i$增加的总次数  </p><p>$T_m=O(m)$</p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NotFound</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">void</span> <span class="token function">BuildMatch</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>pattern<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>match<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>    match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        i <span class="token operator">=</span> match<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> pattern<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            i <span class="token operator">=</span> match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> pattern<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            match<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            match<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Position <span class="token function">KMP</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>    Position s<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token operator">*</span>match<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> m<span class="token punctuation">)</span>        <span class="token keyword">return</span> NotFound<span class="token punctuation">;</span>    match <span class="token operator">=</span> <span class="token punctuation">(</span>Position <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Position<span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">BuildMatch</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> match<span class="token punctuation">)</span><span class="token punctuation">;</span>    s <span class="token operator">=</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>s <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> p <span class="token operator">&lt;</span> m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>string<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">==</span> pattern<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            s<span class="token operator">++</span><span class="token punctuation">;</span>            p<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>            p <span class="token operator">=</span> match<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            s<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> m<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>s <span class="token operator">-</span> m<span class="token punctuation">)</span> <span class="token operator">:</span> NotFound<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"This is a simple example."</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> pattern<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"simple"</span><span class="token punctuation">;</span>    Position p <span class="token operator">=</span> <span class="token function">KMP</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> NotFound<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Not Found.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> string <span class="token operator">+</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week11</title>
      <link href="2021/080743265.html"/>
      <url>2021/080743265.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week11散列查找"><a href="#Week11散列查找" class="headerlink" title="Week11散列查找"></a>Week11散列查找</h1><h2 id="11-1散列表"><a href="#11-1散列表" class="headerlink" title="11.1散列表"></a>11.1散列表</h2><p>已知的几种查找方法：  </p><table><thead><tr><th>查找方法</th><th>时间复杂度</th></tr></thead><tbody><tr><td>顺序查找</td><td>$O(N)$</td></tr><tr><td>二分查找（静态查找）</td><td>$O(log_2N)$</td></tr><tr><td>二叉树搜索树</td><td>$O(h)h$为二叉查找树的高度</td></tr><tr><td>平衡二叉树</td><td>$O(log_2N)$</td></tr></tbody></table><p><strong>例</strong> 在登录QQ的时候， QQ服务器是如何<strong>核对你的身份</strong>？面对庞大的用户群,如何快速找到用户信息?  </p><p><strong>分析</strong> 看看是否可以用<strong>二分法</strong>查找。  </p><ul><li>十亿（109 ≈ 230） 有效用户，用二分查找30次。</li><li>十亿$(109 ≈ 230) × 1K ≈ 1024G， 1T$​连续空间。</li><li>按有效QQ号大小有序存储： 在连续存储空间中， <strong>插入和删除</strong>一个新QQ号码将需要<strong>移动大量数据</strong>。  </li></ul><p>问题 如何快速搜索到需要的关键词？ 如果关键词不方便比较怎么办？  </p><p><strong>查找的本质</strong>: 已知对象找位置。  </p><ul><li>有序安排对象：全序、半序</li><li>直接“算出”对象位置： 散列  </li></ul><p>散列查找法的两项基本工作：  </p><p><strong>计算位置：构造散列函数</strong>确定关键词存储位置；</p><p><strong>解决冲突：应用某种策略</strong>解决多个关键词位置相同的问题  </p><p>时间复杂度几乎是常量： $O(1)$， 即查找时间与问题规模无关！  </p><h3 id="散列表（哈希表）"><a href="#散列表（哈希表）" class="headerlink" title="散列表（哈希表）"></a>散列表（哈希表）</h3><p>类型名称:符号表（SymbolTable）</p><p>数据对象集： 符号表是“名字$(Name)$-属性$(Attribute)$”对的集合。</p><p>操作集：$ Table \in SymbolTable， Name \in NameType， Attr \in AttributeType$  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">SymbolTable <span class="token function">InitializeTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> TableSize<span class="token punctuation">)</span><span class="token comment">//创建一个长度为TableSize的符号表；</span>Boolean <span class="token function">IsIn</span><span class="token punctuation">(</span>SymbolTable Table<span class="token punctuation">,</span> NameType Name<span class="token punctuation">)</span><span class="token comment">//查找特定的名字Name是否在符号表Table中；</span>AttributeType <span class="token function">Find</span><span class="token punctuation">(</span>SymbolTable Table<span class="token punctuation">,</span> NameType Name<span class="token punctuation">)</span><span class="token comment">//获取Table中指定名字Name对应的属性；</span>SymbolTable <span class="token function">Modefy</span><span class="token punctuation">(</span>SymbolTable Table<span class="token punctuation">,</span> NameType Name<span class="token punctuation">,</span> AttributeType Attr<span class="token punctuation">)</span><span class="token comment">//将Table中指定名字Name的属性修改为Attr；</span>SymbolTable <span class="token function">Insert</span><span class="token punctuation">(</span>SymbolTable Table<span class="token punctuation">,</span> NameType Name<span class="token punctuation">,</span> AttributeType Attr<span class="token punctuation">)</span><span class="token comment">//向Table中插入一个新名字Name及其属性Attr；</span>SymbolTable <span class="token function">Delete</span><span class="token punctuation">(</span>SymbolTable Table<span class="token punctuation">,</span> NameType Name<span class="token punctuation">)</span><span class="token comment">//从Table中删除一个名字Name及其属性。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>“散列（ Hashing）” 的基本思想是：</p><p>（ 1）以关键字<strong>key</strong>为自变量，通过一个确定的函数 h<strong>（散列函数）</strong> ，计算出对应的函数值$h(key)$​，作为数据对象的存储地址。</p><p>（ 2） 可能不同的关键字会映射到同一个散列地址上，即$h(key_i) = h(key_j)$​（当$key_i ≠key_j$​），称为“<strong>冲突</strong>$(Collision)$​”。—-需要某种冲突解决策略  </p><p>例 有n = 11个数据对象的集合{18， 23， 11， 20， 2， 7， 27， 30，42， 15， 34}。  </p><p>符号表的大小用$TableSize = 17$，选取散列函数h如下：$h(key) = key\ mod\ TableSize $(求余)  </p><table><thead><tr><th>地址</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th></tr></thead><tbody><tr><td>关键词</td><td>34</td><td>18</td><td>2</td><td>20</td><td></td><td></td><td>23</td><td>7</td><td>42</td><td></td><td>27</td><td>11</td><td></td><td>30</td><td></td><td>15</td><td></td></tr></tbody></table><p>存放：</p><p>$h(18)=1, h(23)=6, h(11)=11, h(20)=3, h(2)=2, …….$</p><p>如果新插入35，$ h(35)=1$, 该位置已有对象！ 冲突！！  </p><p>查找:</p><p>$key = 22, h(22)= 5$，该地址空，不在表中</p><p>$key = 30, h(30)= 13$，该地址存放是30，找到！  </p><p><strong>装填因子</strong>（Loading Factor）： 设散列表空间大小为$m$，填入表中元素个数是$n$，则称$α＝ n / m$为散列表的装填因子</p><p>$α＝11 / 17 ≈ 0.65$  </p><p>例 将acos、 define、 float、 exp、 char、 atan、 ceil、 floor、clock、 ctime， 顺次存入一张散列表中。</p><p>散列表设计为一个二维数组$Table[26][2]$， 2列分别代表 2个槽。  </p><p>如何设计散列函数$h (key ) =$​ ?$ h(key) = key[0] – ‘a’$​</p><table><thead><tr><th></th><th>槽0</th><th>槽1</th></tr></thead><tbody><tr><td>0</td><td>acos</td><td>atan</td></tr><tr><td>1</td><td></td><td></td></tr><tr><td>2</td><td>char</td><td>cell</td></tr><tr><td>3</td><td>define</td><td></td></tr><tr><td>4</td><td>exp</td><td></td></tr><tr><td>5</td><td>float</td><td>floor</td></tr><tr><td>6</td><td></td><td></td></tr><tr><td>$\cdots$</td><td></td><td></td></tr><tr><td>25</td><td></td><td></td></tr></tbody></table><p>如果没有溢出,$T_{查询} = T_{插入} = T_{删除} = O( 1 )  $</p><h2 id="11-2-散列函数的构造方法"><a href="#11-2-散列函数的构造方法" class="headerlink" title="11.2 散列函数的构造方法"></a>11.2 散列函数的构造方法</h2><p>一个“好”的散列函数一般应考虑下列<strong>两个因素</strong>：  </p><ol><li><strong>计算简单</strong>，以便提高转换速度；</li><li>关键词对应的<strong>地址空间分布均匀</strong>，以尽量减少冲突。  </li></ol><p><strong>数字关键词</strong>的散列函数构造  </p><h4 id="1．直接定址法"><a href="#1．直接定址法" class="headerlink" title="1．直接定址法"></a>1．直接定址法</h4><p>取关键词的某个线性函数值为散列地址，即$h(key) = a \times key + b$ (a、 b为常数)  </p><table><thead><tr><th>地址h(key)</th><th>出生年份(key)</th><th>人数(attribute)</th></tr></thead><tbody><tr><td>0</td><td>1990</td><td>1285万</td></tr><tr><td>1</td><td>1991</td><td>1281万</td></tr><tr><td>2</td><td>1992</td><td>1280万</td></tr><tr><td>…</td><td>……</td><td>……</td></tr><tr><td>10</td><td>2000</td><td>1250万</td></tr><tr><td>…</td><td>……</td><td>……</td></tr><tr><td>21</td><td>2011</td><td>1180万</td></tr></tbody></table><p>$h(key)=key-1990$</p><h3 id="2．除留余数法"><a href="#2．除留余数法" class="headerlink" title="2．除留余数法"></a>2．除留余数法</h3><p>散列函数为：$h(key) = key\ mod\ p$</p><p>例:$ h(key) = key \% 17$​  </p><table><thead><tr><th>地址</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th></tr></thead><tbody><tr><td>关键词</td><td>34</td><td>18</td><td>2</td><td>20</td><td></td><td></td><td>23</td><td>7</td><td>42</td><td></td><td>27</td><td>11</td><td></td><td>30</td><td></td><td>15</td><td></td></tr></tbody></table><p>这里：$ p = Tablesize = 17  $。​一般， p 取<strong>素数</strong>  </p><h3 id="3．数字分析法"><a href="#3．数字分析法" class="headerlink" title="3．数字分析法"></a>3．数字分析法</h3><p>分析数字关键字在各位上的变化情况，取比较随机的位作为散列地址  </p><p>比如： 取11位手机号码key的后4位作为地址：</p><p>散列函数为：$ h(key) = atoi(key+7) (char *key) $ </p><p>如果关键词 key 是18位的身份证号码：  </p><p>$h_1(key) = (key[6]-‘0’)\times 10^4 + (key[10]-‘0’)\times 10^3 +<br>(key[14]-‘0’)\times 10^2 + (key[16]-‘0’)\times 10 + (key[17]-‘0’)  $</p><p>$h(key) = h1(key)\times 10 + 10$当$key[18]=’x’$时</p><p>或$= h1(key)\times 10 + key[18]-‘0’$当 $key[18] 为’0’-’9’$时</p><h3 id="4．折叠法"><a href="#4．折叠法" class="headerlink" title="4．折叠法"></a>4．折叠法</h3><p>把关键词分割成位数相同的几个部分，然后叠加  </p><p>如： 56793542 </p><p>$h(key)\equiv542+793+056\equiv1391\equiv391\ mod\ 1000$</p><h4 id="5．平方取中法"><a href="#5．平方取中法" class="headerlink" title="5．平方取中法"></a>5．平方取中法</h4><p>如： 56793542  </p><p>$56793542  \times 56793542  =3225506412905764  $</p><p>$h(56793542) = 641  $</p><h3 id="字符关键词的散列函数构造"><a href="#字符关键词的散列函数构造" class="headerlink" title="字符关键词的散列函数构造"></a>字符关键词的散列函数构造</h3><p>1．一个简单的散列函数——ASCII码加和法  </p><p>对字符型关键词key定义散列函数如下：  </p><p>$h(key) = (Σkey[i])\ mod\ TableSize$​  </p><p>冲突严重： a3、b2、 c1；eat、 tea；  </p><p>2．简单的改进——前3个字符移位法  </p><p>$h(key)=(key[0]\times 27^2 + key[1]\times 27 + key[2])\ mod\ TableSize$​</p><p>3．好的散列函数——移位法  </p><p>涉及关键词所有n个字符，并且分布得很好：  </p><p>$h(key)=(\sum_{i=0}^{n-1}key[n-i-1]\times32^i)\ mod\ Tablesize$</p><p>仍然冲突： string、 street、strong、 structure等等；</p><p>空间浪费： $3000/263 ≈ 30%$  </p><p>如何快速计算：  </p><p>$h(“abcde”)=’a’\times 32^4+’b’\times 32^3+’c’\times 32^2+’d’\times 32+’e’  $​​</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Index <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> Key<span class="token punctuation">,</span> <span class="token keyword">int</span> TableSize<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 散列函数值， 初始化为0 */</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>Key <span class="token operator">!=</span> ‘\<span class="token number">0</span>’<span class="token punctuation">)</span> <span class="token comment">/* 位移映射 */</span>h <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span>Key<span class="token operator">++</span><span class="token punctuation">;</span><span class="token keyword">return</span> h <span class="token operator">%</span> TableSize<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="11-3-冲突处理方法"><a href="#11-3-冲突处理方法" class="headerlink" title="11.3 冲突处理方法"></a>11.3 冲突处理方法</h2><p>常用处理冲突的思路：</p><p>换个位置: <strong>开放地址法</strong></p><p>同一位置的冲突对象组织在一起: <strong>链地址法</strong>  </p><h3 id="开放定址法（Open-Addressing）"><a href="#开放定址法（Open-Addressing）" class="headerlink" title="开放定址法（Open Addressing）"></a>开放定址法（Open Addressing）</h3><p>一旦产生了<strong>冲突</strong>（该地址已有其它元素），就按某 种规则去<strong>寻找另一空地址</strong>  </p><p>若发生了第 i 次冲突，试探的下一个地址将增加di， 基本公式是：</p><p>$h_i(key) = (h(key)+d_i)\ mod\ TableSize ( 1≤ i &lt; TableSize )  $​​</p><p>di 决定了不同的解决冲突方案： <strong>线性探测</strong>$(d_i=i)$、<strong>平方探测</strong>$(d_i=\pm i^2)$、<strong>双散列</strong>$(d_i=i*h_2(key))$。  </p><h4 id="1-线性探测法（Linear-Probing）"><a href="#1-线性探测法（Linear-Probing）" class="headerlink" title="1.线性探测法（Linear Probing）"></a>1.线性探测法（Linear Probing）</h4><p>线性探测法： 以增量序列$ 1， 2， ……，(TableSize -1)$循环试探下一个存储地址。  </p><p>例 设关键词序列为 {47， 7， 29， 11， 9， 84， 54， 20， 30}，</p><p>散列表表长$TableSize =13$ （装填因子 $α = 9/13 ≈ 0.69$）；</p><p>散列函数为： $h(key) = key\ mod\ 11$。</p><p>用线性探测法处理冲突，列出依次插入后的散列表，并估算查找性能  </p><table><thead><tr><th>关键词 （key）</th><th>47</th><th>7</th><th>29</th><th>11</th><th>9</th><th>84</th><th>54</th><th>20</th><th>30</th></tr></thead><tbody><tr><td>散列地址 $h(key)$</td><td>3</td><td>7</td><td>7</td><td>0</td><td>9</td><td>7</td><td>10</td><td>9</td><td>8</td></tr></tbody></table><table><thead><tr><th>关键词 (key)</th><th>47</th><th>7</th><th>29</th><th>11</th><th>9</th><th>84</th><th>54</th><th>20</th><th>30</th></tr></thead><tbody><tr><td>散列地址 h(key)</td><td>3</td><td>7</td><td>7</td><td>0</td><td>9</td><td>7</td><td>10</td><td>9</td><td>8</td></tr><tr><td>冲突次数</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>3</td><td>1</td><td>3</td><td>6</td></tr></tbody></table><p>注意聚集现象！</p><p><strong>散列表查找性能分析</strong>  </p><p>成功平均查找长度$(ASLs)  $</p><p>不成功平均查找长度 $(ASLu)$</p><table><thead><tr><th>$H(key)$</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th></tr></thead><tbody><tr><td>key</td><td>11</td><td>30</td><td></td><td>47</td><td></td><td></td><td></td><td>7</td><td>29</td><td>9</td><td>84</td><td>54</td><td>20</td></tr><tr><td>冲突次数</td><td>0</td><td>6</td><td></td><td>0</td><td></td><td></td><td></td><td>0</td><td>1</td><td>0</td><td>3</td><td>1</td><td>3</td></tr></tbody></table><p>$ASLs$： 查找表中关键词的平均查找比较次数<strong>（其冲突次数加1）</strong></p><p>$ASLs= (1+7+1+1+2+1+4+2+4) / 9 = 23/9 ≈ 2.56$​</p><p>$ASLu$：不在散列表中的关键词的平均查找次数（不成功）</p><p>一般方法：将不在散列表中的关键词分若干类。  </p><p>如：根据$H(key)$值分类  </p><p>$ASL u= (3+2+1+2+1+1+1+9+8+7+6)/ 11 = 41/11 ≈ 3.73  $​</p><p>例 将acos、 define、 float、 exp、 char、 atan、 ceil、 floor，顺次存入一张大小为26的散列表中。<br>$H(key)=key[0]-’a’$​，采用线性探测$d_i=i$  </p><table><thead><tr><th>cos</th><th>atan</th><th>char</th><th>define</th><th>exp</th><th>float</th><th>ceil</th><th>floor</th><th></th><th>…..</th><th></th></tr></thead><tbody><tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td></td><td>25</td></tr></tbody></table><p>$ASLs$： 表中关键词的平均查找比较次数</p><p>$ASLs= （1+1+1+1+1+2+5+3） / 8 = 15/8 ≈ 1.87$</p><p>$ASLu$：不在散列表中的关键词的平均查找次数（不成功）</p><p>根据$H(key)$值分为26种情况： H值为$0,1,2,…,25$</p><p>$ASLu= （9+8+7+6+5+4+3+2+1*18） / 26 = 62/26 ≈ 2.38  $</p><h4 id="2-平方探测法（Quadratic-Probing）-—-二次探测"><a href="#2-平方探测法（Quadratic-Probing）-—-二次探测" class="headerlink" title="2.平方探测法（Quadratic Probing） — 二次探测"></a>2.平方探测法（Quadratic Probing） — 二次探测</h4><p>平方探测法： 以增量序列$1^2， -1^2， 2^2， -2^2， ……， q^2， -q^2$,且$q ≤\lfloor TableSize/2\rfloor$ 循环试探下一个存储地址。  </p><p>[例] 设关键词序列为 {47， 7， 29， 11， 9， 84， 54， 20， 30}，</p><p>散列表表长$TableSize = 11$，</p><p>散列函数为：$ h(key) = key\ mod\ 11$。</p><p>用平方探测法处理冲突，列出依次插入后的散列表，并估算$ASLs$。  </p><table><thead><tr><th>关键词 key</th><th>47</th><th>7</th><th>29</th><th>11</th><th>9</th><th>84</th><th>54</th><th>20</th><th>30</th></tr></thead><tbody><tr><td>散列地址h(key)</td><td>3</td><td>7</td><td>7</td><td>0</td><td>9</td><td>7</td><td>10</td><td>9</td><td>8</td></tr><tr><td>冲突次数</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>2</td><td>0</td><td>3</td><td>3</td></tr></tbody></table><p>$ASL s = (1+1+2+1+1+3+1+4+4) / 9 = 18/9 = 2$​</p><p><strong>是否有空间，平方探测（二次探测）就能找得到？</strong>  </p><p>$h(k)= k\ mod\ 5 $</p><table><thead><tr><th>5</th><th>6</th><th>7</th><th></th><th></th></tr></thead><tbody><tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td></tr></tbody></table><p>插入 11，$ h(11)=1$  </p><p>探测序列：$ 1+1=2, 1-1=0, (1+2^2)mod\ 5=0, (1-2^2)mod\ 5=2,$​</p><p>$(1+3^2)mod\ 5=0, (1-3^2)mod\ 5=2, (1+4^2)mod\ 5=2,…$  </p><p>有定理显示：如果散列表长度$TableSize$是某个$4k+3$（k是正整数）形式的<strong>素数</strong>时， <strong>平方探测法</strong>就可以<strong>探查到整个散列表空间</strong>。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token class-name">HashTbl</span><span class="token operator">*</span> HashTable<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">HashTbl</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> TableSize<span class="token punctuation">;</span>Cell<span class="token operator">*</span> TheCells<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>H<span class="token punctuation">;</span>HashTable <span class="token function">InitializeTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> TableSize<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>HashTable H<span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>TableSize <span class="token operator">&lt;</span> MinTableSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">"散列表太小"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 分配散列表 */</span>H <span class="token operator">=</span> <span class="token punctuation">(</span>HashTable<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">HashTbl</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>H <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token function">FatalError</span><span class="token punctuation">(</span><span class="token string">"空间溢出!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>H<span class="token operator">-></span>TableSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* 分配散列表 Cells */</span>H<span class="token operator">-></span>TheCells <span class="token operator">=</span> <span class="token punctuation">(</span>Cell<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Cell<span class="token punctuation">)</span> <span class="token operator">*</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>TheCells <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token function">FatalError</span><span class="token punctuation">(</span><span class="token string">"空间溢出!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>H<span class="token operator">-></span>TheCells<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">=</span> Empty<span class="token punctuation">;</span><span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Position <span class="token function">Find</span><span class="token punctuation">(</span>ElementType Key<span class="token punctuation">,</span> HashTable H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*平方探测*/</span>Position CurrentPos<span class="token punctuation">,</span> NewPos<span class="token punctuation">;</span><span class="token keyword">int</span> CNum<span class="token punctuation">;</span> <span class="token comment">/* 记录冲突次数 */</span>CNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>NewPos <span class="token operator">=</span> CurrentPos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>TheCells<span class="token punctuation">[</span>NewPos<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">!=</span> Empty <span class="token operator">&amp;&amp;</span>H<span class="token operator">-></span>TheCells<span class="token punctuation">[</span>NewPos<span class="token punctuation">]</span><span class="token punctuation">.</span>Element <span class="token operator">!=</span> Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">/* 字符串类型的关键词需要 strcmp 函数!! */</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>CNum <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 判断冲突的奇偶次 */</span>NewPos <span class="token operator">=</span> CurrentPos <span class="token operator">+</span> <span class="token punctuation">(</span>CNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>CNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>NewPos <span class="token operator">>=</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span>NewPos <span class="token operator">-=</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>NewPos <span class="token operator">=</span> CurrentPos <span class="token operator">-</span> CNum <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> CNum <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>NewPos <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>NewPos <span class="token operator">+=</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> NewPos<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>ElementType Key<span class="token punctuation">,</span> HashTable H<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* 插入操作 */</span>Position Pos<span class="token punctuation">;</span>Pos <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>TheCells<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">!=</span> Legitimate<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">/* 确认在此插入 */</span>H<span class="token operator">-></span>TheCells<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">=</span> Legitimate<span class="token punctuation">;</span>H<span class="token operator">-></span>TheCells<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Element <span class="token operator">=</span> Key<span class="token punctuation">;</span><span class="token comment">/*字符串类型的关键词需要 strcpy 函数!! */</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在开放地址散列表中， <strong>删除操作</strong>要很小心。通常只能“<strong>懒惰删除</strong>” ，即需要增加一个“删除标记$(Deleted)$” ，而并不是真正删除它。以便查找时不会“<strong>断链</strong>”。其空间可以在下次插入时<strong>重用</strong>。  </p><h4 id="3-双散列探测法（Double-Hashing）"><a href="#3-双散列探测法（Double-Hashing）" class="headerlink" title="3.双散列探测法（Double Hashing）"></a>3.双散列探测法（Double Hashing）</h4><p>双散列探测法: $d_i 为i*h_2(key)， h_2(key)$是另一个散列函数探测序列成： $h_2(key)， 2h_2(key)， 3h_2(key)， …… $ </p><p>对任意的$key$​， $h_2(key) ≠ 0$​ ！  </p><p>探测序列还应该保证<strong>所有的散列存储单元</strong>都应该能够被<strong>探测到</strong>。</p><p>选择以下形式有良好的效果：  </p><p>$h_2(key) = p - (key\ mod\ p)$  </p><p>其中：$ p &lt; TableSize， p、 TableSize$都是素数。  </p><h4 id="4-再散列（Rehashing）"><a href="#4-再散列（Rehashing）" class="headerlink" title="4.再散列（Rehashing）"></a>4.再散列（Rehashing）</h4><p>当散列表元素太多（即装填因子 α太大）时， 查找效率会下降；  </p><p>实用最大装填因子一般取 $0.5 &lt;= α&lt;= 0.85  $</p><p>当装填因子过大时，解决的方法是加倍扩大散列表，这个过程叫做“再散列”（$Rehashing$）  </p><h3 id="分离链接法（Separate-Chaining）"><a href="#分离链接法（Separate-Chaining）" class="headerlink" title="分离链接法（Separate Chaining）"></a>分离链接法（Separate Chaining）</h3><p>分离链接法：将相应位置上冲突的所有关键词存储在同一个单链表中  </p><p>例 设关键字序列为 47, 7, 29, 11, 16, 92, 22, 8, 3, 50, 37, 89, 94, 21;</p><p>散列函数取为： $h(key) = key\ mod\ 11$​​；</p><p>用分离链接法处理冲突。</p><p>表中有9个结点只需1次查找，5个结点需要2次查找</p><p>查找成功的平均查找次数：$ ASL s=(9+5*2) / 14 ≈ 1.36$​</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">HashTbl</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> TableSize<span class="token punctuation">;</span>List TheLists<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token operator">*</span>H<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ListNode</span><span class="token operator">*</span> Position<span class="token punctuation">,</span> <span class="token operator">*</span> List<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ListNode</span> <span class="token punctuation">&#123;</span>ElementType Element<span class="token punctuation">;</span>Position Next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">HashTbl</span><span class="token operator">*</span> HashTable<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">HashTbl</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> TableSize<span class="token punctuation">;</span>List TheLists<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>Position <span class="token function">Find</span><span class="token punctuation">(</span>ElementType Key<span class="token punctuation">,</span> HashTable H<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Position P<span class="token punctuation">;</span><span class="token keyword">int</span> Pos<span class="token punctuation">;</span>Pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*初始散列位置*/</span>P <span class="token operator">=</span> H<span class="token operator">-></span>TheLists<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span> <span class="token comment">/*获得链表头*/</span><span class="token keyword">while</span> <span class="token punctuation">(</span>P <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>P<span class="token operator">-></span>Element<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">)</span>P <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span><span class="token keyword">return</span> P<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="11-4-散列表的性能分析"><a href="#11-4-散列表的性能分析" class="headerlink" title="11.4 散列表的性能分析"></a>11.4 散列表的性能分析</h2><p>平均查找长度（$ASL$）用来度量散列表查找效率：成功、不成功</p><p>关键词的比较次数，取决于产生冲突的多少</p><p>影响产生冲突多少有以下三个因素：</p><p>（1） 散列函数是否均匀；</p><p>（2） 处理冲突的方法；</p><p>（3）散列表的装填因子α。</p><p>分析：不同冲突处理方法、装填因子对效率的影响  </p><h3 id="1-线性探测法的查找性能"><a href="#1-线性探测法的查找性能" class="headerlink" title="1.线性探测法的查找性能"></a>1.线性探测法的查找性能</h3><p>可以证明，线性探测法的期望探测次数 满足下列公式：<br>$$<br>p=\left\{<br>\begin{aligned}<br>&amp;\frac{1}{2}[1+\frac{1}{(1-\alpha^2)}]\qquad (对插入和不成功查找而言) \newline<br>&amp;\frac{1}{2}(1+\frac{1}{a-\alpha}) \qquad (对成功查找而言)<br>\end{aligned}<br>\right.<br>$$<br>当$α= 0.5$时，</p><p>插入操作和不成功查找的期望 $ASLu = 0.5*(1+1/(1-0.5) 2 ) = 2.5$ 次</p><p>成功查找的期望 $ASLs = 0.5*(1+1/(1-0.5) ) = 1.5$次  </p><table><thead><tr><th>H(key)</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th></tr></thead><tbody><tr><td>key</td><td>11</td><td>30</td><td>47</td><td></td><td></td><td></td><td></td><td>7</td><td>29</td><td>9</td><td>84</td><td>54</td><td>20</td></tr><tr><td>冲突次数</td><td>0</td><td>6</td><td>0</td><td></td><td></td><td></td><td></td><td>0</td><td>1</td><td>0</td><td>3</td><td>1</td><td>3</td></tr></tbody></table><p>$α= 9/13=0.69$，于是</p><p>期望$ ASLu = 0.5*(1+1/(1-0.69) 2 ) = 5.70$次</p><p>期望 $ASLs = 0.5*(1+1/(1-0.69) ) = 2.11$次（实际计算$ASLs =2.56$）  </p><h3 id="2-平方探测法和双散列探测法的查找性能"><a href="#2-平方探测法和双散列探测法的查找性能" class="headerlink" title="2.平方探测法和双散列探测法的查找性能"></a>2.平方探测法和双散列探测法的查找性能</h3><p>可以证明，平方探测法和双散列探测法探测次数 满足下列公式：<br>$$<br>p=\left\{<br>\begin{aligned}<br>&amp;\frac{1}{1-\alpha}\qquad (对插入和不成功查找而言) \newline<br>&amp;-\frac{1}{\alpha}ln(1-\alpha) \qquad (对成功查找而言)<br>\end{aligned}<br>\right.<br>$$<br>当$α= 0.5$时，</p><p>插入操作和不成功查找的期望$ ASLu = 1/(1-0.5) = 2 $次</p><p>成功查找的期望 $ASLs = -1/0.5* ln(1-0.5) ≈ 1.39$ 次  </p><table><thead><tr><th>H(key)</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th></tr></thead><tbody><tr><td>key</td><td>11</td><td>30</td><td>20</td><td>47</td><td></td><td></td><td>84</td><td>7</td><td>29</td><td>9</td><td>54</td></tr><tr><td>冲突次数</td><td>0</td><td>3</td><td>3</td><td>0</td><td></td><td></td><td>2</td><td>0</td><td>1</td><td>0</td><td>0</td></tr></tbody></table><p>$α= 9/11=0.82$，于是</p><p>期望 $ASLu = 1/(1-0.82) ≈ 5.56$次</p><p>期望$ ASLs = -1/0.5* ln(1-0.5) ≈ 2.09$次（例中$ASLs =2$）。  </p><p>期望探测次数与装填因子α的关系:</p><p>当装填因子α&lt; 0.5的时候，各种探测法的期望探测次数都不大，也比较接近。  </p><p>随着 α 的增大，线性探测法的期望探测次数增加较快， 不成功查找和插入操作的期望探测次数比成功查找的期望探测次数要大。  </p><p><strong>合理的的最大装入因子α应该不超过0.85。</strong>  </p><h3 id="3-分离链接法的查找性能"><a href="#3-分离链接法的查找性能" class="headerlink" title="3.分离链接法的查找性能"></a>3.分离链接法的查找性能</h3><p>所有地址链表的平均长度定义成<strong>装填因子</strong>α， α有可能超过1。</p><p>不难证明：其<strong>期望探测次数</strong> p为：<br>$$<br>p=\left\{<br>\begin{aligned}<br>&amp;\alpha + e^{-\alpha}\qquad (对插入和不成功查找而言) \newline<br>&amp;1+\frac{\alpha}{2} \qquad (对成功查找而言)<br>\end{aligned}<br>\right.<br>$$<br>当$α = 1$时，</p><p>插入操作和不成功查找的期望 $ASLu = 1+e-1 = 1.37 $次，</p><p>成功查找的期望 $ASLs = 1+1/2 = 1.5$ 次。</p><p>前面例子14个元素分布在11个单链表中，所以α= 14/11≈1.27， 故</p><p>期望 $ASLu = 1.27+e^{-1.27} ≈ 1.55$次</p><p>期望 $ASLs = 1+1.27/2 ≈ 1.64$次（例中$ASLs =1.36$）。  </p><p>选择合适的 h(key) ，散列法的查找效率期望是常数$O(1)$， 它几乎与关键字的空间的大小n无关！也适合于关键字直接比较计算量大的问题  </p><p>它是以<strong>较小的α</strong>为前提。因此，散列方法是一个以<strong>空间换时间</strong>  </p><p>散列方法的存储对关键字是<strong>随机</strong>的，不便于<strong>顺序查找</strong>关键字，也不适合于范围查找，或<strong>最大值最小值</strong>查找。  </p><p><strong>开放地址法：</strong>  </p><p>散列表是一个数组，存储效率高，随机查找。  </p><p>散列表有“聚集”现象  </p><p><strong>分离链法：</strong>  </p><p>散列表是顺序存储和链式存储的结合，链表部分的存储效率和查找效率都比较低。  </p><p>关键字删除不需要“懒惰删除”法，从而没有存储“垃圾”。  </p><p>太小的α可能导致空间浪费，大的α又将付出更多的时间代价。不均匀的链表长度导致时间效率的严重下降。  </p><h3 id="11-5应用：文件中单词词频统计"><a href="#11-5应用：文件中单词词频统计" class="headerlink" title="11.5应用：文件中单词词频统计"></a>11.5应用：文件中单词词频统计</h3><p>例 给定一个英文文本文件，统计文件中所有单词出现的频率，并输出词频最大的前10%的单词及其词频。</p><p>假设单词字符定义为<strong>大小写字母、数字和下划线</strong>，其它字符均认为是单词分隔符，不予考虑。  </p><p>分析 关键：对<strong>新读入的单词在已有单词表中查找</strong>，如果已经存在，则将该单词的词频加1，如果不存在，则插入该单词并记词频为1。</p><p>如何设计该单词表的<strong>数据结构</strong>才可以进行快速地<strong>查找和插入</strong>？  </p><p><strong>散列表！</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> TableSize <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span class="token comment">/* 散列表的估计大小 */</span>    <span class="token keyword">int</span> wordcount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">;</span>    HashTable H<span class="token punctuation">;</span>    ElementType word<span class="token punctuation">;</span>    FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>    <span class="token keyword">char</span> document<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"HarryPotter.txt"</span><span class="token punctuation">;</span> <span class="token comment">/* 要被统计词频的文件名 */</span>    H <span class="token operator">=</span> <span class="token function">InitializeTable</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 建立散列表 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> “r” <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token function">FatalError</span><span class="token punctuation">(</span>“无法打开文件 <span class="token operator">!</span>\n” <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        length <span class="token operator">=</span> <span class="token function">GetAWord</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 从文件中读取一个单词 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">></span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 只考虑适当长度的单词 */</span>            wordcount<span class="token operator">++</span><span class="token punctuation">;</span>             <span class="token comment">/*统计文件中单词总数 */</span>            <span class="token function">InsertAndCount</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"该文档共出现 %d 个有效单词， "</span><span class="token punctuation">,</span> wordcount<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Show</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> <span class="token number">10.0</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 显示词频前10%的所有单词 */</span>    <span class="token function">DestroyTable</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/* 销毁散列表 */</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Show需要实现的功能：</p><p>（1）统计最大词频；</p><p>（2）用一组数统计从1到最大词频 的单词数；</p><p>（3）计算前10%的词频应该是多少</p><p>（4）输出前10%词频的单词</p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXTABLESIZE</span> <span class="token expression"><span class="token number">100000</span> </span><span class="token comment">/* 允许开辟的最大散列表长度 */</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span>    <span class="token comment">/* 关键词类型用整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Index<span class="token punctuation">;</span>          <span class="token comment">/* 散列地址类型 */</span><span class="token keyword">typedef</span> Index Position<span class="token punctuation">;</span> <span class="token comment">/* 数据所在位置与散列地址是同一类型 */</span><span class="token comment">/* 散列单元状态类型，分别对应：有合法元素、空单元、有已删除元素 */</span><span class="token keyword">typedef</span> <span class="token keyword">enum</span> <span class="token punctuation">&#123;</span> Legitimate<span class="token punctuation">,</span> Empty<span class="token punctuation">,</span> Deleted <span class="token punctuation">&#125;</span> EntryType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">HashEntry</span> Cell<span class="token punctuation">;</span> <span class="token comment">/* 散列表单元类型 */</span><span class="token keyword">struct</span> <span class="token class-name">HashEntry</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">;</span> <span class="token comment">/* 存放元素 */</span>    EntryType Info<span class="token punctuation">;</span>   <span class="token comment">/* 单元状态 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token operator">*</span>HashTable<span class="token punctuation">;</span> <span class="token comment">/* 散列表类型 */</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token punctuation">&#123;</span>                   <span class="token comment">/* 散列表结点定义 */</span>    <span class="token keyword">int</span> TableSize<span class="token punctuation">;</span>                 <span class="token comment">/* 表的最大长度 */</span>    Cell <span class="token operator">*</span>Cells<span class="token punctuation">;</span>                   <span class="token comment">/* 存放散列单元数据的数组 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 返回大于N且不超过MAXTABLESIZE的最小素数 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>N <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">?</span> N <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">:</span> N <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/*从大于N的下一个奇数开始 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;=</span> MAXTABLESIZE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sqrt</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>p <span class="token operator">%</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* p不是素数 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* for正常结束，说明p是素数 */</span>        <span class="token keyword">else</span>            p <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">/* 否则试探下一个奇数 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>HashTable <span class="token function">CreateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> TableSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    HashTable H<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    H <span class="token operator">=</span> <span class="token punctuation">(</span>HashTable<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 保证散列表最大长度是素数 */</span>    H<span class="token operator">-></span>TableSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 声明单元数组 */</span>    H<span class="token operator">-></span>Cells <span class="token operator">=</span> <span class="token punctuation">(</span>Cell <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>H<span class="token operator">-></span>TableSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Cell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化单元状态为“空单元” */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        H<span class="token operator">-></span>Cells<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">=</span> Empty<span class="token punctuation">;</span>    <span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Position <span class="token function">Find</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> ElementType Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position CurrentPos<span class="token punctuation">,</span> NewPos<span class="token punctuation">;</span>    <span class="token keyword">int</span> CNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 记录冲突次数 */</span>    NewPos <span class="token operator">=</span> CurrentPos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始散列位置 */</span>    <span class="token comment">/* 当该位置的单元非空，并且不是要找的元素时，发生冲突 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>Cells<span class="token punctuation">[</span>NewPos<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">!=</span> Empty <span class="token operator">&amp;&amp;</span> H<span class="token operator">-></span>Cells<span class="token punctuation">[</span>NewPos<span class="token punctuation">]</span><span class="token punctuation">.</span>Data <span class="token operator">!=</span> Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 字符串类型的关键词需要 strcmp 函数!! */</span>        <span class="token comment">/* 统计1次冲突，并判断奇偶次 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>CNum <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 奇数次冲突 */</span>            NewPos <span class="token operator">=</span> CurrentPos <span class="token operator">+</span>                     <span class="token punctuation">(</span>CNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>CNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">/* 增量为+[(CNum+1)/2]^2 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>NewPos <span class="token operator">>=</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span>                NewPos <span class="token operator">=</span> NewPos <span class="token operator">%</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span>    <span class="token comment">/* 调整为合法地址 */</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                   <span class="token comment">/* 偶数次冲突 */</span>            NewPos <span class="token operator">=</span> CurrentPos <span class="token operator">-</span> CNum <span class="token operator">*</span> CNum <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">/* 增量为-(CNum/2)^2 */</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>NewPos <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>                NewPos <span class="token operator">+=</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> <span class="token comment">/* 调整为合法地址 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> NewPos<span class="token punctuation">;</span> <span class="token comment">/* 此时NewPos或者是Key的位置，或者是一个空单元的位置（表示找不到）*/</span><span class="token punctuation">&#125;</span>bool <span class="token function">Insert</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> ElementType Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position Pos <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 先检查Key是否已经存在 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>Cells<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">!=</span>        Legitimate<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 如果这个单元没有被占，说明Key可以插入在此 */</span>        H<span class="token operator">-></span>Cells<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Info <span class="token operator">=</span> Legitimate<span class="token punctuation">;</span>        H<span class="token operator">-></span>Cells<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Data <span class="token operator">=</span> Key<span class="token punctuation">;</span>        <span class="token comment">/*字符串类型的关键词需要 strcpy 函数!! */</span>        <span class="token keyword">return</span> true<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"键值已存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> false<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEYLENGTH</span> <span class="token expression"><span class="token number">15</span>                     </span><span class="token comment">/* 关键词字符串的最大长度 */</span></span><span class="token keyword">typedef</span> <span class="token keyword">char</span> ElementType<span class="token punctuation">[</span>KEYLENGTH <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 关键词类型用字符串 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Index<span class="token punctuation">;</span>                       <span class="token comment">/* 散列地址类型 */</span><span class="token comment">/******** 以下是单链表的定义 ********/</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token operator">*</span>PtrToLNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">;</span>    PtrToLNode Next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToLNode Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToLNode List<span class="token punctuation">;</span><span class="token comment">/******** 以上是单链表的定义 ********/</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token operator">*</span>HashTable<span class="token punctuation">;</span> <span class="token comment">/* 散列表类型 */</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token punctuation">&#123;</span>                   <span class="token comment">/* 散列表结点定义 */</span>    <span class="token keyword">int</span> TableSize<span class="token punctuation">;</span>                 <span class="token comment">/* 表的最大长度 */</span>    List Heads<span class="token punctuation">;</span>                    <span class="token comment">/* 指向链表头结点的数组 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>HashTable <span class="token function">CreateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> TableSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    HashTable H<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    H <span class="token operator">=</span> <span class="token punctuation">(</span>HashTable<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 保证散列表最大长度是素数，具体见代码5.3 */</span>    H<span class="token operator">-></span>TableSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 以下分配链表头结点数组 */</span>    H<span class="token operator">-></span>Heads <span class="token operator">=</span> <span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>H<span class="token operator">-></span>TableSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化表头结点 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Position <span class="token function">Find</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> ElementType Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position P<span class="token punctuation">;</span>    Index Pos<span class="token punctuation">;</span>    Pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始散列位置 */</span>    P <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span>        <span class="token comment">/* 从该链表的第1个结点开始 */</span>    <span class="token comment">/* 当未到表尾，并且Key未找到时 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P <span class="token operator">&amp;&amp;</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>P<span class="token operator">-></span>Data<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">)</span>        P <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token keyword">return</span> P<span class="token punctuation">;</span> <span class="token comment">/* 此时P或者指向找到的结点，或者为NULL */</span><span class="token punctuation">&#125;</span>bool <span class="token function">Insert</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> ElementType Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position P<span class="token punctuation">,</span> NewCell<span class="token punctuation">;</span>    Index Pos<span class="token punctuation">;</span>    P <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 关键词未找到，可以插入 */</span>        NewCell <span class="token operator">=</span> <span class="token punctuation">(</span>Position<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>NewCell<span class="token operator">-></span>Data<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>        Pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>Key<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始散列位置 */</span>        <span class="token comment">/* 将NewCell插入为H->Heads[Pos]链表的第1个结点 */</span>        NewCell<span class="token operator">-></span>Next <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next <span class="token operator">=</span> NewCell<span class="token punctuation">;</span>        <span class="token keyword">return</span> true<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 关键词已存在 */</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"键值已存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> false<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">DestroyTable</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    Position P<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token comment">/* 释放每个链表的结点 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        P <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            Tmp <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>            <span class="token function">free</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token punctuation">;</span>            P <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">free</span><span class="token punctuation">(</span>H<span class="token operator">-></span>Heads<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 释放头结点数组 */</span>    <span class="token function">free</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 释放散列表结点 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-电话聊天狂人"><a href="#1-电话聊天狂人" class="headerlink" title="1.电话聊天狂人"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988041992250073088">1.电话聊天狂人</a></h3><p>给定大量手机用户通话记录，找出其中通话次数最多的聊天狂人。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入首先给出正整数$N(≤10^5)$，为通话记录条数。随后<em>N</em>行，每行给出一条通话记录。简单起见，这里只列出拨出方和接收方的11位数字构成的手机号码，其中以空格分隔。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>在一行中给出聊天狂人的手机号码及其通话次数，其间以空格分隔。如果这样的人不唯一，则输出狂人中最小的号码及其通话次数，并且附加给出并列狂人的人数。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">413005711862 1358862583213505711862 1308862583213588625832 1808792583215005713862 13588625832<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">13588625832 3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><h5 id="解法1-–-排序"><a href="#解法1-–-排序" class="headerlink" title="解法1 – 排序"></a>解法1 – 排序</h5><p>第1步：读入最多$2\times 10^5$个电话号码，每个号码存为长度为11的字符串</p><p>第2步：按字符串非递减顺序排序</p><p>第3步：扫描有序数组，累计同号码出现的次数，并且更新最大次数  </p><p>编程简单快捷 ，但无法拓展解决动态插入的问题  </p><h5 id="解法2-–-直接映射"><a href="#解法2-–-直接映射" class="headerlink" title="解法2 – 直接映射"></a>解法2 – 直接映射</h5><p>第1步：创建有$2\times 10^{10}$​个单元的整数数组，保证每个电话号码对应唯一的单元下标；数组初始化为0</p><p>第2步：对读入的每个电话号码，找到以之为下标的单元，数值累计1次</p><p>第3步：顺序扫描数组，找出累计次数最多的单元  </p><p>编程简单快捷，动态插入快  </p><p>下标超过了unsigned long</p><p>需要 $2\times 10^{10}\times 2\ bytes \approx 37GB$​</p><p>为了$2\times 10^5$个号码扫描$2\times 10^{10}$个单元  </p><h5 id="解法3-–-带智商的散列"><a href="#解法3-–-带智商的散列" class="headerlink" title="解法3 – 带智商的散列"></a>解法3 – 带智商的散列</h5><p>手机号码分为网络识别号 、地区编码、 用户号码三部分。</p><p>取后5为用于散列。  </p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEYLENGTH</span> <span class="token expression"><span class="token number">11</span> </span><span class="token comment">/* 关键词字符串的最大长度 */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXD</span> <span class="token expression"><span class="token number">4</span></span></span><span class="token comment">/* 关键词类型用字符串 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> ElementType<span class="token punctuation">[</span>KEYLENGTH <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Index<span class="token punctuation">;</span> <span class="token comment">/* 散列地址类型 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token operator">*</span>PtrToLNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">;</span>    PtrToLNode Next<span class="token punctuation">;</span>    <span class="token keyword">int</span> Count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToLNode Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToLNode List<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token operator">*</span>HashTable<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token punctuation">&#123;</span>   <span class="token comment">/* 散列表结点定义 */</span>    <span class="token keyword">int</span> TableSize<span class="token punctuation">;</span> <span class="token comment">/* 表的最大长度 */</span>    List Heads<span class="token punctuation">;</span>    <span class="token comment">/* 指向链表头结点的数组 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXTABLESIZE</span> <span class="token expression"><span class="token number">1000000</span></span></span><span class="token keyword">int</span> <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token keyword">int</span> Key<span class="token punctuation">,</span> <span class="token keyword">int</span> P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 除留余数法法散列函数 */</span>    <span class="token keyword">return</span> Key <span class="token operator">%</span> P<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 返回大于N且不超过MAXTABLESIZE的最小素数 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>N <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">?</span> N <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">:</span> N <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/*从大于N的下一个奇数开始 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;=</span> MAXTABLESIZE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sqrt</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>p <span class="token operator">%</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* p不是素数 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* for正常结束，说明p是素数 */</span>        <span class="token keyword">else</span>            p <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">/* 否则试探下一个奇数 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>HashTable <span class="token function">CreateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> TableSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    HashTable H<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    H <span class="token operator">=</span> <span class="token punctuation">(</span>HashTable<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>TableSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Heads <span class="token operator">=</span> <span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>H<span class="token operator">-></span>TableSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Position <span class="token function">Find</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> ElementType Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position P<span class="token punctuation">;</span>    Index Pos<span class="token punctuation">;</span>    <span class="token comment">/* 初始散列位置 */</span>    Pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token function">atoi</span><span class="token punctuation">(</span>Key <span class="token operator">+</span> KEYLENGTH <span class="token operator">-</span> MAXD<span class="token punctuation">)</span><span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    P <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span> <span class="token comment">/* 从该链表的第1个结点开始 */</span>    <span class="token comment">/* 当未到表尾，并且Key未找到时 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P <span class="token operator">&amp;&amp;</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>P<span class="token operator">-></span>Data<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">)</span> P <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token keyword">return</span> P<span class="token punctuation">;</span> <span class="token comment">/* 此时P或者指向找到的结点，或者为NULL */</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Insert</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> ElementType Key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position P<span class="token punctuation">,</span> NewCell<span class="token punctuation">;</span>    Index Pos<span class="token punctuation">;</span>    P <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 关键词未找到，可以插入 */</span>        NewCell <span class="token operator">=</span> <span class="token punctuation">(</span>Position<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>NewCell<span class="token operator">-></span>Data<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 初始散列位置 */</span>        NewCell<span class="token operator">-></span>Count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        Pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token function">atoi</span><span class="token punctuation">(</span>Key <span class="token operator">+</span> KEYLENGTH <span class="token operator">-</span> MAXD<span class="token punctuation">)</span><span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 将NewCell插入为H->Heads[Pos]链表的第1个结点 */</span>        NewCell<span class="token operator">-></span>Next <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>Pos<span class="token punctuation">]</span><span class="token punctuation">.</span>Next <span class="token operator">=</span> NewCell<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 关键词已存在 */</span>        P<span class="token operator">-></span>Count<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">ScanAndOutput</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> MaxCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> PCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    ElementType MinPhone<span class="token punctuation">;</span>    List Ptr<span class="token punctuation">;</span>    MinPhone<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 扫描链表 */</span>        Ptr <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>Ptr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Ptr<span class="token operator">-></span>Count <span class="token operator">></span> MaxCnt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 更新最大通话次数 */</span>                MaxCnt <span class="token operator">=</span> Ptr<span class="token operator">-></span>Count<span class="token punctuation">;</span>                <span class="token function">strcpy</span><span class="token punctuation">(</span>MinPhone<span class="token punctuation">,</span> Ptr<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>                PCnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Ptr<span class="token operator">-></span>Count <span class="token operator">==</span> MaxCnt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                PCnt<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* 狂人计数 */</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>MinPhone<span class="token punctuation">,</span> Ptr<span class="token operator">-></span>Data<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>                    <span class="token function">strcpy</span><span class="token punctuation">(</span>MinPhone<span class="token punctuation">,</span> Ptr<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 更新狂人的最小手机号码 */</span>            <span class="token punctuation">&#125;</span>            Ptr <span class="token operator">=</span> Ptr<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %d"</span><span class="token punctuation">,</span> MinPhone<span class="token punctuation">,</span> MaxCnt<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>PCnt <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span> PCnt<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">DestroyTable</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    Position P<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token comment">/* 释放每个链表的结点 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        P <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            Tmp <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>            <span class="token function">free</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token punctuation">;</span>            P <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">free</span><span class="token punctuation">(</span>H<span class="token operator">-></span>Heads<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 释放头结点数组 */</span>    <span class="token function">free</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 释放散列表结点 */</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Key<span class="token punctuation">;</span>    HashTable H<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    H <span class="token operator">=</span> <span class="token function">CreateTable</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建一个散列表 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> Key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">ScanAndOutput</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">DestroyTable</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 小数据，狂人唯一</td><td>答案正确</td><td>12</td><td>34 ms</td><td>316 KB</td></tr><tr><td>1</td><td>小数据，多个狂人并列</td><td>答案正确</td><td>3</td><td>4 ms</td><td>296 KB</td></tr><tr><td>2</td><td>最大N，随机</td><td>答案正确</td><td>10</td><td>300 ms</td><td>15928 KB</td></tr></tbody></table><h3 id="2-Hashing"><a href="#2-Hashing" class="headerlink" title="2.Hashing"></a><a href="https://pintia.cn/problem-sets/16/problems/679">2.Hashing</a></h3><p>The task of this problem is simple: insert a sequence of distinct positive integers into a hash table, and output the positions of the input numbers. The hash function is defined to be $H(key)=key\%TSize$ where TSize is the maximum size of the hash table. Quadratic probing (with positive increments only) is used to solve the collisions.</p><p>Note that the table size is better to be prime. If the maximum size given by the user is not prime, you must re-define the table size to be the smallest prime number which is larger than the size given by the user.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains two positive numbers:$ MSize (≤10^4)$ and $N (≤MSize)$ which are the user-defined table size and the number of input numbers, respectively. Then <em>N</em> distinct positive integers are given in the next line. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print the corresponding positions (index starts from 0) of the input numbers in one line. All the numbers in a line are separated by a space, and there must be no extra space at the end of the line. In case it is impossible to insert the number, print “-“ instead.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 410 6 4 15<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">0 1 4 -<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>简单的平方探测法，只需要正数，注意素数判断！</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> MSize<span class="token punctuation">,</span> N<span class="token punctuation">,</span> num<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token keyword">int</span> Key<span class="token punctuation">,</span> <span class="token keyword">int</span> P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 除留余数法散列函数 */</span>    <span class="token keyword">return</span> Key <span class="token operator">%</span> P<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 1不是素数</span>        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> p <span class="token operator">=</span> N <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">?</span> N <span class="token operator">:</span> N <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            p <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>MSize<span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    MSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>MSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> H<span class="token punctuation">[</span>MSize<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> Pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> MSize<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> Pos<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            H<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">=</span> num<span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> Pos<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> MSize <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>temp <span class="token operator">+</span> j <span class="token operator">*</span> j<span class="token punctuation">,</span> MSize<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    H<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> num<span class="token punctuation">;</span>                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample，有无法插入的</td><td>答案正确</td><td>12</td><td>4 ms</td><td>196 KB</td></tr><tr><td>1</td><td>最小值</td><td>答案正确</td><td>3</td><td>3 ms</td><td>192 KB</td></tr><tr><td>2</td><td>最大MSize，测试插入边界</td><td>答案正确</td><td>5</td><td>4 ms</td><td>320 KB</td></tr><tr><td>3</td><td>最大随机</td><td>答案正确</td><td>5</td><td>8 ms</td><td>324 KB</td></tr></tbody></table><h4 id="3-QQ帐户的申请与登陆"><a href="#3-QQ帐户的申请与登陆" class="headerlink" title="3.QQ帐户的申请与登陆"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988042050194141184">3.QQ帐户的申请与登陆</a></h4><p>实现QQ新帐户申请和老帐户登陆的简化版功能。最大挑战是：据说现在的QQ号码已经有10位数了。</p><h3 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式:"></a>输入格式:</h3><p>输入首先给出一个正整数$N(≤10^5)$，随后给出<em>N</em>行指令。每行指令的格式为：“命令符（空格）QQ号码（空格）密码”。其中命令符为“N”（代表New）时表示要新申请一个QQ号，后面是新帐户的号码和密码；命令符为“L”（代表Login）时表示是老帐户登陆，后面是登陆信息。QQ号码为一个不超过10位、但大于1000（据说QQ老总的号码是1001）的整数。密码为不小于6位、不超过16位、且不包含空格的字符串。</p><h4 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>针对每条指令，给出相应的信息：</p><p>1）若新申请帐户成功，则输出“New: OK”；<br>2）若新申请的号码已经存在，则输出“ERROR: Exist”；<br>3）若老帐户登陆成功，则输出“Login: OK”；<br>4）若老帐户QQ号码不存在，则输出“ERROR: Not Exist”；<br>5）若老帐户密码错误，则输出“ERROR: Wrong PW”。</p><h4 id="输入样例-1"><a href="#输入样例-1" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">5L 1234567890 myQQ@qq.comN 1234567890 myQQ@qq.comN 1234567890 myQQ@qq.comL 1234567890 myQQ@qqL 1234567890 myQQ@qq.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例-1"><a href="#输出样例-1" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">ERROR: Not ExistNew: OKERROR: ExistERROR: Wrong PWLogin: OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>题不难，注意判断即可。说句题外话，用c++STL就是秒杀。</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXTABLESIZE</span> <span class="token expression"><span class="token number">100000</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Q</span> <span class="token operator">*</span>QQ<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Q</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ID<span class="token punctuation">;</span>    <span class="token keyword">char</span> pwd<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    QQ next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Q</span> <span class="token operator">*</span>List<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token operator">*</span>HashTable<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span> <span class="token punctuation">&#123;</span>   <span class="token comment">//散列表节点定义</span>    <span class="token keyword">int</span> TableSize<span class="token punctuation">;</span> <span class="token comment">/* 表的最大长度 */</span>    List Heads<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>N <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">?</span> N <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">:</span> N <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;=</span> MAXTABLESIZE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* for循环用来判断p是不是素数 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sqrt</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>p <span class="token operator">%</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* p不是素数break */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* p是素数 结束for循环 */</span>        <span class="token keyword">else</span>            p <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">/* P不是素数，p+2继续向后找 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>HashTable <span class="token function">CreateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> TableSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    HashTable H<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    H <span class="token operator">=</span> <span class="token punctuation">(</span>HashTable<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TblNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 保证散列表的最大长度是素数 */</span>    H<span class="token operator">-></span>TableSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Heads <span class="token operator">=</span> <span class="token punctuation">(</span>QQ<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>H<span class="token operator">-></span>TableSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Q</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//初始化</span>    <span class="token punctuation">&#123;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pwd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> HashTableSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> key <span class="token operator">%</span> HashTableSize<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">New</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> <span class="token keyword">int</span> ID<span class="token punctuation">,</span> <span class="token keyword">char</span> pwd<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//申请QQ</span>    <span class="token keyword">int</span> pos<span class="token punctuation">;</span>    QQ user<span class="token punctuation">;</span>    pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>ID<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    user <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token operator">-></span>ID <span class="token operator">==</span> ID<span class="token punctuation">)</span> <span class="token comment">//有相同的ID就退出循环</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            user <span class="token operator">=</span> user<span class="token operator">-></span>next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//没有相同的ID，开始申请QQ</span>        QQ NewNode <span class="token operator">=</span> <span class="token punctuation">(</span>QQ<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Q</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        NewNode<span class="token operator">-></span>ID <span class="token operator">=</span> ID<span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>NewNode<span class="token operator">-></span>pwd<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>        NewNode<span class="token operator">-></span>next <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">;</span>        H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> NewNode<span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"New: OK\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ERROR: Exist\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Login</span><span class="token punctuation">(</span>HashTable H<span class="token punctuation">,</span> <span class="token keyword">int</span> ID<span class="token punctuation">,</span> <span class="token keyword">char</span> pwd<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//登录QQ</span>    <span class="token keyword">int</span> pos<span class="token punctuation">;</span>    QQ user<span class="token punctuation">;</span>    pos <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>ID<span class="token punctuation">,</span> H<span class="token operator">-></span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    user <span class="token operator">=</span> H<span class="token operator">-></span>Heads<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token operator">-></span>ID <span class="token operator">==</span> ID<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>user<span class="token operator">-></span>pwd<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Login: OK\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ERROR: Wrong PW\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>            user <span class="token operator">=</span> user<span class="token operator">-></span>next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ERROR: Not Exist\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> ID<span class="token punctuation">,</span> TableSize<span class="token punctuation">;</span>    <span class="token keyword">char</span> c<span class="token punctuation">,</span> pwd<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    TableSize <span class="token operator">=</span> <span class="token function">NextPrime</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    HashTable H <span class="token operator">=</span> <span class="token function">CreateTable</span><span class="token punctuation">(</span>TableSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c %d %s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ID<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">)</span>            <span class="token function">New</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> ID<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token function">Login</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> ID<span class="token punctuation">,</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 全部5种输出信息</td><td>答案正确</td><td>10</td><td>4 ms</td><td>324 KB</td></tr><tr><td>1</td><td>最大表，全部是新申请，密码全部16位</td><td>答案正确</td><td>7</td><td>76 ms</td><td>8900 KB</td></tr><tr><td>2</td><td>N和L指令各一半，随机交错。帐号随机，取到上下界。密码随机，取到上下界</td><td>答案正确</td><td>8</td><td>67 ms</td><td>6856 KB</td></tr></tbody></table><h4 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;algorithm&gt;#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;map&gt;using namespace std;map&lt;string, string&gt; QQ;int main() &#123;    int n;    scanf(&quot;%d&quot;, &amp;n);    getchar();    char cmd;    string id, pwd;    for (int i &#x3D; 0; i &lt; n; i++) &#123;        cmd &#x3D; getchar();        if (cmd &#x3D;&#x3D; &#39;N&#39;) &#123;            cin &gt;&gt; id &gt;&gt; pwd;            if (QQ.find(id) !&#x3D; QQ.end())                printf(&quot;ERROR: Exist\n&quot;);            else &#123;                QQ[id] &#x3D; pwd;                printf(&quot;New: OK\n&quot;);            &#125;        &#125; else if (cmd &#x3D;&#x3D; &#39;L&#39;) &#123;            cin &gt;&gt; id &gt;&gt; pwd;            if (QQ.find(id) !&#x3D; QQ.end()) &#123;                if (QQ[id] &#x3D;&#x3D; pwd)                    printf(&quot;Login: OK\n&quot;);                else                    printf(&quot;ERROR: Wrong PW\n&quot;);            &#125; else                printf(&quot;ERROR: Not Exist\n&quot;);        &#125;        getchar();    &#125;    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 全部5种输出信息</td><td>答案正确</td><td>10</td><td>3 ms</td><td>312 KB</td></tr><tr><td>1</td><td>最大表，全部是新申请，密码全部16位</td><td>答案正确</td><td>7</td><td>346 ms</td><td>16832 KB</td></tr><tr><td>2</td><td>N和L指令各一半，随机交错。帐号随机，取到上下界。密码随机，取到上下界</td><td>答案正确</td><td>8</td><td>309 ms</td><td>9268 KB</td></tr></tbody></table><h3 id="4-Hashing-Hard-Version"><a href="#4-Hashing-Hard-Version" class="headerlink" title="4.Hashing - Hard Version"></a>4.Hashing - Hard Version</h3><p>Given a hash table of size <em>N</em>, we can define a hash function $H(x)=x\%N$. Suppose that the linear probing is used to solve collisions, we can easily obtain the status of the hash table with a given sequence of input numbers.</p><p>However, now you are asked to solve the reversed problem: reconstruct the input sequence from the given status of the hash table. Whenever there are multiple choices, the smallest number is always taken.</p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each test case, the first line contains a positive integer $N (≤1000)$, which is the size of the hash table. The next line contains <em>N</em> integers, separated by a space. A negative integer represents an empty cell in the hash table. It is guaranteed that all the non-negative integers are distinct in the table.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print a line that contains the input sequence, with the numbers separated by a space. Notice that there must be no extra space at the end of each line.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">1133 1 13 12 34 38 27 22 32 -1 21<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">1 13 12 21 33 34 38 27 22 32<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h4><p>已知 $H(x) = x\%N $以及用线性探测解决冲突问题</p><p>先给出散列映射的结果，反求输入顺序</p><p>关键：当元素x被映射到H(x)位置，发现这个位置已经有y了，则y一定是在x之前被输入！</p><p>有拓扑排序内味。</p><h4 id="AC-code-3"><a href="#AC-code-3" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXN</span> <span class="token expression"><span class="token number">1000</span></span></span><span class="token keyword">int</span> H<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">,</span> NewH<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">,</span> position<span class="token punctuation">[</span>MAXN <span class="token operator">*</span> MAXN<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token keyword">int</span> cell<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> pos<span class="token punctuation">;</span>    pos <span class="token operator">=</span> cell <span class="token operator">%</span> N<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>NewH<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token operator">++</span>pos<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pos <span class="token operator">>=</span> N<span class="token punctuation">)</span> pos <span class="token operator">=</span> pos <span class="token operator">%</span> N<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> pos<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>a <span class="token operator">-</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> i<span class="token punctuation">,</span> cell<span class="token punctuation">,</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        position<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        NewH<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>H<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            position<span class="token punctuation">[</span>H<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token operator">++</span>cnt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">qsort</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> N<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> compare<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> pos<span class="token punctuation">,</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> Inserted<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Inserted<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                pos <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>H<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>pos <span class="token operator">==</span> position<span class="token punctuation">[</span>H<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token operator">++</span>num<span class="token punctuation">;</span>                    NewH<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                    Inserted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> H<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 有并列初始、中间产生更小并列值，hash取到0和N-1</td><td>答案正确</td><td>18</td><td>16 ms</td><td>292 KB</td></tr><tr><td>1</td><td>全部一次放好</td><td>答案正确</td><td>4</td><td>17 ms</td><td>284 KB</td></tr><tr><td>2</td><td>最大N，但是只有少数值，有非-1的空位</td><td>答案正确</td><td>2</td><td>16 ms</td><td>312 KB</td></tr><tr><td>3</td><td>最小N</td><td>答案正确</td><td>2</td><td>8 ms</td><td>316 KB</td></tr><tr><td>4</td><td>最大N随机</td><td>答案正确</td><td>4</td><td>9 ms</td><td>428 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week10</title>
      <link href="2021/08061709.html"/>
      <url>2021/08061709.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week10排序（下）"><a href="#Week10排序（下）" class="headerlink" title="Week10排序（下）"></a>Week10排序（下）</h1><h2 id="10-1-快速排序"><a href="#10-1-快速排序" class="headerlink" title="10.1 快速排序"></a>10.1 快速排序</h2><h3 id="算法概述"><a href="#算法概述" class="headerlink" title="算法概述"></a>算法概述</h3><p>算法概述  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Quicksort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>N <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>    pivot <span class="token operator">=</span> 从A<span class="token punctuation">[</span><span class="token punctuation">]</span> 中选一个主元<span class="token punctuation">;</span>    将S <span class="token operator">=</span> <span class="token punctuation">&#123;</span>A<span class="token punctuation">[</span><span class="token punctuation">]</span> \ pivot<span class="token punctuation">&#125;</span> 分成<span class="token number">2</span>个独立子集<span class="token operator">:</span>     A1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>a属于S <span class="token operator">|</span> a ≤ pivot<span class="token punctuation">&#125;</span> 和 A2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>a属于S <span class="token operator">|</span> a ≥ pivot<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    A<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Quicksort</span><span class="token punctuation">(</span>A1<span class="token punctuation">,</span> N1<span class="token punctuation">)</span>∪ <span class="token punctuation">&#123;</span> pivot <span class="token punctuation">&#125;</span> ∪ <span class="token function">Quicksort</span><span class="token punctuation">(</span>A2<span class="token punctuation">,</span> N2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>什么是快速排序算法的最好情况？</p><p>每次正好中分$\rightarrow  T(N) = O( NlogN )  $</p><h3 id="选主元"><a href="#选主元" class="headerlink" title="选主元"></a>选主元</h3><p>令 $pivot = A[0]$？  </p><table><thead><tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>$\cdots$</th><th>N-1</th><th>N</th></tr></thead><tbody><tr><td></td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>$\cdots$</td><td>N-1</td><td>N</td></tr><tr><td></td><td></td><td>3</td><td>4</td><td>5</td><td>6</td><td>$\cdots$</td><td>N-1</td><td>N</td></tr></tbody></table><p>$$<br>\begin{aligned}<br>T ( N ) &amp;= O( N ) + T ( N – 1 )\newline<br>&amp;= O( N ) + O ( N – 1 ) + T( N – 2 )\newline<br>&amp;= O( N ) + O ( N – 1 ) + … + O( 1 )\newline<br>&amp;= O( N^2 )<br>\end{aligned}<br>$$</p><p>随机取 pivot？ rand()函数不便宜啊！  </p><p><strong>取头、中、尾的中位数</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">ElementType <span class="token function">Median3</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> Left<span class="token punctuation">,</span> <span class="token keyword">int</span> Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Center <span class="token operator">=</span> <span class="token punctuation">(</span>Left <span class="token operator">+</span> Right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* A[ Left ] &lt;= A[ Center ] &lt;= A[ Right ] */</span>    <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 将pivot藏到右边 */</span>    <span class="token comment">/* 只需要考虑 A[ Left+1 ] … A[ Right–2 ] */</span>    <span class="token keyword">return</span> A<span class="token punctuation">[</span>Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 返回 pivot */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="子集划分"><a href="#子集划分" class="headerlink" title="子集划分"></a>子集划分</h3><p>如果有元素正好等于pivot怎么办？  </p><p>停下来交换!</p><h3 id="小规模数据的处理"><a href="#小规模数据的处理" class="headerlink" title="小规模数据的处理"></a>小规模数据的处理</h3><p>快速排序的问题  </p><ul><li><p>用递归……</p></li><li><p>对小规模的数据（例如N不到100）可能还不如插入排序快  </p></li><li><p>解决方案  </p></li><li><p>当递归的数据规模充分小，则停止递归，直接调用简单排序（例如插入排序）</p></li><li><p>在程序中定义一个Cutoff的阈值  </p></li></ul><h3 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Quicksort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> Left<span class="token punctuation">,</span> <span class="token keyword">int</span> Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Cutoff <span class="token operator">&lt;=</span> Right <span class="token operator">-</span> Left<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Pivot <span class="token operator">=</span> <span class="token function">Median3</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Left<span class="token punctuation">,</span> Right<span class="token punctuation">)</span><span class="token punctuation">;</span>        i <span class="token operator">=</span> Left<span class="token punctuation">;</span>        j <span class="token operator">=</span> Right – <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span><span class="token operator">++</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> Pivot<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span> ––j<span class="token punctuation">]</span> <span class="token operator">></span> Pivot<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> j<span class="token punctuation">)</span>                <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Quicksort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Left<span class="token punctuation">,</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Quicksort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">Insertion_Sort</span><span class="token punctuation">(</span>A <span class="token operator">+</span> Left<span class="token punctuation">,</span> Right <span class="token operator">-</span> Left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Quick_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">Quicksort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="10-2-表排序"><a href="#10-2-表排序" class="headerlink" title="10.2 表排序"></a>10.2 表排序</h2><h3 id="算法概述-1"><a href="#算法概述-1" class="headerlink" title="算法概述"></a>算法概述</h3><p><strong>间接排序</strong>  </p><p>定义一个指针数组作为“表”（table）  </p><table><thead><tr><th align="center">A</th><th align="center">[0]</th><th align="center">[1]</th><th align="center">[2]</th><th align="center">[3]</th><th align="center">[4]</th><th align="center">[5]</th><th align="center">[6]</th><th align="center">[7]</th></tr></thead><tbody><tr><td align="center">key</td><td align="center">f</td><td align="center">d</td><td align="center">c</td><td align="center">a</td><td align="center">g</td><td align="center">b</td><td align="center">h</td><td align="center">e</td></tr><tr><td align="center">table</td><td align="center">3</td><td align="center">5</td><td align="center">2</td><td align="center">1</td><td align="center">7</td><td align="center">0</td><td align="center">4</td><td align="center">6</td></tr></tbody></table><h3 id="物理排序"><a href="#物理排序" class="headerlink" title="物理排序"></a>物理排序</h3><p>N个数字的排列由若干个独立的环组成  </p><p>如何判断一个环的结束？  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>最好情况：初始即有序  </p><p>最坏情况：  </p><ul><li>有 $\lfloor N / 2\rfloor$ 个环，每个环包含2个元素</li><li>需要$\lfloor 3N / 2\rfloor$次元素移动  </li></ul><p>$T = O( m N ) , m $​是每个A元素的复制时间。  </p><h2 id="10-3-基数排序"><a href="#10-3-基数排序" class="headerlink" title="10.3 基数排序"></a>10.3 基数排序</h2><h3 id="桶排序"><a href="#桶排序" class="headerlink" title="桶排序"></a>桶排序</h3><p>假设我们有 N 个学生，他们的成绩是0到100之间的整数（ 于是有$ M = 101$ 个不同的成绩值） 。 如何在线性时间内将学生按成绩排序？  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Bucket_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    count<span class="token punctuation">[</span><span class="token punctuation">]</span> 初始化<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>读入<span class="token number">1</span>个学生成绩grade<span class="token punctuation">)</span>将该生插入count<span class="token punctuation">[</span>grade<span class="token punctuation">]</span>链表<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> M<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> 输出整个count<span class="token punctuation">[</span>i<span class="token punctuation">]</span> 链表<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$T(N, M) = O( M+N )  $</p><p><strong>如果 M &gt;&gt; N该怎么办？</strong>  </p><h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h3><p>假设我们有 N = 10 个整数，每个整数的值在0到999之间（ 于是有 M = 1000 个不同的值）。 还有<br>可能在线性时间内排序吗？  </p><p>输 序列 入序列: 64,  8, 216, 512, 27, 729, 0, 1, 343, 125</p><p>用“次位优先”（Least Significant Digit）</p><p>$T=O(P(N+B))$</p><table><thead><tr><th>Bucket</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>Pass1</td><td>0</td><td>1</td><td>512</td><td>343</td><td>64</td><td>125</td><td>216</td><td>27</td><td>8</td><td>729</td></tr><tr><td></td><td>0</td><td>512</td><td>125</td><td></td><td>343</td><td></td><td>64</td><td></td><td></td><td></td></tr><tr><td>Pass2</td><td>1</td><td>216</td><td>27</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>8</td><td></td><td>729</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>0</td><td>125</td><td>216</td><td>343</td><td></td><td>512</td><td></td><td>729</td><td></td><td></td></tr><tr><td></td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Pass3</td><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>27</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>64</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id="多关键字的排序"><a href="#多关键字的排序" class="headerlink" title="多关键字的排序"></a>多关键字的排序</h3><p>一副扑克牌是按2种关键字排序的：花色和面值</p><p>用“主位优先” （ Most Significant Digit ）排序： 为花色建4个桶  </p><p>在每个桶内分别排序， 最后合并结果。  </p><p>用“次位优先” （Least Significant Digit ）排序： 为面值建13个桶  </p><p>将结果合并 然后再为花色建4个桶  </p><h2 id="10-4-排序算法的比较"><a href="#10-4-排序算法的比较" class="headerlink" title="10.4 排序算法的比较"></a>10.4 排序算法的比较</h2><table><thead><tr><th align="center">排序方法</th><th align="center">平均时间复杂度</th><th align="center">最坏情况下时间复杂度</th><th align="center">额外空间复杂度</th><th align="center">稳定性</th></tr></thead><tbody><tr><td align="center">简单选择排序</td><td align="center">$O(N^2)$</td><td align="center">$O(N^2)$</td><td align="center">$O(1)$</td><td align="center">不稳定</td></tr><tr><td align="center">冒泡排序</td><td align="center">$O(N^2)$</td><td align="center">$O(N^2)$</td><td align="center">$O(1)$</td><td align="center">稳定</td></tr><tr><td align="center">直接插入排序</td><td align="center">$O(N^2) $</td><td align="center">$O(N^2)$</td><td align="center">$O(1)$</td><td align="center">稳定</td></tr><tr><td align="center">希尔排序</td><td align="center">$O(N^d)$</td><td align="center">$O(N^2)$</td><td align="center">$O(1)$</td><td align="center">不稳定</td></tr><tr><td align="center">堆排序</td><td align="center">$O(NlogN)$</td><td align="center">$O(NlogN)$</td><td align="center">$O(1)$</td><td align="center">不稳定</td></tr><tr><td align="center">快速排序</td><td align="center">$O(NlogN)$</td><td align="center">$O(N^2)$</td><td align="center">$O(logN)$</td><td align="center">不稳定</td></tr><tr><td align="center">归并排序</td><td align="center">$O(NlogN)$</td><td align="center">$O(NlogN)$</td><td align="center">$O(N) $</td><td align="center">稳定</td></tr><tr><td align="center">基数排序</td><td align="center">$O(P(N+B))$</td><td align="center">$O(P(N+B))$</td><td align="center">$O(N+B)$</td><td align="center">稳定</td></tr></tbody></table><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* 快速排序 - 直接调用库函数 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token comment">/*---------------简单整数排序--------------------*/</span><span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 比较两整数。非降序排列 */</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>a <span class="token operator">-</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 调用接口 */</span><span class="token function">qsort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> compare<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*---------------简单整数排序--------------------*/</span><span class="token comment">/*--------------- 一般情况下，对结构体Node中的某键值key排序 ---------------*/</span><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> key1<span class="token punctuation">,</span> key2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> A<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">compare2keys</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 比较两种键值：按key1非升序排列；如果key1相等，则按key2非降序排列*/</span>    <span class="token keyword">int</span> k<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>key1 <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>key1<span class="token punctuation">)</span>        k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>key1 <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>key1<span class="token punctuation">)</span>        k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 如果key1相等 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>key2 <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>key2<span class="token punctuation">)</span>            k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> k<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 调用接口 */</span><span class="token function">qsort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">)</span><span class="token punctuation">,</span> compare2keys<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*--------------- 一般情况下，对结构体Node中的某键值key排序 ---------------*/</span><span class="token comment">/* 快速排序 */</span>ElementType <span class="token function">Median3</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> Left<span class="token punctuation">,</span> <span class="token keyword">int</span> Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Center <span class="token operator">=</span> <span class="token punctuation">(</span>Left <span class="token operator">+</span> Right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 此时A[Left] &lt;= A[Center] &lt;= A[Right] */</span>    <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Center<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 将基准Pivot藏到右边*/</span>    <span class="token comment">/* 只需要考虑A[Left+1] … A[Right-2] */</span>    <span class="token keyword">return</span> A<span class="token punctuation">[</span>Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 返回基准Pivot */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Qsort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> Left<span class="token punctuation">,</span> <span class="token keyword">int</span> Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 核心递归函数 */</span>    <span class="token keyword">int</span> Pivot<span class="token punctuation">,</span> Cutoff<span class="token punctuation">,</span> Low<span class="token punctuation">,</span> High<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Cutoff <span class="token operator">&lt;=</span> Right <span class="token operator">-</span> Left<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 如果序列元素充分多，进入快排 */</span>        Pivot <span class="token operator">=</span> <span class="token function">Median3</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Left<span class="token punctuation">,</span> Right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 选基准 */</span>        Low <span class="token operator">=</span> Left<span class="token punctuation">;</span>        High <span class="token operator">=</span> Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*将序列中比基准小的移到基准左边，大的移到右边*/</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span><span class="token operator">++</span>Low<span class="token punctuation">]</span> <span class="token operator">&lt;</span> Pivot<span class="token punctuation">)</span>                <span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span><span class="token operator">--</span>High<span class="token punctuation">]</span> <span class="token operator">></span> Pivot<span class="token punctuation">)</span>                <span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Low <span class="token operator">&lt;</span> High<span class="token punctuation">)</span>                <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Low<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>High<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Low<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>Right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 将基准换到正确的位置 */</span>        <span class="token function">Qsort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Left<span class="token punctuation">,</span> Low <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">/* 递归解决左边 */</span>        <span class="token function">Qsort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Low <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> Right<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/* 递归解决右边 */</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">InsertionSort</span><span class="token punctuation">(</span>A <span class="token operator">+</span> Left<span class="token punctuation">,</span> Right <span class="token operator">-</span> Left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 元素太少，用简单排序 */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">QuickSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 统一接口 */</span>    <span class="token function">Qsort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 基数排序 - 次位优先 */</span><span class="token comment">/* 假设元素最多有MaxDigit个关键字，基数全是同样的Radix */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxDigit</span> <span class="token expression"><span class="token number">4</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Radix</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token comment">/* 桶元素结点 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>PtrToNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> key<span class="token punctuation">;</span>    PtrToNode next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* 桶头结点 */</span><span class="token keyword">struct</span> <span class="token class-name">HeadNode</span> <span class="token punctuation">&#123;</span>    PtrToNode head<span class="token punctuation">,</span> tail<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">HeadNode</span> Bucket<span class="token punctuation">[</span>Radix<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">GetDigit</span><span class="token punctuation">(</span><span class="token keyword">int</span> X<span class="token punctuation">,</span> <span class="token keyword">int</span> D<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 默认次位D=1, 主位D&lt;=MaxDigit */</span>    <span class="token keyword">int</span> d<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> D<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        d <span class="token operator">=</span> X <span class="token operator">%</span> Radix<span class="token punctuation">;</span>        X <span class="token operator">/=</span> Radix<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> d<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">LSDRadixSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 基数排序 - 次位优先 */</span>    <span class="token keyword">int</span> D<span class="token punctuation">,</span> Di<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    Bucket B<span class="token punctuation">;</span>    PtrToNode tmp<span class="token punctuation">,</span> p<span class="token punctuation">,</span> List <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Radix<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 初始化每个桶为空链表 */</span>        B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">=</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tail <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 将原始序列逆序存入初始链表List */</span>        tmp <span class="token operator">=</span> <span class="token punctuation">(</span>PtrToNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        tmp<span class="token operator">-></span>key <span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        tmp<span class="token operator">-></span>next <span class="token operator">=</span> List<span class="token punctuation">;</span>        List <span class="token operator">=</span> tmp<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 下面开始排序 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>D <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> D <span class="token operator">&lt;=</span> MaxDigit<span class="token punctuation">;</span> D<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 对数据的每一位循环处理 */</span>        <span class="token comment">/* 下面是分配的过程 */</span>        p <span class="token operator">=</span> List<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            Di <span class="token operator">=</span> <span class="token function">GetDigit</span><span class="token punctuation">(</span>p<span class="token operator">-></span>key<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 获得当前元素的当前位数字 */</span>            <span class="token comment">/* 从List中摘除 */</span>            tmp <span class="token operator">=</span> p<span class="token punctuation">;</span>            p <span class="token operator">=</span> p<span class="token operator">-></span>next<span class="token punctuation">;</span>            <span class="token comment">/* 插入B[Di]号桶尾 */</span>            tmp<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>                B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">=</span> B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>tail <span class="token operator">=</span> tmp<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>tail<span class="token operator">-></span>next <span class="token operator">=</span> tmp<span class="token punctuation">;</span>                B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>tail <span class="token operator">=</span> tmp<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">/* 下面是收集的过程 */</span>        List <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>Di <span class="token operator">=</span> Radix <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> Di <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> Di<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 将每个桶的元素顺序收集入List */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 <span class="token comment">/* 如果桶不为空 */</span>                <span class="token comment">/* 整桶插入List表头 */</span>                B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>tail<span class="token operator">-></span>next <span class="token operator">=</span> List<span class="token punctuation">;</span>                List <span class="token operator">=</span> B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">;</span>                B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">=</span> B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>tail <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">/* 清空桶 */</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 将List倒入A[]并释放空间 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        tmp <span class="token operator">=</span> List<span class="token punctuation">;</span>        List <span class="token operator">=</span> List<span class="token operator">-></span>next<span class="token punctuation">;</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token operator">-></span>key<span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 基数排序 - 主位优先 */</span><span class="token comment">/* 假设元素最多有MaxDigit个关键字，基数全是同样的Radix */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxDigit</span> <span class="token expression"><span class="token number">4</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Radix</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token comment">/* 桶元素结点 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>PtrToNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> key<span class="token punctuation">;</span>    PtrToNode next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* 桶头结点 */</span><span class="token keyword">struct</span> <span class="token class-name">HeadNode</span> <span class="token punctuation">&#123;</span>    PtrToNode head<span class="token punctuation">,</span> tail<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">HeadNode</span> Bucket<span class="token punctuation">[</span>Radix<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">GetDigit</span><span class="token punctuation">(</span><span class="token keyword">int</span> X<span class="token punctuation">,</span> <span class="token keyword">int</span> D<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 默认次位D=1, 主位D&lt;=MaxDigit */</span>    <span class="token keyword">int</span> d<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> D<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        d <span class="token operator">=</span> X <span class="token operator">%</span> Radix<span class="token punctuation">;</span>        X <span class="token operator">/=</span> Radix<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> d<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">MSD</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>         <span class="token keyword">int</span> L<span class="token punctuation">,</span>         <span class="token keyword">int</span> R<span class="token punctuation">,</span>         <span class="token keyword">int</span> D<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 核心递归函数: 对A[L]...A[R]的第D位数进行排序 */</span>    <span class="token keyword">int</span> Di<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    Bucket B<span class="token punctuation">;</span>    PtrToNode tmp<span class="token punctuation">,</span> p<span class="token punctuation">,</span> List <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>D <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">/* 递归终止条件 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Radix<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 初始化每个桶为空链表 */</span>        B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">=</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tail <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> L<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> R<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 将原始序列逆序存入初始链表List */</span>        tmp <span class="token operator">=</span> <span class="token punctuation">(</span>PtrToNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        tmp<span class="token operator">-></span>key <span class="token operator">=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        tmp<span class="token operator">-></span>next <span class="token operator">=</span> List<span class="token punctuation">;</span>        List <span class="token operator">=</span> tmp<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 下面是分配的过程 */</span>    p <span class="token operator">=</span> List<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Di <span class="token operator">=</span> <span class="token function">GetDigit</span><span class="token punctuation">(</span>p<span class="token operator">-></span>key<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 获得当前元素的当前位数字 */</span>        <span class="token comment">/* 从List中摘除 */</span>        tmp <span class="token operator">=</span> p<span class="token punctuation">;</span>        p <span class="token operator">=</span> p<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token comment">/* 插入B[Di]号桶 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>            B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>tail <span class="token operator">=</span> tmp<span class="token punctuation">;</span>        tmp<span class="token operator">-></span>next <span class="token operator">=</span> B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">;</span>        B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head <span class="token operator">=</span> tmp<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 下面是收集的过程 */</span>    i <span class="token operator">=</span> j <span class="token operator">=</span> L<span class="token punctuation">;</span> <span class="token comment">/* i, j记录当前要处理的A[]的左右端下标 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Di <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Di <span class="token operator">&lt;</span> Radix<span class="token punctuation">;</span> Di<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 对于每个桶 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 将非空的桶整桶倒入A[], 递归排序 */</span>            p <span class="token operator">=</span> B<span class="token punctuation">[</span>Di<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                tmp <span class="token operator">=</span> p<span class="token punctuation">;</span>                p <span class="token operator">=</span> p<span class="token operator">-></span>next<span class="token punctuation">;</span>                A<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token operator">-></span>key<span class="token punctuation">;</span>                <span class="token function">free</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">/* 递归对该桶数据排序, 位数减1 */</span>            <span class="token function">MSD</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> D <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            i <span class="token operator">=</span> j<span class="token punctuation">;</span> <span class="token comment">/* 为下一个桶对应的A[]左端 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">MSDRadixSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 统一接口 */</span>    <span class="token function">MSD</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> MaxDigit<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-统计工龄"><a href="#1-统计工龄" class="headerlink" title="1.统计工龄"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988058096460636160">1.统计工龄</a></h3><p>给定公司<em>N</em>名员工的工龄，要求按工龄增序输出每个工龄段有多少员工。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入首先给出正整数<em>N</em>（≤105），即员工总人数；随后给出<em>N</em>个整数，即每个员工的工龄，范围在[0, 50]。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>按工龄的递增顺序输出每个工龄的员工个数，格式为：“工龄:人数”。每项占一行。如果人数为0则不输出该项。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">810 2 0 5 7 2 5 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">0:12:35:27:110:1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>简单的桶排序，无须赘述。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> num<span class="token punctuation">,</span> age<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    N <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>N<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        num <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>age<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">51</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>age<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d:%d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> age<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 有人数为0的段</td><td>答案正确</td><td>12</td><td>3 ms</td><td>196 KB</td></tr><tr><td>1</td><td>最大N，工龄全0</td><td>答案正确</td><td>4</td><td>5 ms</td><td>196 KB</td></tr><tr><td>2</td><td>最大N，按递减顺序给出</td><td>答案正确</td><td>4</td><td>5 ms</td><td>196 KB</td></tr></tbody></table><h3 id="2-PAT-Judge"><a href="#2-PAT-Judge" class="headerlink" title="2.PAT Judge"></a><a href="https://pintia.cn/problem-sets/16/problems/677">2.PAT Judge</a></h3><p>2014年PAT春季考试真题</p><p>The ranklist of PAT is generated from the status list, which shows the scores of the submissions. This time you are supposed to generate the ranklist for PAT.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains 3 positive integers, $N (≤10^4)$, the total number of users, $K (≤5)$, the total number of problems, and $M (≤10^5)$, the total number of submissions. It is then assumed that the user id’s are 5-digit numbers from 00001 to <em>N</em>, and the problem id’s are from 1 to <em>K</em>. The next line contains <em>K</em> positive integers <code>p[i]</code> （i<code>=1, ..., *K*）, where </code>p[i]` corresponds to the full mark of the i-th problem. Then <em>M</em> lines follow, each gives the information of a submission in the following format:</p><pre class="line-numbers language-none"><code class="language-none">user_id problem_id partial_score_obtained<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>partial_score_obtained</code> is either −1 if the submission cannot even pass the compiler, or is an integer in the range [0, <code>p[problem_id]</code>]. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, you are supposed to output the ranklist in the following format:</p><pre class="line-numbers language-none"><code class="language-none">rank user_id total_score s[1] ... s[K]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>rank</code> is calculated according to the <code>total_score</code>, and all the users with the same <code>total_score</code> obtain the same <code>rank</code>; and <code>s[i]</code> is the partial score obtained for the <code>i</code>-th problem. If a user has never submitted a solution for a problem, then “-“ must be printed at the corresponding position. If a user has submitted several solutions to solve one problem, then the highest score will be counted.</p><p>The ranklist must be printed in non-decreasing order of the ranks. For those who have the same rank, users must be sorted in nonincreasing order according to the number of perfectly solved problems. And if there is still a tie, then they must be printed in increasing order of their id’s. For those who has never submitted any solution that can pass the compiler, or has never submitted any solution, they must NOT be shown on the ranklist. It is guaranteed that at least one user can be shown on the ranklist.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">7 4 2020 25 25 3000002 2 1200007 4 1700005 1 1900007 2 2500005 1 2000002 2 200005 1 1500001 1 1800004 3 2500002 2 2500005 3 2200006 4 -100001 2 1800002 1 2000004 1 1500002 4 1800001 3 400001 4 200005 2 -100004 2 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">1 00002 63 20 25 - 182 00005 42 20 0 22 -2 00007 42 - 25 - 172 00001 42 18 18 4 25 00004 40 15 0 25 -<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>此题关键在于注意细节</p><ul><li>按照总分排序高低排序。</li><li>总分相同，那么按照答对题目个数（完全正确，拿满分）进行排序。</li><li>然后再相同就需要按照学号进行排序。</li><li>一道题都没有提交或者提交但没有一道题通过编译的同学不输出。（提交得零分也要输出）</li><li>提交没有通过编译的题目输出0，没有提交的题目输出“-”。</li></ul><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXP</span> <span class="token expression"><span class="token number">6</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXU</span> <span class="token expression"><span class="token number">10001</span></span></span><span class="token keyword">int</span> N<span class="token punctuation">,</span> K<span class="token punctuation">,</span> M<span class="token punctuation">;</span><span class="token keyword">int</span> Score<span class="token punctuation">[</span>MAXP<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token keyword">int</span> flag<span class="token punctuation">;</span> <span class="token comment">//是否输出</span>    <span class="token keyword">int</span> total_score<span class="token punctuation">;</span>    <span class="token keyword">int</span> score<span class="token punctuation">[</span>MAXP<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> total_number<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> Student<span class="token punctuation">;</span>Student student<span class="token punctuation">[</span>MAXU<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span>Student student<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> id<span class="token punctuation">,</span> pro<span class="token punctuation">,</span> score<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> K<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> Score<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> M<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        id <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pro <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>pro<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>pro<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>pro<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> score<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>total_score <span class="token operator">+=</span> <span class="token punctuation">(</span>score <span class="token operator">-</span> student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>pro<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            student<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>pro<span class="token punctuation">]</span> <span class="token operator">=</span> score<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Count_Number</span><span class="token punctuation">(</span>Student studentList<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>studentList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>total_score <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> K<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>studentList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> Score<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    studentList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>total_number<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">cmp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>total_score <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>total_score <span class="token operator">||</span> <span class="token comment">//分数高低</span>        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>total_score <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>total_score <span class="token operator">&amp;&amp;</span>         <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>total_number <span class="token operator">></span>             <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>total_number<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token comment">//分数相同按完全答对题目个数</span>        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>total_score <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>total_score <span class="token operator">&amp;&amp;</span>         <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>total_number <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>total_number <span class="token operator">&amp;&amp;</span>         <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>id <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//前两者都相同，按id</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//输出函数</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>Student student<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>flag <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>student<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>total_score <span class="token operator">!=</span> student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>total_score<span class="token punctuation">)</span>                number <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%05d %d"</span><span class="token punctuation">,</span> student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>total_score<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> K<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" -"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span> student<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">,</span> <span class="token operator">&amp;</span>K<span class="token punctuation">,</span> <span class="token operator">&amp;</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Init</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Count_Number</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">qsort</span><span class="token punctuation">(</span>student <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Student<span class="token punctuation">)</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 部分分；后面提交没有前面高；并列按id排；没提交；编译不过；有人有题目没提交过；提交0分、提交-1</td><td>答案正确</td><td>13</td><td>3 ms</td><td>312 KB</td></tr><tr><td>1</td><td>最小N</td><td>答案正确</td><td>3</td><td>3 ms</td><td>304 KB</td></tr><tr><td>2</td><td>K最小，有0分</td><td>答案正确</td><td>3</td><td>3 ms</td><td>192 KB</td></tr><tr><td>3</td><td>M最小</td><td>答案正确</td><td>3</td><td>4 ms</td><td>708 KB</td></tr><tr><td>4</td><td>最大随机测试，有满分的题目重复提交</td><td>答案正确</td><td>3</td><td>18 ms</td><td>928 KB</td></tr></tbody></table><h3 id="3-Sort-with-Swap-0-i"><a href="#3-Sort-with-Swap-0-i" class="headerlink" title="3.Sort with Swap$(0, i)$"></a><a href="https://pintia.cn/problem-sets/16/problems/678">3.Sort with Swap$(0, i)$</a></h3><p>Given any permutation of the numbers {0, 1, 2,…, <em>N</em>−1}, it is easy to sort them in increasing order. But what if <code>Swap(0, *)</code> is the ONLY operation that is allowed to use? For example, to sort {4, 0, 2, 1, 3} we may apply the swap operations in the following way:</p><pre class="line-numbers language-none"><code class="language-none">Swap(0, 1) &#x3D;&gt; &#123;4, 1, 2, 0, 3&#125;Swap(0, 3) &#x3D;&gt; &#123;4, 1, 2, 3, 0&#125;Swap(0, 4) &#x3D;&gt; &#123;0, 1, 2, 3, 4&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Now you are asked to find the minimum number of swaps need to sort the given permutation of the first <em>N</em> nonnegative integers.</p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case, which gives a positive $N (≤10^5)$ followed by a permutation sequence of {0, 1, …, <em>N</em>−1}. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each case, simply print in a line the minimum number of swaps need to sort the given permutation.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">103 5 7 2 6 4 9 0 8 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>题意是给定N个数字的排列，仅利用与0交换排序。</p><p>事实上，注意到 N个数字的排列由若干个独立的环组成 。</p><p>环分3种  </p><ol><li><p>只有1个元素：不需要交换</p></li><li><p>环里$n_0$个元素，包括0：需要$n_0–1$次交换</p></li><li><p>第$i$个环里有$n_i$个元素，不包括0：先把0换到环里，再进行$(n_i+1)–1$次交换 —— 一共是$n_i+1$次交换  </p></li></ol><p>若$N$个元素的序列中包含$S$个单元环、 $K$个多元环，则交换次数为：</p><p>$n_0-1+\sum^{K-1}<em>{i=1}(n_i+1)=\sum^{K-1}</em>{i=0}n_i\ +K-2=N-S+K-2$​</p><p>注意若$a[0]=0$，则不存在第二种情况，公式变为$N-S+K$</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">100000</span></span></span><span class="token keyword">int</span> N<span class="token punctuation">,</span> S <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> K <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> pos<span class="token punctuation">,</span> num<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    N <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> num<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> i<span class="token punctuation">)</span>            <span class="token operator">++</span>S<span class="token punctuation">,</span> flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token operator">++</span>K<span class="token punctuation">;</span>            pos <span class="token operator">=</span> num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">!=</span> i<span class="token punctuation">)</span> flag<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pos <span class="token operator">=</span> num<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> N <span class="token operator">-</span> S <span class="token operator">+</span> K <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> N <span class="token operator">-</span> S <span class="token operator">+</span> K<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample （2大环+1单元环，重复3遍）</td><td>答案正确</td><td>15</td><td>3 ms</td><td>320 KB</td></tr><tr><td>1</td><td>最大N，两两倒序</td><td>答案正确</td><td>3</td><td>6 ms</td><td>1084 KB</td></tr><tr><td>2</td><td>全倒序</td><td>答案正确</td><td>3</td><td>4 ms</td><td>572 KB</td></tr><tr><td>3</td><td>初始值为0</td><td>答案正确</td><td>2</td><td>4 ms</td><td>176 KB</td></tr><tr><td>4</td><td>最小N</td><td>答案正确</td><td>1</td><td>3 ms</td><td>192 KB</td></tr><tr><td>5</td><td>N=2</td><td>答案正确</td><td>1</td><td>3 ms</td><td>320 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week9</title>
      <link href="2021/08051709.html"/>
      <url>2021/08051709.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week9排序（上）"><a href="#Week9排序（上）" class="headerlink" title="Week9排序（上）"></a>Week9排序（上）</h1><h2 id="9-1-简单排序"><a href="#9-1-简单排序" class="headerlink" title="9.1 简单排序"></a>9.1 简单排序</h2><h3 id="前-提"><a href="#前-提" class="headerlink" title="前 提"></a>前 提</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">X_Sort</span> <span class="token punctuation">(</span> ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>大多数情况下，为简单起见，讨论从小大的整数排序</p><ul><li>N是正整数</li><li>只讨论基于比较的排序（ &gt; = &lt; 有定义）</li><li>只讨论内部排序</li><li>稳定性：任意两个相等的数据，排序前后的相对位置不发生改变</li><li>没有一种排序是任何情况下都表现最好的  </li></ul><h3 id="简单排序"><a href="#简单排序" class="headerlink" title="简单排序"></a>简单排序</h3><h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Bubble_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> P <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> P<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> P<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 一趟冒泡 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> A<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">Swap</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 标识发生了交换 */</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* 全程无交换 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最好情况：顺序 $T = O( N )$</p><p>最坏情况：逆序 $T = O( N^2 )$</p><p>稳定！</p><h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Insertion_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 摸下一张牌 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 移出空位 */</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>          <span class="token comment">/* 新牌落位 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最好情况：顺序 $T = O( N )$</p><p>最坏情况：逆序 $T = O( N^2 )$</p><p>稳定！</p><h3 id="时间复杂度下界"><a href="#时间复杂度下界" class="headerlink" title="时间复杂度下界"></a>时间复杂度下界</h3><p>对于下标$i&lt;j$，如果$A[i]&gt;A[j]$，则称$(i,j)$是一对逆序对$(inversion)$</p><p>问题：序列{34, 8, 64, 51, 32, 21}中有多少逆序对？</p><p>交换2个相邻元素正好消去1个逆序对！</p><p>$(34, 8) (34, 32) (34, 21) (64, 51) (64, 32) (64, 21) (51, 32) (51, 21) (32, 21)  $</p><p>插入排序： $T(N, I) = O( N+I )$</p><p>— 如果序列<strong>基本有序</strong>，则插入排序简单且高效  </p><p>定理：任意N个不同元素组成的序列平均具有$N ( N - 1 ) / 4$ 个逆序对。</p><p>定理：任何仅以交换相邻两元素来排序的算法，其平均时间复杂度为 $\Omega ( N^2 )$ 。</p><p>这意味着：要提高算法效率，我们必须</p><ul><li>每次消去不止1个逆序对！</li><li>每次交换相隔较远的2个元素！  </li></ul><h2 id="9-2-希尔排序（-by-Donald-Shell-）"><a href="#9-2-希尔排序（-by-Donald-Shell-）" class="headerlink" title="9.2 希尔排序（ by Donald Shell ）"></a>9.2 希尔排序（ by Donald Shell ）</h2><h3 id="举个例子"><a href="#举个例子" class="headerlink" title="举个例子"></a>举个例子</h3><table><thead><tr><th>间隔</th><th>81</th><th>94</th><th>11</th><th>96</th><th>12</th><th>35</th><th>17</th><th>95</th><th>28</th><th>58</th><th>41</th><th>75</th><th>15</th></tr></thead><tbody><tr><td>5-间隔</td><td>35</td><td>17</td><td>11</td><td>28</td><td>12</td><td>41</td><td>75</td><td>15</td><td>96</td><td>58</td><td>81</td><td>94</td><td>95</td></tr><tr><td>3-间隔</td><td>28</td><td>12</td><td>11</td><td>35</td><td>15</td><td>41</td><td>58</td><td>17</td><td>94</td><td>75</td><td>81</td><td>96</td><td>95</td></tr><tr><td>1-间隔</td><td>11</td><td>12</td><td>15</td><td>17</td><td>28</td><td>35</td><td>41</td><td>58</td><td>75</td><td>81</td><td>94</td><td>95</td><td>96</td></tr></tbody></table><p>定义增量序列 $D_M &gt; D_{M-1} &gt; … &gt; D_1 = 1$</p><p>对每个 $D_k$ 进行“$D_k$-间隔”排序$( k = M, M-1, … 1 )$</p><p>注意： “$D_k$-间隔”有序的序列，在执行“$D_{k-1}$-间隔”排序后，仍然是“$D_k$​-间隔”有序的  </p><h3 id="希尔增量序列"><a href="#希尔增量序列" class="headerlink" title="希尔增量序列"></a>希尔增量序列</h3><p>原始希尔排序 $D_M = \lfloor N / 2\rfloor , D_k = \lfloor D_{k+1} / 2 \rfloor$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Shell_sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>D <span class="token operator">=</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> D <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> D <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 希尔增量序列 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> D<span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 插入排序 */</span>            Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">>=</span> D <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> D<span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i <span class="token operator">-=</span> D<span class="token punctuation">)</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> D<span class="token punctuation">]</span><span class="token punctuation">;</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最坏情况： $T =\Theta ( N2 ) $ </p><h3 id="举个坏例子"><a href="#举个坏例子" class="headerlink" title="举个坏例子"></a>举个坏例子</h3><table><thead><tr><th>间隔</th><th>1</th><th>9</th><th>2</th><th>10</th><th>3</th><th>11</th><th>4</th><th>12</th><th>5</th><th>13</th><th>6</th><th>14</th><th>7</th><th>15</th><th>8</th><th>16</th></tr></thead><tbody><tr><td>8-间隔</td><td>1</td><td>9</td><td>2</td><td>10</td><td>3</td><td>11</td><td>4</td><td>12</td><td>5</td><td>13</td><td>6</td><td>14</td><td>7</td><td>15</td><td>8</td><td>16</td></tr><tr><td>4-间隔</td><td>1</td><td>9</td><td>2</td><td>10</td><td>3</td><td>11</td><td>4</td><td>12</td><td>5</td><td>13</td><td>6</td><td>14</td><td>7</td><td>15</td><td>8</td><td>16</td></tr><tr><td>2-间隔</td><td>1</td><td>9</td><td>2</td><td>10</td><td>3</td><td>11</td><td>4</td><td>12</td><td>5</td><td>13</td><td>6</td><td>14</td><td>7</td><td>15</td><td>8</td><td>16</td></tr><tr><td>1-间隔</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td></tr></tbody></table><p><strong>增量元素不互质，则小增量可能根本不起作用。</strong>  </p><h3 id="更多增量序列"><a href="#更多增量序列" class="headerlink" title="更多增量序列"></a>更多增量序列</h3><p>$Hibbard $增量序列  </p><p>$D_k = 2^k – 1$ — 相邻元素互质</p><p>最坏情况： $T = \Theta ( N^{3/2} )$</p><p>猜想： $T_{avg} = O ( N^{5/4} )  $</p><p>$Sedgewick$增量序列  </p><p>{1, 5, 19, 41, 109, … }— $9\times 4^i – 9\times2^i + 1 $或$ 4^i – 3\times 2^i + 1$</p><p>猜想：$ T_{avg} = O ( N^{7/6} )， T_{worst} = O ( N^{4/3} )$  </p><h2 id="9-3-堆排序"><a href="#9-3-堆排序" class="headerlink" title="9.3 堆排序"></a>9.3 堆排序</h2><h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Selection_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        MinPosition <span class="token operator">=</span> <span class="token function">ScanForMin</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i<span class="token punctuation">,</span> N–<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 从A[i]到A[N–1]中找最小元，并将其位置赋给MinPosition */</span>        <span class="token function">Swap</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>MinPosition<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 将未排序部分的最小元换到有序部分的最后位置 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>无论如何： $T = \Theta( N^2 )$</p><p><strong>如何快速找到最小元？？？</strong>  </p><h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h3><h4 id="算法1"><a href="#算法1" class="headerlink" title="算法1"></a>算法1</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Heap_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">BuildHeap</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>                                   <span class="token comment">/* O(N) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* O(logN) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>                         <span class="token comment">/* O(N) */</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> TmpA<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$T ( N ) = O ( N log N )  $</p><p><strong>需要额外O(N)空间，并且复制元素需要时间。</strong>  </p><h4 id="算法2"><a href="#算法2" class="headerlink" title="算法2"></a>算法2</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Heap_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> N <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token comment">/* BuildHeap */</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* DeleteMax */</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>定理：堆排序处理N个不同元素的随机排列的平均比较次数是$2N logN - O(Nlog logN) $。</p><p>虽然堆排序给出最佳平均时间复杂度，但实际效果不如用$Sedgewick$增量序列的希尔排序。  </p><h2 id="9-4-归并排序"><a href="#9-4-归并排序" class="headerlink" title="9.4 归并排序"></a>9.4 归并排序</h2><h3 id="核心：有序子列的归并"><a href="#核心：有序子列的归并" class="headerlink" title="核心：有序子列的归并"></a>核心：有序子列的归并</h3><p>如果两个子列一共有N个元素，则归并的时间复杂度是？<br>$$<br>T ( N ) = O( N )<br>$$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* L = 左边起始位置, R = 右边起始位置, RightEnd = 右边终点位置 */</span><span class="token keyword">void</span> <span class="token function">Merge</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> R<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    LeftEnd <span class="token operator">=</span> R <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 左边终点位置。假设左右两列挨着 */</span>    Tmp <span class="token operator">=</span> L<span class="token punctuation">;</span>         <span class="token comment">/* 存放结果的数组的初始位置 */</span>    NumElements <span class="token operator">=</span> RightEnd <span class="token operator">-</span> L <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd <span class="token operator">&amp;&amp;</span> R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>L<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> A<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">)</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd<span class="token punctuation">)</span> <span class="token comment">/* 直接复制左边剩下的 */</span>        TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> <span class="token comment">/*直接复制右边剩下的 */</span>        TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NumElements<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> RightEnd<span class="token operator">--</span><span class="token punctuation">)</span> A<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span> <span class="token operator">=</span> TmpA<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="递归算法"><a href="#递归算法" class="headerlink" title="递归算法"></a>递归算法</h3><p>分而治之，稳定！</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">MSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Center<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Center <span class="token operator">=</span> <span class="token punctuation">(</span>L <span class="token operator">+</span> RightEnd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token function">MSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">MSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$T( N ) = T( N/2 ) + T( N/2 ) + O( N )\rightarrow T( N ) = O( N logN )  $​</p><p><strong>统一函数接口</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Merge_sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    TmpA <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">MSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token function">Error</span><span class="token punctuation">(</span> <span class="token string">"空间不足"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果只在Merge中声明临时数组</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Merge</span><span class="token punctuation">(</span> ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> R<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd <span class="token punctuation">)</span><span class="token keyword">void</span> <span class="token function">MSort</span><span class="token punctuation">(</span> ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd <span class="token punctuation">)</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="非递归算法"><a href="#非递归算法" class="headerlink" title="非递归算法"></a>非递归算法</h3><p><strong>额外空间复杂度是???</strong> $O( N )$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Merge_pass</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token comment">/* length = 当前有序子列的长度 */</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N–<span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">)</span>        <span class="token function">Merge1</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> length<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length–<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*将A中元素归并到TmpA*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> length <span class="token operator">&lt;</span> N<span class="token punctuation">)</span> <span class="token comment">/* 归并最后2个子列 */</span>        <span class="token function">Merge1</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> length<span class="token punctuation">,</span> N–<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token comment">/* 最后只剩1个子列 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Merge_sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化子序列长度 */</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    TmpA <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>length <span class="token operator">&lt;</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Merge_pass</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> N<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            length <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token function">Merge_pass</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">,</span> A<span class="token punctuation">,</span> N<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            length <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token function">Error</span><span class="token punctuation">(</span> <span class="token string">"空间不足"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>稳定！</strong></p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">InsertionSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 插入排序 */</span>    <span class="token keyword">int</span> P<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出未排序序列中的第一个元素*/</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*依次与已排序序列中元素比较并右移*/</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>          <span class="token comment">/* 放进合适的位置 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">ShellSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 希尔排序 - 用Sedgewick增量序列 */</span>    <span class="token keyword">int</span> Si<span class="token punctuation">,</span> D<span class="token punctuation">,</span> P<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Tmp<span class="token punctuation">;</span>    <span class="token comment">/* 这里只列出一小部分增量 */</span>    <span class="token keyword">int</span> Sedgewick<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">929</span><span class="token punctuation">,</span> <span class="token number">505</span><span class="token punctuation">,</span> <span class="token number">209</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Si <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Sedgewick<span class="token punctuation">[</span>Si<span class="token punctuation">]</span> <span class="token operator">>=</span> N<span class="token punctuation">;</span> Si<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span> <span class="token comment">/* 初始的增量Sedgewick[Si]不能超过待排序列长度 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>D <span class="token operator">=</span> Sedgewick<span class="token punctuation">[</span>Si<span class="token punctuation">]</span><span class="token punctuation">;</span> D <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> D <span class="token operator">=</span> Sedgewick<span class="token punctuation">[</span><span class="token operator">++</span>Si<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> D<span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 插入排序*/</span>            Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">>=</span> D <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> D<span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i <span class="token operator">-=</span> D<span class="token punctuation">)</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> D<span class="token punctuation">]</span><span class="token punctuation">;</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>ElementType <span class="token operator">*</span>a<span class="token punctuation">,</span> ElementType <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    ElementType t <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token punctuation">;</span>    <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">;</span>    <span class="token operator">*</span>b <span class="token operator">=</span> t<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">PercDown</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 改编代码4.24的PercDown( MaxHeap H, int p )    */</span>    <span class="token comment">/* 将N个元素的数组中以A[p]为根的子堆调整为最大堆 */</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">,</span> Child<span class="token punctuation">;</span>    ElementType X<span class="token punctuation">;</span>    X <span class="token operator">=</span> A<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出根结点存放的值 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Parent <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token punctuation">(</span>Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> Parent <span class="token operator">=</span> Child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Child <span class="token operator">=</span> Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Child <span class="token operator">!=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Child<span class="token punctuation">]</span> <span class="token operator">&lt;</span> A<span class="token punctuation">[</span>Child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            Child<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* Child指向左右子结点的较大者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">>=</span> A<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* 找到了合适位置 */</span>        <span class="token keyword">else</span>       <span class="token comment">/* 下滤X */</span>            A<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    A<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">HeapSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 堆排序 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> N <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token comment">/* 建立最大堆 */</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 删除最大堆顶 */</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 见代码7.1 */</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 归并排序 - 递归实现 */</span><span class="token comment">/* L = 左边起始位置, R = 右边起始位置, RightEnd = 右边终点位置*/</span><span class="token keyword">void</span> <span class="token function">Merge</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> R<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将有序的A[L]~A[R-1]和A[R]~A[RightEnd]归并成一个有序序列*/</span>    <span class="token keyword">int</span> LeftEnd<span class="token punctuation">,</span> NumElements<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    LeftEnd <span class="token operator">=</span> R <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 左边终点位置 */</span>    Tmp <span class="token operator">=</span> L<span class="token punctuation">;</span>         <span class="token comment">/* 有序序列的起始位置 */</span>    NumElements <span class="token operator">=</span> RightEnd <span class="token operator">-</span> L <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd <span class="token operator">&amp;&amp;</span> R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>L<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> A<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">)</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将左边元素复制到TmpA */</span>        <span class="token keyword">else</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将右边元素复制到TmpA */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd<span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 直接复制左边剩下的 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 直接复制右边剩下的 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NumElements<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> RightEnd<span class="token operator">--</span><span class="token punctuation">)</span>        A<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span> <span class="token operator">=</span> TmpA<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将有序的TmpA[]复制回A[] */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Msort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 核心递归排序函数 */</span>    <span class="token keyword">int</span> Center<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Center <span class="token operator">=</span> <span class="token punctuation">(</span>L <span class="token operator">+</span> RightEnd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">/* 递归解决左边 */</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 递归解决右边 */</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 合并两段有序序列 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">MergeSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 归并排序 */</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    TmpA <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"空间不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 归并排序 - 循环实现 */</span><span class="token comment">/* 这里Merge函数在递归版本中给出 */</span><span class="token comment">/* length = 当前有序子列的长度*/</span><span class="token keyword">void</span> <span class="token function">Merge_pass</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 两两归并相邻有序子列 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">)</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> length<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> length <span class="token operator">&lt;</span> N<span class="token punctuation">)</span> <span class="token comment">/* 归并最后2个子列*/</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> length<span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token comment">/* 最后只剩1个子列*/</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Merge_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> length<span class="token punctuation">;</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    length <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化子序列长度*/</span>    TmpA <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>length <span class="token operator">&lt;</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Merge_pass</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> N<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            length <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token function">Merge_pass</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">,</span> A<span class="token punctuation">,</span> N<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            length <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"空间不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-排序"><a href="#1-排序" class="headerlink" title="1.排序"></a><a href="https://pintia.cn/problem-sets/434/problems/6477">1.排序</a></h3><p>给定<em>N</em>个（长整型范围内的）整数，要求输出从小到大排序后的结果。</p><p>本题旨在测试各种不同的排序算法在各种数据情况下的表现。各组测试数据特点如下：</p><p>数据1：只有1个元素；</p><p>数据2：11个不相同的整数，测试基本正确性；</p><p>数据3：$10^3$个随机整数；</p><p>数据4：$10^4$个随机整数；</p><p>数据5：$10^5$个随机整数；</p><p>数据6：$10^5$个顺序整数；</p><p>数据7：$10^5$个逆序整数；</p><p>数据8：$10^5$个基本有序的整数；</p><p>数据9：$10^5$个随机正整数，每个数字不超过1000。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入第一行给出正整数<em>N</em>（≤105），随后一行给出<em>N</em>个（长整型范围内的）整数，其间以空格分隔。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>在一行中输出从小到大排序后的结果，数字间以1个空格分隔，行末不得有多余空格。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">114 981 10 -17 0 -20 29 50 8 43 -5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">-20 -17 -5 0 4 8 10 29 43 50 981<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>可以提交各种排序代码来实验！以下代码读入时用了快读，测试某一排序时注释掉其它即可。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">100000</span></span></span><span class="token keyword">int</span> N<span class="token punctuation">,</span> A<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertionSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 插入排序 */</span>    <span class="token keyword">int</span> P<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出未排序序列中的第一个元素*/</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*依次与已排序序列中元素比较并右移*/</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>          <span class="token comment">/* 放进合适的位置 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">ShellSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 希尔排序 - 用Sedgewick增量序列 */</span>    <span class="token keyword">int</span> Si<span class="token punctuation">,</span> D<span class="token punctuation">,</span> P<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Tmp<span class="token punctuation">;</span>    <span class="token comment">/* 这里只列出一小部分增量 */</span>    <span class="token keyword">int</span> Sedgewick<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">929</span><span class="token punctuation">,</span> <span class="token number">505</span><span class="token punctuation">,</span> <span class="token number">209</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Si <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Sedgewick<span class="token punctuation">[</span>Si<span class="token punctuation">]</span> <span class="token operator">>=</span> N<span class="token punctuation">;</span> Si<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span> <span class="token comment">/* 初始的增量Sedgewick[Si]不能超过待排序列长度 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>D <span class="token operator">=</span> Sedgewick<span class="token punctuation">[</span>Si<span class="token punctuation">]</span><span class="token punctuation">;</span> D <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> D <span class="token operator">=</span> Sedgewick<span class="token punctuation">[</span><span class="token operator">++</span>Si<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> D<span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 插入排序*/</span>            Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">>=</span> D <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> D<span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i <span class="token operator">-=</span> D<span class="token punctuation">)</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> D<span class="token punctuation">]</span><span class="token punctuation">;</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>ElementType <span class="token operator">*</span>a<span class="token punctuation">,</span> ElementType <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    ElementType t <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token punctuation">;</span>    <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">;</span>    <span class="token operator">*</span>b <span class="token operator">=</span> t<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">PercDown</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 改编代码4.24的PercDown( MaxHeap H, int p )    */</span>    <span class="token comment">/* 将N个元素的数组中以A[p]为根的子堆调整为最大堆 */</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">,</span> Child<span class="token punctuation">;</span>    ElementType X<span class="token punctuation">;</span>    X <span class="token operator">=</span> A<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出根结点存放的值 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Parent <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token punctuation">(</span>Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> Parent <span class="token operator">=</span> Child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Child <span class="token operator">=</span> Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Child <span class="token operator">!=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Child<span class="token punctuation">]</span> <span class="token operator">&lt;</span> A<span class="token punctuation">[</span>Child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            Child<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* Child指向左右子结点的较大者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">>=</span> A<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* 找到了合适位置 */</span>        <span class="token keyword">else</span>       <span class="token comment">/* 下滤X */</span>            A<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    A<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">HeapSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 堆排序 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> N <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token comment">/* 建立最大堆 */</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 删除最大堆顶 */</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 见代码7.1 */</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 归并排序 - 递归实现 */</span><span class="token comment">/* L = 左边起始位置, R = 右边起始位置, RightEnd = 右边终点位置*/</span><span class="token keyword">void</span> <span class="token function">Merge</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> R<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将有序的A[L]~A[R-1]和A[R]~A[RightEnd]归并成一个有序序列*/</span>    <span class="token keyword">int</span> LeftEnd<span class="token punctuation">,</span> NumElements<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    LeftEnd <span class="token operator">=</span> R <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 左边终点位置 */</span>    Tmp <span class="token operator">=</span> L<span class="token punctuation">;</span>         <span class="token comment">/* 有序序列的起始位置 */</span>    NumElements <span class="token operator">=</span> RightEnd <span class="token operator">-</span> L <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd <span class="token operator">&amp;&amp;</span> R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>L<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> A<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">)</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将左边元素复制到TmpA */</span>        <span class="token keyword">else</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将右边元素复制到TmpA */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd<span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 直接复制左边剩下的 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 直接复制右边剩下的 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NumElements<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> RightEnd<span class="token operator">--</span><span class="token punctuation">)</span>        A<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span> <span class="token operator">=</span> TmpA<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将有序的TmpA[]复制回A[] */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Msort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 核心递归排序函数 */</span>    <span class="token keyword">int</span> Center<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Center <span class="token operator">=</span> <span class="token punctuation">(</span>L <span class="token operator">+</span> RightEnd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">/* 递归解决左边 */</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 递归解决右边 */</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 合并两段有序序列 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">MergeSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 归并排序 */</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    TmpA <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"空间不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 归并排序 - 循环实现 */</span><span class="token comment">/* 这里Merge函数在递归版本中给出 */</span><span class="token comment">/* length = 当前有序子列的长度*/</span><span class="token keyword">void</span> <span class="token function">Merge_pass</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 两两归并相邻有序子列 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">)</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> length<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> length <span class="token operator">&lt;</span> N<span class="token punctuation">)</span> <span class="token comment">/* 归并最后2个子列*/</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> length<span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token comment">/* 最后只剩1个子列*/</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Merge_Sort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> length<span class="token punctuation">;</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    length <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化子序列长度*/</span>    TmpA <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>length <span class="token operator">&lt;</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Merge_pass</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> N<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            length <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token function">Merge_pass</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">,</span> A<span class="token punctuation">,</span> N<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>            length <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"空间不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    N <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">InsertionSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ShellSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">HeapSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">MergeSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Merge_Sort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><h5 id="插入排序-1"><a href="#插入排序-1" class="headerlink" title="插入排序"></a>插入排序</h5><table><thead><tr><th>测试点</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>答案正确</td><td>1</td><td>4 ms</td><td>316 KB</td></tr><tr><td>1</td><td>答案正确</td><td>10</td><td>3 ms</td><td>188 KB</td></tr><tr><td>2</td><td>答案正确</td><td>2</td><td>4 ms</td><td>316 KB</td></tr><tr><td>3</td><td>答案正确</td><td>2</td><td>27 ms</td><td>444 KB</td></tr><tr><td>4</td><td>答案正确</td><td>2</td><td>1310 ms</td><td>1196 KB</td></tr><tr><td>5</td><td>答案正确</td><td>2</td><td>22 ms</td><td>1208 KB</td></tr><tr><td>6</td><td>答案正确</td><td>2</td><td>2506 ms</td><td>1168 KB</td></tr><tr><td>7</td><td>答案正确</td><td>2</td><td>40 ms</td><td>1336 KB</td></tr><tr><td>8</td><td>答案正确</td><td>2</td><td>1290 ms</td><td>1084 KB</td></tr></tbody></table><h5 id="希尔排序——用Sedgewick增量序列"><a href="#希尔排序——用Sedgewick增量序列" class="headerlink" title="希尔排序——用Sedgewick增量序列"></a>希尔排序——用Sedgewick增量序列</h5><table><thead><tr><th>测试点</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>答案正确</td><td>1</td><td>4 ms</td><td>300 KB</td></tr><tr><td>1</td><td>答案正确</td><td>10</td><td>4 ms</td><td>296 KB</td></tr><tr><td>2</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr><tr><td>3</td><td>答案正确</td><td>2</td><td>6 ms</td><td>300 KB</td></tr><tr><td>4</td><td>答案正确</td><td>2</td><td>43 ms</td><td>1196 KB</td></tr><tr><td>5</td><td>答案正确</td><td>2</td><td>29 ms</td><td>1324 KB</td></tr><tr><td>6</td><td>答案正确</td><td>2</td><td>36 ms</td><td>1196 KB</td></tr><tr><td>7</td><td>答案正确</td><td>2</td><td>27 ms</td><td>1196 KB</td></tr><tr><td>8</td><td>答案正确</td><td>2</td><td>37 ms</td><td>1068 KB</td></tr></tbody></table><h5 id="堆排序-1"><a href="#堆排序-1" class="headerlink" title="堆排序"></a>堆排序</h5><table><thead><tr><th>测试点</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>答案正确</td><td>1</td><td>5 ms</td><td>300 KB</td></tr><tr><td>1</td><td>答案正确</td><td>10</td><td>2 ms</td><td>192 KB</td></tr><tr><td>2</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr><tr><td>3</td><td>答案正确</td><td>2</td><td>5 ms</td><td>316 KB</td></tr><tr><td>4</td><td>答案正确</td><td>2</td><td>23 ms</td><td>1204 KB</td></tr><tr><td>5</td><td>答案正确</td><td>2</td><td>33 ms</td><td>1196 KB</td></tr><tr><td>6</td><td>答案正确</td><td>2</td><td>29 ms</td><td>1196 KB</td></tr><tr><td>7</td><td>答案正确</td><td>2</td><td>29 ms</td><td>1212 KB</td></tr><tr><td>8</td><td>答案正确</td><td>2</td><td>30 ms</td><td>952 KB</td></tr></tbody></table><h5 id="归并排序——递归"><a href="#归并排序——递归" class="headerlink" title="归并排序——递归"></a>归并排序——递归</h5><table><thead><tr><th>测试点</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>答案正确</td><td>1</td><td>3 ms</td><td>300 KB</td></tr><tr><td>1</td><td>答案正确</td><td>10</td><td>2 ms</td><td>192 KB</td></tr><tr><td>2</td><td>答案正确</td><td>2</td><td>3 ms</td><td>188 KB</td></tr><tr><td>3</td><td>答案正确</td><td>2</td><td>7 ms</td><td>316 KB</td></tr><tr><td>4</td><td>答案正确</td><td>2</td><td>25 ms</td><td>1204 KB</td></tr><tr><td>5</td><td>答案正确</td><td>2</td><td>27 ms</td><td>1188 KB</td></tr><tr><td>6</td><td>答案正确</td><td>2</td><td>29 ms</td><td>1188 KB</td></tr><tr><td>7</td><td>答案正确</td><td>2</td><td>25 ms</td><td>1192 KB</td></tr><tr><td>8</td><td>答案正确</td><td>2</td><td>36 ms</td><td>1060 KB</td></tr></tbody></table><h5 id="归并排序——循环"><a href="#归并排序——循环" class="headerlink" title="归并排序——循环"></a>归并排序——循环</h5><table><thead><tr><th>测试点</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>答案正确</td><td>1</td><td>7 ms</td><td>320 KB</td></tr><tr><td>1</td><td>答案正确</td><td>10</td><td>2 ms</td><td>196 KB</td></tr><tr><td>2</td><td>答案正确</td><td>2</td><td>3 ms</td><td>196 KB</td></tr><tr><td>3</td><td>答案正确</td><td>2</td><td>5 ms</td><td>320 KB</td></tr><tr><td>4</td><td>答案正确</td><td>2</td><td>36 ms</td><td>1208 KB</td></tr><tr><td>5</td><td>答案正确</td><td>2</td><td>31 ms</td><td>1204 KB</td></tr><tr><td>6</td><td>答案正确</td><td>2</td><td>29 ms</td><td>1208 KB</td></tr><tr><td>7</td><td>答案正确</td><td>2</td><td>29 ms</td><td>1208 KB</td></tr><tr><td>8</td><td>答案正确</td><td>2</td><td>33 ms</td><td>960 KB</td></tr></tbody></table><h3 id="2-Insert-or-Merge"><a href="#2-Insert-or-Merge" class="headerlink" title="2.Insert or Merge"></a>2.Insert or Merge</h3><p> 2014年PAT冬季考试真题</p><p>According to Wikipedia:</p><p><strong>Insertion sort</strong> iterates, consuming one input element each repetition, and growing a sorted output list. Each iteration, insertion sort removes one element from the input data, finds the location it belongs within the sorted list, and inserts it there. It repeats until no input elements remain.</p><p><strong>Merge sort</strong> works as follows: Divide the unsorted list into N sublists, each containing 1 element (a list of 1 element is considered sorted). Then repeatedly merge two adjacent sublists to produce new sorted sublists until there is only 1 sublist remaining.</p><p>Now given the initial sequence of integers, together with a sequence which is a result of several iterations of some sorting method, can you tell which sorting method we are using?</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line gives a positive integer <em>N</em> (≤100). Then in the next line, <em>N</em> integers are given as the initial sequence. The last line contains the partially sorted sequence of the <em>N</em> numbers. It is assumed that the target sequence is always ascending. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in the first line either “Insertion Sort” or “Merge Sort” to indicate the method used to obtain the partial result. Then run this method for one more iteration and output in the second line the resuling sequence. It is guaranteed that the answer is unique for each test case. All the numbers in a line must be separated by a space, and there must be no extra space at the end of the line.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">103 1 2 8 7 5 9 4 6 01 2 3 7 8 5 9 4 6 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Insertion Sort1 2 3 5 7 8 9 4 6 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">103 1 2 8 7 5 9 4 0 61 3 2 8 5 7 4 9 0 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Merge Sort1 2 3 8 4 5 7 9 0 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>如何区分简单插入和非递归的归并排序  </p><ul><li>插入排序：前面有序，后面没变化</li><li>归并排序：分段有序  </li></ul><p>柿子得挑软的捏！</p><p>判断是否插入排序</p><p>从左向右扫描，直到发现顺序不对， <strong>跳出</strong>循环</p><p>从<strong>跳出地点</strong>继续向右扫描，与原始序列比对，发现不同则判断为“非”</p><p>循环自然结束，则判断为“是”，返回<strong>跳出地点</strong></p><p>如果是插入排序，则从<strong>跳出地点</strong>开始进行一趟插入  </p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">100</span></span></span><span class="token keyword">int</span> N<span class="token punctuation">,</span> A<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> B<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">InsertionSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 插入排序 */</span>    <span class="token keyword">int</span> P<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出未排序序列中的第一个元素*/</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*依次与已排序序列中元素比较并右移*/</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>          <span class="token comment">/* 放进合适的位置 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 归并排序 - 递归实现 */</span><span class="token comment">/* L = 左边起始位置, R = 右边起始位置, RightEnd = 右边终点位置*/</span><span class="token keyword">void</span> <span class="token function">Merge</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> R<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将有序的A[L]~A[R-1]和A[R]~A[RightEnd]归并成一个有序序列*/</span>    <span class="token keyword">int</span> LeftEnd<span class="token punctuation">,</span> NumElements<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    LeftEnd <span class="token operator">=</span> R <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 左边终点位置 */</span>    Tmp <span class="token operator">=</span> L<span class="token punctuation">;</span>         <span class="token comment">/* 有序序列的起始位置 */</span>    NumElements <span class="token operator">=</span> RightEnd <span class="token operator">-</span> L <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd <span class="token operator">&amp;&amp;</span> R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>L<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> A<span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">)</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将左边元素复制到TmpA */</span>        <span class="token keyword">else</span>            TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将右边元素复制到TmpA */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;=</span> LeftEnd<span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>L<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 直接复制左边剩下的 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>R <span class="token operator">&lt;=</span> RightEnd<span class="token punctuation">)</span> TmpA<span class="token punctuation">[</span>Tmp<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>R<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 直接复制右边剩下的 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NumElements<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> RightEnd<span class="token operator">--</span><span class="token punctuation">)</span>        A<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span> <span class="token operator">=</span> TmpA<span class="token punctuation">[</span>RightEnd<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 将有序的TmpA[]复制回A[] */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Msort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType TmpA<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> L<span class="token punctuation">,</span> <span class="token keyword">int</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 核心递归排序函数 */</span>    <span class="token keyword">int</span> Center<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>L <span class="token operator">&lt;</span> RightEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Center <span class="token operator">=</span> <span class="token punctuation">(</span>L <span class="token operator">+</span> RightEnd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">/* 递归解决左边 */</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 递归解决右边 */</span>        <span class="token function">Merge</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> L<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> RightEnd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 合并两段有序序列 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">MergeSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 归并排序 */</span>    ElementType <span class="token operator">*</span>TmpA<span class="token punctuation">;</span>    TmpA <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>N <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>TmpA <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Msort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> TmpA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>TmpA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"空间不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> B<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> B<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Insertion Sort\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">InsertionSort</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Merge Sort\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            k <span class="token operator">=</span> k <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">MergeSort</span><span class="token punctuation">(</span>A <span class="token operator">+</span> i <span class="token operator">*</span> k<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">MergeSort</span><span class="token punctuation">(</span>A <span class="token operator">+</span> N <span class="token operator">/</span> k <span class="token operator">*</span> k<span class="token punctuation">,</span> N <span class="token operator">-</span> N <span class="token operator">/</span> k <span class="token operator">*</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 1 Ins 中间步骤，有不需要交换的元素</td><td>答案正确</td><td>7</td><td>3 ms</td><td>304 KB</td></tr><tr><td>1</td><td>sample 2 Mg 有不成双，有不需要交换的元素</td><td>答案正确</td><td>6</td><td>2 ms</td><td>176 KB</td></tr><tr><td>2</td><td>最小N, Ins 第一步没变</td><td>答案正确</td><td>1</td><td>2 ms</td><td>196 KB</td></tr><tr><td>3</td><td>最小N，Mg第一步</td><td>答案正确</td><td>1</td><td>2 ms</td><td>180 KB</td></tr><tr><td>4</td><td>最大N，Ins</td><td>答案正确</td><td>3</td><td>2 ms</td><td>192 KB</td></tr><tr><td>5</td><td>最大N，Mg，后面N位没变化</td><td>答案正确</td><td>4</td><td>2 ms</td><td>176 KB</td></tr><tr><td>6</td><td>卡住Mg检查片段长度的错误算法，连续长度有3种</td><td>答案正确</td><td>3</td><td>2 ms</td><td>192 KB</td></tr></tbody></table><h3 id="3-Insertion-or-Heap-Sort"><a href="#3-Insertion-or-Heap-Sort" class="headerlink" title="3.Insertion or Heap Sort"></a><a href="https://pintia.cn/problem-sets/16/problems/676">3.Insertion or Heap Sort</a></h3><p>2015年考研复试上机真题</p><p>According to Wikipedia:</p><p><strong>Insertion sort</strong> iterates, consuming one input element each repetition, and growing a sorted output list. Each iteration, insertion sort removes one element from the input data, finds the location it belongs within the sorted list, and inserts it there. It repeats until no input elements remain.</p><p><strong>Heap sort</strong> divides its input into a sorted and an unsorted region, and it iteratively shrinks the unsorted region by extracting the largest element and moving that to the sorted region. it involves the use of a heap data structure rather than a linear-time search to find the maximum.</p><p>Now given the initial sequence of integers, together with a sequence which is a result of several iterations of some sorting method, can you tell which sorting method we are using?</p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line gives a positive integer <em>N</em> (≤100). Then in the next line, <em>N</em> integers are given as the initial sequence. The last line contains the partially sorted sequence of the <em>N</em> numbers. It is assumed that the target sequence is always ascending. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in the first line either “Insertion Sort” or “Heap Sort” to indicate the method used to obtain the partial result. Then run this method for one more iteration and output in the second line the resulting sequence. It is guaranteed that the answer is unique for each test case. All the numbers in a line must be separated by a space, and there must be no extra space at the end of the line.</p><h4 id="Sample-Input-1-1"><a href="#Sample-Input-1-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">103 1 2 8 7 5 9 4 6 01 2 3 7 8 5 9 4 6 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1-1"><a href="#Sample-Output-1-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Insertion Sort1 2 3 5 7 8 9 4 6 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Input-2-1"><a href="#Sample-Input-2-1" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">103 1 2 8 7 5 9 4 6 06 4 5 1 0 3 2 7 8 9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-2-1"><a href="#Sample-Output-2-1" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Heap Sort5 4 3 1 0 2 6 7 8 9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>与上题一样的，只不过处理堆排序时略有不同。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">100</span></span></span><span class="token keyword">int</span> N<span class="token punctuation">,</span> A<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> B<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">InsertionSort</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 插入排序 */</span>    <span class="token keyword">int</span> P<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    ElementType Tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>P <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> P <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> P<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Tmp <span class="token operator">=</span> A<span class="token punctuation">[</span>P<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出未排序序列中的第一个元素*/</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> P<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> Tmp<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>            A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*依次与已排序序列中元素比较并右移*/</span>        A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>          <span class="token comment">/* 放进合适的位置 */</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span>ElementType <span class="token operator">*</span>a<span class="token punctuation">,</span> ElementType <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    ElementType t <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token punctuation">;</span>    <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">;</span>    <span class="token operator">*</span>b <span class="token operator">=</span> t<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">PercDown</span><span class="token punctuation">(</span>ElementType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> right <span class="token operator">&amp;&amp;</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> A<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        i <span class="token operator">=</span> j<span class="token punctuation">;</span>        j <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> B<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> B<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Insertion Sort\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">InsertionSort</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Heap Sort\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        k <span class="token operator">=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> B<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">>=</span> B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> k<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>B<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> B<span class="token punctuation">[</span>N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample Ins 中间步骤，有不需要交换的元素</td><td>答案正确</td><td>7</td><td>5 ms</td><td>188 KB</td></tr><tr><td>1</td><td>sample Hp 一般情况</td><td>答案正确</td><td>6</td><td>4 ms</td><td>176 KB</td></tr><tr><td>2</td><td>最小N, Ins 第一步没变</td><td>答案正确</td><td>2</td><td>4 ms</td><td>200 KB</td></tr><tr><td>3</td><td>最小N, Hp第1步</td><td>答案正确</td><td>2</td><td>3 ms</td><td>188 KB</td></tr><tr><td>4</td><td>最大N，Ins</td><td>答案正确</td><td>4</td><td>5 ms</td><td>196 KB</td></tr><tr><td>5</td><td>最大N，Hp，后面x位没变化</td><td>答案正确</td><td>4</td><td>4 ms</td><td>328 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week8</title>
      <link href="2021/080450796.html"/>
      <url>2021/080450796.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week8图（下）"><a href="#Week8图（下）" class="headerlink" title="Week8图（下）"></a>Week8图（下）</h1><h2 id="8-1-最小生成树问题"><a href="#8-1-最小生成树问题" class="headerlink" title="8.1 最小生成树问题"></a>8.1 最小生成树问题</h2><h3 id="什么是最小生成树（Minimum-Spanning-Tree）"><a href="#什么是最小生成树（Minimum-Spanning-Tree）" class="headerlink" title="什么是最小生成树（Minimum Spanning Tree）"></a>什么是最小生成树（Minimum Spanning Tree）</h3><p>是一棵<strong>树</strong>  </p><ul><li>无回路</li><li>$|V|$个顶点一定有$|V|-1$条边  </li></ul><p>是<strong>生成</strong>树  </p><ul><li>包含全部顶点</li><li>$|V|-1$条边都在图里  </li></ul><p>边的权重和<strong>最小</strong>  </p><p>最小生成树存在 ↔ 图连通  </p><p>向生成树中任加一条边都一定构成回路  </p><h3 id="贪心算法"><a href="#贪心算法" class="headerlink" title="贪心算法"></a>贪心算法</h3><p>什么是“贪”：每一步都要最好的</p><p>什么是“好”：权重最小的边</p><p>需要约束：</p><ul><li>只能用图里有的边</li><li>只能正好用掉$|V|-1$条边</li><li>不能有回路  </li></ul><h3 id="Prim算法-—-让一棵小树长大"><a href="#Prim算法-—-让一棵小树长大" class="headerlink" title="Prim算法 — 让一棵小树长大"></a>Prim算法 — 让一棵小树长大</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Prim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MST <span class="token operator">=</span> <span class="token punctuation">&#123;</span>s<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> 未收录顶点中dist最小者<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>这样的V不存在<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    将V收录进MST<span class="token operator">:</span>        dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>W未被收录<span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> W<span class="token punctuation">)</span> <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">E</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">;</span>                    parent<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>MST中收的顶点不到 <span class="token operator">|</span> V <span class="token operator">|</span> 个<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span> “生成树不存在” <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$dist[V] = E_{&lt;s,V&gt;}$或 正无穷  </p><p>$parent[s] = -1$</p><p>$ T = O( |V|^2 )$</p><p><strong>稠密图合算</strong>  </p><h3 id="Kruskal算法-—-将森林合并成树"><a href="#Kruskal算法-—-将森林合并成树" class="headerlink" title="Kruskal算法 — 将森林合并成树"></a>Kruskal算法 — 将森林合并成树</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Kruskal</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MST <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>MST 中不到 <span class="token operator">|</span> V <span class="token operator">|</span> <span class="token operator">-</span> <span class="token number">1</span> 条边 <span class="token operator">&amp;&amp;</span> E 中还有边<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        从 E 中取一条权重最小的边 <span class="token function">E</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*最小堆*/</span>        将 <span class="token function">E</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> w<span class="token punctuation">)</span> 从 E 中删除<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> W<span class="token punctuation">)</span> 不在 MST 中构成回路<span class="token punctuation">)</span><span class="token comment">/*并查集*/</span>            将 <span class="token function">E</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> W<span class="token punctuation">)</span> 加入 MST<span class="token punctuation">;</span>        <span class="token keyword">else</span>            彻底无视 <span class="token function">E</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>MST 中不到 <span class="token operator">|</span> V <span class="token operator">|</span> <span class="token number">1</span> 条边<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span> “生成树不存在” <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$T = O( |E| log |E| )  $</p><h2 id="8-2-拓扑排序"><a href="#8-2-拓扑排序" class="headerlink" title="8.2 拓扑排序"></a>8.2 拓扑排序</h2><h3 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h3><p>拓扑序：如果图中从V到W有一条有向路径，则V一定排在W之前。满足此条件的顶点序列称为一个拓扑序</p><p>获得一个拓扑序的过程就是<strong>拓扑排序</strong></p><p>AOV如果有<strong>合理的</strong>拓扑序，则必定是<strong>有向无环图</strong>（Directed Acyclic Graph, DAG）  </p><h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">TopSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> cnt <span class="token operator">&lt;</span> <span class="token operator">|</span> V <span class="token operator">|</span> <span class="token punctuation">;</span> cnt<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> 未输出的入度为<span class="token number">0</span>的顶点<span class="token punctuation">;</span><span class="token comment">/*O(|V|)*/</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>这样的V不存在<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Error</span><span class="token punctuation">(</span> “图中有回路” <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        输出V，或者记录V的输出序号<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span> Indegree<span class="token punctuation">[</span>W<span class="token punctuation">]</span>––<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="聪明的算法"><a href="#聪明的算法" class="headerlink" title="聪明的算法"></a>聪明的算法</h3><p><strong>随时将入度变为0的顶点放到一个容器里</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">TopSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>图中每个顶点 V<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">Enqueue</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">Dequeue</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        输出V，或者记录V的输出序号<span class="token punctuation">;</span>        cnt<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span> ––Indegree<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">Enqueue</span><span class="token punctuation">(</span>W<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">!=</span> <span class="token operator">|</span> V <span class="token operator">|</span><span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span> “图中有回路” <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$T = O( |V| + |E| )  $</p><p>此算法可以用来检测有向图是否DAG  </p><h3 id="关键路径问题"><a href="#关键路径问题" class="headerlink" title="关键路径问题"></a>关键路径问题</h3><p>AOE （Activity On Edge） 网络  </p><p>一般用于安排项目的工序  </p><p>由<strong>绝对不允许延误</strong>的活动组成的路径  </p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* 邻接矩阵存储 - Prim最小生成树算法 */</span>Vertex <span class="token function">FindMinDist</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> WeightType dist<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 返回未被收录顶点中dist最小者 */</span>    Vertex MinV<span class="token punctuation">,</span> V<span class="token punctuation">;</span>    WeightType MinDist <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">&lt;</span> MinDist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 若V未被收录，且dist[V]更小 */</span>            MinDist <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 更新最小距离 */</span>            MinV <span class="token operator">=</span> V<span class="token punctuation">;</span>          <span class="token comment">/* 更新对应顶点 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>MinDist <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span> <span class="token comment">/* 若找到最小dist */</span>        <span class="token keyword">return</span> MinV<span class="token punctuation">;</span>        <span class="token comment">/* 返回对应的顶点下标 */</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span> <span class="token comment">/* 若这样的顶点不存在，返回-1作为标记 */</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Prim</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> LGraph MST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将最小生成树保存为邻接表存储的图MST，返回最小权重和 */</span>    WeightType dist<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> TotalWeight<span class="token punctuation">;</span>    Vertex parent<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    <span class="token keyword">int</span> VCount<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    <span class="token comment">/* 初始化。默认初始点下标是0 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 这里假设若V到W没有直接的边，则Graph->G[V][W]定义为INFINITY */</span>        dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        parent<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 暂且定义所有顶点的父结点都是初始点0 */</span>    <span class="token punctuation">&#125;</span>    TotalWeight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化权重和     */</span>    VCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">/* 初始化收录的顶点数 */</span>    <span class="token comment">/* 创建包含所有顶点但没有边的图。注意用邻接表版本 */</span>    MST <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立空的边结点 */</span>    <span class="token comment">/* 将初始点0收录进MST */</span>    dist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    VCount<span class="token operator">++</span><span class="token punctuation">;</span>    parent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 当前树根是0 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">FindMinDist</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> dist<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* V = 未被收录顶点中dist最小者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">==</span> ERROR<span class="token punctuation">)</span> <span class="token comment">/* 若这样的V不存在 */</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token comment">/* 算法结束 */</span>        <span class="token comment">/* 将V及相应的边&lt;parent[V], V>收录进MST */</span>        E<span class="token operator">-></span>V1 <span class="token operator">=</span> parent<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        E<span class="token operator">-></span>V2 <span class="token operator">=</span> V<span class="token punctuation">;</span>        E<span class="token operator">-></span>Weight <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MST<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        TotalWeight <span class="token operator">+=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        VCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">/* 若W是V的邻接点并且未被收录 */</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">/* 若收录V使得dist[W]变小 */</span>                    dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 更新dist[W] */</span>                    parent<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span>            <span class="token comment">/* 更新树 */</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>                       <span class="token comment">/* while结束*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>VCount <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span> <span class="token comment">/* MST中收的顶点不到|V|个 */</span>        TotalWeight <span class="token operator">=</span> ERROR<span class="token punctuation">;</span>    <span class="token keyword">return</span> TotalWeight<span class="token punctuation">;</span> <span class="token comment">/* 算法执行完毕，返回最小权重和或错误标记 */</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接表存储 - Kruskal最小生成树算法 */</span><span class="token comment">/*-------------------- 顶点并查集定义 --------------------*/</span><span class="token keyword">typedef</span> Vertex ElementType<span class="token punctuation">;</span> <span class="token comment">/* 默认元素可以用非负整数表示 */</span><span class="token keyword">typedef</span> Vertex SetName<span class="token punctuation">;</span>     <span class="token comment">/* 默认用根结点的下标作为集合名称 */</span><span class="token keyword">typedef</span> ElementType SetType<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 假设集合元素下标从0开始 */</span><span class="token keyword">void</span> <span class="token function">InitializeVSet</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 初始化并查集 */</span>    ElementType X<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>X <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> X <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> X<span class="token operator">++</span><span class="token punctuation">)</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Union</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> SetName Root1<span class="token punctuation">,</span> SetName Root2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 这里默认Root1和Root2是不同集合的根结点 */</span>    <span class="token comment">/* 保证小集合并入大集合 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 如果集合2比较大 */</span>        S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">+=</span> S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">/* 集合1并入集合2  */</span>        S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span> <span class="token operator">=</span> Root2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                  <span class="token comment">/* 如果集合1比较大 */</span>        S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span> <span class="token operator">+=</span> S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 集合2并入集合1  */</span>        S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">=</span> Root1<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>SetName <span class="token function">Find</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 默认集合元素全部初始化为-1 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>                        <span class="token comment">/* 找到集合的根 */</span>        <span class="token keyword">return</span> X<span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 路径压缩 */</span><span class="token punctuation">&#125;</span>bool <span class="token function">CheckCycle</span><span class="token punctuation">(</span>SetType VSet<span class="token punctuation">,</span> Vertex V1<span class="token punctuation">,</span> Vertex V2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 检查连接V1和V2的边是否在现有的最小生成树子集中构成回路 */</span>    Vertex Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">;</span>    Root1 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>VSet<span class="token punctuation">,</span> V1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 得到V1所属的连通集名称 */</span>    Root2 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>VSet<span class="token punctuation">,</span> V2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 得到V2所属的连通集名称 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Root1 <span class="token operator">==</span> Root2<span class="token punctuation">)</span> <span class="token comment">/* 若V1和V2已经连通，则该边不能要 */</span>        <span class="token keyword">return</span> false<span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 否则该边可以被收集，同时将V1和V2并入同一连通集 */</span>        <span class="token function">Union</span><span class="token punctuation">(</span>VSet<span class="token punctuation">,</span> Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> true<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/*-------------------- 并查集定义结束 --------------------*/</span><span class="token comment">/*-------------------- 边的最小堆定义 --------------------*/</span><span class="token keyword">void</span> <span class="token function">PercDown</span><span class="token punctuation">(</span>Edge ESet<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 改编代码4.24的PercDown( MaxHeap H, int p )    */</span>    <span class="token comment">/* 将N个元素的边数组中以ESet[p]为根的子堆调整为关于Weight的最小堆 */</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">,</span> Child<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">ENode</span> X<span class="token punctuation">;</span>    X <span class="token operator">=</span> ESet<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出根结点存放的值 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Parent <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token punctuation">(</span>Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> Parent <span class="token operator">=</span> Child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Child <span class="token operator">=</span> Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Child <span class="token operator">!=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ESet<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">.</span>Weight <span class="token operator">></span> ESet<span class="token punctuation">[</span>Child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Weight<span class="token punctuation">)</span><span class="token punctuation">)</span>            Child<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* Child指向左右子结点的较小者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X<span class="token punctuation">.</span>Weight <span class="token operator">&lt;=</span> ESet<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">.</span>Weight<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* 找到了合适位置 */</span>        <span class="token keyword">else</span>       <span class="token comment">/* 下滤X */</span>            ESet<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> ESet<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    ESet<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InitializeESet</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> Edge ESet<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将图的边存入数组ESet，并且初始化为最小堆 */</span>    Vertex V<span class="token punctuation">;</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    <span class="token keyword">int</span> ECount<span class="token punctuation">;</span>    <span class="token comment">/* 将图的边存入数组ESet */</span>    ECount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span> W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">&lt;</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 避免重复录入无向图的边，只收V1&lt;V2的边 */</span>                ESet<span class="token punctuation">[</span>ECount<span class="token punctuation">]</span><span class="token punctuation">.</span>V1 <span class="token operator">=</span> V<span class="token punctuation">;</span>                ESet<span class="token punctuation">[</span>ECount<span class="token punctuation">]</span><span class="token punctuation">.</span>V2 <span class="token operator">=</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">;</span>                ESet<span class="token punctuation">[</span>ECount<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Weight <span class="token operator">=</span> W<span class="token operator">-></span>Weight<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token comment">/* 初始化为最小堆 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ECount <span class="token operator">=</span> Graph<span class="token operator">-></span>Ne <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> ECount <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> ECount<span class="token operator">--</span><span class="token punctuation">)</span>        <span class="token function">PercDown</span><span class="token punctuation">(</span>ESet<span class="token punctuation">,</span> ECount<span class="token punctuation">,</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">GetEdge</span><span class="token punctuation">(</span>Edge ESet<span class="token punctuation">,</span> <span class="token keyword">int</span> CurrentSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 给定当前堆的大小CurrentSize，将当前最小边位置弹出并调整堆*/</span>    <span class="token comment">/* 将最小边与当前堆的最后一个位置的边交换 */</span>    <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ESet<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ESet<span class="token punctuation">[</span>CurrentSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 将剩下的边继续调整成最小堆 */</span>    <span class="token function">PercDown</span><span class="token punctuation">(</span>ESet<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> CurrentSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> CurrentSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 返回最小边所在位置 */</span><span class="token punctuation">&#125;</span><span class="token comment">/*-------------------- 最小堆定义结束 --------------------*/</span><span class="token keyword">int</span> <span class="token function">Kruskal</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> LGraph MST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将最小生成树保存为邻接表存储的图MST，返回最小权重和 */</span>    WeightType TotalWeight<span class="token punctuation">;</span>    <span class="token keyword">int</span> ECount<span class="token punctuation">,</span> NextEdge<span class="token punctuation">;</span>    SetType VSet<span class="token punctuation">;</span> <span class="token comment">/* 顶点数组 */</span>    Edge ESet<span class="token punctuation">;</span>    <span class="token comment">/* 边数组 */</span>    <span class="token function">InitializeVSet</span><span class="token punctuation">(</span>VSet<span class="token punctuation">,</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化顶点并查集 */</span>    ESet <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span> <span class="token operator">*</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">InitializeESet</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> ESet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化边的最小堆 */</span>    <span class="token comment">/* 创建包含所有顶点但没有边的图。注意用邻接表版本 */</span>    MST <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    TotalWeight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化权重和     */</span>    ECount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">/* 初始化收录的边数 */</span>    NextEdge <span class="token operator">=</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span>            <span class="token comment">/* 原始边集的规模 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ECount <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 当收集的边不足以构成树时 */</span>        NextEdge <span class="token operator">=</span> <span class="token function">GetEdge</span><span class="token punctuation">(</span>ESet<span class="token punctuation">,</span> NextEdge<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 从边集中得到最小边的位置 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>NextEdge <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>                   <span class="token comment">/* 边集已空 */</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token comment">/* 如果该边的加入不构成回路，即两端结点不属于同一连通集 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">CheckCycle</span><span class="token punctuation">(</span>VSet<span class="token punctuation">,</span> ESet<span class="token punctuation">[</span>NextEdge<span class="token punctuation">]</span><span class="token punctuation">.</span>V1<span class="token punctuation">,</span> ESet<span class="token punctuation">[</span>NextEdge<span class="token punctuation">]</span><span class="token punctuation">.</span>V2<span class="token punctuation">)</span> <span class="token operator">==</span> true<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 将该边插入MST */</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MST<span class="token punctuation">,</span> ESet <span class="token operator">+</span> NextEdge<span class="token punctuation">)</span><span class="token punctuation">;</span>            TotalWeight <span class="token operator">+=</span> ESet<span class="token punctuation">[</span>NextEdge<span class="token punctuation">]</span><span class="token punctuation">.</span>Weight<span class="token punctuation">;</span> <span class="token comment">/* 累计权重 */</span>            ECount<span class="token operator">++</span><span class="token punctuation">;</span>                             <span class="token comment">/* 生成树中边数加1 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ECount <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        TotalWeight <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 设置错误标记，表示生成树不存在 */</span>    <span class="token keyword">return</span> TotalWeight<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接表存储 - 拓扑排序算法 */</span>bool <span class="token function">TopSort</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> Vertex TopOrder<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 对Graph进行拓扑排序,TopOrder[]顺序存储排序后的顶点下标 */</span>    <span class="token keyword">int</span> Indegree<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> cnt<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    Queue Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化Indegree[] */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 遍历图，得到Indegree[] */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span> W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span>            Indegree<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* 对有向边&lt;V, W->AdjV>累计终点的入度 */</span>    <span class="token comment">/* 将所有入度为0的顶点入列 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 下面进入拓扑排序 */</span>    cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">/* 弹出一个入度为0的顶点 */</span>        TopOrder<span class="token punctuation">[</span>cnt<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span> <span class="token comment">/* 将之存为结果序列的下一个元素 */</span>        <span class="token comment">/* 对V的每个邻接点W->AdjV */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span> W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>Indegree<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 若删除V使得W->AdjV入度为0 */</span>                <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">/* 则该顶点入列 */</span>    <span class="token punctuation">&#125;</span>                                     <span class="token comment">/* while结束*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">!=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span>        <span class="token keyword">return</span> false<span class="token punctuation">;</span> <span class="token comment">/* 说明图中有回路, 返回不成功标志 */</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> true<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-公路村村通"><a href="#1-公路村村通" class="headerlink" title="1.公路村村通"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988056020271796224">1.公路村村通</a></h3><p>现有村落间道路的统计数据表中，列出了有可能建设成标准公路的若干条道路的成本，求使每个村落都有公路连通所需要的最低成本。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入数据包括城镇数目正整数$N(≤1000)$​和候选道路数目$M(≤3N)$；随后的<em>M</em>行对应<em>M</em>条道路，每行给出3个正整数，分别是该条道路直接连通的两个城镇的编号以及该道路改建的预算成本。为简单起见，城镇从1到<em>N</em>编号。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>输出村村通需要的最低成本。如果输入数据不足以保证畅通，则输出−1，表示需要建设更多公路。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">6 151 2 51 3 31 4 71 5 41 6 22 3 42 4 62 5 22 6 63 4 63 5 13 6 14 5 104 6 85 6 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">12<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>直白地最小生成树算法</p><p>这里考虑用邻接矩阵+Prim算法</p><p>然后，套模板时一定要注意数组下标！！！</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token comment">/* 图的邻接矩阵表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">1000</span> </span><span class="token comment">/* 最大顶点数设为1000 */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INFINITY</span> <span class="token expression"><span class="token number">65535</span>  </span><span class="token comment">/* ∞设为双字节无符号整数的最大值65535*/</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>     <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> WeightType<span class="token punctuation">;</span> <span class="token comment">/* 边的权值设为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span>  <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span>     <span class="token comment">/* 有向边&lt;V1, V2> */</span>    WeightType Weight<span class="token punctuation">;</span> <span class="token comment">/* 权重 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                                   <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>                                   <span class="token comment">/* 边数   */</span>    WeightType G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span><span class="token keyword">typedef</span> PtrToGNode LGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span>MGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接矩阵 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 若是无向图，还要插入边&lt;V2, V1> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span> <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点 权重"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">/* 注意：如果权重不是整型，Weight的读入格式要改 */</span>            <span class="token operator">--</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">--</span>E<span class="token operator">-></span>V2<span class="token punctuation">;</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接矩阵存储 - Prim最小生成树算法 */</span>Vertex <span class="token function">FindMinDist</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> WeightType dist<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 返回未被收录顶点中dist最小者 */</span>    Vertex MinV<span class="token punctuation">,</span> V<span class="token punctuation">;</span>    WeightType MinDist <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">&lt;</span> MinDist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 若V未被收录，且dist[V]更小 */</span>            MinDist <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 更新最小距离 */</span>            MinV <span class="token operator">=</span> V<span class="token punctuation">;</span>          <span class="token comment">/* 更新对应顶点 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>MinDist <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span> <span class="token comment">/* 若找到最小dist */</span>        <span class="token keyword">return</span> MinV<span class="token punctuation">;</span>        <span class="token comment">/* 返回对应的顶点下标 */</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span> <span class="token comment">/* 若这样的顶点不存在，返回-1作为标记 */</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Prim</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> LGraph MST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将最小生成树保存为邻接表存储的图MST，返回最小权重和 */</span>    WeightType dist<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> TotalWeight<span class="token punctuation">;</span>    Vertex parent<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    <span class="token keyword">int</span> VCount<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    <span class="token comment">/* 初始化。默认初始点下标是0 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 这里假设若V到W没有直接的边，则Graph->G[V][W]定义为INFINITY */</span>        dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        parent<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 暂且定义所有顶点的父结点都是初始点0 */</span>    <span class="token punctuation">&#125;</span>    TotalWeight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化权重和     */</span>    VCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">/* 初始化收录的顶点数 */</span>    <span class="token comment">/* 创建包含所有顶点但没有边的图。注意用邻接表版本 */</span>    MST <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立空的边结点 */</span>    <span class="token comment">/* 将初始点0收录进MST */</span>    dist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    VCount<span class="token operator">++</span><span class="token punctuation">;</span>    parent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 当前树根是0 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">FindMinDist</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> dist<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* V = 未被收录顶点中dist最小者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">==</span> ERROR<span class="token punctuation">)</span> <span class="token comment">/* 若这样的V不存在 */</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token comment">/* 算法结束 */</span>        <span class="token comment">/* 将V及相应的边&lt;parent[V], V>收录进MST */</span>        E<span class="token operator">-></span>V1 <span class="token operator">=</span> parent<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        E<span class="token operator">-></span>V2 <span class="token operator">=</span> V<span class="token punctuation">;</span>        E<span class="token operator">-></span>Weight <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MST<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        TotalWeight <span class="token operator">+=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        VCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">/* 若W是V的邻接点并且未被收录 */</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">/* 若收录V使得dist[W]变小 */</span>                    dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 更新dist[W] */</span>                    parent<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span>            <span class="token comment">/* 更新树 */</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>                       <span class="token comment">/* while结束*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>VCount <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span> <span class="token comment">/* MST中收的顶点不到|V|个 */</span>        TotalWeight <span class="token operator">=</span> ERROR<span class="token punctuation">;</span>    <span class="token keyword">return</span> TotalWeight<span class="token punctuation">;</span> <span class="token comment">/* 算法执行完毕，返回最小权重和或错误标记 */</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    LGraph MST<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token function">Prim</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> MST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>MST<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample换数字，各种回路判断</td><td>答案正确</td><td>15</td><td>4 ms</td><td>300 KB</td></tr><tr><td>1</td><td>M&lt;N-1，不可能有生成树</td><td>答案正确</td><td>2</td><td>2 ms</td><td>200 KB</td></tr><tr><td>2</td><td>M达到N-1，但是图不连通</td><td>答案正确</td><td>2</td><td>3 ms</td><td>300 KB</td></tr><tr><td>3</td><td>最大N和M，连通</td><td>答案正确</td><td>5</td><td>28 ms</td><td>8108 KB</td></tr><tr><td>4</td><td>最大N和M，不连通</td><td>答案正确</td><td>6</td><td>18 ms</td><td>7988 KB</td></tr></tbody></table><h3 id="2-How-Long-Does-It-Take"><a href="#2-How-Long-Does-It-Take" class="headerlink" title="2.How Long Does It Take"></a><a href="https://pintia.cn/problem-sets/16/problems/674">2.How Long Does It Take</a></h3><p>Given the relations of all the activities of a project, you are supposed to find the earliest completion time of the project.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. Each case starts with a line containing two positive integers $N (≤100)$, the number of activity check points (hence it is assumed that the check points are numbered from 0 to <em>N</em>−1), and <em>M</em>, the number of activities. Then <em>M</em> lines follow, each gives the description of an activity. For the <code>i</code>-th activity, three non-negative numbers are given: <code>S[i]</code>, <code>E[i]</code>, and <code>L[i]</code>, where <code>S[i]</code> is the index of the starting check point, <code>E[i]</code> of the ending check point, and <code>L[i]</code> the lasting time of the activity. The numbers in a line are separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, if the scheduling is possible, print in a line its earliest completion time; or simply output “Impossible”.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">9 120 1 60 2 40 3 51 4 12 4 13 5 25 4 04 6 94 7 75 7 46 8 27 8 4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">18<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 50 1 10 2 22 1 31 3 43 2 5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Impossible<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>拓扑排序的变形，输出最早完成时间，图如果存在回路，输出”Impossible”。注意细节。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">1000</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span>    <span class="token comment">/* 存储元素的数组 */</span>    Position Front<span class="token punctuation">,</span> Rear<span class="token punctuation">;</span> <span class="token comment">/* 队列的头、尾指针 */</span>    <span class="token keyword">int</span> MaxSize<span class="token punctuation">;</span>          <span class="token comment">/* 队列最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token operator">*</span>Queue<span class="token punctuation">;</span><span class="token keyword">int</span> time<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>Queue <span class="token function">CreateQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q <span class="token operator">=</span> <span class="token punctuation">(</span>Queue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>MaxSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>MaxSize <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsFull</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize <span class="token operator">==</span> Q<span class="token operator">-></span>Front<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsFull</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列满"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Rear<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">==</span> Q<span class="token operator">-></span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Front <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        <span class="token keyword">return</span> Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Front<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 图的邻接表表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>      <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> WeightType<span class="token punctuation">;</span>  <span class="token comment">/* 边的权值设为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span>   <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span>     <span class="token comment">/* 有向边&lt;V1, V2> */</span>    WeightType Weight<span class="token punctuation">;</span> <span class="token comment">/* 权重 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 邻接点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span> <span class="token operator">*</span>PtrToAdjVNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span> <span class="token punctuation">&#123;</span>    Vertex AdjV<span class="token punctuation">;</span>        <span class="token comment">/* 邻接点下标 */</span>    WeightType Weight<span class="token punctuation">;</span>  <span class="token comment">/* 边权重 */</span>    PtrToAdjVNode Next<span class="token punctuation">;</span> <span class="token comment">/* 指向下一个邻接点的指针 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* 顶点表头结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Vnode</span> <span class="token punctuation">&#123;</span>    PtrToAdjVNode FirstEdge<span class="token punctuation">;</span> <span class="token comment">/* 边表头指针 */</span>    DataType Data<span class="token punctuation">;</span>           <span class="token comment">/* 存顶点的数据 */</span>    <span class="token comment">/* 注意：很多情况下，顶点无数据，此时Data可以不用出现 */</span><span class="token punctuation">&#125;</span> AdjList<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* AdjList是邻接表类型 */</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>    <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>    <span class="token comment">/* 边数   */</span>    AdjList G<span class="token punctuation">;</span> <span class="token comment">/* 邻接表 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode LGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接表方式存储的图类型 */</span>LGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">;</span>    LGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>LGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接表头指针 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    PtrToAdjVNode NewNode<span class="token punctuation">;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    <span class="token comment">/* 为V2建立新的邻接点 */</span>    NewNode <span class="token operator">=</span> <span class="token punctuation">(</span>PtrToAdjVNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>AdjV <span class="token operator">=</span> E<span class="token operator">-></span>V2<span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>Weight <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 将V2插入V1的表头 */</span>    NewNode<span class="token operator">-></span>Next <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> NewNode<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>LGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    LGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点 权重"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">/* 注意：如果权重不是整型，Weight的读入格式要改 */</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接表存储 - 拓扑排序算法 */</span><span class="token keyword">int</span> <span class="token function">TopSort</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 对Graph进行拓扑排序,TopOrder[]顺序存储排序后的顶点下标 */</span>    <span class="token keyword">int</span> Indegree<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    Queue Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化Indegree[] */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 遍历图，得到Indegree[] */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span> W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span>            Indegree<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* 对有向边&lt;V, W->AdjV>累计终点的入度 */</span>    <span class="token comment">/* 将所有入度为0的顶点入列 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>            time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token comment">/* 下面进入拓扑排序 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 弹出一个入度为0的顶点 */</span>        <span class="token operator">++</span>cnt<span class="token punctuation">;</span>        W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">&lt;</span> time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> W<span class="token operator">-></span>Weight<span class="token punctuation">)</span> <span class="token comment">//计算最早完成时间</span>                time<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">=</span> time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> W<span class="token operator">-></span>Weight<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>Indegree<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">)</span><span class="token punctuation">;</span>            W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* while结束*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">!=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 说明图中有回路, 返回不成功标志 */</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">></span> ans<span class="token punctuation">)</span> ans <span class="token operator">=</span> time<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    LGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token function">TopSort</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ans<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Impossible"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 1 一般情况，有0边，单个起点和单个终点</td><td>答案正确</td><td>15</td><td>3 ms</td><td>188 KB</td></tr><tr><td>1</td><td>sample 2 有环</td><td>答案正确</td><td>2</td><td>3 ms</td><td>312 KB</td></tr><tr><td>2</td><td>多个起点和多个终点</td><td>答案正确</td><td>4</td><td>3 ms</td><td>320 KB</td></tr><tr><td>3</td><td>最大N，不可行</td><td>答案正确</td><td>2</td><td>4 ms</td><td>180 KB</td></tr><tr><td>4</td><td>最大N，可行</td><td>答案正确</td><td>2</td><td>3 ms</td><td>188 KB</td></tr></tbody></table><h3 id="3-关键活动"><a href="#3-关键活动" class="headerlink" title="3.关键活动"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988057428416819200">3.关键活动</a></h3><p>假定一个工程项目由一组子任务构成，子任务之间有的可以并行执行，有的必须在完成了其它一些子任务后才能执行。“任务调度”包括一组子任务、以及每个子任务可以执行所依赖的子任务集。</p><p>比如完成一个专业的所有课程学习和毕业设计可以看成一个本科生要完成的一项工程，各门课程可以看成是子任务。有些课程可以同时开设，比如英语和C程序设计，它们没有必须先修哪门的约束；有些课程则不可以同时开设，因为它们有先后的依赖关系，比如C程序设计和数据结构两门课，必须先学习前者。</p><p>但是需要注意的是，对一组子任务，并不是任意的任务调度都是一个可行的方案。比如方案中存在“子任务A依赖于子任务B，子任务B依赖于子任务C，子任务C又依赖于子任务A”，那么这三个任务哪个都不能先执行，这就是一个不可行的方案。</p><p>任务调度问题中，如果还给出了完成每个子任务需要的时间，则我们可以算出完成整个工程需要的最短时间。在这些子任务中，有些任务即使推迟几天完成，也不会影响全局的工期；但是有些任务必须准时完成，否则整个项目的工期就要因此延误，这种任务就叫“关键活动”。</p><p>请编写程序判定一个给定的工程项目的任务调度是否可行；如果该调度方案可行，则计算完成整个工程项目需要的最短时间，并输出所有的关键活动。</p><h4 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入第1行给出两个正整数$N(≤100)$和<em>M</em>，其中<em>N</em>是任务交接点（即衔接相互依赖的两个子任务的节点，例如：若任务2要在任务1完成后才开始，则两任务之间必有一个交接点）的数量。交接点按1-N编号，<em>M</em>是子任务的数量，依次编号为1~<em>M</em>。随后<em>M</em>行，每行给出了3个正整数，分别是该任务开始和完成涉及的交接点编号以及该任务所需的时间，整数间用空格分隔。</p><h4 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>如果任务调度不可行，则输出0；否则第1行输出完成整个工程项目需要的时间，第2行开始输出所有关键活动，每个关键活动占一行，按格式“V-&gt;W”输出，其中V和W为该任务开始和完成涉及的交接点编号。关键活动输出的顺序规则是：任务开始的交接点编号小者优先，起点编号相同时，与输入时任务的顺序相反。</p><h4 id="输入样例-1"><a href="#输入样例-1" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">7 81 2 41 3 32 4 53 4 34 5 14 6 65 7 56 7 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例-1"><a href="#输出样例-1" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">171-&gt;22-&gt;44-&gt;66-&gt;7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>在上一题的程序基础上增加一些内容即可，以下代码没有做任何优化。</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">1000</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span>    <span class="token comment">/* 存储元素的数组 */</span>    Position Front<span class="token punctuation">,</span> Rear<span class="token punctuation">;</span> <span class="token comment">/* 队列的头、尾指针 */</span>    <span class="token keyword">int</span> MaxSize<span class="token punctuation">;</span>          <span class="token comment">/* 队列最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token operator">*</span>Queue<span class="token punctuation">;</span><span class="token keyword">int</span> time<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> index<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos<span class="token punctuation">;</span>Queue <span class="token function">CreateQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q <span class="token operator">=</span> <span class="token punctuation">(</span>Queue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>MaxSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>MaxSize <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsFull</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize <span class="token operator">==</span> Q<span class="token operator">-></span>Front<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsFull</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列满"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Rear<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">==</span> Q<span class="token operator">-></span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Front <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        <span class="token keyword">return</span> Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Front<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 图的邻接表表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>      <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> WeightType<span class="token punctuation">;</span>  <span class="token comment">/* 边的权值设为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span>   <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span>     <span class="token comment">/* 有向边&lt;V1, V2> */</span>    WeightType Weight<span class="token punctuation">;</span> <span class="token comment">/* 权重 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 邻接点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span> <span class="token operator">*</span>PtrToAdjVNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span> <span class="token punctuation">&#123;</span>    Vertex AdjV<span class="token punctuation">;</span>        <span class="token comment">/* 邻接点下标 */</span>    WeightType Weight<span class="token punctuation">;</span>  <span class="token comment">/* 边权重 */</span>    PtrToAdjVNode Next<span class="token punctuation">;</span> <span class="token comment">/* 指向下一个邻接点的指针 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* 顶点表头结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Vnode</span> <span class="token punctuation">&#123;</span>    PtrToAdjVNode FirstEdge<span class="token punctuation">;</span> <span class="token comment">/* 边表头指针 */</span><span class="token punctuation">&#125;</span> AdjList<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment">/* AdjList是邻接表类型 */</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>    <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>    <span class="token comment">/* 边数   */</span>    AdjList G<span class="token punctuation">;</span> <span class="token comment">/* 邻接表 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode LGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接表方式存储的图类型 */</span>LGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">;</span>    LGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>LGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接表头指针 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    PtrToAdjVNode NewNode<span class="token punctuation">;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    <span class="token comment">/* 为V2建立新的邻接点 */</span>    NewNode <span class="token operator">=</span> <span class="token punctuation">(</span>PtrToAdjVNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>AdjV <span class="token operator">=</span> E<span class="token operator">-></span>V2<span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>Weight <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 将V2插入V1的表头 */</span>    NewNode<span class="token operator">-></span>Next <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> NewNode<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>LGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    LGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点 权重"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">/* 注意：如果权重不是整型，Weight的读入格式要改 */</span>            <span class="token operator">--</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">--</span>E<span class="token operator">-></span>V2<span class="token punctuation">;</span>            index<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">cmp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>V1 <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>V1<span class="token punctuation">)</span>        <span class="token keyword">return</span> index<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">&lt;</span>               index<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token operator">-></span>V1 <span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span>b<span class="token punctuation">)</span><span class="token operator">-></span>V1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接表存储 - 拓扑排序算法 */</span><span class="token keyword">int</span> <span class="token function">TopSort</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 对Graph进行拓扑排序,TopOrder[]顺序存储排序后的顶点下标 */</span>    <span class="token keyword">int</span> Indegree<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    Queue Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化Indegree[] */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 遍历图，得到Indegree[] */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span> W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span>            Indegree<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* 对有向边&lt;V, W->AdjV>累计终点的入度 */</span>    <span class="token comment">/* 将所有入度为0的顶点入列 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Indegree<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>            time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token comment">/* 下面进入拓扑排序 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 弹出一个入度为0的顶点 */</span>        <span class="token operator">++</span>cnt<span class="token punctuation">;</span>        W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">&lt;</span> time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> W<span class="token operator">-></span>Weight<span class="token punctuation">)</span> <span class="token comment">//计算最早完成时间</span>                time<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">=</span> time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> W<span class="token operator">-></span>Weight<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>Indegree<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">)</span><span class="token punctuation">;</span>            W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* while结束*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">!=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 说明图中有回路, 返回不成功标志 */</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">></span> ans<span class="token punctuation">)</span> pos <span class="token operator">=</span> V<span class="token punctuation">,</span> ans <span class="token operator">=</span> time<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> vis<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Queue Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    Edge edge <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span> <span class="token operator">*</span> MaxVertexNum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> time<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>W<span class="token operator">-></span>AdjV <span class="token operator">==</span> V<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>                W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">-</span> W<span class="token operator">-></span>Weight <span class="token operator">==</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    edge<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>V2 <span class="token operator">=</span> V<span class="token punctuation">;</span>                    edge<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>V1 <span class="token operator">=</span> i<span class="token punctuation">;</span>                    cnt<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>                        vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">qsort</span><span class="token punctuation">(</span>edge<span class="token punctuation">,</span> cnt<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cnt<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d->%d\n"</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    LGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token function">TopSort</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 4条简单路径选1</td><td>答案正确</td><td>15</td><td>4 ms</td><td>320 KB</td></tr><tr><td>1</td><td>单起点和单终点，2条关键路径</td><td>答案正确</td><td>3</td><td>5 ms</td><td>300 KB</td></tr><tr><td>2</td><td>多起点和多终点</td><td>答案正确</td><td>3</td><td>7 ms</td><td>316 KB</td></tr><tr><td>3</td><td>不可行</td><td>答案正确</td><td>1</td><td>26 ms</td><td>308 KB</td></tr><tr><td>4</td><td>最大N，简单回路不可行</td><td>答案正确</td><td>4</td><td>10 ms</td><td>568 KB</td></tr><tr><td>5</td><td>最大N，随机，可行</td><td>答案正确</td><td>4</td><td>4 ms</td><td>568 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week7</title>
      <link href="2021/080349708.html"/>
      <url>2021/080349708.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week7图（中）"><a href="#Week7图（中）" class="headerlink" title="Week7图（中）"></a>Week7图（中）</h1><h2 id="7-1-最短路径问题"><a href="#7-1-最短路径问题" class="headerlink" title="7.1 最短路径问题"></a>7.1 最短路径问题</h2><h3 id="最短路径问题的抽象"><a href="#最短路径问题的抽象" class="headerlink" title="最短路径问题的抽象"></a>最短路径问题的抽象</h3><p>在网络中，求两个不同顶点之间的所有路径中，边的权值之和最小的那一条路径</p><ul><li>这条路径就是两点之间的<strong>最短路径</strong>（ShortestPath）</li><li>第一个顶点为<strong>源点</strong>（Source）</li><li>最后一个顶点为<strong>终点</strong>（Destination）  </li></ul><h3 id="问题分类"><a href="#问题分类" class="headerlink" title="问题分类"></a>问题分类</h3><p><strong>单源</strong>最短路径问题：从某固定源点出发，求其到所有其他顶点的最短路径  </p><ul><li>（有向）无权图</li><li>（有向）有权图</li></ul><p><strong>多源</strong>最短路径问题：求任意两顶点间的最短路径。</p><h3 id="无权图的单源最短路算法"><a href="#无权图的单源最短路算法" class="headerlink" title="无权图的单源最短路算法"></a>无权图的单源最短路算法</h3><p>按照递增（非递减） 的顺序找出到各个顶点的最短路  </p><p><strong>BFS!</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Unweighted</span><span class="token punctuation">(</span>Vertex S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">Enqueue</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">Dequeue</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                path<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span>                <span class="token function">Enqueue</span><span class="token punctuation">(</span>W<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/*dist[W] = S到W的最短距离dist[S] = 0path[W] = S到W的路上经过的某顶*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="有权图的单源最短路算法"><a href="#有权图的单源最短路算法" class="headerlink" title="有权图的单源最短路算法"></a>有权图的单源最短路算法</h3><p>按照递增的顺序找出到各个顶点的最短路  </p><h4 id="Dijkstra-算法"><a href="#Dijkstra-算法" class="headerlink" title="Dijkstra 算法"></a>Dijkstra 算法</h4><p>令$S$={源点$s$ + 已经确定了最短路径的顶点$v_i$​}  </p><p>对任一未收录的顶点$v$，定义$dist[v]$为s到v的最短路径长度，但该路径<strong>仅经过S中的顶点</strong>。即路径<br>{$s\rightarrow(vi\in S)\rightarrow v$}的最小长度  </p><p>若路径是按照递增（非递减） 的顺序生成的，则  </p><ul><li>真正的最短路必须只经过S中的顶点（为什么？）  </li><li>反证:假设最短路经过$w($不属于S$)，s\rightarrow w \rightarrow v $为最短路，则$s\rightarrow w$比$s\rightarrow v$要短，而$v$​是下一个马上要收进去的顶点（真正的最短路），与之矛盾！             </li><li>每次从未收录的顶点中选一个$dist$最小的收录（贪心）</li><li>增加一个$v$进入$S$，可能影响另外一个$w$的$dist$值！（只影响邻接点）</li></ul><p>$dist[w] = min${$dist[w], dist[v] + &lt;v,w&gt;$ 的权重}​​</p><p>注意负值圈！</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Dijkstra</span><span class="token punctuation">(</span>Vertex s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> 未收录顶点中dist最小者<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>这样的V不存在<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        collected<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>collected<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">==</span> false<span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> E<span class="token operator">&lt;</span>V<span class="token punctuation">,</span> W<span class="token operator">></span> <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> E<span class="token operator">&lt;</span>V<span class="token punctuation">,</span> W<span class="token operator">></span><span class="token punctuation">;</span>                    path<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment">/* 不能解决有负边的情况 */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="找未收录顶点中dist最小者方法"><a href="#找未收录顶点中dist最小者方法" class="headerlink" title="找未收录顶点中dist最小者方法"></a>找未收录顶点中dist最小者方法</h4><p>方法1：直接扫描所有未收录顶点 $—— O( |V| )$</p><p>对稠密图效果较好</p><p>$T = O( |V|^2 + |E| )$</p><p>方法2：将$dist$​存在最小堆中 $ ——O( log|V| )$​​</p><p>对稀疏图效果较好</p><p>更新$dist[w]$的值 $—— O( log|V| )$​​</p><p>$T = O( |V| log|V| + |E| log|V| ) = O( |E| log|V| )$</p><h3 id="多源最短路算法"><a href="#多源最短路算法" class="headerlink" title="多源最短路算法"></a>多源最短路算法</h3><p>方法1：直接将单源最短路算法调用$|V|$遍</p><p>对稠密图效果较好</p><p>$T = O( |V|^3 + |E|\times|V|)$​</p><p>方法2：Floyd算法</p><p>对于稀疏图效果好 </p><p>$T = O( |V|^3 )$​</p><h4 id="Floyd-算法"><a href="#Floyd-算法" class="headerlink" title="Floyd 算法"></a>Floyd 算法</h4><p>$D^k[i][j] =$​ 路径$\{ i \rightarrow \{ l \leq k \} \rightarrow j \}$​​的最小长度</p><p>$D^0, D^1, …, D^{|V|-1}[i][j]$即给出了$i$到$j$的真正最短距离</p><p>最初的$D^{-1}$是开始的邻接矩阵</p><p>当$D^{k-1}$已经完成，递推到$D^k$时：</p><p>或者$k \notin$最短路径$\{ i \rightarrow \{ l\leq k \} \rightarrow j \}$，则$D^k = D^{k-1}$</p><p>或者$k \in$ 最短路径$\{ i \rightarrow \{ l \leq k \} \rightarrow j \}$，则该路径必定由两段最短路径组成:$D^k[i][j]=D^{k-1}[i][k]+D^{k-1}[k][j]    $​​</p><p>细节上，邻接矩阵无边处打成无穷。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Floyd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> D<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    D<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> D<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                    path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* 邻接表存储 - 无权图的单源最短路算法 */</span><span class="token comment">/* dist[]和path[]全部初始化为-1 */</span><span class="token keyword">void</span> <span class="token function">Unweighted</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> <span class="token keyword">int</span> dist<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> path<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Vertex S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建空队列, MaxSize为外部定义的常数 */</span>    dist<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token comment">/* 初始化源点 */</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span>             W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span>                    <span class="token comment">/* 对V的每个邻接点W->AdjV */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token comment">/* 若W->AdjV未被访问过 */</span>                dist<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* W->AdjV到S的距离更新 */</span>                path<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span> <span class="token comment">/* 将V记录在S到W->AdjV的路径上 */</span>                <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* while结束*/</span><span class="token punctuation">&#125;</span>Vertex <span class="token function">FindMinDist</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span>                   <span class="token keyword">int</span> dist<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                   <span class="token keyword">int</span> collected<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 返回未被收录顶点中dist最小者 */</span>    Vertex MinV<span class="token punctuation">,</span> V<span class="token punctuation">;</span>    <span class="token keyword">int</span> MinDist <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>collected<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">==</span> false <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">&lt;</span> MinDist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 若V未被收录，且dist[V]更小 */</span>            MinDist <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 更新最小距离 */</span>            MinV <span class="token operator">=</span> V<span class="token punctuation">;</span>          <span class="token comment">/* 更新对应顶点 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>MinDist <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span> <span class="token comment">/* 若找到最小dist */</span>        <span class="token keyword">return</span> MinV<span class="token punctuation">;</span>        <span class="token comment">/* 返回对应的顶点下标 */</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span> <span class="token comment">/* 若这样的顶点不存在，返回错误标记 */</span><span class="token punctuation">&#125;</span>bool <span class="token function">Dijkstra</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> <span class="token keyword">int</span> dist<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> path<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Vertex S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> collected<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    <span class="token comment">/* 初始化：此处默认邻接矩阵中不存在的边用INFINITY表示 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span>            path<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">;</span>        <span class="token keyword">else</span>            path<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        collected<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> false<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 先将起点收入集合 */</span>    dist<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    collected<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* V = 未被收录顶点中dist最小者 */</span>        V <span class="token operator">=</span> <span class="token function">FindMinDist</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> dist<span class="token punctuation">,</span> collected<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">==</span> ERROR<span class="token punctuation">)</span>                 <span class="token comment">/* 若这样的V不存在 */</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>                      <span class="token comment">/* 算法结束 */</span>        collected<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span>            <span class="token comment">/* 收录V */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>            <span class="token comment">/* 若W是V的邻接点并且未被收录 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>collected<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">==</span> false <span class="token operator">&amp;&amp;</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 若有负边 */</span>                    <span class="token keyword">return</span> false<span class="token punctuation">;</span> <span class="token comment">/* 不能正确解决，返回错误标记 */</span>                <span class="token comment">/* 若收录V使得dist[W]变小 */</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    dist<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> dist<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">+</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 更新dist[W] */</span>                    path<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span> <span class="token comment">/* 更新S到W的路径 */</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>            <span class="token comment">/* while结束*/</span>    <span class="token keyword">return</span> true<span class="token punctuation">;</span> <span class="token comment">/* 算法执行完毕，返回正确标记 */</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接矩阵存储 - 多源最短路算法 */</span>bool <span class="token function">Floyd</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span>           WeightType D<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span>           Vertex path<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Vertex i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span>    <span class="token comment">/* 初始化 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> D<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> D<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> j <span class="token operator">&amp;&amp;</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 若发现负值圈 */</span>                        <span class="token keyword">return</span> false<span class="token punctuation">;</span> <span class="token comment">/* 不能正确解决，返回错误标记 */</span>                    path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> k<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> true<span class="token punctuation">;</span> <span class="token comment">/* 算法执行完毕，返回正确标记 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-哈利·波特的考试"><a href="#1-哈利·波特的考试" class="headerlink" title="1.哈利·波特的考试"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988055970443194368">1.哈利·波特的考试</a></h3><p>哈利·波特要考试了，他需要你的帮助。这门课学的是用魔咒将一种动物变成另一种动物的本事。例如将猫变成老鼠的魔咒是haha，将老鼠变成鱼的魔咒是hehe等等。反方向变化的魔咒就是简单地将原来的魔咒倒过来念，例如ahah可以将老鼠变成猫。另外，如果想把猫变成鱼，可以通过念一个直接魔咒lalala，也可以将猫变老鼠、老鼠变鱼的魔咒连起来念：hahahehe。</p><p>现在哈利·波特的手里有一本教材，里面列出了所有的变形魔咒和能变的动物。老师允许他自己带一只动物去考场，要考察他把这只动物变成任意一只指定动物的本事。于是他来问你：带什么动物去可以让最难变的那种动物（即该动物变为哈利·波特自己带去的动物所需要的魔咒最长）需要的魔咒最短？例如：如果只有猫、鼠、鱼，则显然哈利·波特应该带鼠去，因为鼠变成另外两种动物都只需要念4个字符；而如果带猫去，则至少需要念6个字符才能把猫变成鱼；同理，带鱼去也不是最好的选择。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入说明：输入第1行给出两个正整数<em>N</em> (≤100)和<em>M</em>，其中<em>N</em>是考试涉及的动物总数，<em>M</em>是用于直接变形的魔咒条数。为简单起见，我们将动物按1~<em>N</em>编号。随后<em>M</em>行，每行给出了3个正整数，分别是两种动物的编号、以及它们之间变形需要的魔咒的长度(≤100)，数字之间用空格分隔。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>输出哈利·波特应该带去考场的动物的编号、以及最长的变形魔咒的长度，中间以空格分隔。如果只带1只动物是不可能完成所有变形要求的，则输出0。如果有若干只动物都可以备选，则输出编号最小的那只。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">6 113 4 701 2 15 4 502 6 505 6 601 3 704 6 603 6 805 1 1002 4 605 2 80<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">4 70<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>一句话概括本题就是多源最短路径问题，利用Floyd算法即可（邻接矩阵存储）。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INFINITY</span> <span class="token expression"><span class="token number">65535</span>   </span><span class="token comment">/* ∞设为双字节无符号整数的最大值65535*/</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>      <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> WeightType<span class="token punctuation">;</span>  <span class="token comment">/* 边的权值设为整型 */</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span>     <span class="token comment">/* 有向边&lt;V1, V2> */</span>    WeightType Weight<span class="token punctuation">;</span> <span class="token comment">/* 权重 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                                   <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>                                   <span class="token comment">/* 边数 */</span>    WeightType G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span>MGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接矩阵 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 若是无向图，还要插入边&lt;V2, V1> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span> <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点 权重"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>            E<span class="token operator">-></span>V1<span class="token operator">--</span><span class="token punctuation">;</span>            E<span class="token operator">-></span>V2<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">/*编号从0开始*/</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Floyd</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> WeightType D<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Vertex i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span>    <span class="token comment">/* 初始化 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> D<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">!=</span> j<span class="token punctuation">)</span>                    D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> D<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>WeightType <span class="token function">FindMaxDist</span><span class="token punctuation">(</span>WeightType D<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> Vertex i<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    WeightType MaxDist<span class="token punctuation">;</span>    Vertex j<span class="token punctuation">;</span>    MaxDist <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 找出i到其他动物j的最长距离 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> j <span class="token operator">&amp;&amp;</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> MaxDist<span class="token punctuation">)</span> MaxDist <span class="token operator">=</span> D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> MaxDist<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">FindAnimal</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    WeightType D<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">,</span> MaxDist<span class="token punctuation">,</span> MinDist<span class="token punctuation">;</span>    Vertex Animal<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">Floyd</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">;</span>    MinDist <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        MaxDist <span class="token operator">=</span> <span class="token function">FindMaxDist</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span> i<span class="token punctuation">,</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>MaxDist <span class="token operator">==</span> INFINITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 说明有从i无法变出的动物 */</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>MinDist <span class="token operator">></span> MaxDist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 找到最长距离更小的动物 */</span>            MinDist <span class="token operator">=</span> MaxDist<span class="token punctuation">;</span>            Animal <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 更新距离，记录编号 */</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> Animal<span class="token punctuation">,</span> MinDist<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph G <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FindAnimal</span><span class="token punctuation">(</span>G<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample换数字，只有唯一解</td><td>答案正确</td><td>12</td><td>4 ms</td><td>296 KB</td></tr><tr><td>1</td><td>无解</td><td>答案正确</td><td>1</td><td>4 ms</td><td>188 KB</td></tr><tr><td>2</td><td>最大N的等边长环，解不唯一，输出最小编号</td><td>答案正确</td><td>4</td><td>6 ms</td><td>308 KB</td></tr><tr><td>3</td><td>最大N，最大M，随机完全图</td><td>答案正确</td><td>8</td><td>9 ms</td><td>300 KB</td></tr></tbody></table><h3 id="2-Saving-James-Bond-Hard-Version"><a href="#2-Saving-James-Bond-Hard-Version" class="headerlink" title="2.Saving James Bond - Hard Version"></a><a href="https://pintia.cn/problem-sets/16/problems/673">2.Saving James Bond - Hard Version</a></h3><p>This time let us consider the situation in the movie “Live and Let Die” in which James Bond, the world’s most famous spy, was captured by a group of drug dealers. He was sent to a small piece of land at the center of a lake filled with crocodiles. There he performed the most daring action to escape – he jumped onto the head of the nearest crocodile! Before the animal realized what was happening, James jumped again onto the next big head… Finally he reached the bank before the last crocodile could bite him (actually the stunt man was caught by the big mouth and barely escaped with his extra thick boot).</p><p>Assume that the lake is a 100 by 100 square one. Assume that the center of the lake is at $(0,0)$ and the northeast corner at$ (50,50)$. The central island is a disk centered at$(0,0)$ with the diameter of 15. A number of crocodiles are in the lake at various positions. Given the coordinates of each crocodile and the distance that James could jump, you must tell him a shortest path to reach one of the banks. The length of a path is the number of jumps that James has to make.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. Each case starts with a line containing two positive integers $N (≤100)$, the number of crocodiles, and <em>D</em>, the maximum distance that James could jump. Then <em>N</em> lines follow, each containing the $(x,y)$ location of a crocodile. Note that no two crocodiles are staying at the same position.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, if James can escape, output in one line the minimum number of jumps he must make. Then starting from the next line, output the position$ (x,y)$ of each crocodile on the path, each pair in one line, from the island to the bank. If it is impossible for James to escape that way, simply give him 0 as the number of jumps. If there are many shortest paths, just output the one with the minimum first jump, which is guaranteed to be unique.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">17 1510 -2110 21-40 1030 -5020 4035 100 -10-25 2240 -40-30 30-10 220 1125 2125 1010 1010 35-30 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">40 1110 2110 35<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 13-12 1212 12-12 -1212 -12<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>好人做到底，如果能跳出，输出需要几跳以及鳄鱼坐标。这题必须用BFS！同时看测试点的提示会发现坑点不少！需要组织好逻辑。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">1001</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span>    <span class="token comment">/* 存储元素的数组 */</span>    Position Front<span class="token punctuation">,</span> Rear<span class="token punctuation">;</span> <span class="token comment">/* 队列的头、尾指针 */</span>    <span class="token keyword">int</span> MaxSize<span class="token punctuation">;</span>          <span class="token comment">/* 队列最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token operator">*</span>Queue<span class="token punctuation">;</span>Queue <span class="token function">CreateQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q <span class="token operator">=</span> <span class="token punctuation">(</span>Queue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>MaxSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>MaxSize <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Rear<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">==</span> Q<span class="token operator">-></span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Front<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> D<span class="token punctuation">;</span> <span class="token comment">// 跳跃距离</span><span class="token keyword">const</span> <span class="token keyword">double</span> first_D <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span><span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Stack<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pre<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ans_jump <span class="token operator">=</span> <span class="token number">65536</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> first<span class="token punctuation">,</span> visit<span class="token punctuation">,</span> safe<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                      <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">struct</span> <span class="token class-name">Node</span> G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span><span class="token comment">// 距离</span><span class="token keyword">int</span> <span class="token function">Distance</span><span class="token punctuation">(</span><span class="token keyword">int</span> x1<span class="token punctuation">,</span> <span class="token keyword">int</span> y1<span class="token punctuation">,</span> <span class="token keyword">int</span> x2<span class="token punctuation">,</span> <span class="token keyword">int</span> y2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> y2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> y2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//能否到岸边</span><span class="token keyword">int</span> <span class="token function">Is_shore</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 分别计算当前结点与岸边的距离</span>    <span class="token comment">// 即与 (x,50),(x,-50),(50,y),(-50,y) 的距离</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">||</span> <span class="token function">abs</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">||</span> <span class="token function">abs</span><span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">||</span>        <span class="token function">abs</span><span class="token punctuation">(</span>y <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//是否安全("能上岸")</span><span class="token keyword">void</span> <span class="token function">Init_Safe</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 如果该鳄鱼能到岸边</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Is_shore</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>safe <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>safe <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//可以第一步跳上去</span><span class="token keyword">void</span> <span class="token function">Init_first</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 如果该鳄鱼位置和"湖中心"相邻（跳跃距离+半径）</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span>                <span class="token punctuation">(</span>D <span class="token operator">+</span> first_D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>D <span class="token operator">+</span> first_D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>            <span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span>                first_D <span class="token operator">*</span> first_D <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">/* 读入顶点个数 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 读入直径 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>        Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">Init_Safe</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Init_first</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">BFS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q<span class="token punctuation">;</span>    <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">,</span> last <span class="token operator">=</span> v<span class="token punctuation">,</span> tail<span class="token punctuation">,</span> first<span class="token punctuation">;</span>    Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>MAXSIZE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建空队列, MaxSize为外部定义的常数 */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    first <span class="token operator">=</span> v<span class="token punctuation">;</span>    pre<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">/* 弹出V */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 未跳过，且能跳上</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">&amp;&amp;</span>                <span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>                         Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">*</span> D<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">;</span>                pre<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> V<span class="token punctuation">;</span>                tail <span class="token operator">=</span> W<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">.</span>safe<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    ans <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> ans_jump <span class="token operator">||</span>                        cnt <span class="token operator">==</span> ans_jump <span class="token operator">&amp;&amp;</span>                        <span class="token punctuation">(</span><span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span>                          <span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">int</span> cnt1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cnt2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                        <span class="token keyword">while</span> <span class="token punctuation">(</span>W <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            Stack<span class="token punctuation">[</span>cnt1<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> W<span class="token punctuation">;</span>                            W <span class="token operator">=</span> pre<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt1<span class="token punctuation">)</span> index<span class="token punctuation">[</span>cnt2<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> Stack<span class="token punctuation">[</span><span class="token operator">--</span>cnt1<span class="token punctuation">]</span><span class="token punctuation">;</span>                        ans_jump <span class="token operator">=</span> cnt<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">return</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">==</span> last<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token operator">++</span>cnt<span class="token punctuation">;</span>            last <span class="token operator">=</span> tail<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Save007</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Is_shore</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> v<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> w <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> w <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> w<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token function">BFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> ans_jump <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ans_jump <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>index<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">></span>G<span class="token punctuation">[</span>index<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Save007</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample1 多条最短路，同一点有多路，最近点无路，多连通</td><td>答案正确</td><td>15</td><td>4 ms</td><td>184 KB</td></tr><tr><td>1</td><td>sample 2 聚集型，均离岸远</td><td>答案正确</td><td>3</td><td>3 ms</td><td>192 KB</td></tr><tr><td>2</td><td>分散型，均跳不到，有在角上</td><td>答案正确</td><td>2</td><td>10 ms</td><td>188 KB</td></tr><tr><td>3</td><td>有一只在岸上，有一只在岛上，不能算在内</td><td>答案正确</td><td>3</td><td>4 ms</td><td>172 KB</td></tr><tr><td>4</td><td>最大N，sample1的复杂版，可选路径8条，后面要更新前面的最短路</td><td>答案正确</td><td>6</td><td>6 ms</td><td>192 KB</td></tr><tr><td>5</td><td>最小N，一步跳到岸</td><td>答案正确</td><td>1</td><td>4 ms</td><td>184 KB</td></tr></tbody></table><h3 id="3-旅游规划"><a href="#3-旅游规划" class="headerlink" title="3.旅游规划"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988055915007348736">3.旅游规划</a></h3><p>有了一张自驾旅游路线图，你会知道城市间的高速公路长度、以及该公路要收取的过路费。现在需要你写一个程序，帮助前来咨询的游客找一条出发地和目的地之间的最短路径。如果有若干条路径都是最短的，那么需要输出最便宜的一条路径。</p><h4 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入说明：输入数据的第1行给出4个正整数<em>N</em>、<em>M</em>、<em>S</em>、<em>D</em>，其中$N(2≤N≤500)$​是城市的个数，顺便假设城市的编号为$0-(N−1)$​​；<em>M</em>是高速公路的条数；<em>S</em>是出发地的城市编号；<em>D</em>是目的地的城市编号。随后的<em>M</em>行中，每行给出一条高速公路的信息，分别是：城市1、城市2、高速公路长度、收费额，中间用空格分开，数字均为整数且不超过500。输入保证解的存在。</p><h4 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>在一行里输出路径的长度和收费总额，数字间以空格分隔，输出结尾不能有多余空格。</p><h4 id="输入样例-1"><a href="#输入样例-1" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 5 0 30 1 1 201 3 2 300 3 4 100 2 2 202 3 1 20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例-1"><a href="#输出样例-1" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">3 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>Dijkstra算法变形，简单修改即可。这里图省事，就不套模板建图了（doge）。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">505</span></span></span><span class="token keyword">const</span> <span class="token keyword">int</span> inf <span class="token operator">=</span> <span class="token number">0x7FFFFFF</span><span class="token punctuation">;</span><span class="token keyword">int</span> N<span class="token punctuation">,</span> M<span class="token punctuation">,</span> S<span class="token punctuation">,</span> D<span class="token punctuation">;</span><span class="token keyword">int</span> dist<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> Cost<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> length<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span>    money<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> visited<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    visited<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> Min <span class="token operator">=</span> inf<span class="token punctuation">,</span> k<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> Min<span class="token punctuation">)</span> Min <span class="token operator">=</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> k <span class="token operator">=</span> i<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Min <span class="token operator">==</span> inf<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>        visited<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> dist<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> length<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dist<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> length<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                Cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Cost<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> money<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> dist<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> length<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>                       Cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> Cost<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> money<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                Cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Cost<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> money<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">,</span> <span class="token operator">&amp;</span>M<span class="token punctuation">,</span> <span class="token operator">&amp;</span>S<span class="token punctuation">,</span> <span class="token operator">&amp;</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> length<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> money<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> inf<span class="token punctuation">;</span>    <span class="token keyword">int</span> city1<span class="token punctuation">,</span> city2<span class="token punctuation">,</span> len<span class="token punctuation">,</span> cost<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>M<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>city1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>city2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>len<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cost<span class="token punctuation">)</span><span class="token punctuation">;</span>        length<span class="token punctuation">[</span>city1<span class="token punctuation">]</span><span class="token punctuation">[</span>city2<span class="token punctuation">]</span> <span class="token operator">=</span> length<span class="token punctuation">[</span>city2<span class="token punctuation">]</span><span class="token punctuation">[</span>city1<span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">;</span>        money<span class="token punctuation">[</span>city1<span class="token punctuation">]</span><span class="token punctuation">[</span>city2<span class="token punctuation">]</span> <span class="token operator">=</span> money<span class="token punctuation">[</span>city2<span class="token punctuation">]</span><span class="token punctuation">[</span>city1<span class="token punctuation">]</span> <span class="token operator">=</span> cost<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> dist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> length<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> Cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> money<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    dist<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> Cost<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> dist<span class="token punctuation">[</span>D<span class="token punctuation">]</span><span class="token punctuation">,</span> Cost<span class="token punctuation">[</span>D<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 最便宜的路不是最短路；输出2条最短路中最便宜的</td><td>答案正确</td><td>12</td><td>5 ms</td><td>184 KB</td></tr><tr><td>1</td><td>最小N和M</td><td>答案正确</td><td>5</td><td>4 ms</td><td>348 KB</td></tr><tr><td>2</td><td>最大N，有多条等长等价的道路</td><td>答案正确</td><td>4</td><td>6 ms</td><td>2236 KB</td></tr><tr><td>3</td><td>最大N和M, 随机完全图</td><td>答案正确</td><td>4</td><td>46 ms</td><td>2240 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week6</title>
      <link href="2021/0802749.html"/>
      <url>2021/0802749.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week6图（上）"><a href="#Week6图（上）" class="headerlink" title="Week6图（上）"></a>Week6图（上）</h1><h2 id="6-1-什么是图"><a href="#6-1-什么是图" class="headerlink" title="6.1 什么是图"></a>6.1 什么是图</h2><h3 id="什么是“图”（Graph）"><a href="#什么是“图”（Graph）" class="headerlink" title="什么是“图”（Graph）"></a>什么是“图”（Graph）</h3><p>表示“多对多”的关系</p><p>包含</p><p>一组顶点：通常用 $V (Vertex)$ 表示顶点集合</p><p>一组边：通常用 $E (Edge)$ 表示边的集合</p><ul><li>边是顶点对： $(v, w) \in E $，其中 $v, w \in V$</li><li>有向边 $&lt; v, w&gt;$ 表示从v指向w的边  </li><li>不考虑重边和自回路  </li></ul><h3 id="抽象数据类型定义"><a href="#抽象数据类型定义" class="headerlink" title="抽象数据类型定义"></a>抽象数据类型定义</h3><p>类型名称： 图（Graph）</p><p>数据对象集：$ G(V,E)$由一个非空的有限顶点集合$V$和一个有限边集合$E$组成。</p><p>操作集： 对于任意图$ G \in Graph$，以及 $v \in V, e \in E$  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Graph <span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//建立并返回空图；</span>Graph <span class="token function">InsertVertex</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">,</span> Vertex v<span class="token punctuation">)</span><span class="token comment">//将v插入G；</span>Graph <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">,</span> Edge e<span class="token punctuation">)</span><span class="token comment">//将e插入G；</span><span class="token keyword">void</span> <span class="token function">DFS</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">,</span> Vertex v<span class="token punctuation">)</span><span class="token comment">//从顶点v出发深度优先遍历图G；</span><span class="token keyword">void</span> <span class="token function">BFS</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">,</span> Vertex v<span class="token punctuation">)</span><span class="token comment">//从顶点v出发宽度优先遍历图G；</span><span class="token keyword">void</span> <span class="token function">ShortestPath</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">,</span> Vertex v<span class="token punctuation">,</span> <span class="token keyword">int</span> Dist<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">//计算图G中顶点v到任意其他顶点的最短距离；</span><span class="token keyword">void</span> <span class="token function">MST</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">)</span><span class="token comment">//计算图G的最小生成树；</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="常见术语"><a href="#常见术语" class="headerlink" title="常见术语"></a>常见术语</h3><p>无向图 ，有向图，网络$\cdots$</p><h3 id="怎么在程序中表示一个图"><a href="#怎么在程序中表示一个图" class="headerlink" title="怎么在程序中表示一个图"></a>怎么在程序中表示一个图</h3><p>邻接矩阵$G[N][N]——N$个顶点从0到$N-1$编号<br>$$<br>G[i][j]=\left\{<br>    \begin{aligned}<br>        &amp; 1   &amp; &lt;v_i,v_j&gt; \in E \newline<br>        &amp; 0   &amp; &lt;v_i,v_j&gt; \notin E<br>    \end{aligned}<br>\right.<br>$$</p><h4 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h4><p>问题：对于无向图的存储，怎样可以省一半空间？  </p><p>用一个长度为$N(N+1)/2$​​​​​​的1维数组A存储$\{G_{00},G_{10},G_{11},……,G_{n-1\ 0},…,G_{n-1\ n-1}\}$​​​​​​，则$G_{ij}$​​在A中对应的下标是：$( i\times(i+1)/2 + j )$​​</p><p>对于网络，只要把$G[i][j]$的值定义为边$&lt;v_i,v_j&gt;$的权重即可。</p><p>问题：$ v_i$和$v_j$之间若没有边该怎么表示？  </p><p><strong>邻接矩阵 —— 有什么好处？</strong>  </p><ul><li>直观、简单、好理解  </li><li>方便检查任意一对顶点间是否存在边  </li><li>方便找任一顶点的所有“邻接点”（有边直接相连的顶点）  </li><li>方便计算任一顶点的“度”（从该点发出的边数为“出度”，指向该点的边数为“入度”）  </li></ul><p>无向图：对应行（或列）非0元素的个数  </p><p>有向图：对应行非0元素的个数是“出度”；对应列非0元素的个数是“入度”  </p><p><strong>邻接矩阵 —— 有什么不好？</strong>  </p><ul><li>浪费空间 —— 存稀疏图（点很多而边很少）有大量无效元素。对稠密图（特别是完全图）还是很合算的  </li><li>浪费时间 —— 统计稀疏图中一共有多少条边  </li></ul><p>邻接表： $G[N]$为指针数组，对应矩阵每行一个链表，只存非0元素  </p><p>对于<strong>网络</strong>，结构中要增加权重的域。  </p><p>一定要够稀疏才合算啊！！！</p><h4 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h4><p><strong>方便找任一顶点的所有“邻接点”</strong></p><p><strong>节约稀疏图的空间</strong></p><p>需要N个头指针 + 2E个结点（每个结点至少2个域）</p><p><strong>方便计算任一顶点的“度”？</strong></p><p>对无向图：是的</p><p>对有向图：只能计算“出度”；需要构造“逆邻接表”（存指向自己的边）来方便计算“入度”</p><p><strong>方便检查任意一对顶点间是否存在边？</strong>  No！</p><h2 id="6-2-图的遍历"><a href="#6-2-图的遍历" class="headerlink" title="6.2 图的遍历"></a>6.2 图的遍历</h2><h3 id="深度优先搜索（Depth-First-Search-DFS）"><a href="#深度优先搜索（Depth-First-Search-DFS）" class="headerlink" title="深度优先搜索（Depth First Search, DFS）"></a>深度优先搜索（Depth First Search, DFS）</h3><p>类似于树的<strong>先序</strong>遍历  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">DFS</span><span class="token punctuation">(</span>Vertex V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    visited<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">DFS</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>若有$N$个顶点、 $E$条边，时间复杂度是  </p><ul><li>用邻接表存储图，有$O(N+E)$</li><li>用邻接矩阵存储图，有$O(N^2)$  </li></ul><h3 id="广度优先搜索（Breadth-First-Search-BFS）"><a href="#广度优先搜索（Breadth-First-Search-BFS）" class="headerlink" title="广度优先搜索（Breadth First Search, BFS）"></a>广度优先搜索（Breadth First Search, BFS）</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">BFS</span><span class="token punctuation">(</span>Vertex V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    visited<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span>    <span class="token function">Enqueue</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">Dequeue</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>V 的每个邻接点 W<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span>                <span class="token function">Enqueue</span><span class="token punctuation">(</span>W<span class="token punctuation">,</span> Q<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>若有$N$个顶点、 $E$条边，时间复杂度是  </p><ul><li>用邻接表存储图，有$O(N+E)$</li><li>用邻接矩阵存储图，有$O(N^2)$​  </li></ul><h3 id="为什么需要两种遍历？"><a href="#为什么需要两种遍历？" class="headerlink" title="为什么需要两种遍历？"></a>为什么需要两种遍历？</h3><p>不同情况下各有优势。</p><h3 id="图不连通怎么办？"><a href="#图不连通怎么办？" class="headerlink" title="图不连通怎么办？"></a>图不连通怎么办？</h3><ul><li>连通：如果从V到W存在一条（无向） 路径，则称V和W是连通的</li><li><strong>路径</strong>： V到W的路径是一系列顶点$\{V, v_1, v_2, …,v_n, W\}$​的集合，其中任一对相邻的顶点间都有图中的边。 <strong>路径的长度</strong>是路径中的边数（如果带权，则是所有边的权重和）。如果$V$到$W$之间的所有顶点都不同，则称<strong>简单路径</strong></li><li><strong>回路</strong>：起点等于终点的路径</li><li><strong>连通图</strong>：图中任意两顶点均连通  </li></ul><p><strong>连通分量</strong>：无向图的<strong>极大</strong>连通子图  </p><ul><li>极大顶点数：再加1个顶点就不连通了</li><li>极大边数：包含子图中所有顶点相连的所有边  </li></ul><p><strong>强连通</strong>：有向图中顶点V和W之间存在双向路径，则称V和W是强连通的</p><p><strong>强连通图</strong>：有向图中任意两顶点均强连通</p><p><strong>强连通分量</strong>：有向图的极大强连通子图  </p><p><strong>每调用一次DFS(V)，就把V所在的连通分量遍历了一遍。 BFS也是一样。</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">ListComponents</span><span class="token punctuation">(</span>Graph G<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>each V in G<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">DFS</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*or BFS( V )*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* 图的邻接矩阵表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INFINITY</span> <span class="token expression"><span class="token number">65535</span>   </span><span class="token comment">/* ∞设为双字节无符号整数的最大值65535*/</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>      <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> WeightType<span class="token punctuation">;</span>  <span class="token comment">/* 边的权值设为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span>   <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span>     <span class="token comment">/* 有向边&lt;V1, V2> */</span>    WeightType Weight<span class="token punctuation">;</span> <span class="token comment">/* 权重 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                                   <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>                                   <span class="token comment">/* 边数   */</span>    WeightType G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span>    DataType Data<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token comment">/* 存顶点的数据 */</span>    <span class="token comment">/* 注意：很多情况下，顶点无数据，此时Data[]可以不用出现 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span>MGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接矩阵 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 若是无向图，还要插入边&lt;V2, V1> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span> <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点 权重"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">/* 注意：如果权重不是整型，Weight的读入格式要改 */</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 如果顶点有数据的话，读入数据 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">" %c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Data<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 图的邻接表表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>      <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> WeightType<span class="token punctuation">;</span>  <span class="token comment">/* 边的权值设为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span>   <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span>     <span class="token comment">/* 有向边&lt;V1, V2> */</span>    WeightType Weight<span class="token punctuation">;</span> <span class="token comment">/* 权重 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 邻接点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span> <span class="token operator">*</span>PtrToAdjVNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span> <span class="token punctuation">&#123;</span>    Vertex AdjV<span class="token punctuation">;</span>        <span class="token comment">/* 邻接点下标 */</span>    WeightType Weight<span class="token punctuation">;</span>  <span class="token comment">/* 边权重 */</span>    PtrToAdjVNode Next<span class="token punctuation">;</span> <span class="token comment">/* 指向下一个邻接点的指针 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* 顶点表头结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Vnode</span> <span class="token punctuation">&#123;</span>    PtrToAdjVNode FirstEdge<span class="token punctuation">;</span> <span class="token comment">/* 边表头指针 */</span>    DataType Data<span class="token punctuation">;</span>           <span class="token comment">/* 存顶点的数据 */</span>    <span class="token comment">/* 注意：很多情况下，顶点无数据，此时Data可以不用出现 */</span><span class="token punctuation">&#125;</span> AdjList<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* AdjList是邻接表类型 */</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>    <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>    <span class="token comment">/* 边数   */</span>    AdjList G<span class="token punctuation">;</span> <span class="token comment">/* 邻接表 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode LGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接表方式存储的图类型 */</span>LGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">;</span>    LGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>LGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接表头指针 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    PtrToAdjVNode NewNode<span class="token punctuation">;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    <span class="token comment">/* 为V2建立新的邻接点 */</span>    NewNode <span class="token operator">=</span> <span class="token punctuation">(</span>PtrToAdjVNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>AdjV <span class="token operator">=</span> E<span class="token operator">-></span>V2<span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>Weight <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 将V2插入V1的表头 */</span>    NewNode<span class="token operator">-></span>Next <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> NewNode<span class="token punctuation">;</span>    <span class="token comment">/* 若是无向图，还要插入边 &lt;V2, V1> */</span>    <span class="token comment">/* 为V1建立新的邻接点 */</span>    NewNode <span class="token operator">=</span> <span class="token punctuation">(</span>PtrToAdjVNode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">AdjVNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>AdjV <span class="token operator">=</span> E<span class="token operator">-></span>V1<span class="token punctuation">;</span>    NewNode<span class="token operator">-></span>Weight <span class="token operator">=</span> E<span class="token operator">-></span>Weight<span class="token punctuation">;</span>    <span class="token comment">/* 将V1插入V2的表头 */</span>    NewNode<span class="token operator">-></span>Next <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge <span class="token operator">=</span> NewNode<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>LGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    LGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点 权重"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">/* 注意：如果权重不是整型，Weight的读入格式要改 */</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 如果顶点有数据的话，读入数据 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">" %c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>Data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接表存储的图 - DFS */</span><span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>Vertex V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"正在访问顶点%d\n"</span><span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* Visited[]为全局变量，已经初始化为false */</span><span class="token keyword">void</span> <span class="token function">DFS</span><span class="token punctuation">(</span>LGraph Graph<span class="token punctuation">,</span> Vertex V<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>Visit<span class="token punctuation">)</span><span class="token punctuation">(</span>Vertex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 以V为出发点对邻接表存储的图Graph进行DFS搜索 */</span>    PtrToAdjVNode W<span class="token punctuation">;</span>    <span class="token function">Visit</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">/* 访问第V个顶点 */</span>    Visited<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span> <span class="token comment">/* 标记V已访问 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">.</span>FirstEdge<span class="token punctuation">;</span> W<span class="token punctuation">;</span> W <span class="token operator">=</span> W<span class="token operator">-></span>Next<span class="token punctuation">)</span> <span class="token comment">/* 对V的每个邻接点W->AdjV */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>W<span class="token operator">-></span>AdjV<span class="token punctuation">]</span><span class="token punctuation">)</span>                      <span class="token comment">/* 若W->AdjV未被访问 */</span>            <span class="token function">DFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> W<span class="token operator">-></span>AdjV<span class="token punctuation">,</span> Visit<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">/* 则递归访问之 */</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接矩阵存储的图 - BFS */</span><span class="token comment">/* IsEdge(Graph, V, W)检查&lt;V, W>是否图Graph中的一条边，即W是否V的邻接点。  */</span><span class="token comment">/* 此函数根据图的不同类型要做不同的实现，关键取决于对不存在的边的表示方法。*/</span><span class="token comment">/* 例如对有权图, 如果不存在的边被初始化为INFINITY, 则函数实现如下:         */</span>bool <span class="token function">IsEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex V<span class="token punctuation">,</span> Vertex W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY <span class="token operator">?</span> true <span class="token operator">:</span> false<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* Visited[]为全局变量，已经初始化为false */</span><span class="token keyword">void</span> <span class="token function">BFS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex S<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>Visit<span class="token punctuation">)</span><span class="token punctuation">(</span>Vertex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 以S为出发点对邻接矩阵存储的图Graph进行BFS搜索 */</span>    Queue Q<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>MaxSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建空队列, MaxSize为外部定义的常数 */</span>    <span class="token comment">/* 访问顶点S：此处可根据具体访问需要改写 */</span>    <span class="token function">Visit</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>    Visited<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span> <span class="token comment">/* 标记S已访问 */</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* S入队列 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">/* 弹出V */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>            <span class="token comment">/* 若W是V的邻接点并且未访问过 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">IsEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">/* 访问顶点W */</span>                <span class="token function">Visit</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">;</span>                Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> true<span class="token punctuation">;</span> <span class="token comment">/* 标记W已访问 */</span>                <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* W入队列 */</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* while结束*/</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-列出连通集"><a href="#1-列出连通集" class="headerlink" title="1.列出连通集"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988056412506300416">1.列出连通集</a></h3><p>给定一个有<em>N</em>个顶点和<em>E</em>条边的无向图，请用DFS和BFS分别列出其所有的连通集。假设顶点从0到<em>N</em>−1编号。进行搜索时，假设我们总是从编号最小的顶点出发，按编号递增的顺序访问邻接点。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入第1行给出2个整数$N(0&lt;N≤10)$​和$E$，分别是图的顶点数和边数。随后<em>E</em>行，每行给出一条边的两个端点。每行中的数字之间用1空格分隔。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>按照”$\{\ v_1\ v_2\ …\ v_k\ \}$​​​​”的格式，每行输出一个连通集。先输出DFS的结果，再输出BFS的结果。</p><p>输入样例:</p><pre class="line-numbers language-in" data-language="in"><code class="language-in">8 60 70 12 04 12 43 5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">&#123; 0 1 4 2 7 &#125;&#123; 3 5 &#125;&#123; 6 &#125;&#123; 0 1 2 7 4 &#125;&#123; 3 5 &#125;&#123; 6 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>图的基本训练，这里采用邻接矩阵，因为本身定点数就很少。剩下的就是考验基本功（doge）。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">101</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span>    <span class="token comment">/* 存储元素的数组 */</span>    Position Front<span class="token punctuation">,</span> Rear<span class="token punctuation">;</span> <span class="token comment">/* 队列的头、尾指针 */</span>    <span class="token keyword">int</span> MaxSize<span class="token punctuation">;</span>          <span class="token comment">/* 队列最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token operator">*</span>Queue<span class="token punctuation">;</span>Queue <span class="token function">CreateQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q <span class="token operator">=</span> <span class="token punctuation">(</span>Queue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>MaxSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>MaxSize <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsFull</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize <span class="token operator">==</span> Q<span class="token operator">-></span>Front<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsFull</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列满"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Rear<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">==</span> Q<span class="token operator">-></span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Front <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        <span class="token keyword">return</span> Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Front<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 图的邻接矩阵表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">20</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INFINITY</span> <span class="token expression"><span class="token number">65535</span>  </span><span class="token comment">/* ∞设为双字节无符号整数的最大值65535*/</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>     <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span>  <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token keyword">int</span> Visited<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span> <span class="token comment">/* 有向边&lt;V1, V2> */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                            <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>                            <span class="token comment">/* 边数   */</span>    <span class="token keyword">int</span> G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span>    <span class="token comment">/* 注意：很多情况下，顶点无数据，此时Data[]可以不用出现 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span>MGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接矩阵 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从0开始，到(Graph->Nv - 1) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> V <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">/* 若是无向图，还要插入边&lt;V2, V1> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>E<span class="token operator">-></span>V2<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 邻接矩阵存储的图 - DFS */</span><span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>Vertex V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex V<span class="token punctuation">,</span> Vertex W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* Visited[]为全局变量，已经初始化为false */</span><span class="token keyword">void</span> <span class="token function">DFS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex V<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>Visit<span class="token punctuation">)</span><span class="token punctuation">(</span>Vertex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 以V为出发点对邻接矩阵存储的图Graph进行DFS搜索 */</span>    Vertex W<span class="token punctuation">;</span>    <span class="token function">Visit</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">/* 访问第V个顶点 */</span>    Visited<span class="token punctuation">[</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 标记V已访问 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>        <span class="token comment">/* 若W是V的邻接点并且未访问过 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">IsEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token function">DFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> W<span class="token punctuation">,</span> Visit<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 则递归访问之 */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">BFS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex S<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>Visit<span class="token punctuation">)</span><span class="token punctuation">(</span>Vertex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 以S为出发点对邻接矩阵存储的图Graph进行BFS搜索 */</span>    Queue Q<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>MAXSIZE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建空队列, MaxSize为外部定义的常数 */</span>    <span class="token comment">/* 访问顶点S：此处可根据具体访问需要改写 */</span>    <span class="token function">Visit</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>    Visited<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 标记S已访问 */</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/* S入队列 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">/* 弹出V */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> W <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>            <span class="token comment">/* 若W是V的邻接点并且未访问过 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">IsEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">/* 访问顶点W */</span>                <span class="token function">Visit</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">;</span>                Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 标记W已访问 */</span>                <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/* W入队列 */</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* while结束*/</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Vertex v<span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>Visited<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Visited<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> v<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&#123; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">DFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> v<span class="token punctuation">,</span> Visit<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&#125;\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>Visited<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Visited<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> v<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&#123; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">BFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> v<span class="token punctuation">,</span> Visit<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&#125;\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 两种顺序不同，也有相同，有未出现的单个顶点</td><td>答案正确</td><td>15</td><td>3 ms</td><td>188 KB</td></tr><tr><td>1</td><td>第1个是单独点，最大N</td><td>答案正确</td><td>8</td><td>3 ms</td><td>308 KB</td></tr><tr><td>2</td><td>N和E最小</td><td>答案正确</td><td>2</td><td>4 ms</td><td>180 KB</td></tr></tbody></table><h3 id="2-Saving-James-Bond-Easy-Version"><a href="#2-Saving-James-Bond-Easy-Version" class="headerlink" title="2.Saving James Bond - Easy Version"></a><a href="https://pintia.cn/problem-sets/16/problems/672">2.Saving James Bond - Easy Version</a></h3><p>This time let us consider the situation in the movie “Live and Let Die” in which James Bond, the world’s most famous spy, was captured by a group of drug dealers. He was sent to a small piece of land at the center of a lake filled with crocodiles. There he performed the most daring action to escape – he jumped onto the head of the nearest crocodile! Before the animal realized what was happening, James jumped again onto the next big head… Finally he reached the bank before the last crocodile could bite him (actually the stunt man was caught by the big mouth and barely escaped with his extra thick boot).</p><p>Assume that the lake is a 100 by 100 square one. Assume that the center of the lake is at$ (0,0)$ and the northeast corner at$ (50,50)$. The central island is a disk centered at$ (0,0)$ with the diameter of 15. A number of crocodiles are in the lake at various positions. Given the coordinates of each crocodile and the distance that James could jump, you must tell him whether or not he can escape.</p><h3 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h3><p>Each input file contains one test case. Each case starts with a line containing two positive integers$ N (≤100)$, the number of crocodiles, and <em>D</em>, the maximum distance that James could jump. Then <em>N</em> lines follow, each containing the $(x,y)$ location of a crocodile. Note that no two crocodiles are staying at the same position.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in a line “Yes” if James can escape, or “No” if not.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">14 2025 -15-25 288 4929 15-35 -25 2827 -29-8 -28-20 -35-25 -20-13 29-30 15-35 4012 12<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 13-12 1212 12-12 -1212 -12<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">No<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>依然考虑利用类邻接矩阵存储，多了一些判断，第一步能否跳到，能否从该鳄鱼到岸边以及能否到下一条鳄鱼，这里图省事，没有引入边，依然利用DFS,当然BFS肯定也可以。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> D<span class="token punctuation">;</span> <span class="token comment">// 跳跃距离</span><span class="token keyword">const</span> <span class="token keyword">double</span> first_D <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span><span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">/* 最大顶点数设为100 */</span></span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> first<span class="token punctuation">,</span> visit<span class="token punctuation">,</span> safe<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                      <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">struct</span> <span class="token class-name">Node</span> G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span><span class="token comment">// 距离</span><span class="token keyword">double</span> <span class="token function">Distance</span><span class="token punctuation">(</span><span class="token keyword">int</span> x1<span class="token punctuation">,</span> <span class="token keyword">int</span> y1<span class="token punctuation">,</span> <span class="token keyword">int</span> x2<span class="token punctuation">,</span> <span class="token keyword">int</span> y2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">pow</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">pow</span><span class="token punctuation">(</span>y1 <span class="token operator">-</span> y2<span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//能否到岸边</span><span class="token keyword">int</span> <span class="token function">Is_shore</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 分别计算当前结点与岸边的距离</span>    <span class="token comment">// 即与 (x,50),(x,-50),(50,y),(-50,y) 的距离</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">||</span> <span class="token function">abs</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">||</span> <span class="token function">abs</span><span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">||</span>        <span class="token function">abs</span><span class="token punctuation">(</span>y <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//是否安全("能上岸")</span><span class="token keyword">void</span> <span class="token function">Init_Safe</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 如果该鳄鱼能到岸边</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Is_shore</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>safe <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>safe <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//可以第一步跳上去</span><span class="token keyword">void</span> <span class="token function">Init_first</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 如果该鳄鱼位置和"湖中心"相邻（跳跃距离+半径）</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D <span class="token operator">+</span> first_D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">/* 读入顶点个数 */</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 读入直径 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>        Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">Init_Safe</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Init_first</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">DFS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>safe<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        ans <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> w <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> w <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> w<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 未跳过，且能跳上</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">.</span>visit <span class="token operator">&amp;&amp;</span> <span class="token function">Distance</span><span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>                                           Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> D<span class="token punctuation">)</span>            <span class="token function">DFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Save007</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> v<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>visit<span class="token punctuation">)</span> <span class="token function">DFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ans<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Save007</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-六度空间"><a href="#3-六度空间" class="headerlink" title="3.六度空间"></a><a href="https://pintia.cn/problem-sets/434/problems/6476">3.六度空间</a></h3><p>“六度空间”理论又称作“六度分隔（Six Degrees of Separation）”理论。这个理论可以通俗地阐述为：“你和任何一个陌生人之间所间隔的人不会超过六个，也就是说，最多通过五个人你就能够认识任何一个陌生人。”如图1所示。</p><p><img src="https://images.ptausercontent.com/35" alt="图1 六度空间示意图"></p><p>“六度空间”理论虽然得到广泛的认同，并且正在得到越来越多的应用。但是数十年来，试图验证这个理论始终是许多社会学家努力追求的目标。然而由于历史的原因，这样的研究具有太大的局限性和困难。随着当代人的联络主要依赖于电话、短信、微信以及因特网上即时通信等工具，能够体现社交网络关系的一手数据已经逐渐使得“六度空间”理论的验证成为可能。</p><p>假如给你一个社交网络图，请你对每个节点计算符合“六度空间”理论的结点占结点总数的百分比。</p><h4 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入第1行给出两个正整数，分别表示社交网络图的结点数<em>N</em>（1&lt;<em>N</em>≤103，表示人数）、边数<em>M</em>（≤33×<em>N</em>，表示社交关系数）。随后的<em>M</em>行对应<em>M</em>条边，每行给出一对正整数，分别是该条边直接连通的两个结点的编号（节点从1到<em>N</em>编号）。</p><h4 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>对每个结点输出与该结点距离不超过6的结点数占结点总数的百分比，精确到小数点后2位。每个结节点输出一行，格式为“结点编号:（空格）百分比%”。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">10 91 22 33 44 55 66 77 88 99 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例-1"><a href="#输出样例-1" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">1: 70.00%2: 80.00%3: 90.00%4: 100.00%5: 100.00%6: 100.00%7: 100.00%8: 90.00%9: 80.00%10: 70.00%<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>在BFS的基础上多一步层数判断即可，需要理解什么时候层数该+1，并注意数组下标。</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">1001</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span>    <span class="token comment">/* 存储元素的数组 */</span>    Position Front<span class="token punctuation">,</span> Rear<span class="token punctuation">;</span> <span class="token comment">/* 队列的头、尾指针 */</span>    <span class="token keyword">int</span> MaxSize<span class="token punctuation">;</span>          <span class="token comment">/* 队列最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token operator">*</span>Queue<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Queue <span class="token function">CreateQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q <span class="token operator">=</span> <span class="token punctuation">(</span>Queue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>MaxSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>MaxSize <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Rear<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">==</span> Q<span class="token operator">-></span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Front<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 图的邻接矩阵表示法 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxVertexNum</span> <span class="token expression"><span class="token number">1001</span> </span><span class="token comment">/* 最大顶点数设为1000 */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INFINITY</span> <span class="token expression"><span class="token number">65535</span> </span><span class="token comment">/* ∞设为双字节无符号整数的最大值65535*/</span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Vertex<span class="token punctuation">;</span>    <span class="token comment">/* 用顶点下标表示顶点,为整型 */</span><span class="token keyword">typedef</span> <span class="token keyword">char</span> DataType<span class="token punctuation">;</span> <span class="token comment">/* 顶点存储的数据类型设为字符型 */</span><span class="token keyword">int</span> Visited<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/* 边的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token operator">*</span>PtrToENode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span> <span class="token punctuation">&#123;</span>    Vertex V1<span class="token punctuation">,</span> V2<span class="token punctuation">;</span> <span class="token comment">/* 有向边&lt;V1, V2> */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToENode Edge<span class="token punctuation">;</span><span class="token comment">/* 图结点的定义 */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token operator">*</span>PtrToGNode<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">;</span>                            <span class="token comment">/* 顶点数 */</span>    <span class="token keyword">int</span> Ne<span class="token punctuation">;</span>                            <span class="token comment">/* 边数   */</span>    <span class="token keyword">int</span> G<span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">[</span>MaxVertexNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 邻接矩阵 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> PtrToGNode MGraph<span class="token punctuation">;</span> <span class="token comment">/* 以邻接矩阵存储的图类型 */</span>MGraph <span class="token function">CreateGraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> VertexNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 初始化一个有VertexNum个顶点但没有边的图 */</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">;</span>    MGraph Graph<span class="token punctuation">;</span>    Graph <span class="token operator">=</span> <span class="token punctuation">(</span>MGraph<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立图 */</span>    Graph<span class="token operator">-></span>Nv <span class="token operator">=</span> VertexNum<span class="token punctuation">;</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* 初始化邻接矩阵 */</span>    <span class="token comment">/* 注意：这里默认顶点编号从1开始，到(Graph->Nv) */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>V <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> V <span class="token operator">&lt;=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> V<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> W <span class="token operator">&lt;=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> INFINITY<span class="token punctuation">;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">InsertEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Edge E<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 插入边 &lt;V1, V2> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">/* 若是无向图，还要插入边&lt;V2, V1> */</span>    Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>E<span class="token operator">-></span>V2<span class="token punctuation">]</span><span class="token punctuation">[</span>E<span class="token operator">-></span>V1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>MGraph <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph<span class="token punctuation">;</span>    Edge E<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">;</span>    <span class="token keyword">int</span> Nv<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    Nv <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">/* 读入顶点个数 */</span>    Graph <span class="token operator">=</span> <span class="token function">CreateGraph</span><span class="token punctuation">(</span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 初始化有Nv个顶点但没有边的图 */</span>    Graph<span class="token operator">-></span>Ne <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">/* 读入边数 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Graph<span class="token operator">-></span>Ne <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       <span class="token comment">/* 如果有边 */</span>        E <span class="token operator">=</span> <span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">ENode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立边结点 */</span>        <span class="token comment">/* 读入边，格式为"起点 终点"，插入邻接矩阵 */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Graph<span class="token operator">-></span>Ne<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            E<span class="token operator">-></span>V1 <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> E<span class="token operator">-></span>V2 <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">InsertEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> Graph<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEdge</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex V<span class="token punctuation">,</span> Vertex W<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> Graph<span class="token operator">-></span>G<span class="token punctuation">[</span>V<span class="token punctuation">]</span><span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&lt;</span> INFINITY <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">BFS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">,</span> Vertex S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 以S为出发点对邻接矩阵存储的图Graph进行BFS搜索 */</span>    Queue Q<span class="token punctuation">;</span>    Vertex V<span class="token punctuation">,</span> W<span class="token punctuation">,</span> last <span class="token operator">=</span> S<span class="token punctuation">,</span> tail<span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>MAXSIZE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建空队列, MaxSize为外部定义的常数 */</span>    Visited<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token comment">/* 标记S已访问 */</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">/* S入队列 */</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        V <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* 弹出V */</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>W <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> W <span class="token operator">&lt;=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> W<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">/* 对图中的每个顶点W */</span>            <span class="token comment">/* 若W是V的邻接点并且未访问过 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">IsEdge</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> V<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                Visited<span class="token punctuation">[</span>W<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 标记W已访问 */</span>                <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/* W入队列 */</span>                tail <span class="token operator">=</span> W<span class="token punctuation">;</span>                <span class="token operator">++</span>count<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">==</span> last<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token operator">++</span>level<span class="token punctuation">;</span>            last <span class="token operator">=</span> tail<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>level <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* while结束*/</span>    <span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">SDS</span><span class="token punctuation">(</span>MGraph Graph<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Vertex v <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> v <span class="token operator">&lt;=</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">;</span> v<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">memset</span><span class="token punctuation">(</span>Visited<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Visited<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token function">BFS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d: %.2f%%\n"</span><span class="token punctuation">,</span> v<span class="token punctuation">,</span> <span class="token number">100.0</span> <span class="token operator">*</span> count <span class="token operator">/</span> Graph<span class="token operator">-></span>Nv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    MGraph Graph <span class="token operator">=</span> <span class="token function">BuildGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">SDS</span><span class="token punctuation">(</span>Graph<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 简单一条链</td><td>答案正确</td><td>18</td><td>7 ms</td><td>428 KB</td></tr><tr><td>1</td><td>不连通</td><td>答案正确</td><td>3</td><td>3 ms</td><td>324 KB</td></tr><tr><td>2</td><td>一般图</td><td>答案正确</td><td>3</td><td>3 ms</td><td>320 KB</td></tr><tr><td>3</td><td>最小N和M</td><td>答案正确</td><td>3</td><td>4 ms</td><td>180 KB</td></tr><tr><td>4</td><td>最大N和M</td><td>答案正确</td><td>3</td><td>300 ms</td><td>8128 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week5</title>
      <link href="2021/0801941.html"/>
      <url>2021/0801941.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week5树（下）"><a href="#Week5树（下）" class="headerlink" title="Week5树（下）"></a>Week5树（下）</h1><h2 id="5-1-堆（heap）"><a href="#5-1-堆（heap）" class="headerlink" title="5.1 堆（heap）"></a>5.1 堆（heap）</h2><h3 id="什么是堆"><a href="#什么是堆" class="headerlink" title="什么是堆"></a>什么是堆</h3><p><strong>优先队列</strong>（Priority Queue）：特殊的“<strong>队列</strong>” ，取出元素的顺序是依照元素的<strong>优先权（关键字）</strong> 大小，而不是元素进入队列的先后顺序。  </p><p>问题：如何组织优先队列？</p><ul><li>一般的数组、链表？</li><li>有序的数组或者链表？</li><li>二叉搜索树？ AVL树？  </li></ul><p>若采用数组或链表实现优先队列  </p><p><strong>数组 :</strong>  </p><p><strong>插入</strong> — 元素总是插入尾部                        ——————$\Theta(1)$</p><p><strong>删除</strong> — 查找最大（或最小）关键字         ——————$\Theta(n)$</p><p>从数组中删去需要移动元素                       ——————$O(n)$</p><p><strong>链表:</strong>****</p><p><strong>插入</strong> — 元素总是插入链表的头部             ——————$\Theta(1)$</p><p><strong>删除</strong> — 查找最大（或最小）关键字          ——————$\Theta(n)$</p><p>删去结点                                                      ——————$\Theta(1)$</p><p><strong>有序数组:</strong>  </p><p><strong>插入</strong> — 找到合适的位置                              ——————$O(n)或O(log_2n)$</p><p>移动元素并插入                                           ——————$O(n)$</p><p>删除 — 删去最后一个元素                          ——————$\Theta(1)$​</p><p><strong>有序链表:</strong></p><p><strong>插入</strong> — 找到合适的位置                              ——————$O(n)$​</p><p>插入元素                                                       ——————$\Theta(1)$​</p><p><strong>删除</strong> — 删除首元素或最后元素                  ——————$\Theta(1)$​</p><p>是否可以采用二叉树存储结构？  </p><p>二叉搜索树？  </p><p>如果采用二叉树结构，应更关注插入还是删除？  </p><ul><li>树结点顺序怎么安排？</li><li>树结构怎样？  </li></ul><p>优先队列的<strong>完全二叉树</strong>表示  </p><p>堆的两个特性  </p><p><strong>结构性：</strong>用数组表示的完全二叉树；  </p><p><strong>有序性：</strong> 任一结点的关键字是其子树所有结点的最大值(或最小值)  </p><ul><li>“<strong>最大堆(MaxHeap)<strong>” ,也称“</strong>大顶堆</strong>”：最大值</li><li>“<strong>最小堆(MinHeap)<strong>” ,也称“</strong>小顶堆</strong>” ：最小值  </li></ul><p>注意：从根结点到任意结点路径上结点序列的有序性！  </p><h3 id="堆的抽象数据类型描述"><a href="#堆的抽象数据类型描述" class="headerlink" title="堆的抽象数据类型描述"></a>堆的抽象数据类型描述</h3><p>类型名称： <strong>最大堆（MaxHeap）</strong></p><p>数据对象集： <strong>完全二叉树</strong>，每个结点的元素值<strong>不小于</strong>其子结点的元素值</p><p>操作集：最大堆$H \in MaxHeap$，元素$item \in ElementType$，主要操作有：</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">MaxHeap <span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span><span class="token comment">//创建一个空的最大堆。</span>Boolean <span class="token function">IsFull</span><span class="token punctuation">(</span>MaxHeap H<span class="token punctuation">)</span><span class="token comment">//判断最大堆H是否已满。</span><span class="token function">Insert</span><span class="token punctuation">(</span>MaxHeap H<span class="token punctuation">,</span> ElementType item<span class="token punctuation">)</span><span class="token comment">//将元素item插入最大堆H。</span>Boolean <span class="token function">IsEmpty</span><span class="token punctuation">(</span>MaxHeap H<span class="token punctuation">)</span><span class="token comment">//判断最大堆H是否为空。</span>ElementType <span class="token function">DeleteMax</span><span class="token punctuation">(</span>MaxHeap H<span class="token punctuation">)</span><span class="token comment">//返回H中最大元素(高优先级)。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="最大堆的操作"><a href="#最大堆的操作" class="headerlink" title="最大堆的操作"></a>最大堆的操作</h3><h4 id="最大堆的创建"><a href="#最大堆的创建" class="headerlink" title="最大堆的创建"></a>最大堆的创建</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">HeapStruct</span> <span class="token operator">*</span>MaxHeap<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">HeapStruct</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Elements<span class="token punctuation">;</span> <span class="token comment">/* 存储堆元素的数组 */</span>    <span class="token keyword">int</span> Size<span class="token punctuation">;</span>              <span class="token comment">/* 堆的当前元素个数 */</span>    <span class="token keyword">int</span> Capacity<span class="token punctuation">;</span>          <span class="token comment">/* 堆的最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>MaxHeap <span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 创建容量为MaxSize的空的最大堆 */</span>    MaxHeap H <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">HeapStruct</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Elements <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MaxSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Capacity <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    H<span class="token operator">-></span>Elements<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> MaxData<span class="token punctuation">;</span>    <span class="token comment">/* 定义“哨兵”为大于堆中所有可能元素的值，便于以后更快操作 */</span>    <span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>把MaxData换成小于堆中所有元素的MinData，同样适用于创建<strong>最小堆</strong>。  </p><h4 id="最大堆的插入"><a href="#最大堆的插入" class="headerlink" title="最大堆的插入"></a>最大堆的插入</h4><p>算法：将新增结点插入到从其父结点到根结点的有序序列中  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>MaxHeap H<span class="token punctuation">,</span> ElementType item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将元素item 插入最大堆H，其中H->Elements[0]已经定义为哨兵 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsFull</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"最大堆已满"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    i <span class="token operator">=</span> <span class="token operator">++</span>H<span class="token operator">-></span>Size<span class="token punctuation">;</span> <span class="token comment">/* i指向插入后堆中的最后一个元素的位置 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> item<span class="token punctuation">;</span> i <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span>        H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 向下过滤结点 */</span>    H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>                   <span class="token comment">/* 将item 插入 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>向下过滤结点，比交换数据要快  </p><p>$H-&gt;Element[ 0 ]$ 是哨兵元素，它不小于堆中的最大元素，控制循环结束。  </p><h4 id="最大堆的删除"><a href="#最大堆的删除" class="headerlink" title="最大堆的删除"></a>最大堆的删除</h4><p>取出根结点（最大值）元素，同时删除堆的一个结点。$T (N) = O ( log N )$  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">ElementType <span class="token function">DeleteMax</span><span class="token punctuation">(</span>MaxHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 从最大堆H中取出键值为最大的元素， 并删除一个结点 */</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">,</span> Child<span class="token punctuation">;</span>    ElementType MaxItem<span class="token punctuation">,</span> temp<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"最大堆已为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    MaxItem <span class="token operator">=</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出根结点最大值 */</span>    <span class="token comment">/* 用最大堆中最后一个元素从根结点开始向上过滤下层结点 */</span>    temp <span class="token operator">=</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>H<span class="token operator">-></span>Size<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Parent <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> H<span class="token operator">-></span>Size<span class="token punctuation">;</span> Parent <span class="token operator">=</span> Child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Child <span class="token operator">=</span> Parent <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Child <span class="token operator">!=</span> H<span class="token operator">-></span>Size<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>Child<span class="token punctuation">]</span> <span class="token operator">&lt;</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>Child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            Child<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* Child指向左右子结点的较大者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">>=</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token comment">/* 移动temp元素到下一层 */</span>            H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    H<span class="token operator">-></span>Elements<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>    <span class="token keyword">return</span> MaxItem<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="最大堆的建立"><a href="#最大堆的建立" class="headerlink" title="最大堆的建立"></a>最大堆的建立</h4><p><strong>建立最大堆</strong>： 将<strong>已经存在的N个元素</strong>按最大堆的要求存放在<br>一个一维数组中  </p><p>方法1： 通过插入操作，将N个元素<strong>一个个相继插入到一个初始为空的堆中去</strong>，其时间代价最大为$O(N logN)$。  </p><p>方法2： 在<strong>线性时间复杂度</strong>下建立最大堆。</p><p>（1）将N个元素按输入顺序存入，先满足<strong>完全二叉树的结构特性</strong></p><p>（2）调整各结点位置，以满足最大堆的<strong>有序特性</strong>。  </p><p>线性时间复杂度$T(n)=O(n)$  </p><table><thead><tr><th align="center">结点数</th><th align="center">最多交换次数</th></tr></thead><tbody><tr><td align="center">$n/4$</td><td align="center">1</td></tr><tr><td align="center">$n/8$</td><td align="center">2</td></tr><tr><td align="center">$n/16$</td><td align="center">3</td></tr><tr><td align="center">$n/2^k=1$</td><td align="center">$log_2n-1(k-1)$</td></tr></tbody></table><p>$$<br>T(n)=\frac{n}{4}+\frac{n}{8}\times2+\frac{n}{16}\times3+\cdots+\frac{n}{2^k}\times(k-1)<br>$$</p><p>$$<br>2T(n)=\frac{n}{2}+\frac{n}{4}\times2+\frac{n}{8}\times3+\cdots+\frac{n}{2^{k-1} }\times(k-1)<br>$$</p><p>$$<br>2T(n)-T(n)=\frac{n}{2}+\frac{n}{4}+\frac{n}{8}+\cdots+\frac{n}{2^{k-1}}-\frac{n}{2^k}\times(k-1)\leq n-(log_2n-1)\leq n<br>$$</p><h2 id="5-2-哈夫曼树与哈夫曼编码"><a href="#5-2-哈夫曼树与哈夫曼编码" class="headerlink" title="5.2 哈夫曼树与哈夫曼编码"></a>5.2 哈夫曼树与哈夫曼编码</h2><h3 id="什么是哈夫曼树（Huffman-Tree）"><a href="#什么是哈夫曼树（Huffman-Tree）" class="headerlink" title="什么是哈夫曼树（Huffman Tree）"></a>什么是哈夫曼树（Huffman Tree）</h3><p>例 将百分制的考试成绩转换成五分制的成绩  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> grade <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">70</span><span class="token punctuation">)</span> grade <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">)</span> grade <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">90</span><span class="token punctuation">)</span> grade <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">else</span> grade <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果考虑学生成绩的分布的概率：  </p><table><thead><tr><th>分数段</th><th>0-59</th><th>60-69</th><th>70-79</th><th>80-89</th><th>90-100</th></tr></thead><tbody><tr><td>比例</td><td>0.05</td><td>0.15</td><td>0.40</td><td>0.30</td><td>0.10</td></tr></tbody></table><p>查找效率： 0.05 × 1 + 0.15 × 2 + 0.4 × 3 + 0.3 × 4 + 0.1 ×  4 = 3.15  </p><p>修改判定树：  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">70</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> grade <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> grade <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> grade <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&lt;</span> <span class="token number">90</span><span class="token punctuation">)</span> grade <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">else</span> grade <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>效率: 0.05 × 3 + 0.15 × 3 + 0.4 × 2 + 0.3 × 2 + 0.1× 2 = 2.2  </p><p>如何根据结点不同的查找频率构造更有效的搜索树？  </p><h3 id="哈夫曼树的定义"><a href="#哈夫曼树的定义" class="headerlink" title="哈夫曼树的定义"></a>哈夫曼树的定义</h3><p><strong>带权路径长度</strong>$(WPL)$： 设二叉树有<strong>n个叶子结点</strong>，每个叶子结点带有权值$ w_k$，从根结点到每个叶子结点的长度为 $l_k$，则每个叶子结点的带权路径长度之和就是： $WPL=\sum_{k=1}^nw_kl_k$</p><p><strong>最优二叉树</strong>或<strong>哈夫曼树</strong>: $WPL$最小的二叉树  </p><h3 id="哈夫曼树的构造"><a href="#哈夫曼树的构造" class="headerlink" title="哈夫曼树的构造"></a>哈夫曼树的构造</h3><p>每次把<strong>权值最小的两棵</strong>二叉树合并  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token operator">*</span>HuffmanTree<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Weight<span class="token punctuation">;</span>    HuffmanTree Left<span class="token punctuation">,</span> Right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> HuffmanTree<span class="token function">Huffman</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 假设H->Size个权值已经存在H->Elements[]->Weight里 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    HuffmanTree T<span class="token punctuation">;</span>    <span class="token function">BuildMinHeap</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*将H->Elements[]按权值调整为最小堆*/</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> H<span class="token operator">-></span>Size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token comment">/*做H->Size-1次合并*/</span>        T <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*建立新结点*/</span>        T<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*从最小堆中删除一个结点， 作为新T的左子结点*/</span>        T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*从最小堆中删除一个结点， 作为新T的右子结点*/</span>        T<span class="token operator">-></span>Weight <span class="token operator">=</span> T<span class="token operator">-></span>Left<span class="token operator">-></span>Weight <span class="token operator">+</span> T<span class="token operator">-></span>Right<span class="token operator">-></span>Weight<span class="token punctuation">;</span>        <span class="token comment">/*计算新权值*/</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*将新T插入最小堆*/</span>    <span class="token punctuation">&#125;</span>    T <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>整体复杂度为$O(N logN)$</p><p><strong>哈夫曼树的特点:</strong>  </p><ul><li>没有度为1的结点；</li><li>哈夫曼树的任意非叶节点的左右子树交换后仍是哈夫曼树；</li><li>n个叶子结点的哈夫曼树共有2n-1个结点；</li><li>对同一组权值{w1 ,w2 , …… , wn}， 是否存在不同构的两棵哈夫曼树呢？  （存在！）</li></ul><h3 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h3><p>给定一段字符串，如何<strong>对字符进行编码</strong>，可以使得该字符串的编码<strong>存储空间最少</strong>？  </p><p>假设有一段文本，包含58个字符，并由以下7个字符构： a， e， i，s， t，空格（sp），换行（nl）；这7个字符出现的次数不同。如何对这7个字符进行编码，使得总编码空间最少？  </p><p><strong>分析</strong>  </p><p>（1）用等长ASCII编码： <strong>58 × 8 = 464</strong>位；<br>（2）用等长3位编码： <strong>58 × 3 = 174</strong>位；<br>（3）不等长编码：出现频率高的字符用的<strong>编码短些</strong>，出现频率低的字符则可以<strong>编码长些</strong>？  </p><p>怎么进行不等长编码？  </p><p>如何避免二义性？  </p><p><strong>前缀码</strong>（prefix code）：任何字符的编码都不是另一字符编码的前缀，可以无二义地解码  </p><p>二叉树用于编码  </p><p>用二叉树进行编码：</p><p>（1）左右分支： 0、 1</p><p>（2）字符只在叶结点上  </p><p>怎么构造一颗编码代价最小的二叉树？  哈夫曼编码 </p><h2 id="5-3-集合及运算"><a href="#5-3-集合及运算" class="headerlink" title="5.3 集合及运算"></a>5.3 集合及运算</h2><h3 id="集合的表示"><a href="#集合的表示" class="headerlink" title="集合的表示"></a>集合的表示</h3><p>集合运算： <strong>交、并、补、差， 判定</strong>一个元素是否属于某一集合  </p><p><strong>并查集</strong>：集合<strong>并、 查</strong>某元素属于什么集合  </p><p>并查集问题中集合存储如何实现？  </p><p>可以用<strong>树结构</strong>表示集合，树的每个结点代表一个集合元素  </p><p>双亲表示法：孩子指向双亲。  </p><p>采用数组存储形式  </p><p>数组中每个元素的类型描述为  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">;</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> SetType<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>负数表示根结点；非负数表示双亲结点的下标。  </p><h3 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h3><p>（1）查找某个元素所在的集合（用根结点表示）  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">Find</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 在数组S中查找值为X的元素所属的集合 */</span>    <span class="token comment">/* MaxSize是全局变量， 为数组S的最大长度 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MaxSize <span class="token operator">&amp;&amp;</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Data <span class="token operator">!=</span> X<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> MaxSize<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 未找到X， 返回-1 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Parent <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">=</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Parent<span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token keyword">return</span> i<span class="token punctuation">;</span> <span class="token comment">/* 找到X所属集合， 返回树根结点在数组S中的下标 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>（ 2） 集合的并运算  </p><p>分别找到X1和X2两个元素所在集合树的根结点  </p><p>如果它们不同根，则将其中<strong>一个根结点的父结点指针设置成另一个根结点</strong>的数组下标。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Union</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType X1<span class="token punctuation">,</span> ElementType X2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">;</span>    Root1 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> X1<span class="token punctuation">)</span><span class="token punctuation">;</span>    Root2 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> X2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span>（ Root1 <span class="token operator">!=</span> Root2 ） S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span><span class="token punctuation">.</span>Parent <span class="token operator">=</span> Root1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当x1和x2不属于同一子集时，才需要合并  </p><p>为了改善合并以后的查找性能，可以采用小的集合合并到相对大的集合中。（修改Union函数）  </p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;*------------------ Heap ------------------*&#x2F;typedef int ElementType;typedef struct HNode *Heap; &#x2F;* 堆的类型定义 *&#x2F;struct HNode &#123;    ElementType *Data; &#x2F;* 存储元素的数组 *&#x2F;    int Size;          &#x2F;* 堆中当前元素个数 *&#x2F;    int Capacity;      &#x2F;* 堆的最大容量 *&#x2F;&#125;;typedef Heap MaxHeap; &#x2F;* 最大堆 *&#x2F;typedef Heap MinHeap; &#x2F;* 最小堆 *&#x2F;#define MAXDATA 1000 &#x2F;* 该值应根据具体情况定义为大于堆中所有可能元素的值 *&#x2F;MaxHeap CreateHeap(int MaxSize) &#123; &#x2F;* 创建容量为MaxSize的空的最大堆 *&#x2F;    MaxHeap H &#x3D; (MaxHeap)malloc(sizeof(struct HNode));    H-&gt;Data &#x3D; (ElementType *)malloc((MaxSize + 1) * sizeof(ElementType));    H-&gt;Size &#x3D; 0;    H-&gt;Capacity &#x3D; MaxSize;    H-&gt;Data[0] &#x3D; MAXDATA; &#x2F;* 定义&quot;哨兵&quot;为大于堆中所有可能元素的值*&#x2F;    return H;&#125;bool IsFull(MaxHeap H) &#123; return (H-&gt;Size &#x3D;&#x3D; H-&gt;Capacity); &#125;bool Insert(    MaxHeap H,    ElementType X) &#123; &#x2F;* 将元素X插入最大堆H，其中H-&gt;Data[0]已经定义为哨兵 *&#x2F;    int i;    if (IsFull(H)) &#123;        printf(&quot;最大堆已满&quot;);        return false;    &#125;    i &#x3D; ++H-&gt;Size; &#x2F;* i指向插入后堆中的最后一个元素的位置 *&#x2F;    for (; H-&gt;Data[i &#x2F; 2] &lt; X; i &#x2F;&#x3D; 2) H-&gt;Data[i] &#x3D; H-&gt;Data[i &#x2F; 2]; &#x2F;* 上滤X *&#x2F;    H-&gt;Data[i] &#x3D; X; &#x2F;* 将X插入 *&#x2F;    return true;&#125;#define ERROR -1 &#x2F;* 错误标识应根据具体情况定义为堆中不可能出现的元素值 *&#x2F;bool IsEmpty(MaxHeap H) &#123; return (H-&gt;Size &#x3D;&#x3D; 0); &#125;ElementType DeleteMax(MaxHeap H) &#123;    &#x2F;* 从最大堆H中取出键值为最大的元素，并删除一个结点 *&#x2F;    int Parent, Child;    ElementType MaxItem, X;    if (IsEmpty(H)) &#123;        printf(&quot;最大堆已为空&quot;);        return ERROR;    &#125;    MaxItem &#x3D; H-&gt;Data[1]; &#x2F;* 取出根结点存放的最大值 *&#x2F;    &#x2F;* 用最大堆中最后一个元素从根结点开始向上过滤下层结点 *&#x2F;    X &#x3D; H-&gt;Data[H-&gt;Size--]; &#x2F;* 注意当前堆的规模要减小 *&#x2F;    for (Parent &#x3D; 1; Parent * 2 &lt;&#x3D; H-&gt;Size; Parent &#x3D; Child) &#123;        Child &#x3D; Parent * 2;        if ((Child !&#x3D; H-&gt;Size) &amp;&amp; (H-&gt;Data[Child] &lt; H-&gt;Data[Child + 1]))            Child++; &#x2F;* Child指向左右子结点的较大者 *&#x2F;        if (X &gt;&#x3D; H-&gt;Data[Child])            break; &#x2F;* 找到了合适位置 *&#x2F;        else       &#x2F;* 下滤X *&#x2F;            H-&gt;Data[Parent] &#x3D; H-&gt;Data[Child];    &#125;    H-&gt;Data[Parent] &#x3D; X;    return MaxItem;&#125;&#x2F;*----------- 建造最大堆 -----------*&#x2F;void PercDown(MaxHeap H, int p) &#123;     &#x2F;* 下滤：将H中以H-&gt;Data[p]为根的子堆调整为最大堆 *&#x2F;    int Parent, Child;    ElementType X;    X &#x3D; H-&gt;Data[p]; &#x2F;* 取出根结点存放的值 *&#x2F;    for (Parent &#x3D; p; Parent * 2 &lt;&#x3D; H-&gt;Size; Parent &#x3D; Child) &#123;        Child &#x3D; Parent * 2;        if ((Child !&#x3D; H-&gt;Size) &amp;&amp; (H-&gt;Data[Child] &lt; H-&gt;Data[Child + 1]))            Child++; &#x2F;* Child指向左右子结点的较大者 *&#x2F;        if (X &gt;&#x3D; H-&gt;Data[Child])            break; &#x2F;* 找到了合适位置 *&#x2F;        else       &#x2F;* 下滤X *&#x2F;            H-&gt;Data[Parent] &#x3D; H-&gt;Data[Child];    &#125;    H-&gt;Data[Parent] &#x3D; X;&#125;void BuildHeap(MaxHeap H) &#123; &#x2F;* 调整H-&gt;Data[]中的元素，使满足最大堆的有序性  *&#x2F;    &#x2F;* 这里假设所有H-&gt;Size个元素已经存在H-&gt;Data[]中 *&#x2F;    int i;    &#x2F;* 从最后一个结点的父节点开始，到根结点1 *&#x2F;    for (i &#x3D; H-&gt;Size &#x2F; 2; i &gt; 0; i--) PercDown(H, i);&#125;&#x2F;*HUFFMAN TREE*&#x2F;typedef struct TreeNode *HuffmanTree;struct TreeNode &#123;    int Weight;    HuffmanTree Left, Right;&#125;;HuffmanTree Huffman(MinHeap H) &#123;     &#x2F;* 假设H-&gt;Size个权值已经存在H-&gt;Elements[]-&gt;Weight里 *&#x2F;    int i;    HuffmanTree T;    BuildMinHeap(H); &#x2F;*将H-&gt;Elements[]按权值调整为最小堆*&#x2F;    int size &#x3D; H-&gt;Size;    for (i &#x3D; 1; i &lt; size; i++) &#123; &#x2F;*做H-&gt;Size-1次合并*&#x2F;        T &#x3D; (HuffmanTree)malloc(sizeof(struct TreeNode)); &#x2F;*建立新结点*&#x2F;        T-&gt;Left &#x3D; DeleteMin(H);        &#x2F;*从最小堆中删除一个结点， 作为新T的左子结点*&#x2F;        T-&gt;Right &#x3D; DeleteMin(H);        &#x2F;*从最小堆中删除一个结点， 作为新T的右子结点*&#x2F;        T-&gt;Weight &#x3D; T-&gt;Left-&gt;Weight + T-&gt;Right-&gt;Weight;        &#x2F;*计算新权值*&#x2F;        Insert(H, T); &#x2F;*将新T插入最小堆*&#x2F;    &#125;    T &#x3D; DeleteMin(H);    return T;&#125;&#x2F;*------------------ Set ------------------*&#x2F;#define MAXN 1000        &#x2F;* 集合最大元素个数 *&#x2F;typedef int ElementType; &#x2F;* 默认元素可以用非负整数表示 *&#x2F;typedef int SetName;     &#x2F;* 默认用根结点的下标作为集合名称 *&#x2F;typedef ElementType SetType[MAXN]; &#x2F;* 假设集合元素下标从0开始 *&#x2F;void Union(SetType S,           SetName Root1,           SetName Root2) &#123; &#x2F;* 这里默认Root1和Root2是不同集合的根结点 *&#x2F;    &#x2F;* 保证小集合并入大集合 *&#x2F;    if (S[Root2] &lt; S[Root1]) &#123; &#x2F;* 如果集合2比较大 *&#x2F;        S[Root2] +&#x3D; S[Root1];  &#x2F;* 集合1并入集合2  *&#x2F;        S[Root1] &#x3D; Root2;    &#125; else &#123;                  &#x2F;* 如果集合1比较大 *&#x2F;        S[Root1] +&#x3D; S[Root2]; &#x2F;* 集合2并入集合1  *&#x2F;        S[Root2] &#x3D; Root1;    &#125;&#125;SetName Find(SetType S, ElementType X) &#123; &#x2F;* 默认集合元素全部初始化为-1 *&#x2F;    if (S[X] &lt; 0)                        &#x2F;* 找到集合的根 *&#x2F;        return X;    else        return S[X] &#x3D; Find(S, S[X]); &#x2F;* 路径压缩 *&#x2F;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h3><h3 id="1-堆中的路径"><a href="#1-堆中的路径" class="headerlink" title="1.堆中的路径"></a><a href="https://pintia.cn/problem-sets/434/problems/6104">1.堆中的路径</a></h3><p>将一系列给定数字插入一个初始为空的小顶堆<code>H[]</code>。随后对任意给定的下标<code>i</code>，打印从<code>H[i]</code>到根结点的路径。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>每组测试第1行包含2个正整数<em>N</em>和<em>M</em>(≤1000)，分别是插入元素的个数、以及需要打印的路径条数。下一行给出区间[-10000, 10000]内的<em>N</em>个要被插入一个初始为空的小顶堆的整数。最后一行给出<em>M</em>个下标。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>对输入中给出的每个下标<code>i</code>，在一行中输出从<code>H[i]</code>到根结点的路径上的数据。数字间以1个空格分隔，行末不得有多余空格。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">5 346 23 26 24 105 4 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">24 23 1046 23 1026 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>建立最小堆的基本操作训练，这里采用逐个插入的方法建造堆，套模板，不赘述。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXN</span> <span class="token expression"><span class="token number">1001</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MINH</span> <span class="token expression"><span class="token operator">-</span><span class="token number">10001</span></span></span><span class="token keyword">int</span> H<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    H<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> MINH<span class="token punctuation">;</span>    <span class="token comment">/*设置“岗哨” */</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将X插入H。这里省略检查堆是否已满的代码 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token operator">++</span>size<span class="token punctuation">;</span> H<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">></span> X<span class="token punctuation">;</span> i <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span>        H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> x<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">/* 堆初始化 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*以逐个插入方式建堆 */</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> H<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*沿根方向输出各结点*/</span>            j <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span> H<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 调整到根、到中间位置，有不需要调整的元素</td><td>答案正确</td><td>13</td><td>3 ms</td><td>316 KB</td></tr><tr><td>1</td><td>路径更长，交错，index从中间开始，有负数</td><td>答案正确</td><td>6</td><td>3 ms</td><td>308 KB</td></tr><tr><td>2</td><td>最小N和M</td><td>答案正确</td><td>2</td><td>3 ms</td><td>184 KB</td></tr><tr><td>3</td><td>最大N和M随机，元素取到正负10000</td><td>答案正确</td><td>4</td><td>4 ms</td><td>320 KB</td></tr></tbody></table><h3 id="2-File-Transfer"><a href="#2-File-Transfer" class="headerlink" title="2.File Transfer"></a><a href="https://pintia.cn/problem-sets/16/problems/670">2.File Transfer</a></h3><p>关于并查集，2005、2007年浙江大学计算机学院免试研究生上机考试题即由此题改编而来。</p><p>We have a network of computers and a list of bi-directional connections. Each of these connections allows a file transfer from one computer to another. Is it possible to send a file from any computer on the network to any other?</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each test case, the first line contains <em>N</em> $(2≤N≤10^4)$, the total number of computers in a network. Each computer in the network is then represented by a positive integer between 1 and <em>N</em>. Then in the following lines, the input is given in the format:</p><pre class="line-numbers language-none"><code class="language-none">I c1 c2  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>I</code> stands for inputting a connection between <code>c1</code> and <code>c2</code>; or</p><pre class="line-numbers language-none"><code class="language-none">C c1 c2    <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>C</code> stands for checking if it is possible to transfer files between <code>c1</code> and <code>c2</code>; or</p><pre class="line-numbers language-none"><code class="language-none">S<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>S</code> stands for stopping this case.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each <code>C</code> case, print in one line the word “yes” or “no” if it is possible or impossible to transfer files between <code>c1</code> and <code>c2</code>, respectively. At the end of each case, print in one line “The network is connected.” if there is a path between any pair of computers; or “There are <code>k</code> components.” where <code>k</code> is the number of connected components in this network.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">5C 3 2I 3 2C 1 5I 4 5I 2 4C 3 5S<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">nonoyesThere are 2 components.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">5C 3 2I 3 2C 1 5I 4 5I 2 4C 3 5I 1 3C 1 5S<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">nonoyesyesThe network is connected.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>此题的关键在于如何提高效率。</p><p>TSSN的实现（too simple sometimes neive）</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">SetName <span class="token function">Find</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 默认集合元素全部初始化为-1 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> X <span class="token operator">=</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token keyword">return</span> X<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Union</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> SetName Root1<span class="token punctuation">,</span> SetName Root2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token comment">/* 这里默认Root1和Root2是不同集合的根结点 */</span>    S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">=</span> Root1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Find</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MaxSize <span class="token operator">&amp;&amp;</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Data <span class="token operator">!=</span> X<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> MaxSize<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Parent <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">=</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Parent<span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token keyword">return</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Union</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ElementType X1<span class="token punctuation">,</span> ElementType X2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">;</span>    Root1 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> X1<span class="token punctuation">)</span><span class="token punctuation">;</span>    Root2 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> X2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Root1 <span class="token operator">!=</span> Root2<span class="token punctuation">)</span> S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span><span class="token punctuation">.</span>Parent <span class="token operator">=</span> Root1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对照下文测试点即知道为何不行（doge）。</p><p>下面引入按秩归并。</p><p>为什么需要按秩归并？ </p><p>因为朴素的Union$T(n)=O(n^2)$。关键在于树会越来越高！</p><p>所以应该把矮树贴到高树上！</p><p>树的高度存哪里？ </p><p>S[Root] = -树高; （仍然初始化为-1）</p><p>最坏情况下的树高 =$ O(log N)$​  </p><p>另一种做法：比规模  </p><p>把小树贴到大树上 S[Root] = -元素个数;  </p><p>两种方法统称“按秩归并”</p><p>同时还需要路径压缩 ：先找到根；把根变成 X 的父结点；再返回根。</p><p>时间复杂度  </p><p>引理 （Tarjan）令$ T( M, N )$ 为交错执行$M \geq N$ 次带路径压缩的查找和$N - 1$ 次按秩归并的最坏情况时间。则存在正常数 $k_1$ 和 $k_2$使得:<br>$$<br>k_1M\alpha(M,N)\leq T(M,N)\leq k_2M\alpha(M,N)<br>$$<br><strong>Ackermann 函数和</strong> $\alpha( M, N )$​<br>$$<br>A(i,j)=\left\{<br>    \begin{aligned}<br>        &amp; 2^j   &amp; i=1\ and\ j\geq1\newline<br>        &amp; A(i-1,2)   &amp; i\geq2\ and\ j=1 \newline<br>        &amp; A(i-1,A(i,j-1))   &amp; i\geq 2\ and\ j\geq2<br>    \end{aligned}<br>\right.<br>$$<br><a href="http://mathworld.wolfram.com/AckermannFunction.html">http://mathworld.wolfram.com/AckermannFunction.html</a><br>$$<br>\alpha(M,N)=min\{i\geq1 |A(i,\lfloor M/N\rfloor)&gt;logN\}\leq O(log^{@}N)\leq4<br>$$<br>$log^{@}N$​（Ackermann反函数）=对N求对数直到结果$\leq1$​​的次数</p><p>$log^{@}2^{65536}=5$​  因为 $logloglogloglog(2^{65536})=1$​​</p><p>所以事实上路径压缩不会使得算法的时间复杂度有显著的下降，但也是一个可行的手段。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxSize</span> <span class="token expression"><span class="token number">10000</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span> <span class="token comment">/*默认元素可以用非负整数表示*/</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> SetName<span class="token punctuation">;</span>     <span class="token comment">/*默认用根结点的下标作为集合名称*/</span><span class="token keyword">typedef</span> ElementType SetType<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">;</span>SetName <span class="token function">Find</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 找到集合的根 */</span>        <span class="token keyword">return</span> X<span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> S<span class="token punctuation">[</span>X<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Union</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> SetName Root1<span class="token punctuation">,</span> SetName Root2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">+=</span> S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span><span class="token punctuation">;</span>        S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span> <span class="token operator">=</span> Root2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        S<span class="token punctuation">[</span>Root1<span class="token punctuation">]</span> <span class="token operator">+=</span> S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span><span class="token punctuation">;</span>        S<span class="token punctuation">[</span>Root2<span class="token punctuation">]</span> <span class="token operator">=</span> Root1<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Initialization</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Input_connection</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    ElementType u<span class="token punctuation">,</span> v<span class="token punctuation">;</span>    SetName Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    Root1 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> u <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Root2 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> v <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Root1 <span class="token operator">!=</span> Root2<span class="token punctuation">)</span>        <span class="token function">Union</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Check_connection</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    ElementType u<span class="token punctuation">,</span> v<span class="token punctuation">;</span>    SetName Root1<span class="token punctuation">,</span> Root2<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    Root1 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> u <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Root2 <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> v <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Root1 <span class="token operator">==</span> Root2<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"yes\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"no\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Check_network</span><span class="token punctuation">(</span>SetType S<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            counter<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>counter <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"The network is connected.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"There are %d components.\n"</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    SetType S<span class="token punctuation">;</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>    <span class="token keyword">char</span> in<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Initialization</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>in<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token string">'I'</span><span class="token operator">:</span>            <span class="token function">Input_connection</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'C'</span><span class="token operator">:</span>            <span class="token function">Check_connection</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'S'</span><span class="token operator">:</span>            <span class="token function">Check_network</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>in <span class="token operator">!=</span> <span class="token string">'S'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 1 合并2个集合，最后不连通</td><td>答案正确</td><td>7</td><td>4 ms</td><td>316 KB</td></tr><tr><td>1</td><td>sample 2 最后连通</td><td>答案正确</td><td>7</td><td>4 ms</td><td>324 KB</td></tr><tr><td>2</td><td>最小N，无连通操作</td><td>答案正确</td><td>1</td><td>4 ms</td><td>300 KB</td></tr><tr><td>3</td><td>最大N，无操作</td><td>答案正确</td><td>1</td><td>6 ms</td><td>312 KB</td></tr><tr><td>4</td><td>最大N，递增链，卡不按大小union的</td><td>答案正确</td><td>4</td><td>7 ms</td><td>304 KB</td></tr><tr><td>5</td><td>最大N，递减链，卡不按大小union的</td><td>答案正确</td><td>4</td><td>9 ms</td><td>316 KB</td></tr><tr><td>6</td><td>最大N，两两合并，反复查最深结点，卡不压缩路径的</td><td>答案正确</td><td>1</td><td>16 ms</td><td>300 KB</td></tr></tbody></table><h3 id="3-Huffman-Codes"><a href="#3-Huffman-Codes" class="headerlink" title="3.Huffman Codes"></a><a href="https://pintia.cn/problem-sets/16/problems/671">3.Huffman Codes</a></h3><p>In 1953, David A. Huffman published his paper “A Method for the Construction of Minimum-Redundancy Codes”, and hence printed his name in the history of computer science. As a professor who gives the final exam problem on Huffman codes, I am encountering a big problem: the Huffman codes are NOT unique. For example, given a string “aaaxuaxz”, we can observe that the frequencies of the characters ‘a’, ‘x’, ‘u’ and ‘z’ are 4, 2, 1 and 1, respectively. We may either encode the symbols as {‘a’=0, ‘x’=10, ‘u’=110, ‘z’=111}, or in another way as {‘a’=1, ‘x’=01, ‘u’=001, ‘z’=000}, both compress the string into 14 bits. Another set of code can be given as {‘a’=0, ‘x’=11, ‘u’=100, ‘z’=101}, but {‘a’=0, ‘x’=01, ‘u’=011, ‘z’=001} is NOT correct since “aaaxuaxz” and “aazuaxax” can both be decoded from the code 00001011001001. The students are submitting all kinds of codes, and I need a computer program to help me determine which ones are correct and which ones are not.</p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line gives an integer <em>N</em> (2≤<em>N</em>≤63), then followed by a line that contains all the <em>N</em> distinct characters and their frequencies in the following format:</p><pre class="line-numbers language-none"><code class="language-none">c[1] f[1] c[2] f[2] ... c[N] f[N]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>c[i]</code> is a character chosen from {‘0’ - ‘9’, ‘a’ - ‘z’, ‘A’ - ‘Z’, ‘_’}, and <code>f[i]</code> is the frequency of <code>c[i]</code> and is an integer no more than 1000. The next line gives a positive integer <em>M</em> (≤1000), then followed by <em>M</em> student submissions. Each student submission consists of <em>N</em> lines, each in the format:</p><pre class="line-numbers language-none"><code class="language-none">c[i] code[i]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>c[i]</code> is the <code>i</code>-th character and <code>code[i]</code> is an non-empty string of no more than 63 ‘0’s and ‘1’s.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in each line either “Yes” if the student’s submission is correct, or “No” if not.</p><p>Note: The optimal solution is not necessarily generated by Huffman algorithm. Any prefix code with code length being optimal is considered correct.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">7A 1 B 1 C 1 D 3 E 3 F 6 G 64A 00000B 00001C 0001D 001E 01F 10G 11A 01010B 01011C 0100D 011E 10F 11G 00A 000B 001C 010D 011E 100F 101G 110A 00000B 00001C 0001D 001E 00F 10G 11结尾无空行<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">YesYesNoNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>Huffman编码不唯一，并且最优编码不一定通过Huffman编码得到！</p><p>回顾Huffman Codes 的特点  </p><ol><li>最优编码 —— 总长度（WPL）最小</li><li>无歧义解码 —— 前缀码：数据仅存于叶子结点</li><li>有度为1的结点 —— 满足1、 2则必然有3  </li></ol><p>注意：满足2、 3可不一定有1！  </p><p>核心算法  </p><p>1.计算最优编码长度  </p><p>2.对每位学生的提交，检查</p><p>a) 长度是否正确 $Len=\sum_{i=0}^{N-1}strlen(code[i])\times f(i))$</p><p>注意：$Code[i]$的最大长度为$N-1$</p><p>b) 建树的过程中检查是否满足前缀码要求</p><p>本题相对来说代码冗长，还有不少细节需要注意。</p><p>特别地，在此处指出慕课里给出的代码模板的一个错误，在创建HUffman树时，需要经过H-&gt;Size-1次调整，但是在for循环的条件里不能直接写成i &lt; H-&gt;Size-1​​​，因为DeleteMin后H-&gt;Size会变化，应该提前记录H-&gt;Size的值。</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXN</span> <span class="token expression"><span class="token number">65</span></span></span><span class="token keyword">int</span> Weight<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token operator">*</span>HuffmanTree<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Weight<span class="token punctuation">;</span>    <span class="token keyword">char</span> c<span class="token punctuation">;</span>    HuffmanTree Left<span class="token punctuation">,</span> Right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> HuffmanTree ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">HNode</span> <span class="token operator">*</span>Heap<span class="token punctuation">;</span> <span class="token comment">/* 堆的类型定义 */</span><span class="token keyword">struct</span> <span class="token class-name">HNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span> <span class="token comment">/* 存储元素的数组 */</span>    <span class="token keyword">int</span> Size<span class="token punctuation">;</span>          <span class="token comment">/* 堆中当前元素个数 */</span>    <span class="token keyword">int</span> Capacity<span class="token punctuation">;</span>      <span class="token comment">/* 堆的最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> Heap MinHeap<span class="token punctuation">;</span> <span class="token comment">/* 最小堆 */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MINDATA</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span> </span><span class="token comment">/* 该值应根据具体情况定义为小于堆中所有可能元素的值 */</span></span>HuffmanTree <span class="token function">NewHuffmanNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    HuffmanTree BST <span class="token operator">=</span> <span class="token punctuation">(</span>HuffmanTree<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    BST<span class="token operator">-></span>Weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    BST<span class="token operator">-></span>Left <span class="token operator">=</span> BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>MinHeap <span class="token function">CreateHeap</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 创建容量为MaxSize的空的最小堆 */</span>    MinHeap H <span class="token operator">=</span> <span class="token punctuation">(</span>MinHeap<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">HNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MaxSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    H<span class="token operator">-></span>Capacity <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    HuffmanTree T <span class="token operator">=</span> <span class="token function">NewHuffmanNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    T<span class="token operator">-></span>Weight <span class="token operator">=</span> MINDATA<span class="token punctuation">;</span> <span class="token comment">/* 定义"哨兵"为小于堆中所有可能元素的值*/</span>    H<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> T<span class="token punctuation">;</span>    <span class="token keyword">return</span> H<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsFull</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>Size <span class="token operator">==</span> H<span class="token operator">-></span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Insert</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将元素X插入最小堆H，其中H->Data[0]已经定义为哨兵 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsFull</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"最小堆已满"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    i <span class="token operator">=</span> <span class="token operator">++</span>H<span class="token operator">-></span>Size<span class="token punctuation">;</span> <span class="token comment">/* i指向插入后堆中的最后一个元素的位置 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-></span>Weight <span class="token operator">></span> X<span class="token operator">-></span>Weight<span class="token punctuation">;</span> i <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span>        H<span class="token operator">-></span>Data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 上滤X */</span>    H<span class="token operator">-></span>Data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>                  <span class="token comment">/* 将X插入 */</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token constant">NULL</span> </span><span class="token comment">/* 错误标识应根据具体情况定义为堆中不可能出现的元素值 */</span></span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>H<span class="token operator">-></span>Size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteMin</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 从最小堆H中取出键值为最大的元素，并删除一个结点 */</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">,</span> Child<span class="token punctuation">;</span>    ElementType MinItem<span class="token punctuation">,</span> X<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"最小堆已为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    MinItem <span class="token operator">=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出根结点存放的最小值 */</span>    <span class="token comment">/* 用最小堆中最后一个元素从根结点开始向上过滤下层结点 */</span>    X <span class="token operator">=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>H<span class="token operator">-></span>Size<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 注意当前堆的规模要减小 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Parent <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> H<span class="token operator">-></span>Size<span class="token punctuation">;</span> Parent <span class="token operator">=</span> Child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Child <span class="token operator">=</span> Parent <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Child <span class="token operator">!=</span> H<span class="token operator">-></span>Size<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>            <span class="token punctuation">(</span>H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token operator">-></span>Weight <span class="token operator">></span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">)</span>            Child<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* Child指向左右子结点的较大者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X<span class="token operator">-></span>Weight <span class="token operator">&lt;=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token operator">-></span>Weight<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* 找到了合适位置 */</span>        <span class="token keyword">else</span>       <span class="token comment">/* 下滤X */</span>            H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>    <span class="token keyword">return</span> MinItem<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*----------- 建造最小堆 -----------*/</span><span class="token keyword">void</span> <span class="token function">PercDown</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 下滤：将H中以H->Data[p]为根的子堆调整为最小堆 */</span>    <span class="token keyword">int</span> Parent<span class="token punctuation">,</span> Child<span class="token punctuation">;</span>    ElementType X<span class="token punctuation">;</span>    X <span class="token operator">=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 取出根结点存放的值 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Parent <span class="token operator">=</span> p<span class="token punctuation">;</span> Parent <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> H<span class="token operator">-></span>Size<span class="token punctuation">;</span> Parent <span class="token operator">=</span> Child<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Child <span class="token operator">=</span> Parent <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Child <span class="token operator">!=</span> H<span class="token operator">-></span>Size<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>            <span class="token punctuation">(</span>H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token operator">-></span>Weight <span class="token operator">></span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">)</span>            Child<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* Child指向左右子结点的较大者 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X<span class="token operator">-></span>Weight <span class="token operator">&lt;=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token operator">-></span>Weight<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">/* 找到了合适位置 */</span>        <span class="token keyword">else</span>       <span class="token comment">/* 下滤X */</span>            H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Child<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    H<span class="token operator">-></span>Data<span class="token punctuation">[</span>Parent<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">BuildMinHeap</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 调整H->Data[]中的元素，使满足最小堆的有序性  */</span>    <span class="token comment">/* 这里假设所有H->Size个元素已经存在H->Data[]中 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token comment">/* 从最后一个结点的父节点开始，到根结点1 */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> H<span class="token operator">-></span>Size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token function">PercDown</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*HUFFMAN TREE*/</span>HuffmanTree <span class="token function">Huffman</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 假设H->Size个权值已经存在H->Elements[]->Weight里 */</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    HuffmanTree T<span class="token punctuation">;</span>    <span class="token function">BuildMinHeap</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*将H->Elements[]按权值调整为最小堆*/</span>    <span class="token keyword">int</span> size <span class="token operator">=</span> H<span class="token operator">-></span>Size<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*做H->Size-1次合并*/</span>        T <span class="token operator">=</span> <span class="token function">NewHuffmanNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*建立新结点*/</span>        T<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*从最小堆中删除一个结点， 作为新T的左子结点*/</span>        T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*从最小堆中删除一个结点， 作为新T的右子结点*/</span>        T<span class="token operator">-></span>Weight <span class="token operator">=</span> T<span class="token operator">-></span>Left<span class="token operator">-></span>Weight <span class="token operator">+</span> T<span class="token operator">-></span>Right<span class="token operator">-></span>Weight<span class="token punctuation">;</span>        <span class="token comment">/*计算新权值*/</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*将新T插入最小堆*/</span>    <span class="token punctuation">&#125;</span>    T <span class="token operator">=</span> <span class="token function">DeleteMin</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">ReadData</span><span class="token punctuation">(</span>MinHeap H<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读换行</span>        HuffmanTree T <span class="token operator">=</span> <span class="token function">NewHuffmanNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>T<span class="token operator">-></span>c<span class="token punctuation">,</span> <span class="token operator">&amp;</span>T<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>        Weight<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>T<span class="token operator">-></span>c<span class="token punctuation">]</span> <span class="token operator">=</span> T<span class="token operator">-></span>Weight<span class="token punctuation">;</span>        H<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token operator">++</span><span class="token punctuation">(</span>H<span class="token operator">-></span>Size<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> T<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">WPL</span><span class="token punctuation">(</span>HuffmanTree T<span class="token punctuation">,</span> <span class="token keyword">int</span> Depth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>T<span class="token operator">-></span>Left <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>Depth <span class="token operator">*</span> T<span class="token operator">-></span>Weight<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token comment">/* 否则T一定有2个孩子 */</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">WPL</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">,</span> Depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">WPL</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">,</span> Depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">judge</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>str2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>str1<span class="token operator">++</span> <span class="token operator">==</span> <span class="token operator">*</span>str2<span class="token operator">++</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>str1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>str2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">--</span>str1 <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token operator">--</span>str2<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> M<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    MinHeap H <span class="token operator">=</span> <span class="token function">CreateHeap</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建一个空的、容量为N的最小堆 */</span>    <span class="token function">ReadData</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">/* 将f[]读入H->Data[]中 */</span>    HuffmanTree T <span class="token operator">=</span> <span class="token function">Huffman</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 建立Huffman树 */</span>    <span class="token keyword">int</span> CodeLen <span class="token operator">=</span> <span class="token function">WPL</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>M<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>M<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> c<span class="token punctuation">,</span> code<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c %s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">,</span> code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">></span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> sum <span class="token operator">+=</span> Weight<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c<span class="token punctuation">]</span> <span class="token operator">*</span> length<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">!=</span> CodeLen<span class="token punctuation">)</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> pre <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> j<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">judge</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> code<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        pre <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                        <span class="token keyword">break</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>pre<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>pre<span class="token punctuation">)</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Yes\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 有并列、多分支，有长度错、长度对但是前缀错；仅英文大写字符</td><td>答案正确</td><td>16</td><td>3 ms</td><td>196 KB</td></tr><tr><td>1</td><td>小写字母，01反、且2点对换；有2点重合</td><td>答案正确</td><td>7</td><td>4 ms</td><td>176 KB</td></tr><tr><td>2</td><td>几组编码不等长，都对；等长但前缀错误；code长度超过N</td><td>答案正确</td><td>3</td><td>3 ms</td><td>192 KB</td></tr><tr><td>3</td><td>最大N&amp;M，code长度等于63</td><td>答案正确</td><td>1</td><td>40 ms</td><td>192 KB</td></tr><tr><td>4</td><td>最小N&amp;M</td><td>答案正确</td><td>1</td><td>3 ms</td><td>192 KB</td></tr><tr><td>5</td><td>编码的字符是双数个，而提交采用的是等长编码。卡仅判断叶结点和度的错误算法</td><td>答案正确</td><td>1</td><td>4 ms</td><td>192 KB</td></tr><tr><td>6</td><td>非Huffman编码，但是正确；没有停在叶子上</td><td>答案正确</td><td>1</td><td>4 ms</td><td>196 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week4</title>
      <link href="2021/073150028.html"/>
      <url>2021/073150028.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week4树（中）"><a href="#Week4树（中）" class="headerlink" title="Week4树（中）"></a>Week4树（中）</h1><h2 id="4-1-二叉搜索树"><a href="#4-1-二叉搜索树" class="headerlink" title="4.1 二叉搜索树"></a>4.1 二叉搜索树</h2><h3 id="什么是二叉搜索树"><a href="#什么是二叉搜索树" class="headerlink" title="什么是二叉搜索树"></a>什么是二叉搜索树</h3><p><strong>查找问题:</strong></p><ul><li>静态查找与动态查找</li><li>针对动态查找，数据如何组织？  </li></ul><p><strong>二叉搜索树</strong>（BST， Binary Search Tree），也称<strong>二叉排序树</strong>或<strong>二叉查找树</strong>  </p><p>二叉搜索树：一棵二叉树，可以为空；如果不为空，满足以下性质：</p><ol><li>非空<strong>左子树</strong>的所有<strong>键值小于其根结点</strong>的键值。</li><li>非空<strong>右子树</strong>的所有<strong>键值大于其根结点</strong>的键值。</li><li><strong>左、右子树都是二叉搜索树</strong>。  </li></ol><h3 id="二叉搜索树操作的特别函数"><a href="#二叉搜索树操作的特别函数" class="headerlink" title="二叉搜索树操作的特别函数"></a>二叉搜索树操作的特别函数</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">Find</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span><span class="token comment">//从二叉搜索树BST中查找元素X，返回其所在结点的地址；</span>Position <span class="token function">FindMin</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">)</span><span class="token comment">//从二叉搜索树BST中查找并返回最小元素所在结点的地址；</span>Position <span class="token function">FindMax</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">)</span><span class="token comment">//从二叉搜索树BST中查找并返回最大元素所在结点的地址。</span>BinTree <span class="token function">Insert</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span>BinTree <span class="token function">Delete</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二叉搜索树的查找操作：-Find"><a href="#二叉搜索树的查找操作：-Find" class="headerlink" title="二叉搜索树的查找操作： Find"></a>二叉搜索树的查找操作： Find</h3><ul><li><p>查找从根结点开始，如果树为空，返回NULL</p></li><li><p>若搜索树非空，则根结点关键字和X进行比较， 并进行不同处理：</p><p>1.若X小于根结点键值，只需在左子树中继续搜索；</p><p>2.如果X大于根结点的键值， 在右子树中进行继续搜索；</p><p>3.若两者比较结果是相等，搜索完成，返回指向此结点的指针。  </p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">Find</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>          <span class="token comment">/*查找失败*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>         <span class="token keyword">return</span> <span class="token function">Find</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*在右子树中继续查找*/</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>         <span class="token keyword">return</span> <span class="token function">Find</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*在左子树中继续查找*/</span>    <span class="token keyword">else</span>                           <span class="token comment">/* X == BST->Data */</span>        <span class="token keyword">return</span> BST<span class="token punctuation">;</span> <span class="token comment">/*查找成功， 返回结点的找到结点的地址*/</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由于非递归函数的执行效率高，可将“尾递归” 函数改为迭代函数  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">IterFind</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>BST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>BST <span class="token operator">=</span> BST<span class="token operator">-></span>Right<span class="token punctuation">;</span> <span class="token comment">/*向右子树中移动， 继续查找*/</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>BST <span class="token operator">=</span> BST<span class="token operator">-></span>Left<span class="token punctuation">;</span> <span class="token comment">/*向左子树中移动， 继续查找*/</span><span class="token keyword">else</span> <span class="token comment">/* X == BST->Data */</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span> <span class="token comment">/*查找成功， 返回结点的找到结点的地址*/</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">/*查找失败*/</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>查找的效率决定于树的高度</strong>  </p><ul><li>最大元素一定是在树的最右分枝的端结点上</li><li>最小元素一定是在树的最左分枝的端结点上    </li></ul><p>查找最小元素的<strong>递归</strong>函数  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">FindMin</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">/*空的二叉搜索树，返回NULL*/</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span> <span class="token comment">/*找到最左叶结点并返回*/</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token function">FindMin</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*沿左分支继续查找*/</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>查找最大元素的<strong>迭代</strong>函数  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">FindMax</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BST<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">)</span> BST <span class="token operator">=</span> BST<span class="token operator">-></span>Right<span class="token punctuation">;</span><span class="token comment">/*沿右分支继续查找，直到最右叶结点*/</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二叉搜索树的插入"><a href="#二叉搜索树的插入" class="headerlink" title="二叉搜索树的插入"></a>二叉搜索树的插入</h3><p>分析 关键是要找到元素应该插入的<strong>位置</strong>，可以采用与<strong>Find</strong>类似的方法  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">BinTree <span class="token function">Insert</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">/*若原树为空， 生成并返回一个结点的二叉搜索树*/</span>BST <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>BST<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>BST<span class="token operator">-></span>Left <span class="token operator">=</span> BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token comment">/*开始找要插入元素的位置*/</span><span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>BST<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*递归插入左子树*/</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*递归插入右子树*/</span><span class="token comment">/* else X已经存在， 什么都不做 */</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二叉搜索树的删除"><a href="#二叉搜索树的删除" class="headerlink" title="二叉搜索树的删除"></a>二叉搜索树的删除</h3><p>考虑<strong>三种情况</strong>：  </p><p>1.要删除的是<strong>叶结点</strong>： 直接删除， 并再修改其父结点指针—置为NULL  </p><p>2.要删除的结点只有一个孩子结点:将其父结点的指针指向要删除结点的孩子结点  </p><p>3.要删除的结点有左、右两棵子树：用另一结点替代被删除结点： 右子树的最小元素 或者 左子树的最大元素  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">BinTree <span class="token function">Delete</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Position Tmp<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"要删除的元素未找到"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>BST<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 左子树递归删除 */</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 右子树递归删除 */</span><span class="token keyword">else</span> <span class="token comment">/*找到要删除的结点 */</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BST<span class="token operator">-></span>Left <span class="token operator">&amp;&amp;</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*被删除结点有左右两个子结点 */</span>Tmp <span class="token operator">=</span> <span class="token function">FindMin</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*在右子树中找最小的元素填充删除结点*/</span>BST<span class="token operator">-></span>Data <span class="token operator">=</span> Tmp<span class="token operator">-></span>Data<span class="token punctuation">;</span>BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Data<span class="token punctuation">,</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*在删除结点的右子树中删除最小元素*/</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*被删除结点有一个或无子结点*/</span>Tmp <span class="token operator">=</span> BST<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token comment">/* 有右孩子或无子结点*/</span>BST <span class="token operator">=</span> BST<span class="token operator">-></span>Right<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token comment">/*有左孩子或无子结点*/</span>BST <span class="token operator">=</span> BST<span class="token operator">-></span>Left<span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-2平衡二叉树"><a href="#4-2平衡二叉树" class="headerlink" title="4.2平衡二叉树"></a>4.2平衡二叉树</h2><h3 id="什么是平衡二叉树"><a href="#什么是平衡二叉树" class="headerlink" title="什么是平衡二叉树"></a>什么是平衡二叉树</h3><p>搜索树结点不同插入次序，将导致不同的<strong>深度</strong>和平均查找长度<strong>ASL</strong>  </p><p>“平衡因子（ Balance Factor，简称BF） : $BF(T) = h_L-h_R$，其中$h_L$和$h_R$分别为T的左、右子树的高度。  </p><p><strong>平衡二叉树</strong>（ Balanced Binary Tree）（ <strong>AVL树</strong>）<br>空树，或者任一结点左、右子树高度差的绝对值不超过1，即$|BF(T) |≤ 1$  </p><p>平衡二叉树的高度能达到log2n吗？</p><p>设 $n_h$ 高度为h的平衡二叉树的最少结点数。结点数最少时：$n_h = n_{h-1} + n_{h-2} + 1$  </p><p>斐波那契序列:$F_0= 1, F_1 = 1, F_i = F_{i-1} + F_{i-2}\qquad for\ i &gt; 1 $​​ </p><table><thead><tr><th>h</th><th>$n_h$</th><th>$F_h$</th></tr></thead><tbody><tr><td>0</td><td>1</td><td>1</td></tr><tr><td>1</td><td>2</td><td>1</td></tr><tr><td>2</td><td>4</td><td>2</td></tr><tr><td>3</td><td>7</td><td>3</td></tr><tr><td>4</td><td>12</td><td>5</td></tr><tr><td>5</td><td>30</td><td>8</td></tr><tr><td>6</td><td>33</td><td>13</td></tr><tr><td>7</td><td>54</td><td>21</td></tr><tr><td>8</td><td>88</td><td>34</td></tr><tr><td>9</td><td>$\cdots$</td><td>$\cdots$</td></tr></tbody></table><p>$$<br>n_h = F_{h+2}-1(h\geq0)<br>$$</p><p>$$<br>F_i\approx \frac{1}{\sqrt{5} }(\frac{1+\sqrt{5}}{2})^i<br>$$</p><p>$$<br>n_h\approx \frac{1}{\sqrt{5} }(\frac{1+\sqrt{5}}{2})^{h+2}-1<br>$$</p><p>$$<br>h=O(log_2n)<br>$$</p><p>给定结点数为$n$的$AVL$树的最大高度为$O(log2n)！$  </p><h3 id="平衡二叉树的调整"><a href="#平衡二叉树的调整" class="headerlink" title="平衡二叉树的调整"></a>平衡二叉树的调整</h3><p><strong>麻烦结点</strong>在发现者<strong>右</strong>子树的<strong>右边</strong>，因而叫 <strong>RR 插入</strong>，需要<strong>RR 旋转（右单旋）</strong>  </p><p><strong>麻烦结点</strong>在发现者<strong>左</strong>子树的<strong>左边</strong>，因而叫 <strong>LL 插入</strong>，需要<strong>LL 旋转（左单旋）</strong>  </p><p><strong>麻烦结点</strong>在<strong>左</strong>子树的<strong>右边</strong>，因而叫 <strong>LR 插入</strong>，需要<strong>LR 旋转</strong>  </p><p><strong>注意：有时候插入元素即便不需要调整结构，也可能需要重新计算一些平衡因子。</strong>  </p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TNode</span> <span class="token operator">*</span>Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> Position BinTree<span class="token punctuation">;</span> <span class="token comment">/* 二叉树类型 */</span><span class="token keyword">struct</span> <span class="token class-name">TNode</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 树结点定义 */</span>    ElementType Data<span class="token punctuation">;</span>     <span class="token comment">/* 结点数据 */</span>    BinTree Left<span class="token punctuation">;</span>         <span class="token comment">/* 指向左子树 */</span>    BinTree Right<span class="token punctuation">;</span>        <span class="token comment">/* 指向右子树 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>BinTree <span class="token function">Insert</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 若原树为空，生成并返回一个结点的二叉搜索树 */</span>        BST <span class="token operator">=</span> <span class="token punctuation">(</span>BinTree<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        BST<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>        BST<span class="token operator">-></span>Left <span class="token operator">=</span> BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 开始找要插入元素的位置 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*递归插入左子树*/</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*递归插入右子树*/</span>        <span class="token comment">/* else X已经存在，什么都不做 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>BinTree <span class="token function">Delete</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position Tmp<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"要删除的元素未找到"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 从左子树递归删除 */</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 从右子树递归删除 */</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* BST就是要删除的结点 */</span>            <span class="token comment">/* 如果被删除结点有左右两个子结点 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>BST<span class="token operator">-></span>Left <span class="token operator">&amp;&amp;</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">/* 从右子树中找最小的元素填充删除结点 */</span>                Tmp <span class="token operator">=</span> <span class="token function">FindMin</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>                BST<span class="token operator">-></span>Data <span class="token operator">=</span> Tmp<span class="token operator">-></span>Data<span class="token punctuation">;</span>                <span class="token comment">/* 从右子树中删除最小元素 */</span>                BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 被删除结点有一个或无子结点 */</span>                Tmp <span class="token operator">=</span> BST<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token comment">/* 只有右孩子或无子结点 */</span>                    BST <span class="token operator">=</span> BST<span class="token operator">-></span>Right<span class="token punctuation">;</span>                <span class="token keyword">else</span> <span class="token comment">/* 只有左孩子 */</span>                    BST <span class="token operator">=</span> BST<span class="token operator">-></span>Left<span class="token punctuation">;</span>                <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">AVLNode</span> <span class="token operator">*</span>Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> Position AVLTree<span class="token punctuation">;</span> <span class="token comment">/* AVL树类型 */</span><span class="token keyword">struct</span> <span class="token class-name">AVLNode</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">;</span> <span class="token comment">/* 结点数据 */</span>    AVLTree Left<span class="token punctuation">;</span>     <span class="token comment">/* 指向左子树 */</span>    AVLTree Right<span class="token punctuation">;</span>    <span class="token comment">/* 指向右子树 */</span>    <span class="token keyword">int</span> Height<span class="token punctuation">;</span>       <span class="token comment">/* 树高 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> a <span class="token operator">></span> b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>Position P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>P <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> P<span class="token operator">-></span>Height<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token comment">/* 注意：A必须有一个左子结点B */</span>    <span class="token comment">/* 将A与B做左单旋，更新A与B的高度，返回新的根结点B */</span>    AVLTree B <span class="token operator">=</span> A<span class="token operator">-></span>Left<span class="token punctuation">;</span>    A<span class="token operator">-></span>Left <span class="token operator">=</span> B<span class="token operator">-></span>Right<span class="token punctuation">;</span>    B<span class="token operator">-></span>Right <span class="token operator">=</span> A<span class="token punctuation">;</span>    A<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    B<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>B<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token operator">-></span>Height<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> B<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">DoubleLeftRightRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token comment">/* 注意：A必须有一个左子结点B，且B必须有一个右子结点C */</span>    <span class="token comment">/* 将A、B与C做两次单旋，返回新的根结点C */</span>    <span class="token comment">/* 将B与C做右单旋，C被返回 */</span>    A<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 将A与C做左单旋，C被返回 */</span>    <span class="token keyword">return</span> <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*************************************/</span><span class="token comment">/* 对称的右单旋与右-左双旋请自己实现 */</span><span class="token comment">/*************************************/</span><span class="token comment">/* 实现如下 */</span>AVLTree <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 注意：A必须有一个右子结点B */</span>    <span class="token comment">/* 将A与B做右单旋，更新A与B的高度，返回新的根结点B */</span>    AVLTree B <span class="token operator">=</span> A<span class="token operator">-></span>Right<span class="token punctuation">;</span>    A<span class="token operator">-></span>Right <span class="token operator">=</span> B<span class="token operator">-></span>Left<span class="token punctuation">;</span>    B<span class="token operator">-></span>Left <span class="token operator">=</span> A<span class="token punctuation">;</span>    A<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    B<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>B<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token operator">-></span>Height<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> B<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">DoubleRightLeftRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 注意：A必须有一个右子结点B，且B必须有一个左子结点C */</span>    <span class="token comment">/* 将A、B与C做两次单旋，返回新的根结点C */</span>    <span class="token comment">/* 将B与C做左单旋，C被返回 */</span>    A<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 将A与C做右单旋，C被返回 */</span>    <span class="token keyword">return</span> <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">Insert</span><span class="token punctuation">(</span>AVLTree T<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token comment">/* 将X插入AVL树T中，并且返回调整后的AVL树 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>T<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 若插入空树，则新建包含一个结点的树 */</span>        T <span class="token operator">=</span> <span class="token punctuation">(</span>AVLTree<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">AVLNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        T<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>        T<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        T<span class="token operator">-></span>Left <span class="token operator">=</span> T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* if (插入空树) 结束 */</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 插入T的左子树 */</span>        T<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 如果需要左旋 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> T<span class="token operator">-></span>Left<span class="token operator">-></span>Data<span class="token punctuation">)</span>                T <span class="token operator">=</span> <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 左单旋 */</span>            <span class="token keyword">else</span>                T <span class="token operator">=</span> <span class="token function">DoubleLeftRightRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 左-右双旋 */</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* else if (插入左子树) 结束 */</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 插入T的右子树 */</span>        T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 如果需要右旋 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> T<span class="token operator">-></span>Right<span class="token operator">-></span>Data<span class="token punctuation">)</span>                T <span class="token operator">=</span> <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 右单旋 */</span>            <span class="token keyword">else</span>                T <span class="token operator">=</span> <span class="token function">DoubleRightLeftRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 右-左双旋 */</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* else if (插入右子树) 结束 */</span>    <span class="token comment">/* else X == T->Data，无须插入 */</span>    <span class="token comment">/* 别忘了更新树高 */</span>    T<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-是否同一棵二叉搜索树"><a href="#1-是否同一棵二叉搜索树" class="headerlink" title="1.是否同一棵二叉搜索树"></a><a href="https://pintia.cn/problem-sets/15/problems/712">1.是否同一棵二叉搜索树</a></h3><p>给定一个插入序列就可以唯一确定一棵二叉搜索树。然而，一棵给定的二叉搜索树却可以由多种不同的插入序列得到。例如分别按照序列{2, 1, 3}和{2, 3, 1}插入初始为空的二叉搜索树，都得到一样的结果。于是对于输入的各种插入序列，你需要判断它们是否能生成一样的二叉搜索树。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入包含若干组测试数据。每组数据的第1行给出两个正整数<em>N</em> (≤10)和<em>L</em>，分别是每个序列插入元素的个数和需要检查的序列个数。第2行给出<em>N</em>个以空格分隔的正整数，作为初始插入序列。最后<em>L</em>行，每行给出<em>N</em>个插入的元素，属于<em>L</em>个需要检查的序列。</p><p>简单起见，我们保证每个插入序列都是1到<em>N</em>的一个排列。当读到<em>N</em>为0时，标志输入结束，这组数据不要处理。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>对每一组需要检查的序列，如果其生成的二叉搜索树跟对应的初始序列生成的一样，输出“Yes”，否则输出“No”。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 23 1 4 23 4 1 23 2 4 12 12 11 20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">YesNoNo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>两个序列是否对应相同搜索树的判别</p><p>1.分别建两棵搜索树的判别方法，根据两个序列分别建树，再判别树是否一样</p><p>2.不建树的判别方法  </p><p>3.建一棵树，再判别其他序列是否与该树一致  </p><p>这里考虑法三，建树就不赘述，关键在于判别序列。</p><p>方法：在树中按顺序搜索序列中的每个数，如果每次搜索所经过的结点在前面均出现过，则一致 ，否则（某次搜索中遇到前面未出现的结点），则不一致 。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token operator">*</span>Tree<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> v<span class="token punctuation">;</span>    Tree Left<span class="token punctuation">,</span> Right<span class="token punctuation">;</span>    <span class="token keyword">int</span> flag<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>Tree <span class="token function">NewNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//建立新结点</span>    Tree T <span class="token operator">=</span> <span class="token punctuation">(</span>Tree<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    T<span class="token operator">-></span>v <span class="token operator">=</span> V<span class="token punctuation">;</span>    T<span class="token operator">-></span>Left <span class="token operator">=</span> T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    T<span class="token operator">-></span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Tree <span class="token function">Insert</span><span class="token punctuation">(</span>Tree T<span class="token punctuation">,</span> <span class="token keyword">int</span> V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//插入新结点</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>T<span class="token punctuation">)</span>                  <span class="token comment">//空树</span>        T <span class="token operator">=</span> <span class="token function">NewNode</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">></span> T<span class="token operator">-></span>v<span class="token punctuation">)</span>            T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            T<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Tree <span class="token function">MakeTree</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//建树</span>    Tree T<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> V<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>    T <span class="token operator">=</span> <span class="token function">NewNode</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//根节点</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>        T <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">check</span><span class="token punctuation">(</span>Tree T<span class="token punctuation">,</span> <span class="token keyword">int</span> V<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//访问过该节点</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">&lt;</span> T<span class="token operator">-></span>v<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">check</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">></span> T<span class="token operator">-></span>v<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">check</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">//没访问过该节点</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">==</span> T<span class="token operator">-></span>v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            T<span class="token operator">-></span>flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Judge</span><span class="token punctuation">(</span>Tree T<span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//序列的每一个点进行check，若首次新访问的节点值一样，则一样</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> V<span class="token punctuation">,</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/* flag: 0代表目前还一致， 1代表已经不一致*/</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>V <span class="token operator">!=</span> T<span class="token operator">-></span>v<span class="token punctuation">)</span>        flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        T<span class="token operator">-></span>flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//保证读完</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">check</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">ResetT</span><span class="token punctuation">(</span>Tree T<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 清除T中各结点的flag标记 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token function">ResetT</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token function">ResetT</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    T<span class="token operator">-></span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">FreeTree</span><span class="token punctuation">(</span>Tree T<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 释放T的空间 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token function">FreeTree</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token function">FreeTree</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> L<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    Tree T<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>        T <span class="token operator">=</span> <span class="token function">MakeTree</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> L<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Judge</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Yes\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">ResetT</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*清除T中的标记flag*/</span>        <span class="token punctuation">&#125;</span>        <span class="token function">FreeTree</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 换顺序。有Yes，有No：根不同，子树根不同。树有单边、有双子树</td><td>答案正确</td><td>12</td><td>4 ms</td><td>316 KB</td></tr><tr><td>1</td><td>最大N，多组合</td><td>答案正确</td><td>8</td><td>3 ms</td><td>192 KB</td></tr><tr><td>2</td><td>N=1，只有1个节点</td><td>答案正确</td><td>3</td><td>3 ms</td><td>188 KB</td></tr><tr><td>3</td><td>卡只判断数字相对先后位置的错误算法</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr></tbody></table><h3 id="2-Root-of-AVL-Tree"><a href="#2-Root-of-AVL-Tree" class="headerlink" title="2.Root of AVL Tree"></a><a href="https://pintia.cn/problem-sets/16/problems/668">2.Root of AVL Tree</a></h3><p><strong>2013年浙江大学计算机学院免试研究生上机考试真题</strong></p><p>An AVL tree is a self-balancing binary search tree. In an AVL tree, the heights of the two child subtrees of any node differ by at most one; if at any time they differ by more than one, rebalancing is done to restore this property. Figures 1-4 illustrate the rotation rules.</p><p><img src="https://images.ptausercontent.com/d265ae37-4348-4585-b39f-0b2e2e0a24f5.jpg"></p><p><img src="https://images.ptausercontent.com/4a9f6fbd-e21e-4493-834d-7782e13bee4e.jpg"></p><p><img src="https://images.ptausercontent.com/7dc0e66f-c458-4c92-bb8e-55b7bf6391ce.jpg"></p><p><img src="https://images.ptausercontent.com/b17a9687-6be8-4256-873d-6a747154a58d.jpg"></p><p>Now given a sequence of insertions, you are supposed to tell the root of the resulting AVL tree.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains a positive integer <em>N</em> （≤20） which is the total number of keys to be inserted. Then <em>N</em> distinct integer keys are given in the next line. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print the root of the resulting AVL tree in one line.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input 1:"></a>Sample Input 1:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">588 70 61 96 120<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output 1:"></a>Sample Output 1:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">70<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input 2:"></a>Sample Input 2:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">788 70 61 96 120 90 65<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output 2:"></a>Sample Output 2:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">88<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>基本的AVL树训练，套模板即可。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">AVLNode</span> <span class="token operator">*</span>Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> Position AVLTree<span class="token punctuation">;</span> <span class="token comment">/* AVL树类型 */</span><span class="token keyword">struct</span> <span class="token class-name">AVLNode</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">;</span> <span class="token comment">/* 结点数据 */</span>    AVLTree Left<span class="token punctuation">;</span>     <span class="token comment">/* 指向左子树 */</span>    AVLTree Right<span class="token punctuation">;</span>    <span class="token comment">/* 指向右子树 */</span>    <span class="token keyword">int</span> Height<span class="token punctuation">;</span>       <span class="token comment">/* 树高 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">></span> b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>Position P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>P <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> P<span class="token operator">-></span>Height<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 注意：A必须有一个左子结点B */</span>    <span class="token comment">/* 将A与B做左单旋，更新A与B的高度，返回新的根结点B */</span>    AVLTree B <span class="token operator">=</span> A<span class="token operator">-></span>Left<span class="token punctuation">;</span>    A<span class="token operator">-></span>Left <span class="token operator">=</span> B<span class="token operator">-></span>Right<span class="token punctuation">;</span>    B<span class="token operator">-></span>Right <span class="token operator">=</span> A<span class="token punctuation">;</span>    A<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    B<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>B<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token operator">-></span>Height<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> B<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 注意：A必须有一个右子结点B */</span>    <span class="token comment">/* 将A与B做右单旋，更新A与B的高度，返回新的根结点B */</span>    AVLTree B <span class="token operator">=</span> A<span class="token operator">-></span>Right<span class="token punctuation">;</span>    A<span class="token operator">-></span>Right <span class="token operator">=</span> B<span class="token operator">-></span>Left<span class="token punctuation">;</span>    B<span class="token operator">-></span>Left <span class="token operator">=</span> A<span class="token punctuation">;</span>    A<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    B<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>B<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token operator">-></span>Height<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> B<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">DoubleLeftRightRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 注意：A必须有一个左子结点B，且B必须有一个右子结点C */</span>    <span class="token comment">/* 将A、B与C做两次单旋，返回新的根结点C */</span>    <span class="token comment">/* 将B与C做右单旋，C被返回 */</span>    A<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 将A与C做左单旋，C被返回 */</span>    <span class="token keyword">return</span> <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">DoubleRightLeftRotation</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 注意：A必须有一个右子结点B，且B必须有一个左子结点C */</span>    <span class="token comment">/* 将A、B与C做两次单旋，返回新的根结点C */</span>    <span class="token comment">/* 将B与C做左单旋，C被返回 */</span>    A<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 将A与C做右单旋，C被返回 */</span>    <span class="token keyword">return</span> <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">Insert</span><span class="token punctuation">(</span>AVLTree T<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 将X插入AVL树T中，并且返回调整后的AVL树 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>T<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 若插入空树，则新建包含一个结点的树 */</span>        T <span class="token operator">=</span> <span class="token punctuation">(</span>AVLTree<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">AVLNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        T<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>        T<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        T<span class="token operator">-></span>Left <span class="token operator">=</span> T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* if (插入空树) 结束 */</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 插入T的左子树 */</span>        T<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 如果需要左旋 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> T<span class="token operator">-></span>Left<span class="token operator">-></span>Data<span class="token punctuation">)</span>                T <span class="token operator">=</span> <span class="token function">SingleLeftRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 左单旋 */</span>            <span class="token keyword">else</span>                T <span class="token operator">=</span> <span class="token function">DoubleLeftRightRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 左-右双旋 */</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* else if (插入左子树) 结束 */</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* 插入T的右子树 */</span>        T<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 如果需要右旋 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> T<span class="token operator">-></span>Right<span class="token operator">-></span>Data<span class="token punctuation">)</span>                T <span class="token operator">=</span> <span class="token function">SingleRightRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 右单旋 */</span>            <span class="token keyword">else</span>                T <span class="token operator">=</span> <span class="token function">DoubleRightLeftRotation</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 右-左双旋 */</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* else if (插入右子树) 结束 */</span>    <span class="token comment">/* else X == T->Data，无须插入 */</span>    <span class="token comment">/* 别忘了更新树高 */</span>    T<span class="token operator">-></span>Height <span class="token operator">=</span> <span class="token function">Max</span><span class="token punctuation">(</span><span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">GetHeight</span><span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> T<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>AVLTree <span class="token function">MakeTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//建树</span>    AVLTree A <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> num<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>        A <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> A<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">FreeTree</span><span class="token punctuation">(</span>AVLTree A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 释放A的空间 */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token function">FreeTree</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token function">FreeTree</span><span class="token punctuation">(</span>A<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    AVLTree A <span class="token operator">=</span> <span class="token function">MakeTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> A<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">FreeTree</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>fig 1 - LL</td><td>答案正确</td><td>4</td><td>5 ms</td><td>312 KB</td></tr><tr><td>1</td><td>fig 2 - RR</td><td>答案正确</td><td>4</td><td>5 ms</td><td>168 KB</td></tr><tr><td>2</td><td>fig 3 - RL</td><td>答案正确</td><td>4</td><td>4 ms</td><td>168 KB</td></tr><tr><td>3</td><td>fig 4 - LR</td><td>答案正确</td><td>4</td><td>4 ms</td><td>172 KB</td></tr><tr><td>4</td><td>深度LL旋转</td><td>答案正确</td><td>4</td><td>5 ms</td><td>172 KB</td></tr><tr><td>5</td><td>最大N，深度RL旋转</td><td>答案正确</td><td>4</td><td>4 ms</td><td>180 KB</td></tr><tr><td>6</td><td>最小N</td><td>答案正确</td><td>1</td><td>4 ms</td><td>180 KB</td></tr></tbody></table><h3 id="3-Complete-Binary-Search-Tree"><a href="#3-Complete-Binary-Search-Tree" class="headerlink" title="3.Complete Binary Search Tree"></a><a href="https://pintia.cn/problem-sets/16/problems/669">3.Complete Binary Search Tree</a></h3><p><strong>2013</strong>年秋季PAT甲级真题</p><p>A Binary Search Tree (BST) is recursively defined as a binary tree which has the following properties:</p><p>The left subtree of a node contains only nodes with keys less than the node’s key.</p><p>The right subtree of a node contains only nodes with keys greater than or equal to the node’s key.</p><p>Both the left and right subtrees must also be binary search trees.</p><p>A Complete Binary Tree (CBT) is a tree that is completely filled, with the possible exception of the bottom level, which is filled from left to right.</p><p>Now given a sequence of distinct non-negative integer keys, a unique BST can be constructed if it is required that the tree must also be a CBT. You are supposed to output the level order traversal sequence of this BST.</p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains a positive integer <em>N</em> （≤1000）. Then <em>N</em> distinct non-negative integer keys are given in the next line. All the numbers in a line are separated by a space and are no greater than 2000.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in one line the level order traversal sequence of the corresponding complete binary search tree. All the numbers in a line must be separated by a space, and there must be no extra space at the end of the line.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">101 2 3 4 5 6 7 8 9 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">6 3 8 1 5 7 9 0 2 4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>一句话概括题意：完全二叉树层序遍历。考虑利用数组，同时将输入序列进行排序，方便插入数组。</p><p>本题关键在于计算一个根节点左子树的规模，注意利用完全二叉树的性质即可！</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;algorithm&gt;#include &lt;cmath&gt;#include &lt;cstdio&gt;#define MAXSIZE 2021int A[MAXSIZE], T[MAXSIZE];int min(int a, int b) &#123;    return (a &lt; b) ? a : b;&#125;bool cmp(int a, int b) &#123;    return a &lt; b;&#125;int pow(int a, int b) &#123;    int ans &#x3D; 1;    while (b &amp;&amp; a) &#123;        if (b &amp; 1)            ans *&#x3D; a;        a &#x3D; a * a;        b &gt;&gt;&#x3D; 1;    &#125;    return ans;&#125;int GetLeftLength(int n) &#123;    int H &#x3D; (int)(log(n + 1) &#x2F; log(2));    int x &#x3D; n + 1 - pow(2, H);    x &#x3D; min(x, pow(2, H - 1));    return pow(2, H - 1) - 1 + x;&#125;void solve(int ALeft, int ARight, int TRoot) &#123;    &#x2F;* 初始调用为 solve(0, N-1, 0)*&#x2F;    int n &#x3D; ARight - ALeft + 1;    if (n &#x3D;&#x3D; 0)        return;    int L &#x3D; GetLeftLength(n); &#x2F;* 计算出n个结点的树其左子树有多少个结点 *&#x2F;    T[TRoot] &#x3D; A[ALeft + L];    int LeftTRoot &#x3D; TRoot * 2 + 1;    int RightTRoot &#x3D; LeftTRoot + 1;    solve(ALeft, ALeft + L - 1, LeftTRoot);    solve(ALeft + L + 1, ARight, RightTRoot);&#125;int main() &#123;    int n;    scanf(&quot;%d&quot;, &amp;n);    for (int i &#x3D; 0; i &lt; n; ++i)        scanf(&quot;%d&quot;, &amp;A[i]);    std::sort(A, A + n, cmp);    solve(0, n - 1, 0);    for (int i &#x3D; 0; i &lt; n - 1; ++i)        printf(&quot;%d &quot;, T[i]);    printf(&quot;%d&quot;, T[n - 1]);    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 换数字，但大小顺序不变</td><td>答案正确</td><td>18</td><td>4 ms</td><td>192 KB</td></tr><tr><td>1</td><td>完全平衡</td><td>答案正确</td><td>3</td><td>5 ms</td><td>308 KB</td></tr><tr><td>2</td><td>右边有余</td><td>答案正确</td><td>2</td><td>4 ms</td><td>344 KB</td></tr><tr><td>3</td><td>底层只多1个</td><td>答案正确</td><td>2</td><td>4 ms</td><td>192 KB</td></tr><tr><td>4</td><td>只有1个</td><td>答案正确</td><td>3</td><td>3 ms</td><td>188 KB</td></tr><tr><td>5</td><td>最大N随机</td><td>答案正确</td><td>2</td><td>5 ms</td><td>300 KB</td></tr></tbody></table><h3 id="4-二叉搜索树的操作集"><a href="#4-二叉搜索树的操作集" class="headerlink" title="4.二叉搜索树的操作集"></a><a href="https://pintia.cn/problem-sets/15/problems/927">4.二叉搜索树的操作集</a></h3><p>本题要求实现给定二叉搜索树的5种常用操作。</p><h4 id="函数接口定义："><a href="#函数接口定义：" class="headerlink" title="函数接口定义："></a>函数接口定义：</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">BinTree Insert( BinTree BST, ElementType X );BinTree Delete( BinTree BST, ElementType X );Position Find( BinTree BST, ElementType X );Position FindMin( BinTree BST );Position FindMax( BinTree BST );<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其中<code>BinTree</code>结构定义如下：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">typedef struct TNode *Position;typedef Position BinTree;struct TNode&#123;    ElementType Data;    BinTree Left;    BinTree Right;&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>函数<code>Insert</code>将<code>X</code>插入二叉搜索树<code>BST</code>并返回结果树的根结点指针；</li><li>函数<code>Delete</code>将<code>X</code>从二叉搜索树<code>BST</code>中删除，并返回结果树的根结点指针；如果<code>X</code>不在树中，则打印一行<code>Not Found</code>并返回原树的根结点指针；</li><li>函数<code>Find</code>在二叉搜索树<code>BST</code>中找到<code>X</code>，返回该结点的指针；如果找不到则返回空指针；</li><li>函数<code>FindMin</code>返回二叉搜索树<code>BST</code>中最小元结点的指针；</li><li>函数<code>FindMax</code>返回二叉搜索树<code>BST</code>中最大元结点的指针。</li></ul><h4 id="裁判测试程序样例："><a href="#裁判测试程序样例：" class="headerlink" title="裁判测试程序样例："></a>裁判测试程序样例：</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;typedef int ElementType;typedef struct TNode *Position;typedef Position BinTree;struct TNode&#123;    ElementType Data;    BinTree Left;    BinTree Right;&#125;;void PreorderTraversal( BinTree BT ); &#x2F;* 先序遍历，由裁判实现，细节不表 *&#x2F;void InorderTraversal( BinTree BT );  &#x2F;* 中序遍历，由裁判实现，细节不表 *&#x2F;BinTree Insert( BinTree BST, ElementType X );BinTree Delete( BinTree BST, ElementType X );Position Find( BinTree BST, ElementType X );Position FindMin( BinTree BST );Position FindMax( BinTree BST );int main()&#123;    BinTree BST, MinP, MaxP, Tmp;    ElementType X;    int N, i;    BST &#x3D; NULL;    scanf(&quot;%d&quot;, &amp;N);    for ( i&#x3D;0; i&lt;N; i++ ) &#123;        scanf(&quot;%d&quot;, &amp;X);        BST &#x3D; Insert(BST, X);    &#125;    printf(&quot;Preorder:&quot;); PreorderTraversal(BST); printf(&quot;\n&quot;);    MinP &#x3D; FindMin(BST);    MaxP &#x3D; FindMax(BST);    scanf(&quot;%d&quot;, &amp;N);    for( i&#x3D;0; i&lt;N; i++ ) &#123;        scanf(&quot;%d&quot;, &amp;X);        Tmp &#x3D; Find(BST, X);        if (Tmp &#x3D;&#x3D; NULL) printf(&quot;%d is not found\n&quot;, X);        else &#123;            printf(&quot;%d is found\n&quot;, Tmp-&gt;Data);            if (Tmp&#x3D;&#x3D;MinP) printf(&quot;%d is the smallest key\n&quot;, Tmp-&gt;Data);            if (Tmp&#x3D;&#x3D;MaxP) printf(&quot;%d is the largest key\n&quot;, Tmp-&gt;Data);        &#125;    &#125;    scanf(&quot;%d&quot;, &amp;N);    for( i&#x3D;0; i&lt;N; i++ ) &#123;        scanf(&quot;%d&quot;, &amp;X);        BST &#x3D; Delete(BST, X);    &#125;    printf(&quot;Inorder:&quot;); InorderTraversal(BST); printf(&quot;\n&quot;);    return 0;&#125;&#x2F;* 你的代码将被嵌在这里 *&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输入样例："><a href="#输入样例：" class="headerlink" title="输入样例："></a>输入样例：</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">105 8 6 2 4 1 0 10 9 756 3 10 0 555 7 0 10 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例："><a href="#输出样例：" class="headerlink" title="输出样例："></a>输出样例：</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">Preorder: 5 2 1 0 4 8 6 7 10 96 is found3 is not found10 is found10 is the largest key0 is found0 is the smallest key5 is foundNot FoundInorder: 1 2 4 6 8 9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h4><p>将先前的二叉树操作再实现一遍，注意修改模板代码使得接口一致。</p><h4 id="AC-code-3"><a href="#AC-code-3" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">BinTree <span class="token function">Insert</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 若原树为空，生成并返回一个结点的二叉搜索树 */</span>        BST <span class="token operator">=</span> <span class="token punctuation">(</span>BinTree<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        BST<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>        BST<span class="token operator">-></span>Left <span class="token operator">=</span> BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 开始找要插入元素的位置 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*递归插入左子树*/</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Insert</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*递归插入右子树*/</span>        <span class="token comment">/* else X已经存在，什么都不做 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>BinTree <span class="token function">Delete</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position Tmp<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Not Found\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Left <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 从左子树递归删除 */</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>            BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 从右子树递归删除 */</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* BST就是要删除的结点 */</span>            <span class="token comment">/* 如果被删除结点有左右两个子结点 */</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>BST<span class="token operator">-></span>Left <span class="token operator">&amp;&amp;</span> BST<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">/* 从右子树中找最小的元素填充删除结点 */</span>                Tmp <span class="token operator">=</span> <span class="token function">FindMin</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>                BST<span class="token operator">-></span>Data <span class="token operator">=</span> Tmp<span class="token operator">-></span>Data<span class="token punctuation">;</span>                <span class="token comment">/* 从右子树中删除最小元素 */</span>                BST<span class="token operator">-></span>Right <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 被删除结点有一个或无子结点 */</span>                Tmp <span class="token operator">=</span> BST<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token comment">/* 只有右孩子或无子结点 */</span>                    BST <span class="token operator">=</span> BST<span class="token operator">-></span>Right<span class="token punctuation">;</span>                <span class="token keyword">else</span> <span class="token comment">/* 只有左孩子 */</span>                    BST <span class="token operator">=</span> BST<span class="token operator">-></span>Left<span class="token punctuation">;</span>                <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Position <span class="token function">Find</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>          <span class="token comment">/*查找失败*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>         <span class="token keyword">return</span> <span class="token function">Find</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*在右子树中继续查找*/</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> BST<span class="token operator">-></span>Data<span class="token punctuation">)</span>         <span class="token keyword">return</span> <span class="token function">Find</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*在左子树中继续查找*/</span>    <span class="token keyword">else</span>                           <span class="token comment">/* X == BST->Data */</span>        <span class="token keyword">return</span> BST<span class="token punctuation">;</span> <span class="token comment">/*查找成功， 返回结点的找到结点的地址*/</span><span class="token punctuation">&#125;</span>Position <span class="token function">FindMin</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">/*空的二叉搜索树，返回NULL*/</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span> <span class="token comment">/*找到最左叶结点并返回*/</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token function">FindMin</span><span class="token punctuation">(</span>BST<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*沿左分支继续查找*/</span><span class="token punctuation">&#125;</span>Position <span class="token function">FindMax</span><span class="token punctuation">(</span>BinTree BST<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BST<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token punctuation">(</span>BST<span class="token operator">-></span>Right<span class="token punctuation">)</span> BST <span class="token operator">=</span> BST<span class="token operator">-></span>Right<span class="token punctuation">;</span><span class="token comment">/*沿右分支继续查找，直到最右叶结点*/</span><span class="token keyword">return</span> BST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample等价</td><td>答案正确</td><td>18</td><td>4 ms</td><td>324 KB</td></tr><tr><td>1</td><td>左斜，Find小于最小、大于最大，delete小于最小、大于最大、头尾和中间</td><td>答案正确</td><td>4</td><td>3 ms</td><td>348 KB</td></tr><tr><td>2</td><td>右斜，Find小于最小、大于最大，delete小于最小、大于最大、头尾和中间</td><td>答案正确</td><td>4</td><td>3 ms</td><td>196 KB</td></tr><tr><td>3</td><td>只有1个结点，删除成空树</td><td>答案正确</td><td>2</td><td>4 ms</td><td>316 KB</td></tr><tr><td>4</td><td>空树</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week3</title>
      <link href="2021/0730301.html"/>
      <url>2021/0730301.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week3树（上）"><a href="#Week3树（上）" class="headerlink" title="Week3树（上）"></a>Week3树（上）</h1><h2 id="3-1-树与树的表示"><a href="#3-1-树与树的表示" class="headerlink" title="3.1 树与树的表示"></a>3.1 树与树的表示</h2><h3 id="什么是树"><a href="#什么是树" class="headerlink" title="什么是树"></a>什么是树</h3><p><strong>客观世界中许多事物存在层次关系</strong></p><ul><li>类社会家谱</li><li>社会组织结构</li><li>图书信息管理  </li></ul><p><strong>分层次组织在管理上具有更高的效率!</strong>  </p><p>数据管理的基本操作之一： 查找。如何实现有效率的查找？  </p><h3 id="查找（Searching）"><a href="#查找（Searching）" class="headerlink" title="查找（Searching）"></a>查找（Searching）</h3><p><strong>查找：</strong> 根据某个给定<strong>关键字K</strong> ，从<strong>集合R</strong>中找出关键字与<strong>K</strong>相同的记录  </p><p><strong>静态查找：</strong>集合中<strong>记录是固定</strong>的</p><ul><li>没有插入和删除操作，只有查找  </li></ul><p><strong>动态查找：</strong>集合中<strong>记录是动态变化</strong>的</p><ul><li>除查找，还可能发生插入和删除  </li></ul><h3 id="静态查找"><a href="#静态查找" class="headerlink" title="静态查找"></a>静态查找</h3><h4 id="方法1：顺序查找"><a href="#方法1：顺序查找" class="headerlink" title="方法1：顺序查找"></a>方法1：顺序查找</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">SequentialSearch</span><span class="token punctuation">(</span>StaticTable<span class="token operator">*</span> Tbl<span class="token punctuation">,</span>ElementType K<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/*在表Tbl[1]~Tbl[n]中查找关键字为K的数据元素*/</span><span class="token keyword">int</span> i<span class="token punctuation">;</span>Tbl<span class="token operator">-></span>Element<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> K<span class="token punctuation">;</span> <span class="token comment">/*建立哨兵*/</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> Tbl<span class="token operator">-></span>Length<span class="token punctuation">;</span> Tbl<span class="token operator">-></span>Element<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> K<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> i<span class="token punctuation">;</span> <span class="token comment">/*查找成功返回所在单元下标；不成功返回0*/</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>顺序查找算法的时间复杂度为$O(n)$。  </p><h4 id="方法2：二分查找（Binary-Search"><a href="#方法2：二分查找（Binary-Search" class="headerlink" title="方法2：二分查找（Binary Search)"></a>方法2：二分查找（Binary Search)</h4><p>假设n个数据元素的关键字满足有序（<strong>比如：小到大</strong>）<br>$$<br>k_1&lt;k_2&lt;\cdots &lt;k_n<br>$$<br>并且是连续存放（<strong>数组</strong>），那么可以进行二分查找。  </p><p><strong>例</strong> 假设有13个数据元素，按关键字由小到大顺序存放.</p><p>二分查找关健字为<strong>444</strong>的数据元素过程如下：  </p><table><thead><tr><th>5</th><th>16</th><th>39</th><th>45</th><th>51</th><th>98</th><th>100</th><th>202</th><th>226</th><th>321</th><th>368</th><th>444</th><th>501</th></tr></thead><tbody><tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td></tr></tbody></table><p>1、 left = 1, right = 13; mid = (1+13)/2 = 7:                     <strong>100 &lt; 444</strong>;</p><p>2、 left = mid+1=8, right = 13; mid = (8+13)/2 = 10:      <strong>321 &lt; 444</strong>;</p><p>3、 left = mid+1=11, right = 13; mid = (11+13)/2 = 12:  <strong>查找结束</strong>;  </p><p><strong>例</strong> 仍然以上面13个数据元素构成的有序线性表为例</p><p>二分查找关健字为 <strong>43</strong> 的数据元素如下：  </p><p>1、 left = 1, right = 13; mid = (1+13)/2 = 7:         <strong>100 &gt; 43</strong>;</p><p>2、 left = 1, right = mid-1= 6; mid = (1+6)/2 = 3: <strong>39 &lt; 43</strong>;</p><p>3、 left = mid+1=4, right = 6; mid = (4+6)/2 = 5: <strong>51 &gt; 43</strong>;</p><p>4、 left = 4, right = mid-1= 4; mid = (4+4)/2 = 4: <strong>45 &gt; 43</strong>;</p><p>5、 left = 4, right = mid-1= 3; <strong>left &gt; right ? 查找失败，结束</strong>;  </p><h5 id="二分查找算法"><a href="#二分查找算法" class="headerlink" title="二分查找算法"></a>二分查找算法</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">BinarySearch</span><span class="token punctuation">(</span>StaticTable<span class="token operator">*</span> Tbl<span class="token punctuation">,</span> ElementType K<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/*在表Tbl中查找关键字为K的数据元素*/</span><span class="token keyword">int</span> left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> NoFound <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>left <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/*初始左边界*/</span>right <span class="token operator">=</span> Tbl<span class="token operator">-></span>Length<span class="token punctuation">;</span> <span class="token comment">/*初始右边界*/</span><span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">/*计算中间元素坐标*/</span><span class="token keyword">if</span> <span class="token punctuation">(</span>K <span class="token operator">&lt;</span> Tbl<span class="token operator">-></span>Element<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span> right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/*调整右边界*/</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>K <span class="token operator">></span> Tbl<span class="token operator">-></span>Element<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span> left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/*调整左边界*/</span><span class="token keyword">else</span> <span class="token keyword">return</span> mid<span class="token punctuation">;</span> <span class="token comment">/*查找成功，返回数据元素的下标*/</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> NotFound<span class="token punctuation">;</span> <span class="token comment">/*查找不成功，返回-1*/</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>二分查找算法具有对数的时间复杂度$O(logN)$  </p><ul><li>11个元素的二分查找<strong>判定树</strong>  </li><li>判定树上每个结点需要的查找次数刚好为该结点所在的层数;</li><li>查找成功时查找次数不会超过判定树的深度</li><li>n个结点的判定树的深度为$\lfloor log_2n\rfloor+1$​.</li><li>ASL = （4*4+4*3+2*2+1）/11 = 3  </li></ul><p>二分查找的启示？  </p><h3 id="树的定义"><a href="#树的定义" class="headerlink" title="树的定义"></a>树的定义</h3><p><strong>树（Tree）</strong> : n（n≥0）个结点构成的有限集合。</p><p>当n=0时，称为<strong>空树</strong>；</p><p>对于任一棵<strong>非空树</strong>（n&gt; 0），它具备以下性质：</p><ul><li>树中有一个称为“<strong>根（Root）</strong> ”的特殊结点， 用 <strong>r</strong> 表示；</li><li>其余结点可分为m（m&gt;0）个<strong>互不相交的</strong>有限集T1， T2， … ， Tm，其中每个集合本身又是一棵树，称为原来树的“<strong>子树</strong>（SubTree）”  </li></ul><h4 id="树与非树"><a href="#树与非树" class="headerlink" title="树与非树?"></a>树与非树?</h4><ul><li>子树是<strong>不相交</strong>的；</li><li>除了根结点外， <strong>每个结点有且仅有一个父结点</strong>；</li><li>一棵N个结点的树有<strong>N-1条边</strong>。</li></ul><h4 id="树的一些基本术语"><a href="#树的一些基本术语" class="headerlink" title="树的一些基本术语"></a>树的一些基本术语</h4><ol><li><strong>结点的度</strong>（Degree）：结点的<strong>子树个数</strong></li><li><strong>树的度</strong>：树的所有结点中最大的度数</li><li><strong>叶结点</strong>（Leaf）： <strong>度为0</strong>的结点</li><li><strong>父结点</strong>（Parent）：有子树的结点是其子树的根结点的父结点</li><li><strong>子结点</strong>（Child）：若A结点是B结点的父结点，则称B结点是A结点的子结点；子结点也称孩子结点。</li><li><strong>兄弟结点</strong>（Sibling）：具有同一父结点的各结点彼此是兄弟结点。  </li><li><strong>路径和路径长度</strong>：从结点$n_1$到$n_k$的<strong>路径</strong>为一个结点序列$n_1 , n_2 ,… , n_k , n_i$是 $n_{i+1}$的父结点。路径所包含边的个数为<strong>路径的长度</strong>。</li><li><strong>祖先结点</strong>(Ancestor)：沿<strong>树根到某一结点路径</strong>上的所有结点都是这个结点的祖先结点。</li><li><strong>子孙结点</strong>(Descendant)：某一结点<strong>的子树中的所有结点</strong>是这个结点的子孙。</li><li><strong>结点的层次</strong>（Level）：规定<strong>根结点在1层</strong>，其它任一结点的层数是其父结点的层数加1。</li><li><strong>树的深度</strong>（Depth） ：树中所有结点中的<strong>最大层次</strong>是这棵树的深度。  </li></ol><h3 id="树的表示"><a href="#树的表示" class="headerlink" title="树的表示"></a>树的表示</h3><p>儿子-兄弟表示法  。倾斜45度可看做二叉树。</p><h2 id="3-2-二叉树及存储结构"><a href="#3-2-二叉树及存储结构" class="headerlink" title="3.2 二叉树及存储结构"></a>3.2 二叉树及存储结构</h2><h3 id="二叉树的定义"><a href="#二叉树的定义" class="headerlink" title="二叉树的定义"></a>二叉树的定义</h3><p><strong>二叉树T</strong>：一个有穷的结点集合。</p><ul><li>这个集合<strong>可以为空</strong></li><li>若不为空，则它是由<strong>根结点</strong>和称为其<strong>左子树</strong>$T_L$和<strong>右子树</strong>$T_R$的两个不相交的二叉树组成。</li></ul><p>二叉树具体五种基本形态  </p><p>二叉树的<strong>子树有左右顺序之分</strong>  </p><h4 id="特殊二叉树"><a href="#特殊二叉树" class="headerlink" title="特殊二叉树"></a>特殊二叉树</h4><p><strong>斜二叉树</strong>（Skewed Binary Tree）  </p><p><strong>完美二叉树</strong>（Perfect Binary Tree） <strong>满二叉树</strong>（Full Binary Tree）  </p><p><strong>完全二叉树</strong>（Complete Binary Tree）有n个结点的二叉树，对树中结点按从上至下、从左到右顺序进行编号，编号为$i(1 ≤ i ≤ n)$结点与满二叉树中编号为$ i$ 结点在二叉树中位置相同  </p><h3 id="二叉树几个重要性质"><a href="#二叉树几个重要性质" class="headerlink" title="二叉树几个重要性质"></a>二叉树几个重要性质</h3><ol><li>一个二叉树第 $i$ 层的最大结点数为： $2^{ i-1}， i \geq 1$。</li><li>深度为k的二叉树有最大结点总数为： $2^ k-1， k \geq 1$。  </li><li>对任何非空二叉树 T，若$n_0$表示叶结点的个数、 $n_2$是度为2的非叶结点个数，那么两者满足关系$n_0 = n_2 +1$。  </li></ol><h4 id="proof"><a href="#proof" class="headerlink" title="proof:"></a>proof:</h4><p>1.第一层最大$2^0=1$，第$i$​层最大$2^{i-1}$。</p><p>2.满二叉树$2^0+2^1+\cdots +2^{k-1}=2^k-1$。</p><p>3.不妨设$n_1$​为度节点为1的叶结点个数，利用算两次原理，考虑边的条数为<br>$$<br>n_0+n_1+n_2-1=n_1+2n_2<br>$$<br>左边表示边为叶结点总数$-1$，右边表示度为一的贡献一条边，度为2的贡献两条边。立得$n_0 = n_2 +1$​。</p><h3 id="二叉树的抽象数据类型定义"><a href="#二叉树的抽象数据类型定义" class="headerlink" title="二叉树的抽象数据类型定义"></a>二叉树的抽象数据类型定义</h3><p><strong>类型名称：二叉树</strong></p><p><strong>数据对象集</strong>： 一个有穷的结点集合。</p><p>若不为空，则由<strong>根结点和其左、右二叉子树</strong>组成。</p><p><strong>操作集</strong>： $B_T \in BinTree, Item \in ElementType$，重要操作有：  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Boolean <span class="token function">IsEmpty</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token comment">// 判别BT是否为空；</span><span class="token keyword">void</span> <span class="token function">Traversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token comment">//遍历，按某顺序访问每个结点；</span>BinTree <span class="token function">CreatBinTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//创建一个二叉树。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>常用的遍历方法有：</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">PreOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token comment">//先序----根、左子树、右子树；</span><span class="token keyword">void</span> <span class="token function">InOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token comment">//中序---- 左子树、根、右子树；</span><span class="token keyword">void</span> <span class="token function">PostOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token comment">//后序---- 左子树、右子树、根</span><span class="token keyword">void</span> <span class="token function">LevelOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token comment">//层次遍历，从上到下、从左到右</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二叉树的存储结构"><a href="#二叉树的存储结构" class="headerlink" title="二叉树的存储结构"></a>二叉树的存储结构</h3><p>1.<strong>顺序</strong>存储结构  </p><p><strong>完全二叉树</strong>： 按从上至下、从左到右顺序存储$n$个结点的完全二叉树的<strong>结点父子关系</strong>：  </p><p>非根结点（序号 $i &gt; 1$）的父结点的序号是 $\lfloor i / 2\rfloor$;</p><p>结点（序号为 i ）的<strong>左孩子</strong>结点的序号是$ 2i$，（若$2 i \leq n$​​，否则没有左孩子） ；</p><p>结点（序号为 i ）的<strong>右孩子</strong>结点的序号是$ 2i+1$，（若$2 i +1\leq n$，否则没有右孩子） ;  </p><table><thead><tr><th>结点</th><th>A</th><th>B</th><th>O</th><th>C</th><th>S</th><th>M</th><th>Q</th><th>W</th><th>K</th></tr></thead><tbody><tr><td>序号</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr></tbody></table><p><strong>一般二叉树</strong>也可以采用这种结构，但会造成空间浪费……  </p><table><thead><tr><th>结点</th><th>A</th><th>B</th><th>O</th><th>∧</th><th>∧</th><th>M</th><th>∧</th><th>∧</th><th>∧</th><th>∧</th><th>∧</th><th>∧</th><th>C</th></tr></thead><tbody><tr><td>序号</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td></tr></tbody></table><p>2.<strong>链表</strong>存储  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TreeNode</span><span class="token operator">*</span> BinTree<span class="token punctuation">;</span><span class="token keyword">typedef</span> BinTree Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">;</span>BinTree Left<span class="token punctuation">;</span>BinTree Right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-3-二叉树的遍历"><a href="#3-3-二叉树的遍历" class="headerlink" title="3.3 二叉树的遍历"></a>3.3 二叉树的遍历</h2><h3 id="二叉树的遍历"><a href="#二叉树的遍历" class="headerlink" title="二叉树的遍历"></a>二叉树的遍历</h3><h4 id="先序遍历"><a href="#先序遍历" class="headerlink" title="先序遍历"></a>先序遍历</h4><p>遍历过程为：</p><p>① 访问<strong>根结点</strong>；</p><p>② <strong>先序</strong>遍历其<strong>左子树</strong>；</p><p>③ <strong>先序</strong>遍历其<strong>右子树</strong>。</p><p><strong>A</strong>（ <strong>B</strong> D F E ）（ <strong>C</strong> G H I）</p><p><strong>先序</strong>遍历=&gt; <strong>A B D F E C G H I</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">PreOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">PreOrderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">PreOrderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="中序遍历"><a href="#中序遍历" class="headerlink" title="中序遍历"></a>中序遍历</h4><p>遍历过程为：</p><p>① <strong>中序</strong>遍历其<strong>左子树</strong>；</p><p>② 访问<strong>根结点</strong>；</p><p>③ <strong>中序</strong>遍历其<strong>右子树</strong>。  </p><p>（D <strong>B</strong> E F） <strong>A</strong> （ G H <strong>C</strong> I）   </p><p><strong>中序</strong>遍历=&gt; <strong>D B E F A G H C I</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">InOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">InOrderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">InOrderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="后序遍历"><a href="#后序遍历" class="headerlink" title="后序遍历"></a>后序遍历</h4><p>遍历过程为：</p><p>① <strong>后序</strong>遍历其<strong>左子树</strong>；</p><p>② <strong>后序</strong>遍历其<strong>右子树</strong>；</p><p>③ 访问<strong>根结点</strong>。</p><p>（ D E F <strong>B</strong> ）（ H G I <strong>C</strong>） <strong>A</strong></p><p><strong>后序</strong>遍历=&gt; <strong>D E F B H G I C A</strong>  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">PostOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">PostOrderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">PostOrderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>先序、中序和后序遍历过程：遍历过程中经过结点的路线一样，只是访问各结点的时机不同。  </p><h3 id="二叉树的非递归遍历"><a href="#二叉树的非递归遍历" class="headerlink" title="二叉树的非递归遍历"></a>二叉树的非递归遍历</h3><h4 id="中序遍历非递归遍历算法"><a href="#中序遍历非递归遍历算法" class="headerlink" title="中序遍历非递归遍历算法"></a>中序遍历非递归遍历算法</h4><p>非递归算法实现的基本思路： <strong>使用堆栈</strong>  </p><ul><li>遇到一个结点，就把它压栈，并去遍历它的左子树；</li><li>当左子树遍历结束后，从栈顶弹出这个结点并访问它；</li><li>然后按其右指针再去中序遍历该结点的右子树。  </li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">InOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>BinTree T <span class="token operator">=</span> BT<span class="token punctuation">;</span>Stack S <span class="token operator">=</span> <span class="token function">CreatStack</span><span class="token punctuation">(</span>MaxSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*创建并初始化堆栈S*/</span><span class="token keyword">while</span> <span class="token punctuation">(</span>T <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*一直向左并将沿途结点压入堆栈*/</span><span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span>T <span class="token operator">=</span> T<span class="token operator">-></span>Left<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>T <span class="token operator">=</span> <span class="token function">Pop</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*结点弹出堆栈*/</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%5d"</span><span class="token punctuation">,</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*（访问） 打印结点*/</span>T <span class="token operator">=</span> T<span class="token operator">-></span>Right<span class="token punctuation">;</span> <span class="token comment">/*转向右子树*/</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="先序遍历的非递归遍历算法"><a href="#先序遍历的非递归遍历算法" class="headerlink" title="先序遍历的非递归遍历算法"></a>先序遍历的非递归遍历算法</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">InOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>BinTree T <span class="token operator">=</span> BT<span class="token punctuation">;</span>Stack S <span class="token operator">=</span> <span class="token function">CreatStack</span><span class="token punctuation">(</span>MaxSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*创建并初始化堆栈S*/</span><span class="token keyword">while</span> <span class="token punctuation">(</span>T <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*一直向左并将沿途结点压入堆栈*/</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%5d"</span><span class="token punctuation">,</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*（访问） 打印结点*/</span><span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span>T <span class="token operator">=</span> T<span class="token operator">-></span>Left<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>T <span class="token operator">=</span> <span class="token function">Pop</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*结点弹出堆栈*/</span>T <span class="token operator">=</span> T<span class="token operator">-></span>Right<span class="token punctuation">;</span> <span class="token comment">/*转向右子树*/</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="后序遍历非递归遍历算法"><a href="#后序遍历非递归遍历算法" class="headerlink" title="后序遍历非递归遍历算法"></a>后序遍历非递归遍历算法</h4><p>这里要略复杂些，不是挪动一下printf语句就可以了的。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">voidPostOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    BinTree T <span class="token operator">=</span> BT<span class="token punctuation">;</span>    BinTree Exist <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    Stack S <span class="token operator">=</span> <span class="token function">CreatStack</span><span class="token punctuation">(</span>MaxSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//初始化堆栈</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>T <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>T <span class="token operator">&amp;&amp;</span> T<span class="token operator">-></span>Left <span class="token operator">!=</span> Exist <span class="token operator">&amp;&amp;</span> T<span class="token operator">-></span>Right <span class="token operator">!=</span> Exist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//是否遍历完，左孩子或右孩子是否已入栈</span>            <span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从(子)树根向左将结点入栈</span>            T <span class="token operator">=</span> T<span class="token operator">-></span>Left<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            T <span class="token operator">=</span> <span class="token function">GetTop</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">//获取栈顶元素</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Right <span class="token operator">&amp;&amp;</span> T<span class="token operator">-></span>Right <span class="token operator">!=</span> Exist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//右孩子存在且未入过栈</span>                T <span class="token operator">=</span> T<span class="token operator">-></span>Right<span class="token punctuation">;</span> <span class="token comment">//如果左边最后的结点有右子树,继续上述入栈操作</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                T <span class="token operator">=</span> <span class="token function">Pop</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//没有右子树了，就出栈</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%5d"</span><span class="token punctuation">,</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读根</span>                Exist <span class="token operator">=</span> T<span class="token punctuation">;</span>              <span class="token comment">//存放已读根的左孩子</span>                T <span class="token operator">=</span> <span class="token function">GetTop</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取栈顶元素，即返回已读根的父结点</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment">//难点在于对根的左右孩子是否曾经入过栈的判定，以及栈顶元素的返回时机</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="层序遍历"><a href="#层序遍历" class="headerlink" title="层序遍历"></a>层序遍历</h3><p>二叉树遍历的核心问题： 二维结构的线性化</p><ul><li>从结点访问其左、右儿子结点</li><li>访问左儿子后，右儿子结点怎么办？</li></ul><p>需要一个存储结构保存暂时不访问的结点</p><p>存储结构：堆栈、队列  </p><p><strong>队列实现</strong>： 遍历从根结点开始，首先将<strong>根结点入队</strong>，然后开始执行循环：结点出队、访问该结点、其左右儿子入队  </p><p><strong>层序基本过程</strong>：先根结点入队，然后：  </p><p>①从队列中<strong>取出一个</strong>元素；</p><p>② <strong>访问</strong>该元素所指结点；</p><p>③ 若该元素所指结点的左、右孩子结点非空，则将其<strong>左、右孩子的指针顺序入队</strong>。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">LevelOrderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Queue Q<span class="token punctuation">;</span> BinTree T<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BT<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">/* 若是空树则直接返回 */</span>Q <span class="token operator">=</span> <span class="token function">CreatEQueue</span><span class="token punctuation">(</span>MaxSize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*创建并初始化队列Q*/</span><span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> BT<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>T <span class="token operator">=</span> <span class="token function">Delete</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*访问取出队列的结点*/</span><span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><h4 id="例-遍历二叉树的应用：输出二叉树中的叶子结点。"><a href="#例-遍历二叉树的应用：输出二叉树中的叶子结点。" class="headerlink" title="例 遍历二叉树的应用：输出二叉树中的叶子结点。"></a><strong>例</strong> 遍历二叉树的<strong>应用</strong>：输出二叉树中的<strong>叶子结点</strong>。</h4><p>在二叉树的遍历算法中增加检测结点的“ <strong>左右子树是否都为空</strong>”。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">PreOrderPrintLeaves</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BT <span class="token operator">-</span> Left <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">PreOrderPrintLeaves</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">PreOrderPrintLeaves</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="例-求二叉树的高度。"><a href="#例-求二叉树的高度。" class="headerlink" title="例  求二叉树的高度。"></a><strong>例</strong>  求二叉树的<strong>高度</strong>。</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">PostOrderGetHeight</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> HL<span class="token punctuation">,</span> HR<span class="token punctuation">,</span> MaxH<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>HL <span class="token operator">=</span> <span class="token function">PostOrderGetHeight</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*求左子树的深度*/</span>HR <span class="token operator">=</span> <span class="token function">PostOrderGetHeight</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*求右子树的深度*/</span>MaxH <span class="token operator">=</span> <span class="token punctuation">(</span>HL <span class="token operator">></span> HR<span class="token punctuation">)</span> <span class="token operator">?</span> HL <span class="token operator">:</span> HR<span class="token punctuation">;</span> <span class="token comment">/*取左右子树较大的深度*/</span><span class="token keyword">return</span> <span class="token punctuation">(</span>MaxH <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*返回树的深度*/</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 空树深度为0 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="例-二元运算表达式树及其遍历"><a href="#例-二元运算表达式树及其遍历" class="headerlink" title="例 二元运算表达式树及其遍历"></a><strong>例</strong> <strong>二元运算</strong>表达式树及其遍历</h4><p>三种遍历可以得到三种不同的访问结果：</p><ul><li>先序遍历得到前缀表达式： + + a * b c * + * d e f g</li><li>中序遍历得到中缀表达式： a + b * c + <strong>d * e</strong> + <strong>f * g</strong></li><li>后序遍历得到后缀表达式： a b c * + d e * f + g * +  </li></ul><p>中缀表达式会受到运算符优先级的影响!</p><h4 id="例-由两种遍历序列确定二叉树"><a href="#例-由两种遍历序列确定二叉树" class="headerlink" title="例 由两种遍历序列确定二叉树"></a><strong>例</strong> 由<strong>两种</strong>遍历序列确定二叉树</h4><p>已知三种遍历中的任意两种遍历序列，能否唯一确定一棵二叉树呢？  </p><p>必须要有中序遍历！</p><p>没有中序的困扰：</p><ul><li>先序遍历序列： A B</li><li>后序遍历序列： B A  </li></ul><h5 id="先序和中序遍历序列来确定一棵二叉树"><a href="#先序和中序遍历序列来确定一棵二叉树" class="headerlink" title="先序和中序遍历序列来确定一棵二叉树"></a>先序和中序遍历序列来确定一棵二叉树</h5><ul><li>根据先序遍历序列第一个结点确定根结点；</li><li>根据根结点在中序遍历序列中分割出左右两个子序列</li><li>对左子树和右子树分别递归使用相同的方法继续分解。  </li></ul><p>类似地， 后序和中序遍历序列也可以确定一棵二叉树。  </p><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TNode</span> <span class="token operator">*</span>Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> Position BinTree<span class="token punctuation">;</span> <span class="token comment">/* 二叉树类型 */</span><span class="token keyword">struct</span> <span class="token class-name">TNode</span> <span class="token punctuation">&#123;</span>            <span class="token comment">/* 树结点定义 */</span>    ElementType Data<span class="token punctuation">;</span>     <span class="token comment">/* 结点数据 */</span>    BinTree Left<span class="token punctuation">;</span>         <span class="token comment">/* 指向左子树 */</span>    BinTree Right<span class="token punctuation">;</span>        <span class="token comment">/* 指向右子树 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">InorderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">InorderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* 此处假设对BT结点的访问就是打印数据 */</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 假设数据为整型 */</span>        <span class="token function">InorderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">PreorderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">PreorderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">PreorderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">PostorderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">PostorderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">PostorderTraversal</span><span class="token punctuation">(</span>BT<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> BT<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">LevelorderTraversal</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q<span class="token punctuation">;</span>    BinTree T<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>BT<span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">/* 若是空树则直接返回 */</span>    Q <span class="token operator">=</span> <span class="token function">CreatQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 创建空队列Q */</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> BT<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        T <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> T<span class="token operator">-></span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 访问取出队列的结点 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Left<span class="token punctuation">)</span>            <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Right<span class="token punctuation">)</span>            <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-树的同构"><a href="#1-树的同构" class="headerlink" title="1.树的同构"></a><a href="https://pintia.cn/problem-sets/988034414048743424/problems/988039710297038848">1.树的同构</a></h3><p>给定两棵树T1和T2。如果T1可以通过若干次左右孩子互换就变成T2，则我们称两棵树是“同构”的。例如图1给出的两棵树就是同构的，因为我们把其中一棵树的结点A、B、G的左右孩子互换后，就得到另外一棵树。而图2就不是同构的。</p><p><img src="https://images.ptausercontent.com/0c8bbacf-d64e-4c6d-8d4e-1249e33fb0b1.jpg" alt="图1"></p><p><img src="https://images.ptausercontent.com/29" alt="图2"></p><p>现给定两棵树，请你判断它们是否是同构的。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入给出2棵二叉树树的信息。对于每棵树，首先在一行中给出一个非负整数<em>N</em> (≤10)，即该树的结点数（此时假设结点从0到<em>N</em>−1编号）；随后<em>N</em>行，第<em>i</em>行对应编号第<em>i</em>个结点，给出该结点中存储的1个英文大写字母、其左孩子结点的编号、右孩子结点的编号。如果孩子结点为空，则在相应位置上给出“-”。给出的数据间用一个空格分隔。注意：题目保证每个结点中存储的字母是不同的。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>如果两棵树是同构的，输出“Yes”，否则输出“No”。</p><h4 id="输入样例1（对应图1）："><a href="#输入样例1（对应图1）：" class="headerlink" title="输入样例1（对应图1）："></a>输入样例1（对应图1）：</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">8A 1 2B 3 4C 5 -D - -E 6 -G 7 -F - -H - -8G - 4B 7 6F - -A 5 1H - -C 0 -D - -E 2 -<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="输出样例1"><a href="#输出样例1" class="headerlink" title="输出样例1:"></a>输出样例1:</h3><pre class="line-numbers language-out" data-language="out"><code class="language-out">Yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="输入样例2（对应图2）："><a href="#输入样例2（对应图2）：" class="headerlink" title="输入样例2（对应图2）："></a>输入样例2（对应图2）：</h4><pre class="line-numbers language-none"><code class="language-none">8B 5 7F - -A 0 3C 6 -H - -D - -G 4 -E 1 -8D 6 -B 5 -E - -H - -C 0 2G - 3F - -A 1 4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例2"><a href="#输出样例2" class="headerlink" title="输出样例2:"></a>输出样例2:</h4><pre class="line-numbers language-none"><code class="language-none">No<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>首先是二叉树的表示，这里考虑吧用结构数组表示二叉树，然后读数据建二叉树，再二叉树同构判别（递归判别）。  </p><p>建二叉树时读数据要注意读换行符，同时利用一个check数组标记是否有节点指向该节点，没有任何节点指向的的节点即为根节点。</p><p>在判别同构时，注意多种情况的讨论:</p><p>1.都是空树，同构。</p><p>2.一空一非空，不同构。</p><p>3.都不空，根节点不一样，不同构。</p><p>4.都没有左子树，递归地判别右子树是否同构。</p><p>5.左子树都非空，且对应的结点值相同，那么递归地判别左右子树是否同构；否则判别左子树与右子树是否同构，右子树与左子树是否同构。</p><p>以上判断要组织好逻辑顺序，做到不重不漏。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxTree</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ElementType</span> <span class="token expression"><span class="token keyword">char</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Tree</span> <span class="token expression"><span class="token keyword">int</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Null</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>    ElementType Element<span class="token punctuation">;</span>    Tree Left<span class="token punctuation">;</span>    Tree Right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> T1<span class="token punctuation">[</span>MaxTree<span class="token punctuation">]</span><span class="token punctuation">,</span> T2<span class="token punctuation">[</span>MaxTree<span class="token punctuation">]</span><span class="token punctuation">;</span>Tree <span class="token function">BuildTree</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> T<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> check<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> cl<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> row<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">,</span> <span class="token operator">&amp;</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> check<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c %c %c%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Element<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cl<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cl <span class="token operator">!=</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">=</span> cl <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>                check<span class="token punctuation">[</span>T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">=</span> Null<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cr <span class="token operator">!=</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Right <span class="token operator">=</span> cr <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>                check<span class="token punctuation">[</span>T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Right <span class="token operator">=</span> Null<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>check<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token keyword">return</span> Null<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">Isomorphic</span><span class="token punctuation">(</span>Tree R1<span class="token punctuation">,</span> Tree R2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>R1 <span class="token operator">==</span> Null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>R2 <span class="token operator">==</span> Null<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">/* both empty */</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R1 <span class="token operator">==</span> Null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>R2 <span class="token operator">!=</span> Null<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>R1 <span class="token operator">!=</span> Null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>R2 <span class="token operator">==</span> Null<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                                   <span class="token comment">/* one of them is empty */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Element <span class="token operator">!=</span> T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Element<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* roots are different */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">==</span> Null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">==</span> Null<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">/* both have no left subtree */</span>        <span class="token keyword">return</span> <span class="token function">Isomorphic</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">,</span> T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">!=</span> Null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">!=</span> Null<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>        <span class="token punctuation">(</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">]</span><span class="token punctuation">.</span>Element<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>T2<span class="token punctuation">[</span>T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">]</span><span class="token punctuation">.</span>Element<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">/* no need to swap the left and the right */</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">Isomorphic</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">,</span> T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>                <span class="token function">Isomorphic</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">,</span> T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token comment">/* need to swap the left and the right */</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">Isomorphic</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">,</span> T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>                <span class="token function">Isomorphic</span><span class="token punctuation">(</span>T1<span class="token punctuation">[</span>R1<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">,</span> T2<span class="token punctuation">[</span>R2<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Tree R1<span class="token punctuation">,</span> R2<span class="token punctuation">;</span>    R1 <span class="token operator">=</span> <span class="token function">BuildTree</span><span class="token punctuation">(</span>T1<span class="token punctuation">)</span><span class="token punctuation">;</span>    R2 <span class="token operator">=</span> <span class="token function">BuildTree</span><span class="token punctuation">(</span>T2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Isomorphic</span><span class="token punctuation">(</span>R1<span class="token punctuation">,</span> R2<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 1 有双边换、单边换，节点编号不同但数据同</td><td>答案正确</td><td>7</td><td>3 ms</td><td>196 KB</td></tr><tr><td>1</td><td>sample 2 第3层开始错，每层结点数据对，但父结点不对</td><td>答案正确</td><td>7</td><td>4 ms</td><td>304 KB</td></tr><tr><td>2</td><td>结点数不同</td><td>答案正确</td><td>3</td><td>3 ms</td><td>172 KB</td></tr><tr><td>3</td><td>空树</td><td>答案正确</td><td>2</td><td>4 ms</td><td>172 KB</td></tr><tr><td>4</td><td>只有1个结点，结构同但数据不同</td><td>答案正确</td><td>3</td><td>4 ms</td><td>188 KB</td></tr><tr><td>5</td><td>最大N，层序遍历结果相同，但树不同</td><td>答案正确</td><td>3</td><td>5 ms</td><td>176 KB</td></tr></tbody></table><h3 id="2-List-Leaves"><a href="#2-List-Leaves" class="headerlink" title="2.List Leaves"></a><a href="https://pintia.cn/problem-sets/16/problems/666">2.List Leaves</a></h3><p>Given a tree, you are supposed to list all the leaves in the order of top down, and left to right.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line gives a positive integer <em>N</em> (≤10) which is the total number of nodes in the tree – and hence the nodes are numbered from 0 to <em>N</em>−1. Then <em>N</em> lines follow, each corresponds to a node, and gives the indices of the left and right children of the node. If the child does not exist, a “-“ will be put at the position. Any pair of children are separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in one line all the leaves’ indices in the order of top down, and left to right. There must be exactly one space between any adjacent numbers, and no extra space at the end of the line.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">81 -- -0 -2 7- -- -5 -4 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">4 1 5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>一句话概括题意就是层序遍历输出叶结点，在层序遍历的基础上加一个判断叶结点即可，需要简单修改队列模板。建树过程和上题几乎一致，就不赘述。注意格式，结尾不要有多余空格即可。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxTree</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Tree</span> <span class="token expression"><span class="token keyword">int</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Null</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token operator">*</span>BinTree<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>    Tree Left<span class="token punctuation">;</span>    Tree Right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> T1<span class="token punctuation">[</span>MaxTree<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token constant">NULL</span></span></span><span class="token keyword">typedef</span> BinTree ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>    ElementType <span class="token operator">*</span>Data<span class="token punctuation">;</span>    <span class="token comment">/* 存储元素的数组 */</span>    Position Front<span class="token punctuation">,</span> Rear<span class="token punctuation">;</span> <span class="token comment">/* 队列的头、尾指针 */</span>    <span class="token keyword">int</span> MaxSize<span class="token punctuation">;</span>          <span class="token comment">/* 队列最大容量 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token operator">*</span>Queue<span class="token punctuation">;</span>Queue <span class="token function">CreateQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q <span class="token operator">=</span> <span class="token punctuation">(</span>Queue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Data <span class="token operator">=</span> <span class="token punctuation">(</span>ElementType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>MaxSize <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>Front <span class="token operator">=</span> Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    Q<span class="token operator">-></span>MaxSize <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span>    <span class="token keyword">return</span> Q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsFull</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize <span class="token operator">==</span> Q<span class="token operator">-></span>Front<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsFull</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列满"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Rear <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Rear<span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">==</span> Q<span class="token operator">-></span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"队列空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Q<span class="token operator">-></span>Front <span class="token operator">=</span> <span class="token punctuation">(</span>Q<span class="token operator">-></span>Front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> Q<span class="token operator">-></span>MaxSize<span class="token punctuation">;</span>        <span class="token keyword">return</span> Q<span class="token operator">-></span>Data<span class="token punctuation">[</span>Q<span class="token operator">-></span>Front<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Tree <span class="token function">BuildTree</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span> T<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> check<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> cl<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> row<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">,</span> <span class="token operator">&amp;</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> check<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c %c%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cl<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cl <span class="token operator">!=</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">=</span> cl <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>                check<span class="token punctuation">[</span>T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Left<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Left <span class="token operator">=</span> Null<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cr <span class="token operator">!=</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Right <span class="token operator">=</span> cr <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>                check<span class="token punctuation">[</span>T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Right<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>                T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Right <span class="token operator">=</span> Null<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>check<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>        <span class="token keyword">return</span> Null<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">LevelOrderPrintLeaves</span><span class="token punctuation">(</span>BinTree BT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Queue Q<span class="token punctuation">;</span>    BinTree T<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>BT <span class="token operator">-</span> T1 <span class="token operator">==</span> Null<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">/* 若是空树则直接返回 */</span>    Q <span class="token operator">=</span> <span class="token function">CreateQueue</span><span class="token punctuation">(</span>MaxTree<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*创建并初始化队列Q*/</span>    <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> BT<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        T <span class="token operator">=</span> <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Left <span class="token operator">==</span> Null <span class="token operator">&amp;&amp;</span> T<span class="token operator">-></span>Right <span class="token operator">==</span> Null<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> T <span class="token operator">-</span> T1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*访问取出队列的结点，若是叶子则输出*/</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span> T <span class="token operator">-</span> T1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Left <span class="token operator">!=</span> Null<span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> T1 <span class="token operator">+</span> T<span class="token operator">-></span>Left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token operator">-></span>Right <span class="token operator">!=</span> Null<span class="token punctuation">)</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Q<span class="token punctuation">,</span> T1 <span class="token operator">+</span> T<span class="token operator">-></span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Tree T<span class="token punctuation">;</span>    T <span class="token operator">=</span> <span class="token function">BuildTree</span><span class="token punctuation">(</span>T1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">LevelOrderPrintLeaves</span><span class="token punctuation">(</span>T1 <span class="token operator">+</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 编号乱序，有单边左孩子，中间层少先输出</td><td>答案正确</td><td>13</td><td>4 ms</td><td>188 KB</td></tr><tr><td>1</td><td>最大N，有单边右孩子，多层</td><td>答案正确</td><td>5</td><td>4 ms</td><td>196 KB</td></tr><tr><td>2</td><td>最小N</td><td>答案正确</td><td>1</td><td>4 ms</td><td>192 KB</td></tr><tr><td>3</td><td>每层都有输出，有双孩子</td><td>答案正确</td><td>5</td><td>4 ms</td><td>192 KB</td></tr><tr><td>4</td><td>单边树，只有1个输出</td><td>答案正确</td><td>1</td><td>3 ms</td><td>192 KB</td></tr></tbody></table><h3 id="3-Tree-Traversals-Again"><a href="#3-Tree-Traversals-Again" class="headerlink" title="3.Tree Traversals Again"></a><a href="https://pintia.cn/problem-sets/16/problems/667">3.Tree Traversals Again</a></h3><p>An inorder binary tree traversal can be implemented in a non-recursive way with a stack. For example, suppose that when a 6-node binary tree (with the keys numbered from 1 to 6) is traversed, the stack operations are: push(1); push(2); push(3); pop(); pop(); push(4); pop(); pop(); push(5); push(6); pop(); pop(). Then a unique binary tree (shown in Figure 1) can be generated from this sequence of operations. Your task is to give the postorder traversal sequence of this tree.</p><p><img src="https://images.ptausercontent.com/30" alt="图1"></p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains a positive integer <em>N</em> (≤30) which is the total number of nodes in a tree (and hence the nodes are numbered from 1 to <em>N</em>). Then 2<em>N</em> lines follow, each describes a stack operation in the format: “Push X” where X is the index of the node being pushed onto the stack; or “Pop” meaning to pop one node from the stack.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print the postorder traversal sequence of the corresponding tree in one line. A solution is guaranteed to exist. All the numbers must be separated by exactly one space, and there must be no extra space at the end of the line.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">6Push 1Push 2Push 3PopPopPush 4PopPopPush 5Push 6PopPop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">3 4 2 6 5 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>事实上， Push的顺序为先序遍历，Pop的顺序给出中序遍历，要我们求后续遍历。利用前述分解的思路递归求解即可。</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">30</span></span></span><span class="token keyword">int</span> n<span class="token punctuation">,</span> pre<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> in<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> post<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> stack<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">char</span> s<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token keyword">int</span> preL<span class="token punctuation">,</span> <span class="token keyword">int</span> inL<span class="token punctuation">,</span> <span class="token keyword">int</span> postL<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        post<span class="token punctuation">[</span>postL<span class="token punctuation">]</span> <span class="token operator">=</span> pre<span class="token punctuation">[</span>preL<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> root <span class="token operator">=</span> pre<span class="token punctuation">[</span>preL<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">;</span>    post<span class="token punctuation">[</span>postL <span class="token operator">+</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> root<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>in<span class="token punctuation">[</span>inL <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">==</span> root<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> L <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token keyword">int</span> R <span class="token operator">=</span> n <span class="token operator">-</span> L <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">solve</span><span class="token punctuation">(</span>preL <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> inL<span class="token punctuation">,</span> postL<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">solve</span><span class="token punctuation">(</span>preL <span class="token operator">+</span> L <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> inL <span class="token operator">+</span> L <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> postL <span class="token operator">+</span> L<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> cnt1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cnt2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'u'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pre<span class="token punctuation">[</span>cnt1<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> pre<span class="token punctuation">[</span>cnt1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            in<span class="token punctuation">[</span>cnt2<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token operator">--</span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">solve</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> post<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> post<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 有单边有双边结点</td><td>答案正确</td><td>12</td><td>3 ms</td><td>328 KB</td></tr><tr><td>1</td><td>单边喇叭张开形</td><td>答案正确</td><td>4</td><td>3 ms</td><td>328 KB</td></tr><tr><td>2</td><td>交错</td><td>答案正确</td><td>4</td><td>3 ms</td><td>200 KB</td></tr><tr><td>3</td><td>N=1</td><td>答案正确</td><td>1</td><td>4 ms</td><td>192 KB</td></tr><tr><td>4</td><td>N=30，复杂组合</td><td>答案正确</td><td>4</td><td>3 ms</td><td>324 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week2</title>
      <link href="2021/072949644.html"/>
      <url>2021/072949644.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week2线性结构"><a href="#Week2线性结构" class="headerlink" title="Week2线性结构"></a>Week2线性结构</h1><h2 id="2-1-线性表及其实现"><a href="#2-1-线性表及其实现" class="headerlink" title="2.1 线性表及其实现"></a>2.1 线性表及其实现</h2><h3 id="多项式的表示"><a href="#多项式的表示" class="headerlink" title="多项式的表示"></a>多项式的表示</h3><p>例 一元多项式及其运算</p><p>一元多项式 ：$f(x)=a_0+a_1x+\cdots+a_{n-1}x^{n-1}+a_nx^n$​</p><p>主要运算： 多项式相加、相减、相乘等</p><p>分析 如何表示多项式？多项式的关键数据：多项式系数n和各项系数$a_i$及指数i</p><h4 id="方法1：顺序存储结构直接表示"><a href="#方法1：顺序存储结构直接表示" class="headerlink" title="方法1：顺序存储结构直接表示"></a>方法1：顺序存储结构直接表示</h4><p>数组各分量对应多项式各项 ：$a[i]:$项$x^i$的系数$a_i$</p><p>两个多项式相加： 两个数组对应分量相加  </p><p>问题：如何表示多项式 $x+3x^{2000}?$​  （用数组空间浪费）</p><h4 id="方法2：顺序存储结构表示非零项"><a href="#方法2：顺序存储结构表示非零项" class="headerlink" title="方法2：顺序存储结构表示非零项"></a>方法2：顺序存储结构表示非零项</h4><p>每个非零项$a_ix^i$涉及两个信息：系数$a_i$和指数$i$</p><p>可以将一个多项式看成是一个$(a_i,i)$二元组的集合</p><p>用结构数组表示： 数组分量是由系数$a_i$、指数$i$组成的结构，对应一个非零项  </p><p><strong>按指数大小有序存储！</strong></p><p>相加过程：从头开始，比较两个多项式当前对应项的指数  </p><p>$P1: (9,12), (15,8), (3,2)$</p><p>$P2: (26,19), (-4,8), (-13,6), (82,0)$</p><p>$P3: (26,19) (9,12) (11,8) (-13,6) (3,2) (82,0)  $</p><p>$P3(x) = 26x^{19} + 9x^{12} +11x^8 - 13x^6 + 3x^2 + 82$</p><h4 id="方法3：链表结构存储非零项"><a href="#方法3：链表结构存储非零项" class="headerlink" title="方法3：链表结构存储非零项"></a>方法3：链表结构存储非零项</h4><p>链表中每个结点存储多项式中的一个非零项，包括系数和指数两个数据域以及一个指针域  </p><table><thead><tr><th>coef</th><th>expon</th><th>link</th></tr></thead></table><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">PolyNode</span> <span class="token operator">*</span>Polynomial<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">PolyNode</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> coef<span class="token punctuation">;</span><span class="token keyword">int</span> expon<span class="token punctuation">;</span>Polynomial link<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="什么是线性表"><a href="#什么是线性表" class="headerlink" title="什么是线性表"></a>什么是线性表</h3><p>多项式表示问题的启示：</p><ol><li>同一个问题可以有不同的表示（存储）方法</li><li>有一类共性问题：有序线性序列的组织和管理 </li></ol><p>” 线性表（Linear List）”：由同类型数据元素构成有序序列的线性结构</p><ul><li>表中元素个数称为线性表的长度</li><li>线性表没有元素时，称为空表</li><li>表起始位置称表头，表结束位置称表尾  </li></ul><h3 id="线性表的抽象数据类型描述"><a href="#线性表的抽象数据类型描述" class="headerlink" title="线性表的抽象数据类型描述"></a>线性表的抽象数据类型描述</h3><p>类型名称： 线性表$(List)$</p><p>数据对象集： 线性表是 $n (≥0)$个元素构成的有序序列$( a_1, a_2, \cdots,a_n )$</p><p>操作集： 线性表$L \in List$，整数$i$表示位置，元素$X \in ElementType$，</p><p>线性表基本操作主要有：</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">MakeEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//初始化一个空线性表L；</span>ElementType <span class="token function">FindKth</span><span class="token punctuation">(</span><span class="token keyword">int</span> K<span class="token punctuation">,</span> List L<span class="token punctuation">)</span><span class="token comment">//根据位序K，返回相应元素 ；</span><span class="token keyword">int</span> <span class="token function">Find</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> List L<span class="token punctuation">)</span><span class="token comment">//在线性表L中查找X的第一次出现位置；</span><span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> List L<span class="token punctuation">)</span><span class="token comment">//在位序i前插入一个新元素X；</span><span class="token keyword">void</span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> List L<span class="token punctuation">)</span><span class="token comment">//删除指定位序i的元素；</span><span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span>List L<span class="token punctuation">)</span><span class="token comment">//返回线性表L的长度n。    </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="线性表的顺序存储实现"><a href="#线性表的顺序存储实现" class="headerlink" title="线性表的顺序存储实现"></a>线性表的顺序存储实现</h3><p>利用数组的<strong>连续存储空间顺序存放</strong>线性表的各元素  </p><table><thead><tr><th>下标$i$</th><th>0</th><th>1</th><th>$\cdots$</th><th>$i-1$</th><th>$i$</th><th>$\cdots$</th><th>$n-1$</th><th>$\cdots$</th><th>$MAXSIZE-1$</th></tr></thead><tbody><tr><td>Data</td><td>$a_1$</td><td>$a_2$​</td><td>$\cdots$</td><td>$a_i$​</td><td>$a_{i+1}$​</td><td>$\cdots$</td><td>$a_n(Last)$​</td><td>$\cdots$</td><td>-</td></tr></tbody></table><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token operator">*</span> List<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> Last<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> L<span class="token punctuation">;</span>List PtrL<span class="token punctuation">;</span><span class="token comment">//访问下标为 i 的元素： L.Data[i] 或 PtrL->Data[i]</span><span class="token comment">//线性表的长度： L.Last+1 或 PtrL->Last+1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="主要操作的实现"><a href="#主要操作的实现" class="headerlink" title="主要操作的实现"></a>主要操作的实现</h4><h5 id="1-初始化（建立空的顺序表）"><a href="#1-初始化（建立空的顺序表）" class="headerlink" title="1.初始化（建立空的顺序表）"></a>1.初始化（建立空的顺序表）</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">MakeEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>List PtrL<span class="token punctuation">;</span>PtrL <span class="token operator">=</span> <span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>PtrL<span class="token operator">-></span>Last <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">return</span> PtrL<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-查找"><a href="#2-查找" class="headerlink" title="2.查找"></a>2.查找</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">Find</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> PtrL<span class="token operator">-></span>Last <span class="token operator">&amp;&amp;</span> PtrL<span class="token operator">-></span>Data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> X<span class="token punctuation">)</span>i<span class="token operator">++</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> PtrL<span class="token operator">-></span>Last<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* 如果没找到， 返回-1 */</span><span class="token keyword">else</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span> <span class="token comment">/* 找到后返回的是存储位置 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>查找成功的平均比较次数为$(n +1)/2$，平均时间性能为$O(n)$。  </p><h5 id="3-插入（第-i-1≤i≤n-1-个位置上插入一个值为-X-的新元素"><a href="#3-插入（第-i-1≤i≤n-1-个位置上插入一个值为-X-的新元素" class="headerlink" title="3.插入（第 $i (1≤i≤n+1)$个位置上插入一个值为$X$的新元素)"></a>3.插入（第 $i (1≤i≤n+1)$个位置上插入一个值为$X$的新元素)</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> j<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrL<span class="token operator">-></span>Last <span class="token operator">==</span> MAXSIZE <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 表空间已满，不能插入*/</span><span class="token function">printf</span><span class="token punctuation">(</span>＂表满＂<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">></span> PtrL<span class="token operator">-></span>Last <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*检查插入位置的合法性*/</span><span class="token function">printf</span><span class="token punctuation">(</span>＂位置不合法＂<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> PtrL<span class="token operator">-></span>Last<span class="token punctuation">;</span> j <span class="token operator">>=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>PtrL<span class="token operator">-></span>Data<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> PtrL<span class="token operator">-></span>Data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*将 ai～ an倒序向后移动*/</span>PtrL<span class="token operator">-></span>Data<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> X<span class="token punctuation">;</span> <span class="token comment">/*新元素插入*/</span>PtrL<span class="token operator">-></span>Last<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/*Last仍指向最后元素*/</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>平均移动次数为$ n /2$， 平均时间性能为 $O(n)$</p><h5 id="4-删除（删除表的第-i-1≤i≤n-个位置上的元素"><a href="#4-删除（删除表的第-i-1≤i≤n-个位置上的元素" class="headerlink" title="4.删除（删除表的第$ i (1≤i≤n)$个位置上的元素)"></a>4.删除（删除表的第$ i (1≤i≤n)$个位置上的元素)</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> j<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">></span> PtrL<span class="token operator">-></span>Last <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*检查空表及删除位置的合法性*/</span><span class="token function">printf</span><span class="token punctuation">(</span>“不存在第 <span class="token operator">%</span> d个元素”<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> PtrL<span class="token operator">-></span>Last<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>PtrL<span class="token operator">-></span>Data<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> PtrL<span class="token operator">-></span>Data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*将 ai+1～ an顺序向前移动*/</span>PtrL<span class="token operator">-></span>Last<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">/*Last仍指向最后元素*/</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>平均移动次数为$ (n-1) /2$​， 平均时间性能为 $O(n)$​</p><h3 id="线性表的链式存储实现"><a href="#线性表的链式存储实现" class="headerlink" title="线性表的链式存储实现"></a>线性表的链式存储实现</h3><p>不要求逻辑上相邻的两个元素物理上也相邻；通过“链”建立起数据元素之间的逻辑关系。</p><p>• 插入、删除不需要移动数据元素，只需要修改“链” 。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token operator">*</span> List<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">;</span>List Next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Lnode</span> L<span class="token punctuation">;</span>List PtrL<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="主要操作的实现-1"><a href="#主要操作的实现-1" class="headerlink" title="主要操作的实现"></a>主要操作的实现</h4><h5 id="1-求表长"><a href="#1-求表长" class="headerlink" title="1.求表长"></a>1.求表长</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span>List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>List p <span class="token operator">=</span> PtrL<span class="token punctuation">;</span> <span class="token comment">/* p指向表的第一个结点*/</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>p <span class="token operator">=</span> p<span class="token operator">-></span>Next<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">/* 当前p指向的是第 j 个结点*/</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> j<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>时间性能为 $O(n)$。</p><h5 id="2-查找-1"><a href="#2-查找-1" class="headerlink" title="2.查找"></a>2.查找</h5><h6 id="（1）按序号查找-FindKth"><a href="#（1）按序号查找-FindKth" class="headerlink" title="（1）按序号查找: FindKth;"></a>（1）按序号查找: FindKth;</h6><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">FindKth</span><span class="token punctuation">(</span><span class="token keyword">int</span> K<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>List p <span class="token operator">=</span> PtrL<span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> K<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>p <span class="token operator">=</span> p<span class="token operator">-></span>Next<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> K<span class="token punctuation">)</span> <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token comment">/* 找到第K个，返回指针 */</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token comment">/* 否则返回空 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="（2）按值查找-Find"><a href="#（2）按值查找-Find" class="headerlink" title="（2）按值查找: Find"></a>（2）按值查找: Find</h6><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">Find</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>List p <span class="token operator">=</span> PtrL<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> p<span class="token operator">-></span>Data <span class="token operator">!=</span> X<span class="token punctuation">)</span>p <span class="token operator">=</span> p<span class="token operator">-></span>Next<span class="token punctuation">;</span><span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="3-插入（在第-i-1-1≤i≤n-1-个结点后插入一个值为-X-的新结点"><a href="#3-插入（在第-i-1-1≤i≤n-1-个结点后插入一个值为-X-的新结点" class="headerlink" title="3.插入（在第 $i-1(1≤i≤n+1)$个结点后插入一个值为$X$的新结点)"></a>3.插入（在第 $i-1(1≤i≤n+1)$个结点后插入一个值为$X$的新结点)</h5><p>（1）先构造一个新结点，用s指向；</p><p>（2）再找到链表的第 i-1个结点，用p指向；</p><p>（3）然后修改指针，插入结点 （ p之后插入新结点是 s）</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">Insert</span><span class="token punctuation">(</span>ElementType X<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>List p<span class="token punctuation">,</span> s<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 新结点插入在表头 */</span>s <span class="token operator">=</span> <span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*申请、填装结点*/</span>s<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>s<span class="token operator">-></span>Next <span class="token operator">=</span> PtrL<span class="token punctuation">;</span><span class="token keyword">return</span> s<span class="token punctuation">;</span> <span class="token comment">/*返回新表头指针*/</span><span class="token punctuation">&#125;</span>p <span class="token operator">=</span> <span class="token function">FindKth</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> PtrL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 查找第i-1个结点 */</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 第i-1个不存在，不能插入 */</span><span class="token function">printf</span><span class="token punctuation">(</span>＂参数i错＂<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>s <span class="token operator">=</span> <span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*申请、填装结点*/</span>s<span class="token operator">-></span>Data <span class="token operator">=</span> X<span class="token punctuation">;</span>s<span class="token operator">-></span>Next <span class="token operator">=</span> p<span class="token operator">-></span>Next<span class="token punctuation">;</span> <span class="token comment">/*新结点插入在第i-1个结点的后面*/</span>p<span class="token operator">-></span>Next <span class="token operator">=</span> s<span class="token punctuation">;</span><span class="token keyword">return</span> PtrL<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="4-删除（删除链表的第-i-1≤i≤n-个位置上的结点"><a href="#4-删除（删除链表的第-i-1≤i≤n-个位置上的结点" class="headerlink" title="4.删除（删除链表的第 $i (1≤i≤n)$个位置上的结点)"></a>4.删除（删除链表的第 $i (1≤i≤n)$个位置上的结点)</h5><p>（1）先找到链表的第 i-1个结点，用p指向；</p><p>（2）再用指针s指向要被删除的结点（ p的下一个结点）；</p><p>（3）然后修改指针，删除s所指结点;</p><p>（4）最后释放s所指结点的空间。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> List PtrL<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>List p<span class="token punctuation">,</span> s<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 若要删除的是表的第一个结点 */</span>s <span class="token operator">=</span> PtrL<span class="token punctuation">;</span> <span class="token comment">/*s指向第1个结点*/</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrL <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> PtrL <span class="token operator">=</span> PtrL<span class="token operator">-></span>Next<span class="token punctuation">;</span> <span class="token comment">/*从链表中删除*/</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*释放被删除结点 */</span><span class="token keyword">return</span> PtrL<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>p <span class="token operator">=</span> <span class="token function">FindKth</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> PtrL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*查找第i-1个结点*/</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“第 <span class="token operator">%</span> d个结点不存在”<span class="token punctuation">,</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token operator">-></span>Next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“第 <span class="token operator">%</span> d个结点不存在”<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>s <span class="token operator">=</span> p<span class="token operator">-></span>Next<span class="token punctuation">;</span> <span class="token comment">/*s指向第i个结点*/</span>p<span class="token operator">-></span>Next <span class="token operator">=</span> s<span class="token operator">-></span>Next<span class="token punctuation">;</span> <span class="token comment">/*从链表中删除*/</span><span class="token function">free</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*释放被删除结点 */</span><span class="token keyword">return</span> PtrL<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="广义表（Generalized-List）"><a href="#广义表（Generalized-List）" class="headerlink" title="广义表（Generalized List）"></a>广义表（Generalized List）</h3><ul><li>广义表是线性表的推广</li><li>对于线性表而言， n个元素都是基本的单元素；</li><li>广义表中，这些元素不仅可以是单元素也可以是另一个广义表。  </li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">GNode</span><span class="token operator">*</span> GList<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">GNode</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> Tag<span class="token punctuation">;</span> <span class="token comment">/*标志域： 0表示结点是单元素， 1表示结点是广义表 */</span><span class="token keyword">union</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*子表指针域Sublist与单元素数据域Data复用，即共用存储空间*/</span>ElementType Data<span class="token punctuation">;</span>GList SubList<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> URegion<span class="token punctuation">;</span>GList Next<span class="token punctuation">;</span> <span class="token comment">/* 指向后继结点 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="多重链表"><a href="#多重链表" class="headerlink" title="多重链表"></a>多重链表</h3><p>多重链表： 链表中的节点可能同时隶属于多个链</p><ul><li>多重链表中结点的指针域会有多个，如前面例子包含了Next和SubList两个指针域；</li><li> 但包含两个指针域的链表并不一定是多重链表，比如在双向链表不是多重链表。</li></ul><p>多重链表有广泛的用途：基本上如树、图这样相对复杂的数据结构都可以采用多重链表方式实现存储。  </p><p>例 矩阵可以用二维数组表示，但二维数组表示有两个缺陷：  </p><ul><li>一是数组的大小需要事先确定，</li><li>对于“稀疏矩阵 ”，将造成大量的存储空间浪费。  </li></ul><p>分析  采用一种典型的多重链表——十字链表来存储稀疏矩阵</p><p>1.只存储矩阵非0元素项结点的数据域： 行坐标Row、列坐标Col、数值Value</p><p>2.每个结点通过两个指针域， 把同行、同列串起来;</p><ul><li>行指针（或称为向右指针）Right</li><li>列指针（或称为向下指针）Down  </li></ul><p>用一个标识域Tag来区分头结点和非0元素结点：</p><p>头节点的标识值为“Head”，矩阵非0元素结点的标识值为“Term”。  </p><h2 id="2-2-堆栈"><a href="#2-2-堆栈" class="headerlink" title="2.2 堆栈"></a>2.2 堆栈</h2><h3 id="什么是堆栈"><a href="#什么是堆栈" class="headerlink" title="什么是堆栈"></a>什么是堆栈</h3><p>计算机如何进行表达式求值？  </p><p>例 算术表达式$5+6/2-3*4$。</p><p>正确理解$5+6/2-3*4=5+3-3$​​ $ *\ 4=8-3$​​ $*\ 4=-4$​​​​​</p><p>由两类对象构成的：</p><ul><li>运算数，如2、 3、 4</li><li>运算符号，如$+、 -、 *、 /$</li></ul><p>不同运算符号优先级不一样  </p><h3 id="后缀表达式"><a href="#后缀表达式" class="headerlink" title="后缀表达式"></a>后缀表达式</h3><ul><li>中缀表达式： 运算符号位于两个运算数之间。 如 ，$ a + b * c - d / e$</li><li>后缀表达式： 运算符号位于两个运算数之后。如，$ a\ b\ c *\ +\ d\ e\ /\ -  $</li></ul><p>后缀表达式求值策略：从左向右“扫描”，逐个处理运算数和运算符号</p><ol><li>遇到运算数怎么办？如何“记住”目前还不未参与运算的数？</li><li>遇到运算符号怎么办？对应的运算数是什么？  </li></ol><p>启示： 需要有种存储方法，能顺序存储运算数，并在需要时“倒序”输出！  </p><h3 id="堆栈的抽象数据类型描述"><a href="#堆栈的抽象数据类型描述" class="headerlink" title="堆栈的抽象数据类型描述"></a>堆栈的抽象数据类型描述</h3><p>堆栈（Stack） ： 具有一定操作约束的线性表</p><ul><li><p>只在一端（栈顶， Top）做 插入、删除  </p></li><li><p>插入数据： 入栈（Push）</p></li><li><p>删除数据： 出栈（Pop）</p></li><li><p>后入先出： Last In First Out（LIFO）  </p></li></ul><p>类型名称: 堆栈（Stack）</p><p>数据对象集： 一个有0个或多个元素的有穷线性表。</p><p>操作集： 长度为$MaxSize$的堆栈$S \in Stack$，堆栈元素$item \in ElementType$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Stack <span class="token function">CreateStack</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span><span class="token comment">//生成空堆栈，其最大长度为MaxSize；</span><span class="token keyword">int</span> <span class="token function">IsFull</span><span class="token punctuation">(</span>Stack S<span class="token punctuation">,</span> <span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span><span class="token comment">//判断堆栈S是否已满；</span><span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span>Stack S<span class="token punctuation">,</span> ElementType item<span class="token punctuation">)</span><span class="token comment">//将元素item压入堆栈；</span><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Stack S<span class="token punctuation">)</span><span class="token comment">//判断堆栈S是否为空；</span>ElementType <span class="token function">Pop</span><span class="token punctuation">(</span>Stack S<span class="token punctuation">)</span><span class="token comment">//删除并返回栈顶元素；</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Push 和 Pop 可以穿插交替进行；</p><p>按照操作系列</p><p>$(1)Push(S,A), Push(S,B),Push((S,C),Pop(S),Pop(S),Pop(S) $​ 堆栈输出是$CBA$</p><p>$(2)Push(S,A), Pop(S),Push(S,B),Push((S,C),Pop(S),Pop(S)$​ 堆栈输出是$ACB$​ </p><h3 id="栈的顺序存储实现"><a href="#栈的顺序存储实现" class="headerlink" title="栈的顺序存储实现"></a>栈的顺序存储实现</h3><p>栈的顺序存储结构通常由一个一维数组和一个记录栈顶元素位置的变量组成。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxSize</span> <span class="token expression"><span class="token operator">&lt;</span>储存数据元素的最大个数<span class="token operator">></span></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token operator">*</span> Stack<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> Top<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="（1）入-栈"><a href="#（1）入-栈" class="headerlink" title="（1）入 栈"></a>（1）入 栈</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span>Stack PtrS<span class="token punctuation">,</span> ElementType item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top <span class="token operator">==</span> MaxSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“堆栈满”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>PtrS<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token operator">++</span><span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="（2）出栈"><a href="#（2）出栈" class="headerlink" title="（2）出栈"></a>（2）出栈</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">ElementType <span class="token function">Pop</span><span class="token punctuation">(</span>Stack PtrS<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“堆栈空”<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> ERROR<span class="token punctuation">;</span> <span class="token comment">/* ERROR是ElementType的特殊值，标志错误*/</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top<span class="token punctuation">)</span><span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>例 请用一个数组实现两个堆栈，要求最大地利用数组空间，使数组只要有空间入栈操作就可以成功。  </p><p>分析 一种比较聪明的方法是使这两个栈分别从数组的两头开始向中间生长；当两个栈的栈顶指针相遇时，表示两个栈都满了。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxSize</span> <span class="token expression"><span class="token operator">&lt;</span>存储数据元素的最大个数<span class="token operator">></span></span></span><span class="token keyword">struct</span> <span class="token class-name">DStack</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> Top1<span class="token punctuation">;</span> <span class="token comment">/* 堆栈１的栈顶指针 */</span><span class="token keyword">int</span> Top2<span class="token punctuation">;</span> <span class="token comment">/* 堆栈２的栈顶指针 */</span><span class="token punctuation">&#125;</span> S<span class="token punctuation">;</span>S<span class="token punctuation">.</span>Top1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>S<span class="token punctuation">.</span>Top2 <span class="token operator">=</span> MaxSize<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">DStack</span><span class="token operator">*</span> PtrS<span class="token punctuation">,</span> ElementType item<span class="token punctuation">,</span> <span class="token keyword">int</span> Tag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">/* Tag作为区分两个堆栈的标志，取值为1和2 */</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top2 – PtrS<span class="token operator">-></span>Top1 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*堆栈满*/</span><span class="token function">printf</span><span class="token punctuation">(</span>“堆栈满”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>Tag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">/* 对第一个堆栈操作 */</span>PtrS<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token operator">++</span><span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top1<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token comment">/* 对第二个堆栈操作 */</span>PtrS<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token operator">--</span><span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top2<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>ElementType <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">DStack</span><span class="token operator">*</span> PtrS<span class="token punctuation">,</span> <span class="token keyword">int</span> Tag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* Tag作为区分两个堆栈的标志，取值为1和2 */</span><span class="token keyword">if</span> <span class="token punctuation">(</span>Tag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 对第一个堆栈操作 */</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top1 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*堆栈1空 */</span><span class="token function">printf</span><span class="token punctuation">(</span>“堆栈<span class="token number">1</span>空”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">return</span> PtrS<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top1<span class="token punctuation">)</span><span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 对第二个堆栈操作 */</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top2 <span class="token operator">==</span> MaxSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*堆栈2空 */</span><span class="token function">printf</span><span class="token punctuation">(</span>“堆栈<span class="token number">2</span>空”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">return</span> PtrS<span class="token operator">-></span>Data<span class="token punctuation">[</span><span class="token punctuation">(</span>PtrS<span class="token operator">-></span>Top2<span class="token punctuation">)</span><span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="堆栈的链式存储实现"><a href="#堆栈的链式存储实现" class="headerlink" title="堆栈的链式存储实现"></a>堆栈的链式存储实现</h3><p>栈的链式存储结构实际上就是一个单链表，叫做链栈。插入和删除操作只能在链栈的栈顶进行。 </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token operator">*</span> Stack<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token operator">*</span> Next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-堆栈初始化（建立空栈）"><a href="#1-堆栈初始化（建立空栈）" class="headerlink" title="(1) 堆栈初始化（建立空栈）"></a>(1) 堆栈初始化（建立空栈）</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">Stack <span class="token function">CreateStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* 构建一个堆栈的头结点，返回指针 */</span>Stack S<span class="token punctuation">;</span>S <span class="token operator">=</span> <span class="token punctuation">(</span>Stack<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>S<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token keyword">return</span> S<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-判断堆栈S是否为空"><a href="#2-判断堆栈S是否为空" class="headerlink" title="(2) 判断堆栈S是否为空"></a>(2) 判断堆栈S是否为空</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">IsEmpty</span><span class="token punctuation">(</span>Stack S<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/*判断堆栈S是否为空， 若为空函数返回整数1， 否则返回0 */</span><span class="token keyword">return</span> <span class="token punctuation">(</span>S<span class="token operator">-></span>Next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="（3）入-栈"><a href="#（3）入-栈" class="headerlink" title="（3）入 栈"></a>（3）入 栈</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span>ElementType item<span class="token punctuation">,</span> Stack S<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* 将元素item压入堆栈S */</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token operator">*</span> TmpCell<span class="token punctuation">;</span>TmpCell <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>TmpCell<span class="token operator">-></span>Element <span class="token operator">=</span> item<span class="token punctuation">;</span>TmpCell<span class="token operator">-></span>Next <span class="token operator">=</span> S<span class="token operator">-></span>Next<span class="token punctuation">;</span>S<span class="token operator">-></span>Next <span class="token operator">=</span> TmpCell<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="（4）出栈"><a href="#（4）出栈" class="headerlink" title="（4）出栈"></a>（4）出栈</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">ElementType <span class="token function">Pop</span><span class="token punctuation">(</span>Stack S<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* 删除并返回堆栈S的栈顶元素 */</span><span class="token keyword">struct</span> <span class="token class-name">SNode</span><span class="token operator">*</span> FirstCell<span class="token punctuation">;</span>ElementType TopElem<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“堆栈空”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>FirstCell <span class="token operator">=</span> S<span class="token operator">-></span>Next<span class="token punctuation">;</span>S<span class="token operator">-></span>Next <span class="token operator">=</span> FirstCell<span class="token operator">-></span>Next<span class="token punctuation">;</span>TopElem <span class="token operator">=</span> FirstCell<span class="token operator">-></span>Element<span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span>FirstCell<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> TopElem<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="堆栈应用：表达式求值"><a href="#堆栈应用：表达式求值" class="headerlink" title="堆栈应用：表达式求值"></a>堆栈应用：表达式求值</h3><p>回忆： 应用堆栈实现后缀表达式求值的基本过程：</p><p>从左到右读入后缀表达式的各项（运算符或运算数）；</p><ol><li>运算数： 入栈；</li><li>运算符： 从堆栈中弹出适当数量的运算数，计算并结果入栈；</li><li>最后，堆栈顶上的元素就是表达式的结果值。  </li></ol><h3 id="中缀表达式求值"><a href="#中缀表达式求值" class="headerlink" title="中缀表达式求值"></a>中缀表达式求值</h3><p>基本策略：将中缀表达式转换为后缀表达式，然后求值</p><p>如何将中缀表达式转换为后缀？</p><p>观察一个简单例子： $2+9/3-5 \qquad \rightarrow\qquad  2\ 9\ 3\ /\ +\ -$​​</p><ol><li><p>运算数相对顺序不变</p></li><li><p>运算符号顺序发生改变</p><p>需要存储“等待中”的运算符号</p><p>要将当前运算符号与“等待中”的最后一个运算符号比较</p></li></ol><h3 id="中缀表达式如何转换为后缀表达式"><a href="#中缀表达式如何转换为后缀表达式" class="headerlink" title="中缀表达式如何转换为后缀表达式"></a>中缀表达式如何转换为后缀表达式</h3><p>从头到尾读取中缀表达式的每个对象，对不同对象按不同的情况处理。</p><p>① 运算数： 直接输出；</p><p>② 左括号： 压入堆栈；</p><p>③ 右括号： 将栈顶的运算符弹出并输出， 直到遇到左括号（出栈，不输出）；</p><p>④ 运算符：</p><p>• 若优先级大于栈顶运算符时，则把它压栈；</p><p>• 若优先级小于等于栈顶运算符时，将栈顶运算符弹出并输出；再比较新的栈顶运算符，直到该运算符大于栈顶运算符优先级为止，然后将该运算符压栈；</p><p>⑤ 若各对象处理完毕，则把堆栈中存留的运算符一并输出。  </p><h3 id="堆栈的其他应用"><a href="#堆栈的其他应用" class="headerlink" title="堆栈的其他应用"></a>堆栈的其他应用</h3><ul><li>函数调用及递归实现</li><li>深度优先搜索</li><li>回溯算法</li><li>$\cdots$</li></ul><h2 id="2-3-队列及实现"><a href="#2-3-队列及实现" class="headerlink" title="2.3 队列及实现"></a>2.3 队列及实现</h2><h3 id="什么是队列"><a href="#什么是队列" class="headerlink" title="什么是队列"></a>什么是队列</h3><p>队列（Queue）： 具有一定操作约束的线性表</p><ul><li>插入和删除操作：只能在一端插入，而在另一端删除。  </li><li>数据插入： 入队列（AddQ）</li><li>数据删除： 出队列（DeleteQ）</li><li>先来先服务</li><li>先进先出： FIFO  </li></ul><h3 id="队列的抽象数据类型描述"><a href="#队列的抽象数据类型描述" class="headerlink" title="队列的抽象数据类型描述"></a>队列的抽象数据类型描述</h3><p>类型名称：队列（Queue）</p><p>数据对象集： 一个有0个或多个元素的有穷线性表。</p><p>操作集：长度为$MaxSize$的队列$Q \in Queue$，队列元素$item \in ElementType$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Queue <span class="token function">CreatQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span><span class="token comment">//生成长度为MaxSize的空队列；</span><span class="token keyword">int</span> <span class="token function">IsFullQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> <span class="token keyword">int</span> MaxSize<span class="token punctuation">)</span><span class="token comment">//判断队列Q是否已满；</span><span class="token keyword">void</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">,</span> ElementType item<span class="token punctuation">)</span><span class="token comment">// 将数据元素item插入队列Q中；</span><span class="token keyword">int</span> <span class="token function">IsEmptyQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span><span class="token comment">//判断队列Q是否为空；</span>ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue Q<span class="token punctuation">)</span><span class="token comment">//将队头数据元素从队列中删除并返回。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="队列的顺序存储实现"><a href="#队列的顺序存储实现" class="headerlink" title="队列的顺序存储实现"></a>队列的顺序存储实现</h3><p>队列的顺序存储结构通常由一个一维数组和一个记录队列头元素位置的变量front以及一个记录队列尾元素位置的变量rear组成。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxSize</span> <span class="token expression"><span class="token operator">&lt;</span>储存数据元素的最大个数<span class="token operator">></span></span></span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> rear<span class="token punctuation">;</span><span class="token keyword">int</span> front<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token operator">*</span> Queue<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="（1）入队列"><a href="#（1）入队列" class="headerlink" title="（1）入队列"></a>（1）入队列</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">AddQ</span><span class="token punctuation">(</span>Queue PtrQ<span class="token punctuation">,</span> ElementType item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>PtrQ<span class="token operator">-></span>rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> MaxSize <span class="token operator">==</span> PtrQ<span class="token operator">-></span>front<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“队列满”<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>PtrQ<span class="token operator">-></span>rear <span class="token operator">=</span> <span class="token punctuation">(</span>PtrQ<span class="token operator">-></span>rear <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> MaxSize<span class="token punctuation">;</span>PtrQ<span class="token operator">-></span>Data<span class="token punctuation">[</span>PtrQ<span class="token operator">-></span>rear<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Front和rear指针的移动采用“加1取余”法，体现了顺序存储的“循环使用”。  </p><h4 id="（2）出队列"><a href="#（2）出队列" class="headerlink" title="（2）出队列"></a>（2）出队列</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue PtrQ<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrQ<span class="token operator">-></span>front <span class="token operator">==</span> PtrQ<span class="token operator">-></span>rear<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“队列空”<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> ERROR<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>PtrQ<span class="token operator">-></span>front <span class="token operator">=</span> <span class="token punctuation">(</span>PtrQ<span class="token operator">-></span>front <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> MaxSize<span class="token punctuation">;</span><span class="token keyword">return</span> PtrQ<span class="token operator">-></span>Data<span class="token punctuation">[</span>PtrQ<span class="token operator">-></span>front<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="队列的链式存储实现"><a href="#队列的链式存储实现" class="headerlink" title="队列的链式存储实现"></a>队列的链式存储实现</h3><p>队列的链式存储结构也可以用一个单链表实现。插入和删除操作分别在链表的两头进行；   </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>ElementType Data<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token operator">*</span> Next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">QNode</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 链队列结构 */</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token operator">*</span> rear<span class="token punctuation">;</span> <span class="token comment">/* 指向队尾结点 */</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token operator">*</span> front<span class="token punctuation">;</span> <span class="token comment">/* 指向队头结点 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">QNode</span><span class="token operator">*</span> Queue<span class="token punctuation">;</span>Queue PtrQ<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="不带头结点的链式队列出队操作的一个示例："><a href="#不带头结点的链式队列出队操作的一个示例：" class="headerlink" title="不带头结点的链式队列出队操作的一个示例："></a>不带头结点的链式队列出队操作的一个示例：</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">ElementType <span class="token function">DeleteQ</span><span class="token punctuation">(</span>Queue PtrQ<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token operator">*</span> FrontCell<span class="token punctuation">;</span>ElementType FrontElem<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrQ<span class="token operator">-></span>front <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“队列空”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> ERROR<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>FrontCell <span class="token operator">=</span> PtrQ<span class="token operator">-></span>front<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>PtrQ<span class="token operator">-></span>front <span class="token operator">==</span> PtrQ<span class="token operator">-></span>rear<span class="token punctuation">)</span> <span class="token comment">/* 若队列只有一个元素 */</span>PtrQ<span class="token operator">-></span>front <span class="token operator">=</span> PtrQ<span class="token operator">-></span>rear <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">/* 删除后队列置为空 */</span><span class="token keyword">else</span>PtrQ<span class="token operator">-></span>front <span class="token operator">=</span> PtrQ<span class="token operator">-></span>front<span class="token operator">-></span>Next<span class="token punctuation">;</span>FrontElem <span class="token operator">=</span> FrontCell<span class="token operator">-></span>Data<span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span>FrontCell<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 释放被删除结点空间 */</span><span class="token keyword">return</span> FrontElem<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-4-应用-多项式加法运算"><a href="#2-4-应用-多项式加法运算" class="headerlink" title="2.4 应用: 多项式加法运算"></a>2.4 应用: 多项式加法运算</h2><p>主要思路：相同指数的项系数相加，其余部分进行拷贝。  </p><h3 id="多项式加法运算"><a href="#多项式加法运算" class="headerlink" title="多项式加法运算"></a>多项式加法运算</h3><p>采用不带头结点的单向链表， 按照指数递减的顺序排列各项  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">PolyNode</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> coef<span class="token punctuation">;</span> <span class="token comment">// 系数</span><span class="token keyword">int</span> expon<span class="token punctuation">;</span> <span class="token comment">// 指数</span><span class="token keyword">struct</span> <span class="token class-name">PolyNode</span><span class="token operator">*</span> link<span class="token punctuation">;</span> <span class="token comment">// 指向下一个节点的指针</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">PolyNode</span><span class="token operator">*</span> Polynomial<span class="token punctuation">;</span>Polynomial P1<span class="token punctuation">,</span> P2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>算法思路</strong>： 两个指针P1和P2分别指向这两个多项式第一个结点， 不断循环：</p><ul><li>P1-&gt;expon == P2-&gt;expon: 系数相加，若结果不为0，则作为结果多项式对应项的系数。 同时， P1和P2都分别指向下一项；</li><li>P1-&gt;expon &gt; P2-&gt;expon: 将P1的当前项存入结果多项式，并使P1指向下一项；</li><li>P1-&gt;expon &lt; P2-&gt;expon: 将P2的当前项存入结果多项式，并使P2指向下一项；</li></ul><p>当某一多项式处理完时，将另一个多项式的所有结点依次复制到结果多项式中去。  </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Polynomial <span class="token function">PolyAdd</span><span class="token punctuation">(</span>Polynomial P1<span class="token punctuation">,</span> Polynomial P2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Polynomial front<span class="token punctuation">,</span> rear<span class="token punctuation">,</span> temp<span class="token punctuation">;</span><span class="token keyword">int</span> sum<span class="token punctuation">;</span>rear <span class="token operator">=</span> <span class="token punctuation">(</span>Polynomial<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">PolyNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//为方便表头插入，先产生一个临时空结点作为结果多项式链表头</span>front <span class="token operator">=</span> rear<span class="token punctuation">;</span> <span class="token comment">/* 由front 记录结果多项式链表头结点 */</span><span class="token keyword">while</span> <span class="token punctuation">(</span>P1 <span class="token operator">&amp;&amp;</span> P2<span class="token punctuation">)</span> <span class="token comment">/* 当两个多项式都有非零项待处理时 */</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">Compare</span><span class="token punctuation">(</span>P1<span class="token operator">-></span>expon<span class="token punctuation">,</span> P2<span class="token operator">-></span>expon<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token comment">//P1中的数据项指数较大</span><span class="token function">Attach</span><span class="token punctuation">(</span>P1<span class="token operator">-></span>coef<span class="token punctuation">,</span> P1<span class="token operator">-></span>expon<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span>P1 <span class="token operator">=</span> P1<span class="token operator">-></span>link<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span> <span class="token comment">//P2中的数据项指数较大</span><span class="token function">Attach</span><span class="token punctuation">(</span>P2<span class="token operator">-></span>coef<span class="token punctuation">,</span> P2<span class="token operator">-></span>expon<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span>P2 <span class="token operator">=</span> P2<span class="token operator">-></span>link<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token comment">//两数据项指数相等</span>sum <span class="token operator">=</span> P1<span class="token operator">-></span>coef <span class="token operator">+</span> P2<span class="token operator">-></span>coef<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>sum<span class="token punctuation">)</span> <span class="token function">Attach</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> P1<span class="token operator">-></span>expon<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//注意判断系数和是否为0</span>P1 <span class="token operator">=</span> P1<span class="token operator">-></span>link<span class="token punctuation">;</span>P2 <span class="token operator">=</span> P2<span class="token operator">-></span>link<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 将未处理完的另一个多项式的所有节点依次复制到结果多项式中去 */</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> P1<span class="token punctuation">;</span> P1 <span class="token operator">=</span> P1<span class="token operator">-></span>link<span class="token punctuation">)</span> <span class="token function">Attach</span><span class="token punctuation">(</span>P1<span class="token operator">-></span>coef<span class="token punctuation">,</span> P1<span class="token operator">-></span>expon<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> P2<span class="token punctuation">;</span> P2 <span class="token operator">=</span> P2<span class="token operator">-></span>link<span class="token punctuation">)</span> <span class="token function">Attach</span><span class="token punctuation">(</span>P2<span class="token operator">-></span>coef<span class="token punctuation">,</span> P2<span class="token operator">-></span>expon<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rear<span class="token punctuation">)</span><span class="token punctuation">;</span>rear<span class="token operator">-></span>link <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>temp <span class="token operator">=</span> front<span class="token punctuation">;</span>front <span class="token operator">=</span> front<span class="token operator">-></span>link<span class="token punctuation">;</span> <span class="token comment">/*令front指向结果多项式第一个非零项 */</span><span class="token function">free</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 释放临时空表头结点 */</span><span class="token keyword">return</span> front<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">,</span> <span class="token keyword">int</span> e<span class="token punctuation">,</span> Polynomial<span class="token operator">*</span> pRear<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* 由于在本函数中需要改变当前结果表达式尾项指针的值， */</span><span class="token comment">/* 所以函数传递进来的是结点指针的地址， *pRear指向尾项*/</span>Polynomial P<span class="token punctuation">;</span>P <span class="token operator">=</span> <span class="token punctuation">(</span>Polynomial<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">PolyNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 申请新结点 */</span>P<span class="token operator">-></span>coef <span class="token operator">=</span> c<span class="token punctuation">;</span> <span class="token comment">/* 对新结点赋值 */</span>P<span class="token operator">-></span>expon <span class="token operator">=</span> e<span class="token punctuation">;</span>P<span class="token operator">-></span>link <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token comment">/* 将P指向的新结点插入到当前结果表达式尾项的后面 */</span><span class="token punctuation">(</span><span class="token operator">*</span>pRear<span class="token punctuation">)</span><span class="token operator">-></span>link <span class="token operator">=</span> P<span class="token punctuation">;</span><span class="token operator">*</span>pRear <span class="token operator">=</span> P<span class="token punctuation">;</span> <span class="token comment">/* 修改pRear值 */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="代码模板"><a href="#代码模板" class="headerlink" title="代码模板"></a>代码模板</h2><h3 id="线性表数组实现"><a href="#线性表数组实现" class="headerlink" title="线性表数组实现"></a>线性表数组实现</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#define MAXSIZE 1000typedef int ElementType;typedef int Position;typedef struct LNode *List;struct LNode &#123;    ElementType Data[MAXSIZE];    Position Last;&#125;;&#x2F;* 初始化 *&#x2F;List MakeEmpty() &#123;    List L;    L &#x3D; (List)malloc(sizeof(struct LNode));    L-&gt;Last &#x3D; -1;    return L;&#125;&#x2F;* 查找 *&#x2F;#define ERROR -1Position Find(List L, ElementType X) &#123;    Position i &#x3D; 0;    while (i &lt;&#x3D; L-&gt;Last &amp;&amp; L-&gt;Data[i] !&#x3D; X) i++;    if (i &gt; L-&gt;Last)        return ERROR; &#x2F;* 如果没找到，返回错误信息 *&#x2F;    else        return i; &#x2F;* 找到后返回的是存储位置 *&#x2F;&#125;&#x2F;* 插入 *&#x2F;&#x2F;*注意:在插入位置参数P上与课程视频有所不同，课程视频中i是序列位序（从1开始），这里P是存储下标位置（从0开始），两者差1*&#x2F;bool Insert(List L, ElementType X, Position P) &#123;    &#x2F;* 在L的指定位置P前插入一个新元素X *&#x2F;    Position i;    if (L-&gt;Last &#x3D;&#x3D; MAXSIZE - 1) &#123;        &#x2F;* 表空间已满，不能插入 *&#x2F;        printf(&quot;表满&quot;);        return false;    &#125;    if (P &lt; 0 || P &gt; L-&gt;Last + 1) &#123; &#x2F;* 检查插入位置的合法性 *&#x2F;        printf(&quot;位置不合法&quot;);        return false;    &#125;    for (i &#x3D; L-&gt;Last; i &gt;&#x3D; P; i--)        L-&gt;Data[i + 1] &#x3D; L-&gt;Data[i]; &#x2F;* 将位置P及以后的元素顺序向后移动 *&#x2F;    L-&gt;Data[P] &#x3D; X;                  &#x2F;* 新元素插入 *&#x2F;    L-&gt;Last++;                       &#x2F;* Last仍指向最后元素 *&#x2F;    return true;&#125;&#x2F;* 删除 *&#x2F;&#x2F;*注意:在删除位置参数P上与课程视频有所不同，课程视频中i是序列位序（从1开始），这里P是存储下标位置（从0开始），两者差1*&#x2F;bool Delete(List L, Position P) &#123; &#x2F;* 从L中删除指定位置P的元素 *&#x2F;    Position i;    if (P &lt; 0 || P &gt; L-&gt;Last) &#123; &#x2F;* 检查空表及删除位置的合法性 *&#x2F;        printf(&quot;位置%d不存在元素&quot;, P);        return false;    &#125;    for (i &#x3D; P + 1; i &lt;&#x3D; L-&gt;Last; i++)        L-&gt;Data[i - 1] &#x3D; L-&gt;Data[i]; &#x2F;* 将位置P+1及以后的元素顺序向前移动 *&#x2F;    L-&gt;Last--;                       &#x2F;* Last仍指向最后元素 *&#x2F;    return true;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="表的链式结构实现"><a href="#表的链式结构实现" class="headerlink" title="表的链式结构实现"></a>表的链式结构实现</h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">typedef int ElementType;typedef struct LNode *PtrToLNode;struct LNode &#123;    ElementType Data;    PtrToLNode Next;&#125;;typedef PtrToLNode Position;typedef PtrToLNode List;&#x2F;* 查找 *&#x2F;#define ERROR NULLPosition Find(List L, ElementType X) &#123;    Position p &#x3D; L; &#x2F;* p指向L的第1个结点 *&#x2F;    while (p &amp;&amp; p-&gt;Data !&#x3D; X) p &#x3D; p-&gt;Next;    &#x2F;* 下列语句可以用 return p; 替换 *&#x2F;    if (p)        return p;    else        return ERROR;&#125;&#x2F;* 带头结点的插入 *&#x2F;&#x2F;*注意:在插入位置参数P上与课程视频有所不同，课程视频中i是序列位序（从1开始），这里P是链表结点指针，在P之前插入新结点 *&#x2F;bool Insert(List L, ElementType X, Position P) &#123; &#x2F;* 这里默认L有头结点 *&#x2F;    Position tmp, pre;    &#x2F;* 查找P的前一个结点 *&#x2F;    for (pre &#x3D; L; pre &amp;&amp; pre-&gt;Next !&#x3D; P; pre &#x3D; pre-&gt;Next)        ;    if (pre &#x3D;&#x3D; NULL) &#123; &#x2F;* P所指的结点不在L中 *&#x2F;        printf(&quot;插入位置参数错误\n&quot;);        return false;    &#125; else &#123; &#x2F;* 找到了P的前一个结点pre *&#x2F;        &#x2F;* 在P前插入新结点 *&#x2F;        tmp &#x3D; (Position)malloc(sizeof(struct LNode)); &#x2F;* 申请、填装结点 *&#x2F;        tmp-&gt;Data &#x3D; X;        tmp-&gt;Next &#x3D; P;        pre-&gt;Next &#x3D; tmp;        return true;    &#125;&#125;&#x2F;* 带头结点的删除 *&#x2F;&#x2F;*注意:在删除位置参数P上与课程视频有所不同，课程视频中i是序列位序（从1开始），这里P是拟删除结点指针 *&#x2F;bool Delete(List L, Position P) &#123; &#x2F;* 这里默认L有头结点 *&#x2F;    Position pre;    &#x2F;* 查找P的前一个结点 *&#x2F;    for (pre &#x3D; L; pre &amp;&amp; pre-&gt;Next !&#x3D; P; pre &#x3D; pre-&gt;Next)        ;    if (pre &#x3D;&#x3D; NULL || P &#x3D;&#x3D; NULL) &#123; &#x2F;* P所指的结点不在L中 *&#x2F;        printf(&quot;删除位置参数错误\n&quot;);        return false;    &#125; else &#123; &#x2F;* 找到了P的前一个结点pre *&#x2F;        &#x2F;* 将P位置的结点删除 *&#x2F;        pre-&gt;Next &#x3D; P-&gt;Next;        free(P);        return true;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="堆栈数组实现"><a href="#堆栈数组实现" class="headerlink" title="堆栈数组实现"></a>堆栈数组实现</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#define MAXSIZE 1000#define ERROR -1typedef int ElementType;typedef int Position;struct SNode &#123;    ElementType *Data; &#x2F;* 存储元素的数组 *&#x2F;    Position Top;      &#x2F;* 栈顶指针 *&#x2F;    int MaxSize;       &#x2F;* 堆栈最大容量 *&#x2F;&#125;;typedef struct SNode *Stack;Stack CreateStack(int MaxSize) &#123;    Stack S &#x3D; (Stack)malloc(sizeof(struct SNode));    S-&gt;Data &#x3D; (ElementType *)malloc(MaxSize * sizeof(ElementType));    S-&gt;Top &#x3D; -1;    S-&gt;MaxSize &#x3D; MaxSize;    return S;&#125;bool IsFull(Stack S) &#123;    return (S-&gt;Top &#x3D;&#x3D; S-&gt;MaxSize - 1);&#125;bool Push(Stack S, ElementType X) &#123;    if (IsFull(S)) &#123;        printf(&quot;堆栈满&quot;);        return false;    &#125; else &#123;        S-&gt;Data[++(S-&gt;Top)] &#x3D; X;        return true;    &#125;&#125;bool IsEmpty(Stack S) &#123;    return (S-&gt;Top &#x3D;&#x3D; -1);&#125;ElementType Pop(Stack S) &#123;    if (IsEmpty(S)) &#123;        printf(&quot;堆栈空&quot;);        return ERROR; &#x2F;* ERROR是ElementType的特殊值，标志错误 *&#x2F;    &#125; else        return (S-&gt;Data[(S-&gt;Top)--]);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="堆栈链式实现"><a href="#堆栈链式实现" class="headerlink" title="堆栈链式实现"></a>堆栈链式实现</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#define ERROR NULLtypedef int ElementType;typedef struct SNode *PtrToSNode;struct SNode &#123;    ElementType Data;    PtrToSNode Next;&#125;;typedef PtrToSNode Stack;Stack CreateStack() &#123; &#x2F;* 构建一个堆栈的头结点，返回该结点指针 *&#x2F;    Stack S;    S &#x3D; (Stack)malloc(sizeof(struct SNode));    S-&gt;Next &#x3D; NULL;    return S;&#125;bool IsEmpty(Stack S) &#123; &#x2F;* 判断堆栈S是否为空，若是返回true；否则返回false *&#x2F;    return (S-&gt;Next &#x3D;&#x3D; NULL);&#125;bool Push(Stack S, ElementType X) &#123; &#x2F;* 将元素X压入堆栈S *&#x2F;    PtrToSNode TmpCell;    TmpCell &#x3D; (PtrToSNode)malloc(sizeof(struct SNode));    TmpCell-&gt;Data &#x3D; X;    TmpCell-&gt;Next &#x3D; S-&gt;Next;    S-&gt;Next &#x3D; TmpCell;    return true;&#125;ElementType Pop(Stack S) &#123; &#x2F;* 删除并返回堆栈S的栈顶元素 *&#x2F;    PtrToSNode FirstCell;    ElementType TopElem;    if (IsEmpty(S)) &#123;        printf(&quot;堆栈空&quot;);        return ERROR;    &#125; else &#123;        FirstCell &#x3D; S-&gt;Next;        TopElem &#x3D; FirstCell-&gt;Data;        S-&gt;Next &#x3D; FirstCell-&gt;Next;        free(FirstCell);        return TopElem;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="队列数组实现"><a href="#队列数组实现" class="headerlink" title="队列数组实现"></a>队列数组实现</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#define MAXSIZE 1000#define ERROR -1typedef int ElementType;typedef int Position;struct QNode &#123;    ElementType *Data;    &#x2F;* 存储元素的数组 *&#x2F;    Position Front, Rear; &#x2F;* 队列的头、尾指针 *&#x2F;    int MaxSize;          &#x2F;* 队列最大容量 *&#x2F;&#125;;typedef struct QNode *Queue;Queue CreateQueue(int MaxSize) &#123;    Queue Q &#x3D; (Queue)malloc(sizeof(struct QNode));    Q-&gt;Data &#x3D; (ElementType *)malloc(MaxSize * sizeof(ElementType));    Q-&gt;Front &#x3D; Q-&gt;Rear &#x3D; 0;    Q-&gt;MaxSize &#x3D; MaxSize;    return Q;&#125;bool IsFull(Queue Q) &#123;    return ((Q-&gt;Rear + 1) % Q-&gt;MaxSize &#x3D;&#x3D; Q-&gt;Front);&#125;bool AddQ(Queue Q, ElementType X) &#123;    if (IsFull(Q)) &#123;        printf(&quot;队列满&quot;);        return false;    &#125; else &#123;        Q-&gt;Rear &#x3D; (Q-&gt;Rear + 1) % Q-&gt;MaxSize;        Q-&gt;Data[Q-&gt;Rear] &#x3D; X;        return true;    &#125;&#125;bool IsEmpty(Queue Q) &#123;    return (Q-&gt;Front &#x3D;&#x3D; Q-&gt;Rear);&#125;ElementType DeleteQ(Queue Q) &#123;    if (IsEmpty(Q)) &#123;        printf(&quot;队列空&quot;);        return ERROR;    &#125; else &#123;        Q-&gt;Front &#x3D; (Q-&gt;Front + 1) % Q-&gt;MaxSize;        return Q-&gt;Data[Q-&gt;Front];    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="队列链式实现"><a href="#队列链式实现" class="headerlink" title="队列链式实现"></a>队列链式实现</h3><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#define ERROR NULLtypedef int ElementType;typedef struct Node *PtrToNode;struct Node &#123; &#x2F;* 队列中的结点 *&#x2F;    ElementType Data;    PtrToNode Next;&#125;;typedef PtrToNode Position;struct QNode &#123;    Position Front, Rear; &#x2F;* 队列的头、尾指针 *&#x2F;    int MaxSize;          &#x2F;* 队列最大容量 *&#x2F;&#125;;typedef struct QNode *Queue;bool IsEmpty(Queue Q) &#123;    return (Q-&gt;Front &#x3D;&#x3D; NULL);&#125;ElementType DeleteQ(Queue Q) &#123;    Position FrontCell;    ElementType FrontElem;    if (IsEmpty(Q)) &#123;        printf(&quot;队列空&quot;);        return ERROR;    &#125; else &#123;        FrontCell &#x3D; Q-&gt;Front;        if (Q-&gt;Front &#x3D;&#x3D; Q-&gt;Rear)       &#x2F;* 若队列只有一个元素 *&#x2F;            Q-&gt;Front &#x3D; Q-&gt;Rear &#x3D; NULL; &#x2F;* 删除后队列置为空 *&#x2F;        else            Q-&gt;Front &#x3D; Q-&gt;Front-&gt;Next;        FrontElem &#x3D; FrontCell-&gt;Data;        free(FrontCell); &#x2F;* 释放被删除结点空间  *&#x2F;        return FrontElem;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-两个有序链表序列的合并"><a href="#1-两个有序链表序列的合并" class="headerlink" title="1.两个有序链表序列的合并"></a><a href="https://pintia.cn/problem-sets/434/problems/5803">1.两个有序链表序列的合并</a></h3><p>本题要求实现一个函数，将两个链表表示的递增整数序列合并为一个非递减的整数序列。</p><h4 id="函数接口定义："><a href="#函数接口定义：" class="headerlink" title="函数接口定义："></a>函数接口定义：</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">List Merge( List L1, List L2 );<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>其中<code>List</code>结构定义如下：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">typedef struct Node *PtrToNode;struct Node &#123;    ElementType Data; &#x2F;* 存储结点数据 *&#x2F;    PtrToNode   Next; &#x2F;* 指向下一个结点的指针 *&#x2F;&#125;;typedef PtrToNode List; &#x2F;* 定义单链表类型 *&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>L1</code>和<code>L2</code>是给定的带头结点的单链表，其结点存储的数据是递增有序的；函数<code>Merge</code>要将<code>L1</code>和<code>L2</code>合并为一个非递减的整数序列。应直接使用原序列中的结点，返回归并后的带头结点的链表头指针。</p><h4 id="裁判测试程序样例："><a href="#裁判测试程序样例：" class="headerlink" title="裁判测试程序样例："></a>裁判测试程序样例：</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;typedef int ElementType;typedef struct Node *PtrToNode;struct Node &#123;    ElementType Data;    PtrToNode   Next;&#125;;typedef PtrToNode List;List Read(); &#x2F;* 细节在此不表 *&#x2F;void Print( List L ); &#x2F;* 细节在此不表；空链表将输出NULL *&#x2F;List Merge( List L1, List L2 );int main()&#123;    List L1, L2, L;    L1 &#x3D; Read();    L2 &#x3D; Read();    L &#x3D; Merge(L1, L2);    Print(L);    Print(L1);    Print(L2);    return 0;&#125;&#x2F;* 你的代码将被嵌在这里 *&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输入样例："><a href="#输入样例：" class="headerlink" title="输入样例："></a>输入样例：</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">31 3 552 4 6 8 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出样例："><a href="#输出样例：" class="headerlink" title="输出样例："></a>输出样例：</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">1 2 3 4 5 6 8 10 NULLNULL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>类似多项式加法，注意直接用原来L1和L2中节点，同时此题链表是带头结点的，小心空链表情形。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">List <span class="token function">Merge</span><span class="token punctuation">(</span>List L1<span class="token punctuation">,</span> List L2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    List head <span class="token operator">=</span> <span class="token punctuation">(</span>List<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List old <span class="token operator">=</span> head<span class="token punctuation">,</span> Ptr1 <span class="token operator">=</span> L1<span class="token operator">-></span>Next<span class="token punctuation">,</span> Ptr2 <span class="token operator">=</span> L2<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>Ptr1 <span class="token operator">&amp;&amp;</span> Ptr2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Ptr1<span class="token operator">-></span>Data <span class="token operator">&lt;</span> Ptr2<span class="token operator">-></span>Data<span class="token punctuation">)</span>            old<span class="token operator">-></span>Next <span class="token operator">=</span> Ptr1<span class="token punctuation">,</span> Ptr1 <span class="token operator">=</span> Ptr1<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token keyword">else</span>            old<span class="token operator">-></span>Next <span class="token operator">=</span> Ptr2<span class="token punctuation">,</span> Ptr2 <span class="token operator">=</span> Ptr2<span class="token operator">-></span>Next<span class="token punctuation">;</span>        old <span class="token operator">=</span> old<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>Ptr1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        old<span class="token operator">-></span>Next <span class="token operator">=</span> Ptr1<span class="token punctuation">;</span>        Ptr1 <span class="token operator">=</span> Ptr1<span class="token operator">-></span>Next<span class="token punctuation">;</span>        old <span class="token operator">=</span> old<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>Ptr2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        old<span class="token operator">-></span>Next <span class="token operator">=</span> Ptr2<span class="token punctuation">;</span>        Ptr2 <span class="token operator">=</span> Ptr2<span class="token operator">-></span>Next<span class="token punctuation">;</span>        old <span class="token operator">=</span> old<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    old<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    L1<span class="token operator">-></span>Next <span class="token operator">=</span> L2<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> head<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>同sample，交错归并</td><td>答案正确</td><td>9</td><td>3 ms</td><td>184 KB</td></tr><tr><td>1</td><td>两个完全一样的链表</td><td>答案正确</td><td>2</td><td>4 ms</td><td>176 KB</td></tr><tr><td>2</td><td>两个空链表</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr><tr><td>3</td><td>L2完全贴在L1后面</td><td>答案正确</td><td>1</td><td>3 ms</td><td>176 KB</td></tr><tr><td>4</td><td>L1完全贴在L2后面</td><td>答案正确</td><td>1</td><td>3 ms</td><td>180 KB</td></tr></tbody></table><h3 id="2-一元多项式的乘法与加法运算"><a href="#2-一元多项式的乘法与加法运算" class="headerlink" title="2.一元多项式的乘法与加法运算"></a><a href="https://pintia.cn/problem-sets/434/problems/5865">2.一元多项式的乘法与加法运算</a></h3><p>设计函数分别求两个一元多项式的乘积与和。</p><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入分2行，每行分别先给出多项式非零项的个数，再以指数递降方式输入一个多项式非零项系数和指数（绝对值均为不超过1000的整数）。数字间以空格分隔。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>输出分2行，分别以指数递降方式输出乘积多项式以及和多项式非零项的系数和指数。数字间以空格分隔，但结尾不能有多余空格。零多项式应输出<code>0 0</code>。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">4 3 4 -5 2  6 1  -2 03 5 20  -7 4  3 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">15 24 -25 22 30 21 -10 20 -21 8 35 6 -33 5 14 4 -15 3 18 2 -6 15 20 -4 4 -5 2 9 1 -2 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>考虑利用链式结构，多项式加法如前，不赘述。</p><p>读入多项式时要注意要不要带头结点，注意零多项式。</p><p>相乘有两种方法，一是将乘法运算转化为加法运算，二是逐项插入。这里考虑逐项插入。</p><p>输出时注意格式，不要有多余的空格。</p><p>free是一个好习惯！</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Poly</span> <span class="token operator">*</span>Polynomial<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Poly</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> Coefficient<span class="token punctuation">;</span>    <span class="token keyword">int</span> Exponent<span class="token punctuation">;</span>    Polynomial Next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// Insert在rear后面插入，并将rear指向新插入的，因此传rear地址。</span><span class="token keyword">void</span> <span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> coe<span class="token punctuation">,</span> <span class="token keyword">int</span> exp<span class="token punctuation">,</span> Polynomial <span class="token operator">*</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Polynomial Tmp<span class="token punctuation">;</span>    Tmp <span class="token operator">=</span> <span class="token punctuation">(</span>Polynomial<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Poly</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Tmp<span class="token operator">-></span>Coefficient <span class="token operator">=</span> coe<span class="token punctuation">;</span>    Tmp<span class="token operator">-></span>Exponent <span class="token operator">=</span> exp<span class="token punctuation">;</span>    Tmp<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>P<span class="token punctuation">)</span><span class="token operator">-></span>Next<span class="token punctuation">;</span> <span class="token comment">//实际上是NULL</span>    <span class="token punctuation">(</span><span class="token operator">*</span>P<span class="token punctuation">)</span><span class="token operator">-></span>Next <span class="token operator">=</span> Tmp<span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token operator">*</span>P<span class="token punctuation">)</span> <span class="token operator">=</span> Tmp<span class="token punctuation">;</span> <span class="token comment">// rear指向最后一项多项式</span><span class="token punctuation">&#125;</span>Polynomial <span class="token function">ReadPoly</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> N<span class="token punctuation">,</span> coe<span class="token punctuation">,</span> exp<span class="token punctuation">;</span>    Polynomial P<span class="token punctuation">,</span> Rear<span class="token punctuation">,</span> Tmp<span class="token punctuation">;</span>    P <span class="token operator">=</span> <span class="token punctuation">(</span>Polynomial<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Poly</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    P<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    Rear <span class="token operator">=</span> P<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>N<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>coe<span class="token punctuation">,</span> <span class="token operator">&amp;</span>exp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>coe<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    Tmp <span class="token operator">=</span> P<span class="token punctuation">;</span>    P <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> P<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Polynomial <span class="token function">SumPolynomial</span><span class="token punctuation">(</span>Polynomial <span class="token keyword">const</span> Poly1<span class="token punctuation">,</span> Polynomial <span class="token keyword">const</span> Poly2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Polynomial PolySum<span class="token punctuation">,</span> Rear<span class="token punctuation">,</span> Tmp<span class="token punctuation">,</span> P1<span class="token punctuation">,</span> P2<span class="token punctuation">;</span>    PolySum <span class="token operator">=</span> <span class="token punctuation">(</span>Polynomial<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Poly</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    PolySum<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    Rear <span class="token operator">=</span> PolySum<span class="token punctuation">;</span>    P1 <span class="token operator">=</span> Poly1<span class="token punctuation">;</span>    P2 <span class="token operator">=</span> Poly2<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P1 <span class="token operator">&amp;&amp;</span> P2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//有一个加完了就结束</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>P1<span class="token operator">-></span>Exponent <span class="token operator">></span> P2<span class="token operator">-></span>Exponent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Insert</span><span class="token punctuation">(</span>P1<span class="token operator">-></span>Coefficient<span class="token punctuation">,</span> P1<span class="token operator">-></span>Exponent<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>            P1 <span class="token operator">=</span> P1<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>P1<span class="token operator">-></span>Exponent <span class="token operator">&lt;</span> P2<span class="token operator">-></span>Exponent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Insert</span><span class="token punctuation">(</span>P2<span class="token operator">-></span>Coefficient<span class="token punctuation">,</span> P2<span class="token operator">-></span>Exponent<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>            P2 <span class="token operator">=</span> P2<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> sum <span class="token operator">=</span> P1<span class="token operator">-></span>Coefficient <span class="token operator">+</span> P2<span class="token operator">-></span>Coefficient<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>sum<span class="token punctuation">)</span>                <span class="token function">Insert</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> P1<span class="token operator">-></span>Exponent<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>            P1 <span class="token operator">=</span> P1<span class="token operator">-></span>Next<span class="token punctuation">;</span>            P2 <span class="token operator">=</span> P2<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> P1<span class="token punctuation">;</span> P1 <span class="token operator">=</span> P1<span class="token operator">-></span>Next<span class="token punctuation">)</span> <span class="token comment">//剩下的直接加</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>P1<span class="token operator">-></span>Coefficient<span class="token punctuation">,</span> P1<span class="token operator">-></span>Exponent<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> P2<span class="token punctuation">;</span> P2 <span class="token operator">=</span> P2<span class="token operator">-></span>Next<span class="token punctuation">)</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>P2<span class="token operator">-></span>Coefficient<span class="token punctuation">,</span> P2<span class="token operator">-></span>Exponent<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>    Tmp <span class="token operator">=</span> PolySum<span class="token punctuation">;</span>    PolySum <span class="token operator">=</span> PolySum<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//临时头结点释放</span>    <span class="token keyword">return</span> PolySum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Polynomial <span class="token function">MultPolynomial</span><span class="token punctuation">(</span>Polynomial <span class="token keyword">const</span> Poly1<span class="token punctuation">,</span> Polynomial <span class="token keyword">const</span> Poly2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Polynomial PolyMult<span class="token punctuation">,</span> Rear<span class="token punctuation">,</span> Tmp<span class="token punctuation">,</span> P1<span class="token punctuation">,</span> P2<span class="token punctuation">;</span>    <span class="token keyword">int</span> coe<span class="token punctuation">,</span> exp<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Poly1 <span class="token operator">||</span> <span class="token operator">!</span>Poly2<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    PolyMult <span class="token operator">=</span> <span class="token punctuation">(</span>Polynomial<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Poly</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    PolyMult<span class="token operator">-></span>Next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    Rear <span class="token operator">=</span> PolyMult<span class="token punctuation">;</span>    P1 <span class="token operator">=</span> Poly1<span class="token punctuation">;</span>    P2 <span class="token operator">=</span> Poly2<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// P1最高项和P2相乘得到一个多项式</span>        <span class="token function">Insert</span><span class="token punctuation">(</span>P1<span class="token operator">-></span>Coefficient <span class="token operator">*</span> P2<span class="token operator">-></span>Coefficient<span class="token punctuation">,</span> P1<span class="token operator">-></span>Exponent <span class="token operator">+</span> P2<span class="token operator">-></span>Exponent<span class="token punctuation">,</span>               <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>        P2 <span class="token operator">=</span> P2<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    P1 <span class="token operator">=</span> P1<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//逐项插入</span>        P2 <span class="token operator">=</span> Poly2<span class="token punctuation">;</span>        Rear <span class="token operator">=</span> PolyMult<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>P2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            coe <span class="token operator">=</span> P1<span class="token operator">-></span>Coefficient <span class="token operator">*</span> P2<span class="token operator">-></span>Coefficient<span class="token punctuation">;</span>            exp <span class="token operator">=</span> P1<span class="token operator">-></span>Exponent <span class="token operator">+</span> P2<span class="token operator">-></span>Exponent<span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>Rear<span class="token operator">-></span>Next <span class="token operator">&amp;&amp;</span> Rear<span class="token operator">-></span>Next<span class="token operator">-></span>Exponent <span class="token operator">></span> exp<span class="token punctuation">)</span>                Rear <span class="token operator">=</span> Rear<span class="token operator">-></span>Next<span class="token punctuation">;</span> <span class="token comment">//找到该插入的位置,rear指向前一位置</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Rear<span class="token operator">-></span>Next <span class="token operator">&amp;&amp;</span> Rear<span class="token operator">-></span>Next<span class="token operator">-></span>Exponent <span class="token operator">==</span> exp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>Rear<span class="token operator">-></span>Next<span class="token operator">-></span>Coefficient <span class="token operator">+</span> coe<span class="token punctuation">)</span> <span class="token comment">//系数不为0</span>                    Rear<span class="token operator">-></span>Next<span class="token operator">-></span>Coefficient <span class="token operator">+=</span> coe<span class="token punctuation">;</span>                <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">//系数为0删除这一项</span>                    Tmp <span class="token operator">=</span> Rear<span class="token operator">-></span>Next<span class="token punctuation">;</span>                    Rear<span class="token operator">-></span>Next <span class="token operator">=</span> Tmp<span class="token operator">-></span>Next<span class="token punctuation">;</span>                    <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token function">Insert</span><span class="token punctuation">(</span>coe<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Rear<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            P2 <span class="token operator">=</span> P2<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        P1 <span class="token operator">=</span> P1<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    Tmp <span class="token operator">=</span> PolyMult<span class="token punctuation">;</span>    PolyMult <span class="token operator">=</span> PolyMult<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//删除临时头结点</span>    <span class="token keyword">return</span> PolyMult<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">PrintPoly</span><span class="token punctuation">(</span>Polynomial P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"0 0\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span>            flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//非开头打印空格</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> P<span class="token operator">-></span>Coefficient<span class="token punctuation">,</span> P<span class="token operator">-></span>Exponent<span class="token punctuation">)</span><span class="token punctuation">;</span>        P <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">DisposePoly</span><span class="token punctuation">(</span>Polynomial P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Polynomial Tmp<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Tmp <span class="token operator">=</span> P<span class="token punctuation">;</span>        P <span class="token operator">=</span> P<span class="token operator">-></span>Next<span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>Tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Polynomial P1<span class="token punctuation">,</span> P2<span class="token punctuation">,</span> PS<span class="token punctuation">,</span> PM<span class="token punctuation">;</span>    P1 <span class="token operator">=</span> <span class="token function">ReadPoly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    P2 <span class="token operator">=</span> <span class="token function">ReadPoly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    PM <span class="token operator">=</span> <span class="token function">MultPolynomial</span><span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">PrintPoly</span><span class="token punctuation">(</span>PM<span class="token punctuation">)</span><span class="token punctuation">;</span>    PS <span class="token operator">=</span> <span class="token function">SumPolynomial</span><span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">PrintPoly</span><span class="token punctuation">(</span>PS<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">DisposePoly</span><span class="token punctuation">(</span>PS<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">DisposePoly</span><span class="token punctuation">(</span>PM<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">DisposePoly</span><span class="token punctuation">(</span>P1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">DisposePoly</span><span class="token punctuation">(</span>P2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample换个数字</td><td>答案正确</td><td>12</td><td>3 ms</td><td>168 KB</td></tr><tr><td>1</td><td>同类项合并时有抵消</td><td>答案正确</td><td>4</td><td>3 ms</td><td>304 KB</td></tr><tr><td>2</td><td>系数和指数取上限，结果有零多项式</td><td>答案正确</td><td>2</td><td>3 ms</td><td>320 KB</td></tr><tr><td>3</td><td>输入有零多项式和常数多项式</td><td>答案正确</td><td>2</td><td>3 ms</td><td>188 KB</td></tr></tbody></table><h3 id="3-Reverse-Linked-List"><a href="#3-Reverse-Linked-List" class="headerlink" title="3.Reverse Linked List"></a><a href="https://pintia.cn/problem-sets/16/problems/664">3.Reverse Linked List</a></h3><p>根据某大公司笔试题改编的2014年春季PAT真题</p><p>Given a constant <em>K</em> and a singly linked list <em>L</em>, you are supposed to reverse the links of every <em>K</em> elements on <em>L</em>. For example, given <em>L</em> being 1→2→3→4→5→6, if <em>K</em>=3, then you must output 3→2→1→6→5→4; if <em>K</em>=4, you must output 4→3→2→1→5→6.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains the address of the first node, a positive <em>N</em> (≤105) which is the total number of nodes, and a positive <em>K</em> (≤<em>N</em>) which is the length of the sublist to be reversed. The address of a node is a 5-digit nonnegative integer, and NULL is represented by -1.</p><p>Then <em>N</em> lines follow, each describes a node in the format:</p><pre class="line-numbers language-none"><code class="language-none">Address Data Next<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>where <code>Address</code> is the position of the node, <code>Data</code> is an integer, and <code>Next</code> is the position of the next node.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each case, output the resulting ordered linked list. Each node occupies a line, and is printed in the same format as in the input.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">00100 6 400000 4 9999900100 1 1230968237 6 -133218 3 0000099999 5 6823712309 2 33218<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">00000 4 3321833218 3 1230912309 2 0010000100 1 9999999999 5 6823768237 6 -1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>这里考虑利用三个数组，先记录下Address、Data、Next，然后将其转化为顺序表存储，再利用数组可以直接方便地逆转。</p><p>特别地，以下还给出一段基于链表的逆转思路</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Ptr <span class="token function">Reverse</span><span class="token punctuation">(</span>Ptr head<span class="token punctuation">,</span> <span class="token keyword">int</span> K<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    new <span class="token operator">=</span> head<span class="token operator">-></span>next<span class="token punctuation">;</span>    old <span class="token operator">=</span> new<span class="token operator">-></span>next<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cnt <span class="token operator">&lt;</span> K<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        tmp <span class="token operator">=</span> old<span class="token operator">-></span>next<span class="token punctuation">;</span>        old<span class="token operator">-></span>next <span class="token operator">=</span> new<span class="token punctuation">;</span>        new <span class="token operator">=</span> old<span class="token punctuation">;</span>        old <span class="token operator">=</span> tmp<span class="token punctuation">;</span>        cnt<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    head<span class="token operator">-></span>next<span class="token operator">-></span>next <span class="token operator">=</span> old<span class="token punctuation">;</span>    <span class="token keyword">return</span> new<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MaxSize</span> <span class="token expression"><span class="token number">100005</span></span></span><span class="token keyword">int</span> Data<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">,</span> Next<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">,</span> Address<span class="token punctuation">[</span>MaxSize<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> FirstAdd<span class="token punctuation">,</span> N<span class="token punctuation">,</span> K<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>FirstAdd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">,</span> <span class="token operator">&amp;</span>K<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> tmpAdd<span class="token punctuation">,</span> tmpData<span class="token punctuation">,</span> tmpNext<span class="token punctuation">;</span>        tmpAdd <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tmpData <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tmpNext <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Data<span class="token punctuation">[</span>tmpAdd<span class="token punctuation">]</span> <span class="token operator">=</span> tmpData<span class="token punctuation">;</span>        Next<span class="token punctuation">[</span>tmpAdd<span class="token punctuation">]</span> <span class="token operator">=</span> tmpNext<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>FirstAdd <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Address<span class="token punctuation">[</span>cnt<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> FirstAdd<span class="token punctuation">;</span>        FirstAdd <span class="token operator">=</span> Next<span class="token punctuation">[</span>FirstAdd<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cnt <span class="token operator">-</span> cnt <span class="token operator">%</span> K<span class="token punctuation">;</span> i <span class="token operator">+=</span> K<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> K <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> t <span class="token operator">=</span> Address<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>            Address<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> Address<span class="token punctuation">[</span>i <span class="token operator">+</span> K <span class="token operator">-</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            Address<span class="token punctuation">[</span>i <span class="token operator">+</span> K <span class="token operator">-</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%05d %d %05d\n"</span><span class="token punctuation">,</span> Address<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> Data<span class="token punctuation">[</span>Address<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Address<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%05d %d -1\n"</span><span class="token punctuation">,</span> Address<span class="token punctuation">[</span>cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Data<span class="token punctuation">[</span>Address<span class="token punctuation">[</span>cnt <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 有尾巴不反转, 地址取上下界</td><td>答案正确</td><td>12</td><td>5 ms</td><td>316 KB</td></tr><tr><td>1</td><td>正好全反转</td><td>答案正确</td><td>3</td><td>5 ms</td><td>208 KB</td></tr><tr><td>2</td><td>K=N全反转</td><td>答案正确</td><td>2</td><td>4 ms</td><td>320 KB</td></tr><tr><td>3</td><td>K=1不用反转</td><td>答案正确</td><td>2</td><td>5 ms</td><td>320 KB</td></tr><tr><td>4</td><td>N=1 最小case</td><td>答案正确</td><td>2</td><td>4 ms</td><td>192 KB</td></tr><tr><td>5</td><td>最大N,最后剩K-1不反转</td><td>答案正确</td><td>3</td><td>35 ms</td><td>3132 KB</td></tr><tr><td>6</td><td>有多余结点不在链表上</td><td>答案正确</td><td>1</td><td>4 ms</td><td>320 KB</td></tr></tbody></table><h3 id="4-Pop-Sequence"><a href="#4-Pop-Sequence" class="headerlink" title="4.Pop Sequence"></a><a href="https://pintia.cn/problem-sets/16/problems/665">4.Pop Sequence</a></h3><p>2013年PAT春季考试真题</p><p>Given a stack which can keep <em>M</em> numbers at most. Push <em>N</em> numbers in the order of 1, 2, 3, …, <em>N</em> and pop randomly. You are supposed to tell if a given sequence of numbers is a possible pop sequence of the stack. For example, if <em>M</em> is 5 and <em>N</em> is 7, we can obtain 1, 2, 3, 4, 5, 6, 7 from the stack, but not 3, 2, 1, 7, 5, 6, 4.</p><h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains 3 numbers (all no more than 1000): <em>M</em> (the maximum capacity of the stack), <em>N</em> (the length of push sequence), and <em>K</em> (the number of pop sequences to be checked). Then <em>K</em> lines follow, each contains a pop sequence of <em>N</em> numbers. All the numbers in a line are separated by a space.</p><h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each pop sequence, print in one line “YES” if it is indeed a possible pop sequence of the stack, or “NO” if not.</p><h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">5 7 51 2 3 4 5 6 73 2 1 7 5 6 47 6 5 4 3 2 15 6 4 3 7 2 11 7 6 5 4 3 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">YESNONOYESNO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h4><p>考察是否是一个堆栈的出栈序列，正常模拟堆栈即可，注意堆栈容量。</p><p>首先模拟正常顺序的入栈，若遇到出栈序列的数字则出栈，直至栈容量慢了或全都正常入栈，考察是否全部出栈，若全部出栈则正确，否则错误。</p><h4 id="AC-code-3"><a href="#AC-code-3" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">1001</span></span></span><span class="token keyword">int</span> Stack<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">,</span> num<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> k<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> k<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> cur <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            Stack<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">></span> m<span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>top <span class="token operator">&amp;&amp;</span> Stack<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> num<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">--</span>top<span class="token punctuation">,</span> <span class="token operator">++</span>cur<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> n<span class="token punctuation">)</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"YES\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"NO\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample乱序，一般的Y&amp;N</td><td>答案正确</td><td>15</td><td>4 ms</td><td>188 KB</td></tr><tr><td>1</td><td>达到最大size后又溢出</td><td>答案正确</td><td>3</td><td>3 ms</td><td>188 KB</td></tr><tr><td>2</td><td>M==N</td><td>答案正确</td><td>2</td><td>3 ms</td><td>188 KB</td></tr><tr><td>3</td><td>最大数</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr><tr><td>4</td><td>最小数</td><td>答案正确</td><td>1</td><td>3 ms</td><td>192 KB</td></tr><tr><td>5</td><td>卡特殊错误算法（通过比较大小判断）</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构week1</title>
      <link href="2021/072849324.html"/>
      <url>2021/072849324.html</url>
      
        <content type="html"><![CDATA[<h1 id="Week1基本概念"><a href="#Week1基本概念" class="headerlink" title="Week1基本概念"></a>Week1基本概念</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>以下内容均综合整理自浙江大学数据结构慕课，包括后续同tag文章。</p><h2 id="1-1什么是数据结构"><a href="#1-1什么是数据结构" class="headerlink" title="1.1什么是数据结构"></a>1.1什么是数据结构</h2><h3 id="没有官方统一定义"><a href="#没有官方统一定义" class="headerlink" title="没有官方统一定义"></a>没有官方统一定义</h3><p><strong>“数据结构是数据对象以及存在于该对象的实例和组成实例的数据元素之间的各种联系。这些联系可以通过定义相关的函数来给出。“</strong>                                                                                                                                            <strong>——Sartaj Sahni，《数据结构、算法与应用》</strong><br> <strong>“数据结构是ADT（抽象数据类型 Abstract DataType）的物理实现。 ”            ——Clifford A.Shaffer，《数据结构与算法分析》</strong><br> <strong>“数据结构（data structure）是计算机中存储、组织数据的方式。通常情况下，精心选择的数据结构可以带来最优效率的算法。 ”</strong>                                                                                                                                                                                                <strong>——中文维基百科</strong></p><h4 id="1-解决问题方法的效率，跟数据的组织方式有关。"><a href="#1-解决问题方法的效率，跟数据的组织方式有关。" class="headerlink" title="1.解决问题方法的效率，跟数据的组织方式有关。"></a><strong>1.解决问题方法的效率，跟数据的组织方式有关。</strong></h4><p>例1：如何在书架上摆放图书？                                                                                                                                                                                图书的摆放要使得2个相关操作方便实现：<br>操作1：新书怎么插入？（1.随便放 2.按拼音字母顺序 3.划分类别+拼音字母顺序）<br>操作2：怎么找到某本指定的书？ （1.累死 2.二分查找 3.定类别+二分）</p><h4 id="2-解决问题方法的效率，跟空间的利用效率有关。"><a href="#2-解决问题方法的效率，跟空间的利用效率有关。" class="headerlink" title="2.解决问题方法的效率，跟空间的利用效率有关。"></a><strong>2.解决问题方法的效率，跟空间的利用效率有关。</strong></h4><p>例2：写程序实现一个函数PrintN，使得传入一个正整数为N的参数后，能顺序打印从1到N的全部正整数</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//循环实现</span><span class="token keyword">void</span> <span class="token function">PrintN1</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span>“ <span class="token operator">%</span> d\n”<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//递归实现</span><span class="token keyword">void</span> <span class="token function">PrintN2</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">PrintN</span><span class="token punctuation">(</span>N – <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span>“ <span class="token operator">%</span> d\n”<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>令 N = 100, 1000, 10000, 10000 测试效率。</p><h4 id="3-解决问题方法的效率，跟算法的巧妙程度有关。"><a href="#3-解决问题方法的效率，跟算法的巧妙程度有关。" class="headerlink" title="3.解决问题方法的效率，跟算法的巧妙程度有关。"></a><strong>3.解决问题方法的效率，跟算法的巧妙程度有关。</strong></h4><p>例3：写程序计算给定多项式在给定点x处的值 $f(x)=a_0+a_1x+\cdots+a_{n-1}x^{n-1}+a_nx^n$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">double</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">double</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">double</span> p <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>p <span class="token operator">+=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$f(x)=a_0+x(a_1+x(\cdots(a_{n-1}+x(a_n))\cdots))$</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">double</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">double</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">double</span> p <span class="token operator">=</span> a<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> n<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>p <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> x <span class="token operator">*</span> p<span class="token punctuation">;</span><span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token comment">//clock()：捕捉从程序开始运行到clock()被调用时所耗费的时间。这个时间单位是clock tick，即“时钟打点”。</span><span class="token comment">//常数CLK_TCK(或CLOCKS_PER_SEC)：机器时钟每秒所走的时钟打点数。</span><span class="token class-name">clock_t</span> start<span class="token punctuation">,</span> stop<span class="token punctuation">;</span><span class="token keyword">double</span> duration<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXN</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXK</span> <span class="token expression"><span class="token number">1e7</span></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">double</span> a<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAXN<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>i<span class="token punctuation">;</span>    start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAXK<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">f1</span><span class="token punctuation">(</span>MAXN <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    stop <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    duration <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>stop <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> CLK_TCK <span class="token operator">/</span> MAXK<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ticks1 = %f\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>stop <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"duration1 = %6.2e\n"</span><span class="token punctuation">,</span> duration<span class="token punctuation">)</span><span class="token punctuation">;</span>    start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAXK<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token function">f2</span><span class="token punctuation">(</span>MAXN <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    stop <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    duration <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>stop <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> CLK_TCK <span class="token operator">/</span> MAXK<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ticks1 = %f\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>stop <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"duration1 = %6.2e\n"</span><span class="token punctuation">,</span> duration<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*ticks1 = 1725.000000duration1 = 1.73e-07ticks1 = 288.000000 duration1 = 2.88e-08*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>让被测函数重复运行多次，使得测出的总的时钟打点间隔充分长，最后计算被测函数平均每次运行的时间，即可进行时间效率测试!</p><h3 id="所以什么是数据结构"><a href="#所以什么是数据结构" class="headerlink" title="所以什么是数据结构?"></a>所以什么是数据结构?</h3><p><strong>数据对象在计算机中的组织方式 1.逻辑结构 2.物理存储结构</strong></p><p><strong>数据对象必定与一系列加在其上的操作相关联，完成这些操作所用的方法就是算法</strong>  </p><p><strong>抽象数据类型（Abstract Data Type）</strong><br><strong>1.数据类型  2.数据对象集 3.数据集合相关联的操作集</strong><br>抽象：描述数据类型的方法不依赖于具体实现,与存放数据的机器无关,与数据存储的物理结构无关,与实现操作的算法和编程语言均无关<br>只描述数据对象集和相关操作集“是什么”，并不涉及“如何做到”的问题。</p><p>例4： “矩阵”的抽象数据类型定义<br><strong>类型名称</strong>： 矩阵（Matrix）<br>数据对象集： 一个$M\times N$​的矩阵$A_{M\times N}$​ = $(a_{ij})(i=1,\cdots,M;j=1,\cdots,N)$​​由$M\times N$​​个三元组$&lt; a, i, j &gt;$构成，其中a是矩阵元素的值， i是元素所在的行号， j是元素所在的列号。<br><strong>操作集</strong>： 对于任意矩阵$A、 B、 C \in Matrix$，以及整数$i、 j、 M、 N$                                                                                                               </p><pre class="line-numbers language-c" data-language="c"><code class="language-c">Matrix <span class="token function">Create</span><span class="token punctuation">(</span> <span class="token keyword">int</span> M<span class="token punctuation">,</span> <span class="token keyword">int</span> N <span class="token punctuation">)</span><span class="token comment">//返回一个M×N的空矩阵；</span><span class="token keyword">int</span> <span class="token function">GetMaxRow</span><span class="token punctuation">(</span> Matrix A <span class="token punctuation">)</span><span class="token comment">//返回矩阵A的总行数；</span><span class="token keyword">int</span> <span class="token function">GetMaxCol</span><span class="token punctuation">(</span> Matrix A <span class="token punctuation">)</span><span class="token comment">//返回矩阵A的总列数；</span>ElementType <span class="token function">GetEntry</span><span class="token punctuation">(</span> Matrix A<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j <span class="token punctuation">)</span><span class="token comment">//返回矩阵A的第i行、第j列的元素；</span>Matrix <span class="token function">Add</span><span class="token punctuation">(</span> Matrix A<span class="token punctuation">,</span> Matrix B <span class="token punctuation">)</span><span class="token comment">//如果A和B的行、列数一致，则返回矩阵C=A+B，否则返回错误标志；</span>Matrix <span class="token function">Multiply</span><span class="token punctuation">(</span> Matrix A<span class="token punctuation">,</span> Matrix B <span class="token punctuation">)</span><span class="token comment">//如果A的列数等于B的行数，则返回矩阵C=AB，否则返回错误标志；</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Q：矩阵用什么存储？二维数组？一维数组？十字链表？加法如何执行？先按行加？先按列加？什么语言？  </p><h2 id="1-2-什么是算法"><a href="#1-2-什么是算法" class="headerlink" title="1.2 什么是算法"></a>1.2 什么是算法</h2><h3 id="算法（Algorithm）"><a href="#算法（Algorithm）" class="headerlink" title="算法（Algorithm）"></a><strong>算法（Algorithm）</strong></h3><p>（1）一个有限指令集 接受一些输入（有些情况下不需要输入）<br>（2）产生输出<br>（3）一定在有限步骤之后终止<br>（4）每一条指令必须  </p><p>1.有充分明确的目标，不可以有歧义 2.计算机能处理的范围之内 3.描述应不依赖于任何一种计算机语言以及具体的实现手段 </p><p>例1：选择排序算法的伪码描述</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">SelectionSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> List<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* 将N个整数List[0]...List[N-1]进行非递减排序 */</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>MinPosition <span class="token operator">=</span> <span class="token function">ScanForMin</span><span class="token punctuation">(</span>List<span class="token punctuation">,</span> i<span class="token punctuation">,</span> N–<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* 从List[i]到List[N–1]中找最小元，并将其位置赋给MinPosition */</span><span class="token function">Swap</span><span class="token punctuation">(</span>List<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> List<span class="token punctuation">[</span>MinPosition<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* 将未排序部分的最小元换到有序部分的最后位置 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>抽象——List到底是数组还是链表（虽然看上去很像数组？Swap用函数还是用宏去实现？  </p><h3 id="什么是好的算法？"><a href="#什么是好的算法？" class="headerlink" title="什么是好的算法？"></a>什么是好的算法？</h3><p>1.<strong>空间复杂度$S(n)$</strong> —— 根据算法写成的程序在执行时<strong>占用存储单元的长度</strong>。这个长度往往与输入数据的规模有关。空间复杂度过高的算法可能导致使用的内存超限，造成程序非正常中断。 </p><p>2.<strong>时间复杂度$T(n)$</strong> —— 根据算法写成的程序在执行时<strong>耗费时间的长度</strong>。这个长度往往也与输入数据的规模有关。时间复杂度过高的低效算法可能导致我们在有生之年都等不到运行结果。  </p><p>例2：递归实现的PrintN2 $S(N) = C · N$  f1 $T(n) = C_1n^2+C_2n$  f2 $T(n) = C · n$</p><p>什么是好的算法？<br>在分析一般算法的效率时，我们经常关注下面两种复杂度: 1.最坏情况复杂度 $T_{worst}( n )$  2.平均复杂度 $T_{avg}( n )$<br>$$<br>T_{avg}(n)\leq T_{worst}(n)<br>$$</p><h4 id="复杂度的渐进表示法"><a href="#复杂度的渐进表示法" class="headerlink" title="复杂度的渐进表示法"></a>复杂度的渐进表示法</h4><p>$T(n) = O(f(n))$​ 表示存在常数$C &gt;0, n_0&gt;0$​ 使得当$n\geq n_0$​ 时有$T(n) \leq C·f(n)$​​<br>$T(n) = Ω(g(n))$ 表示存在常数$C &gt;0, n_0&gt;0$ 使得当$n\geq n_0$ 时有$T(n) \geq C·g(n)$​<br>$T(n) = Θ (h(n))$ 表示同时有$T(n) = O(h(n))$ 和$T(n) = Ω(h(n))$</p><h4 id="复杂度分析小窍门"><a href="#复杂度分析小窍门" class="headerlink" title="复杂度分析小窍门"></a>复杂度分析小窍门</h4><p>若两段算法分别有复杂度$T_1(n) = O(f_1(n))$​​ 和$T_2(n) =O(f_2(n))$​​，则                                                                                                                                    $T1(n) + T2(n) = max( O(f_1(n))$​​,$ O(f_2(n)) )\qquad  T_1(n) \times T_2(n) = O( f1(n) \times f2(n) )$​​<br>若$T(n)$​是关于n的k阶多项式，那么$T(n)=Θ (n^k)$​​<br>一个for循环的时间复杂度等于循环次数乘以循环体代码的复杂度<br>if-else 结构的复杂度取决于 if的条件判断复杂度和两个分支部分的复杂度，总体复杂度取三者中最大  </p><h2 id="1-3-应用实例：最大子列和问题"><a href="#1-3-应用实例：最大子列和问题" class="headerlink" title="1.3 应用实例：最大子列和问题"></a>1.3 应用实例：最大子列和问题</h2><p>给定N个整数的序列${ A_1, A_2, …, A_N}$​，求函数$f(i,j)=max(0,\sum_{k=i}^jA_k)$​ 的最大值。  </p><h3 id="算法1-T-N-O-N-3"><a href="#算法1-T-N-O-N-3" class="headerlink" title="算法1  $T( N ) = O( N^3 )$"></a>算法1  $T( N ) = O( N^3 )$</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">MaxSubseqSum1</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> ThisSum<span class="token punctuation">,</span> MaxSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* i是子列左端位置 */</span><span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* j是子列右端位置 */</span>ThisSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* ThisSum是从A[i]到A[j]的子列和 */</span><span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> i<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> j<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>ThisSum <span class="token operator">+=</span> A<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">></span> MaxSum<span class="token punctuation">)</span> <span class="token comment">/* 如果刚得到的这个子列和更大 */</span>MaxSum <span class="token operator">=</span> ThisSum<span class="token punctuation">;</span> <span class="token comment">/* 则更新结果 */</span><span class="token punctuation">&#125;</span> <span class="token comment">/* j循环结束 */</span><span class="token punctuation">&#125;</span> <span class="token comment">/* i循环结束 */</span><span class="token keyword">return</span> MaxSum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="算法2-T-N-O-N-2-​"><a href="#算法2-T-N-O-N-2-​" class="headerlink" title="算法2  $T( N ) = O( N^2 )$​"></a>算法2  $T( N ) = O( N^2 )$​</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">MaxSubseqSum2</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> ThisSum<span class="token punctuation">,</span> MaxSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* i是子列左端位置 */</span>ThisSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* ThisSum是从A[i]到A[j]的子列和 */</span><span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* j是子列右端位置 */</span>ThisSum <span class="token operator">+=</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/*对于相同的i，不同的j，只要在j-1次循环的基础上累加1项即可*/</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">></span> MaxSum<span class="token punctuation">)</span> <span class="token comment">/* 如果刚得到的这个子列和更大 */</span>MaxSum <span class="token operator">=</span> ThisSum<span class="token punctuation">;</span> <span class="token comment">/* 则更新结果 */</span><span class="token punctuation">&#125;</span> <span class="token comment">/* j循环结束 */</span><span class="token punctuation">&#125;</span> <span class="token comment">/* i循环结束 */</span><span class="token keyword">return</span> MaxSum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="算法3：分而治之"><a href="#算法3：分而治之" class="headerlink" title="算法3：分而治之"></a>算法3：分而治之</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">Max3</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">,</span> <span class="token keyword">int</span> B<span class="token punctuation">,</span> <span class="token keyword">int</span> C<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 返回3个整数中的最大值 */</span>    <span class="token keyword">return</span> A <span class="token operator">></span> B <span class="token operator">?</span> A <span class="token operator">></span> C <span class="token operator">?</span> A <span class="token operator">:</span> C <span class="token operator">:</span> B <span class="token operator">></span> C <span class="token operator">?</span> B <span class="token operator">:</span> C<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">MaxSubSum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> Left<span class="token punctuation">,</span> <span class="token keyword">int</span> Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 分治法求A[Left]到A[Right]的最大子列和 */</span>    <span class="token keyword">int</span> MaxLeftSum<span class="token punctuation">,</span> MaxRightSum<span class="token punctuation">;</span>             <span class="token comment">/* 存放左右子问题的解 */</span>    <span class="token keyword">int</span> MaxLeftBorderSum<span class="token punctuation">,</span> MaxRightBorderSum<span class="token punctuation">;</span> <span class="token comment">/*存放跨分界线的结果*/</span>    <span class="token keyword">int</span> LeftBorderSum<span class="token punctuation">,</span> RightBorderSum<span class="token punctuation">;</span>    <span class="token keyword">int</span> Center<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Left <span class="token operator">==</span> Right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 递归的终止条件，子列只有1个数字 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> A<span class="token punctuation">[</span>Left<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* 下面是"分"的过程 */</span>    Center <span class="token operator">=</span> <span class="token punctuation">(</span>Left <span class="token operator">+</span> Right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">/* 找到中分点 */</span>    <span class="token comment">/* 递归求得两边子列的最大和 */</span>    MaxLeftSum <span class="token operator">=</span> <span class="token function">MaxSubSum</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Left<span class="token punctuation">,</span> Center<span class="token punctuation">)</span><span class="token punctuation">;</span>    MaxRightSum <span class="token operator">=</span> <span class="token function">MaxSubSum</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> Right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 下面求跨分界线的最大子列和 */</span>    MaxLeftBorderSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    LeftBorderSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> Center<span class="token punctuation">;</span> i <span class="token operator">>=</span> Left<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 从中线向左扫描 */</span>        LeftBorderSum <span class="token operator">+=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>LeftBorderSum <span class="token operator">></span> MaxLeftBorderSum<span class="token punctuation">)</span>            MaxLeftBorderSum <span class="token operator">=</span> LeftBorderSum<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* 左边扫描结束 */</span>    MaxRightBorderSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    RightBorderSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> Center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> Right<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* 从中线向右扫描 */</span>        RightBorderSum <span class="token operator">+=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>RightBorderSum <span class="token operator">></span> MaxRightBorderSum<span class="token punctuation">)</span>            MaxRightBorderSum <span class="token operator">=</span> RightBorderSum<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token comment">/* 右边扫描结束 */</span>    <span class="token comment">/* 下面返回"治"的结果 */</span>    <span class="token keyword">return</span> <span class="token function">Max3</span><span class="token punctuation">(</span>MaxLeftSum<span class="token punctuation">,</span> MaxRightSum<span class="token punctuation">,</span> MaxLeftBorderSum <span class="token operator">+</span> MaxRightBorderSum<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">MaxSubsequenceSum3</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 保持与前2种算法相同的函数接口 */</span>    <span class="token keyword">return</span> <span class="token function">MaxSubSum</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$$<br>\begin{aligned}<br>    T(N)&amp;=2T(N/2)+cN,\qquad T(1)=O(1) \newline<br>        &amp;=2[2T(N/2^2)+c(N/2)]+cN \newline<br>        &amp;=2^kO(1)+ckN,\qquad N/2^k=1 \newline<br>        &amp;=O(NlogN)<br>\end{aligned}<br>$$</p><h4 id="算法4：在线处理-T-N-O-N"><a href="#算法4：在线处理-T-N-O-N" class="headerlink" title="算法4：在线处理  $T( N ) = O( N )  $"></a>算法4：在线处理  $T( N ) = O( N )  $</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">MaxSubsequenceSum4</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> N<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ThisSum<span class="token punctuation">,</span> MaxSum<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    ThisSum <span class="token operator">=</span> MaxSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        ThisSum <span class="token operator">+=</span> A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* 向右累加 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">></span> MaxSum<span class="token punctuation">)</span>            MaxSum <span class="token operator">=</span> ThisSum<span class="token punctuation">;</span> <span class="token comment">/* 发现更大和则更新当前结果 */</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 如果当前子列和为负 */</span>            ThisSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 则不可能使后面的部分和增大，抛弃之 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> MaxSum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>“在线”的意思是指每输入一个数据就进行即时处理，在任何一个地方中止输入，算法都能正确给出当前的解。  </p><h2 id="编程习题"><a href="#编程习题" class="headerlink" title="编程习题"></a>编程习题</h2><h3 id="1-最大子列和问题"><a href="#1-最大子列和问题" class="headerlink" title="1.最大子列和问题"></a><a href="https://pintia.cn/problem-sets/434/problems/5404">1.<strong>最大子列和问题</strong></a></h3><p>给定<em>K</em>个整数组成的序列$\{ N_1, N_2, …, N_K \}$​​​​​​​​​​​​​​​​，“连续子列”被定义为$\{ N_i, N_{i+1}, …, N_j \}$​​​​​​​​​​​​​​​​​，其中 $1≤i≤j≤K$​​​​​​​​​​​​​​​​。“最大子列和”则被定义为所有连续子列元素的和中最大者。例如给定序列$\{ -2, 11, -4, 13, -5, -2\}$​​​​​​​​​​​​​​，其连续子列$\{ 11, -4, 13 \}$​​​​​​​​​​​​​​有最大的和20。现要求你编写程序，计算给定整数序列的最大子列和。</p><p>本题旨在测试各种不同的算法在各种数据情况下的表现。各组测试数据特点如下：</p><ul><li>数据1：与样例等价，测试基本正确性；</li><li>数据2：$10^2$个随机整数；</li><li>数据3：$10^3$个随机整数；</li><li>数据4：$10^4$个随机整数；</li><li>数据5：$10^5$个随机整数；</li></ul><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><p>输入第1行给出正整数<em>K</em> (≤100000)；第2行给出<em>K</em>个整数，其间以空格分隔。</p><h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><p>在一行中输出最大子列和。如果序列中所有整数皆为负数，则输出0。</p><h4 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例:"></a>输入样例:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">6-2 11 -4 13 -5 -2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例:"></a>输出样例:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>最大子列和问题前述4种算法，用在线处理算法+快读可达到较好效率。</p><h4 id="AC-code"><a href="#AC-code" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span>            symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> K<span class="token punctuation">,</span> ThisSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> MaxSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> num<span class="token punctuation">;</span>    K <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> K<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        num <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ThisSum <span class="token operator">+=</span> num<span class="token punctuation">;</span> <span class="token comment">/* 向右累加 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">></span> MaxSum<span class="token punctuation">)</span>            MaxSum <span class="token operator">=</span> ThisSum<span class="token punctuation">;</span> <span class="token comment">/* 发现更大和则更新当前结果 */</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 如果当前子列和为负 */</span>            ThisSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 则不可能使后面的部分和增大，抛弃之 */</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> MaxSum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample 有正负，负数开头结尾，最大和有更新</td><td>答案正确</td><td>12</td><td>3 ms</td><td>328 KB</td></tr><tr><td>1</td><td>100个随机数</td><td>答案正确</td><td>2</td><td>4 ms</td><td>196 KB</td></tr><tr><td>2</td><td>1000个随机数</td><td>答案正确</td><td>2</td><td>4 ms</td><td>192 KB</td></tr><tr><td>3</td><td>10000个随机数</td><td>答案正确</td><td>2</td><td>4 ms</td><td>188 KB</td></tr><tr><td>4</td><td>100000个随机数</td><td>答案正确</td><td>2</td><td>5 ms</td><td>184 KB</td></tr></tbody></table><h3 id="2-Maximum-Subsequence-Sum（2004年浙江大学计算机专业考研复试真题）"><a href="#2-Maximum-Subsequence-Sum（2004年浙江大学计算机专业考研复试真题）" class="headerlink" title="2.Maximum Subsequence Sum（2004年浙江大学计算机专业考研复试真题）"></a><a href="https://pintia.cn/problem-sets/16/problems/663">2.<strong>Maximum Subsequence Sum</strong>（2004年浙江大学计算机专业考研复试真题）</a></h3><p>Given a sequence of <em>K</em> integers$\{N_1, N_2, …, N_K \}$​. A continuous subsequence is defined to be$\{ N_i, N_{i+1}, …, N_j \}$​where$1≤i≤j≤K$​.The Maximum Subsequence is the continuous subsequence which has the largest sum of its elements. For example, given sequence$\{-2, 11, -4, 13, -5, -2 \}$​, its maximum subsequence is $\{ 11, -4, 13 \}$​​​​​​​ with the largest sum being 20.</p><p>Now you are supposed to find the largest sum, together with the first and the last numbers of the maximum subsequence.</p><h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. Each case occupies two lines. The first line contains a positive integer <em>K</em> (≤10000). The second line contains <em>K</em> numbers, separated by a space.</p><h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, output in one line the largest sum, together with the first and the last numbers of the maximum subsequence. The numbers must be separated by one space, but there must be no extra space at the end of a line. In case that the maximum subsequence is not unique, output the one with the smallest indices <em>i</em> and <em>j</em> （as shown by the sample case）. If all the <em>K</em> numbers are negative, then its maximum sum is defined to be 0, and you are supposed to output the first and the last numbers of the whole sequence.</p><h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">10-10 1 2 3 4 -5 -23 3 7 -21<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">10 1 4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><p>最大子列和问题变形，还要求输出最大子列开头和结尾的数字。</p><p>首先为了避免开数组用两个变量记住开头和结尾的数字，处理全负情况。</p><p>考虑对每一段可能的最大子列开头，其先前的累加和ThisSum一定为负，利用一个start标记是否是某一段开头，当ThisSum &lt; 0则start置零；对于结尾，由于它是(当前)最大子列，只需要在ThisSum &gt; MaxSum（这也保证了多解时输出第一组）时更新结尾和开头数字。   </p><p>注意一类特殊情况，负数和0，其最大子列和为0，但是开头和结尾数字也应该是0，因此开始的MaxSum不能为0.            </p><p>全负当且仅当开头和结尾数字为初值(-1)。</p><h4 id="AC-code-1"><a href="#AC-code-1" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> symbol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token string">'0'</span> <span class="token operator">||</span> ch <span class="token operator">></span> <span class="token string">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span>            symbol <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span>        num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> num <span class="token operator">*</span> symbol<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> K<span class="token punctuation">,</span> ThisSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> MaxSum <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    K <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> _begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> _end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> K<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        num <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            _begin <span class="token operator">=</span> num<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> K <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            _end <span class="token operator">=</span> num<span class="token punctuation">;</span>        ThisSum <span class="token operator">+=</span> num<span class="token punctuation">;</span> <span class="token comment">/* 向右累加 */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>start <span class="token operator">&amp;&amp;</span> ThisSum <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span>            first <span class="token operator">=</span> num<span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">></span> MaxSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            MaxSum <span class="token operator">=</span> ThisSum<span class="token punctuation">;</span> <span class="token comment">/* 发现更大和则更新当前结果 */</span>            begin <span class="token operator">=</span> first<span class="token punctuation">,</span> end <span class="token operator">=</span> num<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ThisSum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* 如果当前子列和为负 */</span>            ThisSum <span class="token operator">=</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 则不可能使后面的部分和增大，抛弃之 */</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>begin <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> MaxSum<span class="token punctuation">,</span> begin<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> _begin<span class="token punctuation">,</span> _end<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample换1个数字。有正负，负数开头结尾，有并列最大和</td><td>答案正确</td><td>13</td><td>4 ms</td><td>176 KB</td></tr><tr><td>1</td><td>最大和序列中有负数</td><td>答案正确</td><td>2</td><td>4 ms</td><td>292 KB</td></tr><tr><td>2</td><td>并列和对应相同i但是不同j，即尾是0</td><td>答案正确</td><td>2</td><td>3 ms</td><td>296 KB</td></tr><tr><td>3</td><td>1个正数</td><td>答案正确</td><td>2</td><td>3 ms</td><td>188 KB</td></tr><tr><td>4</td><td>全是负数</td><td>答案正确</td><td>2</td><td>4 ms</td><td>176 KB</td></tr><tr><td>5</td><td>负数和0</td><td>答案正确</td><td>2</td><td>3 ms</td><td>320 KB</td></tr><tr><td>6</td><td>最大和前面有一段是0</td><td>答案正确</td><td>1</td><td>3 ms</td><td>196 KB</td></tr><tr><td>7</td><td>最大N</td><td>答案正确</td><td>1</td><td>4 ms</td><td>172 KB</td></tr></tbody></table><h3 id="3-二分查找"><a href="#3-二分查找" class="headerlink" title="3.二分查找"></a><a href="https://pintia.cn/problem-sets/434/problems/965458856133562368">3.<strong>二分查找</strong></a></h3><p>本题要求实现二分查找算法。</p><h4 id="函数接口定义："><a href="#函数接口定义：" class="headerlink" title="函数接口定义："></a>函数接口定义：</h4><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">Position BinarySearch( List L, ElementType X );<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>其中<code>List</code>结构定义如下：</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token operator">*</span>List<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>    Position Last<span class="token punctuation">;</span> <span class="token comment">/* 保存线性表中最后一个元素的位置 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>L</code>是用户传入的一个线性表，其中<code>ElementType</code>元素可以通过&gt;、==、&lt;进行比较，并且题目保证传入的数据是递增有序的。函数<code>BinarySearch</code>要查找<code>X</code>在<code>Data</code>中的位置，即数组下标（注意：元素从下标1开始存储）。找到则返回下标，否则返回一个特殊的失败标记<code>NotFound</code>。</p><h4 id="裁判测试程序样例："><a href="#裁判测试程序样例：" class="headerlink" title="裁判测试程序样例："></a>裁判测试程序样例：</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NotFound</span> <span class="token expression"><span class="token number">0</span></span></span><span class="token keyword">typedef</span> <span class="token keyword">int</span> ElementType<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> Position<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token operator">*</span>List<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">LNode</span> <span class="token punctuation">&#123;</span>    ElementType Data<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>    Position Last<span class="token punctuation">;</span> <span class="token comment">/* 保存线性表中最后一个元素的位置 */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>List <span class="token function">ReadInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 裁判实现，细节不表。元素从下标1开始存储 */</span>Position <span class="token function">BinarySearch</span><span class="token punctuation">(</span> List L<span class="token punctuation">,</span> ElementType X <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    List L<span class="token punctuation">;</span>    ElementType X<span class="token punctuation">;</span>    Position P<span class="token punctuation">;</span>    L <span class="token operator">=</span> <span class="token function">ReadInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>    P <span class="token operator">=</span> <span class="token function">BinarySearch</span><span class="token punctuation">(</span> L<span class="token punctuation">,</span> X <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> P<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 你的代码将被嵌在这里 */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输入样例1："><a href="#输入样例1：" class="headerlink" title="输入样例1："></a>输入样例1：</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">512 31 55 89 10131<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="输出样例1："><a href="#输出样例1：" class="headerlink" title="输出样例1："></a>输出样例1：</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="输入样例2："><a href="#输入样例2：" class="headerlink" title="输入样例2："></a>输入样例2：</h4><pre class="line-numbers language-in" data-language="in"><code class="language-in">326 78 23331<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="输出样例2："><a href="#输出样例2：" class="headerlink" title="输出样例2："></a>输出样例2：</h4><pre class="line-numbers language-out" data-language="out"><code class="language-out">0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h4><p>基础二分查找，注意函数要与裁判程序契合即可。</p><h4 id="AC-code-2"><a href="#AC-code-2" class="headerlink" title="AC code"></a>AC code</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">Position <span class="token function">BinarySearch</span><span class="token punctuation">(</span>List L<span class="token punctuation">,</span> ElementType X<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Position left <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> right <span class="token operator">=</span> L<span class="token operator">-></span>Last<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Position mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">==</span> L<span class="token operator">-></span>Data<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> mid<span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">></span> L<span class="token operator">-></span>Data<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span>            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            right <span class="token operator">=</span> mid <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> NotFound<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>测试点</th><th>提示</th><th>结果</th><th>分数</th><th>耗时</th><th>内存</th></tr></thead><tbody><tr><td>0</td><td>sample1 等价</td><td>答案正确</td><td>10</td><td>3 ms</td><td>192 KB</td></tr><tr><td>1</td><td>sample2 等价，但NotFound重新定义</td><td>答案正确</td><td>2</td><td>3 ms</td><td>192 KB</td></tr><tr><td>2</td><td>奇数个，正中间找到，MAXSIZE重新定义</td><td>答案正确</td><td>1</td><td>3 ms</td><td>188 KB</td></tr><tr><td>3</td><td>偶数个，正中间找到</td><td>答案正确</td><td>1</td><td>3 ms</td><td>192 KB</td></tr><tr><td>4</td><td>大数据，在头部找到</td><td>答案正确</td><td>2</td><td>16 ms</td><td>704 KB</td></tr><tr><td>5</td><td>大数据，在尾部找到</td><td>答案正确</td><td>2</td><td>14 ms</td><td>584 KB</td></tr><tr><td>6</td><td>大数据，找不到</td><td>答案正确</td><td>2</td><td>14 ms</td><td>576 KB</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>crypto函数库</title>
      <link href="2021/041039666.html"/>
      <url>2021/041039666.html</url>
      
        <content type="html"><![CDATA[<h2 id="READ-ME"><a href="#READ-ME" class="headerlink" title="READ ME"></a>READ ME</h2><p>1.本文整理了CTF中Crypto部分可能用到的一些函数，主要是古典密码。事实上绝大部分古典密码都有在线的解密网站，python中的一些库也有不少加/解密函数，以下函数均为为库函数中没有的。之所以做一个这样的整理，还是因为现在古典密码都是套娃加密，在涉及爆破时，在线网站无疑很费劲，因此有一个自己的库函数就显得很有必要。</p><p>2.本文的函数原理部分并无注释，但是绝大部分经过实践检验，如果出现错误，后续会更正（咕咕咕）。</p><p>3.有一些函数接口单一。举个栗子，my_base64_decode只接受字典，因此使用的时候需要将字符集改成字典的结构，当然也可以对源码进行魔改。</p><p>4.下文的凯撒加解密函数其实并不是通常意义下的，有相关需求只需对源代码进行简单修改即可。</p><p>5.以下除了仿射密码使用了gmpy2的invert函数，其余都不需要额外使用任何库。</p><h2 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">alphabet_to_morse <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"A"</span><span class="token punctuation">:</span> <span class="token string">".-"</span><span class="token punctuation">,</span>    <span class="token string">"B"</span><span class="token punctuation">:</span> <span class="token string">"-..."</span><span class="token punctuation">,</span>    <span class="token string">"C"</span><span class="token punctuation">:</span> <span class="token string">"-.-."</span><span class="token punctuation">,</span>    <span class="token string">"D"</span><span class="token punctuation">:</span> <span class="token string">"-.."</span><span class="token punctuation">,</span>    <span class="token string">"E"</span><span class="token punctuation">:</span> <span class="token string">"."</span><span class="token punctuation">,</span>    <span class="token string">"F"</span><span class="token punctuation">:</span> <span class="token string">"..-."</span><span class="token punctuation">,</span>    <span class="token string">"G"</span><span class="token punctuation">:</span> <span class="token string">"--."</span><span class="token punctuation">,</span>    <span class="token string">"H"</span><span class="token punctuation">:</span> <span class="token string">"...."</span><span class="token punctuation">,</span>    <span class="token string">"I"</span><span class="token punctuation">:</span> <span class="token string">".."</span><span class="token punctuation">,</span>    <span class="token string">"J"</span><span class="token punctuation">:</span> <span class="token string">".---"</span><span class="token punctuation">,</span>    <span class="token string">"K"</span><span class="token punctuation">:</span> <span class="token string">"-.-"</span><span class="token punctuation">,</span>    <span class="token string">"L"</span><span class="token punctuation">:</span> <span class="token string">".-.."</span><span class="token punctuation">,</span>    <span class="token string">"M"</span><span class="token punctuation">:</span> <span class="token string">"--"</span><span class="token punctuation">,</span>    <span class="token string">"N"</span><span class="token punctuation">:</span> <span class="token string">"-."</span><span class="token punctuation">,</span>    <span class="token string">"O"</span><span class="token punctuation">:</span> <span class="token string">"---"</span><span class="token punctuation">,</span>    <span class="token string">"P"</span><span class="token punctuation">:</span> <span class="token string">".--."</span><span class="token punctuation">,</span>    <span class="token string">"Q"</span><span class="token punctuation">:</span> <span class="token string">"--.-"</span><span class="token punctuation">,</span>    <span class="token string">"R"</span><span class="token punctuation">:</span> <span class="token string">".-."</span><span class="token punctuation">,</span>    <span class="token string">"S"</span><span class="token punctuation">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span>    <span class="token string">"T"</span><span class="token punctuation">:</span> <span class="token string">"-"</span><span class="token punctuation">,</span>    <span class="token string">"U"</span><span class="token punctuation">:</span> <span class="token string">"..-"</span><span class="token punctuation">,</span>    <span class="token string">"V"</span><span class="token punctuation">:</span> <span class="token string">"...-"</span><span class="token punctuation">,</span>    <span class="token string">"W"</span><span class="token punctuation">:</span> <span class="token string">".--"</span><span class="token punctuation">,</span>    <span class="token string">"X"</span><span class="token punctuation">:</span> <span class="token string">"-..-"</span><span class="token punctuation">,</span>    <span class="token string">"Y"</span><span class="token punctuation">:</span> <span class="token string">"-.--"</span><span class="token punctuation">,</span>    <span class="token string">"Z"</span><span class="token punctuation">:</span> <span class="token string">"--.."</span><span class="token punctuation">,</span>    <span class="token string">"0"</span><span class="token punctuation">:</span> <span class="token string">"-----"</span><span class="token punctuation">,</span>    <span class="token string">"1"</span><span class="token punctuation">:</span> <span class="token string">".----"</span><span class="token punctuation">,</span>    <span class="token string">"2"</span><span class="token punctuation">:</span> <span class="token string">"..---"</span><span class="token punctuation">,</span>    <span class="token string">"3"</span><span class="token punctuation">:</span> <span class="token string">"...--"</span><span class="token punctuation">,</span>    <span class="token string">"4"</span><span class="token punctuation">:</span> <span class="token string">"....-"</span><span class="token punctuation">,</span>    <span class="token string">"5"</span><span class="token punctuation">:</span> <span class="token string">"....."</span><span class="token punctuation">,</span>    <span class="token string">"6"</span><span class="token punctuation">:</span> <span class="token string">"-...."</span><span class="token punctuation">,</span>    <span class="token string">"7"</span><span class="token punctuation">:</span> <span class="token string">"--..."</span><span class="token punctuation">,</span>    <span class="token string">"8"</span><span class="token punctuation">:</span> <span class="token string">"---.."</span><span class="token punctuation">,</span>    <span class="token string">"9"</span><span class="token punctuation">:</span> <span class="token string">"----."</span><span class="token punctuation">,</span>    <span class="token string">"."</span><span class="token punctuation">:</span> <span class="token string">".-.-.-"</span><span class="token punctuation">,</span>    <span class="token string">","</span><span class="token punctuation">:</span> <span class="token string">"--..--"</span><span class="token punctuation">,</span>    <span class="token string">":"</span><span class="token punctuation">:</span> <span class="token string">"---..."</span><span class="token punctuation">,</span>    <span class="token string">";"</span><span class="token punctuation">:</span> <span class="token string">"-.-.-."</span><span class="token punctuation">,</span>    <span class="token string">"?"</span><span class="token punctuation">:</span> <span class="token string">"..--.."</span><span class="token punctuation">,</span>    <span class="token string">"-"</span><span class="token punctuation">:</span> <span class="token string">"-....-"</span><span class="token punctuation">,</span>    <span class="token string">"_"</span><span class="token punctuation">:</span> <span class="token string">"..--.-"</span><span class="token punctuation">,</span>    <span class="token string">"("</span><span class="token punctuation">:</span> <span class="token string">"-.--."</span><span class="token punctuation">,</span>    <span class="token string">")"</span><span class="token punctuation">:</span> <span class="token string">"-.--.-"</span><span class="token punctuation">,</span>    <span class="token string">"="</span><span class="token punctuation">:</span> <span class="token string">"-...-"</span><span class="token punctuation">,</span>    <span class="token string">"+"</span><span class="token punctuation">:</span> <span class="token string">".-.-."</span><span class="token punctuation">,</span>    <span class="token string">"/"</span><span class="token punctuation">:</span> <span class="token string">"-..-."</span><span class="token punctuation">,</span>    <span class="token string">"@"</span><span class="token punctuation">:</span> <span class="token string">".--.-."</span><span class="token punctuation">,</span>    <span class="token string">"$"</span><span class="token punctuation">:</span> <span class="token string">"...-..-"</span><span class="token punctuation">,</span>    <span class="token string">"&amp;"</span><span class="token punctuation">:</span> <span class="token string">"...."</span><span class="token punctuation">,</span>    <span class="token string">"'"</span><span class="token punctuation">:</span> <span class="token string">".----."</span><span class="token punctuation">,</span>    <span class="token string">"!"</span><span class="token punctuation">:</span> <span class="token string">"-.-.--"</span><span class="token punctuation">,</span>    <span class="token string">'"'</span><span class="token punctuation">:</span> <span class="token string">".-..-."</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>morse_to_alphabet <span class="token operator">=</span> <span class="token punctuation">&#123;</span>v<span class="token punctuation">:</span> k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> alphabet_to_morse<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">morseencode</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Morse cipher encryption function    Example::        encoded='.----/-..../...--/--.../-..'        print(morsedecode(encoded))    prints::        1637D    """</span>    morsestring <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    decoded <span class="token operator">=</span> decoded<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    words <span class="token operator">=</span> decoded<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>        letters <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span>        morseword <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>            morseletter <span class="token operator">=</span> alphabet_to_morse<span class="token punctuation">[</span>letter<span class="token punctuation">]</span>            morseword<span class="token punctuation">.</span>append<span class="token punctuation">(</span>morseletter<span class="token punctuation">)</span>        word <span class="token operator">=</span> <span class="token string">"/"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>morseword<span class="token punctuation">)</span>        morsestring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>morsestring<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">morsedecode</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Morse cipher decryption function    Example::        decoded = '1637D'        print(morseencode(decoded))    prints::        .----/-..../...--/--.../-..    """</span>    characterstring <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    words <span class="token operator">=</span> encoded<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> words<span class="token punctuation">:</span>        letters <span class="token operator">=</span> word<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>        characterword <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>            characterletter <span class="token operator">=</span> morse_to_alphabet<span class="token punctuation">[</span>letter<span class="token punctuation">]</span>            characterword<span class="token punctuation">.</span>append<span class="token punctuation">(</span>characterletter<span class="token punctuation">)</span>        word <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>characterword<span class="token punctuation">)</span>        characterstring<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>characterstring<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">my_base64_decode</span><span class="token punctuation">(</span>encoded<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Base64 decryption function, dict is the substitute dictionary    Example::        dict = &#123;0: 'J', 1: 'K', 2: 'L', 3: 'M', 4: 'N', 5: 'O', 6: 'x', 7: 'y', 8: 'U', 9: 'V', 10: 'z', 11: 'A', 12: 'B',        13: 'C', 14: 'D', 15: 'E', 16: 'F', 17: 'G', 18: 'H', 19: '7', 20: '8', 21: '9', 22: 'P', 23: 'Q', 24: 'I',        25: 'a', 26: 'b', 27: 'c', 28: 'd', 29: 'e', 30: 'f', 31: 'g', 32: 'h', 33: 'i', 34: 'j', 35: 'k', 36: 'l',        37: 'm', 38: 'W', 39: 'X', 40: 'Y', 41: 'Z', 42: '0', 43: '1', 44: '2', 45: '3', 46: '4', 47: '5', 48: '6',        49: 'R', 50: 'S', 51: 'T', 52: 'n', 53: 'o', 54: 'p', 55: 'q', 56: 'r', 57: 's', 58: 't', 59: 'u', 60: 'v',        61: 'w', 62: '+', 63: '/', 64: '='&#125;        print(morseencode(decoded))    new_dict = &#123;v : k for k, v in dict.items()&#125;    chipertext = 'FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw'    print(my_base64_decode(chipertext, new_dict))    prints::        BJD&#123;D0_Y0u_kNoW_Th1s_b4se_map&#125;    """</span>    res <span class="token operator">=</span> <span class="token string">''</span>    p1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span>    p2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">:</span>        str_p1 <span class="token operator">=</span> encoded<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> encoded<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> encoded<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> encoded<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> str_p1<span class="token punctuation">]</span>        tmp_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>tmp_str<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp_res<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> p2<span class="token punctuation">:</span>        str_p2 <span class="token operator">=</span> encoded<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> p1<span class="token punctuation">:</span><span class="token punctuation">]</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> str_p2<span class="token punctuation">]</span>        tmp_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>tmp_str<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp_res<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">shift_encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Shift cipher encryption function    Example::        m = "flag&#123;easy_easy_crypto&#125;"        k = "3124"        c = shift_encrypt(m, k)        print(c)    prints::        lafgea&#123;s_eyay_scyprt&#125;o    """</span>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp_c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> l        <span class="token keyword">if</span> i <span class="token operator">+</span> l <span class="token operator">></span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_m <span class="token operator">=</span> m<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_m <span class="token operator">=</span> m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> l<span class="token punctuation">]</span>        <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_c<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmp_m<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span>        c <span class="token operator">+=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span>    <span class="token keyword">return</span> c<span class="token keyword">def</span> <span class="token function">shift_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Shift cipher decryption function    Example::        c = 'lafgea&#123;s_eyay_scyprt&#125;o'        k = "3124"        print(shift_decrypt(c, k))    prints::        flag&#123;easy_easy_crypto&#125;    """</span>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp_m <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> l        <span class="token keyword">if</span> i <span class="token operator">+</span> l <span class="token operator">></span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_c <span class="token operator">=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>            use <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                use<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            use<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp_m<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span> <span class="token operator">=</span> tmp_c<span class="token punctuation">[</span>use<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_c <span class="token operator">=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> l<span class="token punctuation">]</span>            <span class="token keyword">for</span> kindex <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                tmp_m<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span> <span class="token operator">=</span> tmp_c<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span>kindex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>        m <span class="token operator">+=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token keyword">def</span> <span class="token function">c01248_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    01248(yunying) cipher decryption function    Example::        c = "8842101220480224404014224202480122"        print(c01248_decode(c))    prints::        welldone    """</span>    l <span class="token operator">=</span> c<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span>    origin <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>        tmp <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> num <span class="token keyword">in</span> i<span class="token punctuation">:</span>            tmp <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>        r <span class="token operator">+=</span> origin<span class="token punctuation">[</span>tmp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">zhalan_encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    zhalan cipher encryption function    Example::        m = "flag&#123;zhalan_mima_hahaha&#125;"        k = 4        c = zhalan_encrypt(m, k)        print(c)    prints::        f&#123;lm_alzaihhahnmaaga_ah&#125;    """</span>    chip <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">+</span> k <span class="token operator">>=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_m <span class="token operator">=</span> m<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_m <span class="token operator">=</span> m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> k<span class="token punctuation">]</span>        chip<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> tmp_m <span class="token keyword">in</span> chip<span class="token punctuation">:</span>            <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tmp_m<span class="token punctuation">)</span><span class="token punctuation">:</span>                c <span class="token operator">+=</span> tmp_m<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> c<span class="token keyword">def</span> <span class="token function">zhalan_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    zhalan cipher decryption function    Example::        c = "f&#123;lm_alzaihhahnmaaga_ah&#125;"        k = 4        m = zhalan_encrypt(m, k)        print(m)    prints::        flag&#123;zhalan_mima_hahaha&#125;    """</span>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>    partnum <span class="token operator">=</span> l <span class="token operator">//</span> k    <span class="token keyword">if</span> l <span class="token operator">%</span> k <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>        partnum <span class="token operator">+=</span> <span class="token number">1</span>    m <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> l    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> partnum<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">+</span> partnum <span class="token operator">>=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp_c <span class="token operator">=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tmp_c <span class="token operator">=</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> partnum<span class="token punctuation">]</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            m<span class="token punctuation">[</span>j <span class="token operator">*</span> k <span class="token operator">+</span> i <span class="token operator">//</span> partnum<span class="token punctuation">]</span> <span class="token operator">=</span> tmp_c<span class="token punctuation">[</span>j<span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">variation_zhalan_decode</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    a variation of zhalan cipher decryption function    Example::        string = "NxC_GWj&#125;e&#123;1ohUJn$i0i1?p@oiHz?"        key = 3        m = variation_zhalan_decode(string, key)        print(m)    prints::        Nep&#123;x1@oChoU_JinG$HiW0zij1??&#125;    """</span>    de_key <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> key <span class="token operator">-</span> <span class="token number">2</span>    length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token operator">//</span> de_key    r <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token operator">%</span> de_key    delist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>        delist<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token comment"># 确定第一个分组</span>    <span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        delist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> string<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>length<span class="token punctuation">]</span>        s <span class="token operator">=</span> length    <span class="token keyword">else</span><span class="token punctuation">:</span>        delist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> string<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>        s <span class="token operator">=</span> length <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> key <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        l <span class="token operator">=</span> length <span class="token operator">*</span> <span class="token number">2</span>        <span class="token keyword">if</span> r <span class="token operator">></span> i<span class="token punctuation">:</span>            l <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">if</span> r <span class="token operator">></span> de_key <span class="token operator">-</span> i<span class="token punctuation">:</span>            l <span class="token operator">+=</span> <span class="token number">1</span>        delist<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> string<span class="token punctuation">[</span>s<span class="token punctuation">:</span>s <span class="token operator">+</span> l<span class="token punctuation">]</span>        s <span class="token operator">=</span> s <span class="token operator">+</span> l    delist<span class="token punctuation">[</span>key <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> string<span class="token punctuation">[</span>s<span class="token punctuation">:</span><span class="token punctuation">]</span>    destr <span class="token operator">=</span> <span class="token string">''</span>    j <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        destr <span class="token operator">+=</span> delist<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        delist<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> delist<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> j <span class="token operator">==</span> key <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">if</span> flag<span class="token punctuation">:</span>            j <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            j <span class="token operator">-=</span> <span class="token number">1</span>    <span class="token keyword">return</span> destr<span class="token keyword">def</span> <span class="token function">caesar_encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Caesar cipher encryption function    Example::        m = "flag&#123;kaisamima&#125;"        k = 3        c = caesar_encrypt(m, k)        print(c)    prints::        iodj~ndlvdplpd    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">caesar_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Caesar cipher decryption function    Example::        c = "iodj~ndlvdplpd"        k = 3        m = caesar_decrypt(c, k)        print(m)    prints::        iodj~ndlvdplpd    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">caesar_brute</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> match_str<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Caesar brute function    Example::        c = "39.4H/?BA2,0.2@.?J"        print(caesar_brute(c, "flag&#123;"))    prints::        i['flag&#123;kaisamima&#125;']    """</span>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> caesar_decrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">)</span>        <span class="token keyword">if</span> match_str <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    <span class="token keyword">return</span> result<span class="token keyword">def</span> <span class="token function">rot13</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    rot13 decryption/encryption function    Example::        c = "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824"        print(rot13(c))        print(rot13(rot13(c)))    prints::        2ps24qon5so0n30r26r83o2np5o9r29r1o161r5p1sn7425r73043362938o9824        2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">atabsh_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    atabsh encryption/decryption function    Example::        m = "flag&#123;ok_atabsh_flag&#125;"        c = atabsh_encode(m)        print(c)        print(atabsh_encode(c))    prints::        flag&#123;ok_atabsh_flag&#125;        uozt&#123;lp_zgzyhs_uozt&#125;    """</span>    alphabet <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    Origin <span class="token operator">=</span> alphabet <span class="token operator">+</span> alphabet<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    TH_A <span class="token operator">=</span> alphabet<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    TH_a <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    TH <span class="token operator">=</span> TH_A <span class="token operator">+</span> TH_a    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        tmp <span class="token operator">=</span> Origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token keyword">if</span> tmp <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> TH<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">substitution_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    substitution encryption function    Example::        m = "flag&#123;good_good_study&#125;"        k = "zugxjitlrkywdhfbnvosepmacq"        c = substitution_encode(m, k)        print(c)    prints::        iwzt&#123;tffx_tffx_osexc&#125;    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> k<span class="token punctuation">[</span>origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">substitution_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    substitution decryption function    Example::        c = "iwzt&#123;tffx_tffx_osexc&#125;"        k = "zugxjitlrkywdhfbnvosepmacq"        m = substitution_decode(m, k)        print(m)    prints::        flag&#123;good_good_study&#125;    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">if</span> k<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> origin<span class="token punctuation">[</span>k<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">affine_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    affine encryption function    Example::        m = "affinecipher"        a = 5        b = 8        c = affine_encode(m, a, b)        print(c)    prints::        ihhwvcswfrcp    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> origin<span class="token punctuation">[</span><span class="token punctuation">(</span>a <span class="token operator">*</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">affine_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    affine decryption function    Example::        c = "ihhwvcswfrcp"        a = 5        b = 8        m = affine_decode(c, a, b)        print(c)    prints::        affinecipher    """</span>    r <span class="token operator">=</span> <span class="token string">""</span>    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>    ai <span class="token operator">=</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        <span class="token keyword">if</span> origin<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> origin<span class="token punctuation">[</span><span class="token punctuation">(</span>ai <span class="token operator">*</span> <span class="token punctuation">(</span>origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            r <span class="token operator">+=</span> i    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">affine_guessab</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> m2<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    affine brute function -> guess a and b    Example::        print(affine_guessab('a', 'i', 'f', 'h'))    prints::        (mpz(5), mpz(8))    """</span>    x1 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>    x2 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>m2<span class="token punctuation">)</span>    y1 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c1<span class="token punctuation">)</span>    y2 <span class="token operator">=</span> origin<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c2<span class="token punctuation">)</span>    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>    dxi <span class="token operator">=</span> invert<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">if</span> x1 <span class="token operator">-</span> x2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        dxi <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span>    a <span class="token operator">=</span> dxi <span class="token operator">*</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> y2<span class="token punctuation">)</span> <span class="token operator">%</span> n    b <span class="token operator">=</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> a <span class="token operator">*</span> x1<span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gen_cheese_map</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> use_Q<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> upper<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    get chess function    Example::        print(gen_cheese_map("helloword"))    prints::        ['HELOW', 'RDABC', 'FGIKM', 'NPQST', 'UVXYZ']    """</span>    k <span class="token operator">=</span> k<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    k0 <span class="token operator">=</span> <span class="token string">""</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> k<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">for</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> k0<span class="token punctuation">:</span>            k0 <span class="token operator">+=</span> i    <span class="token keyword">if</span> use_Q <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> k0<span class="token punctuation">[</span>k0<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> upper <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        k0 <span class="token operator">=</span> k0<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">25</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k0<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">:</span>i <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">_playfair_2char</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    find char of playfair map while encoding    """</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                ai <span class="token operator">=</span> i                aj <span class="token operator">=</span> j            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                bi <span class="token operator">=</span> i                bj <span class="token operator">=</span> j    <span class="token keyword">if</span> ai <span class="token operator">==</span> bi<span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        bxi <span class="token operator">=</span> bi        axj <span class="token operator">=</span> <span class="token punctuation">(</span>aj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxj <span class="token operator">=</span> <span class="token punctuation">(</span>bj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">elif</span> aj <span class="token operator">==</span> bj<span class="token punctuation">:</span>        axj <span class="token operator">=</span> aj        bxj <span class="token operator">=</span> bj        axi <span class="token operator">=</span> <span class="token punctuation">(</span>ai <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxi <span class="token operator">=</span> <span class="token punctuation">(</span>bi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        axj <span class="token operator">=</span> bj        bxi <span class="token operator">=</span> bi        bxj <span class="token operator">=</span> aj    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">[</span>axi<span class="token punctuation">]</span><span class="token punctuation">[</span>axj<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">map</span><span class="token punctuation">[</span>bxi<span class="token punctuation">]</span><span class="token punctuation">[</span>bxj<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">playfair_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    playfair encryption function    Example::        m = "Hide the gold in the tree stump"        k = "playfairexample"        c = playfair_encode(m, k)        print(c)    prints::        ['BM', 'OD', 'ZB', 'XD', 'NA', 'BE', 'KU', 'DM', 'UI', 'XM', 'MO', 'UV', 'IF']    """</span>    m <span class="token operator">=</span> m<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    origin <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    tmp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">in</span> origin<span class="token punctuation">:</span>            tmp <span class="token operator">+=</span> i    m <span class="token operator">=</span> tmp    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    m0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    idx <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> m<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">2</span>        <span class="token keyword">elif</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"X"</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"X"</span><span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>            idx <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">if</span> idx <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"X"</span><span class="token punctuation">:</span>                m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"X"</span><span class="token punctuation">)</span>                idx <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                m0<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> m0<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_playfair_2char<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">_playfair_2char_decode</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    find char of playfair map while decoding    """</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                ai <span class="token operator">=</span> i                aj <span class="token operator">=</span> j            <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                bi <span class="token operator">=</span> i                bj <span class="token operator">=</span> j    <span class="token keyword">if</span> ai <span class="token operator">==</span> bi<span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        bxi <span class="token operator">=</span> bi        axj <span class="token operator">=</span> <span class="token punctuation">(</span>aj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxj <span class="token operator">=</span> <span class="token punctuation">(</span>bj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">elif</span> aj <span class="token operator">==</span> bj<span class="token punctuation">:</span>        axj <span class="token operator">=</span> aj        bxj <span class="token operator">=</span> bj        axi <span class="token operator">=</span> <span class="token punctuation">(</span>ai <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>        bxi <span class="token operator">=</span> <span class="token punctuation">(</span>bi <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        axi <span class="token operator">=</span> ai        axj <span class="token operator">=</span> bj        bxi <span class="token operator">=</span> bi        bxj <span class="token operator">=</span> aj    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">[</span>axi<span class="token punctuation">]</span><span class="token punctuation">[</span>axj<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">map</span><span class="token punctuation">[</span>bxi<span class="token punctuation">]</span><span class="token punctuation">[</span>bxj<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">playfair_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    playfair decryption function    Example::        k = "playfairexample"        c = ['BM', 'OD', 'ZB', 'XD', 'NA', 'BE', 'KU', 'DM', 'UI', 'XM', 'MO', 'UV', 'IF']        print(playfair_decode(c, k))    prints::        HIDETHEGOLDINTHETREXESTUMP    """</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>        r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_playfair_2char_decode<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">polybius_encode</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"ADFGX"</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    polybius encryption function    Example::        m = "helloworld"        k = "abcd"        c = polybius_encode(m, k)        print(c)    prints::        ['DF', 'AX', 'FA', 'FA', 'FG', 'XD', 'FG', 'GD', 'FA', 'AG']    """</span>    m <span class="token operator">=</span> m<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> m<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> x<span class="token punctuation">:</span>                    r<span class="token punctuation">.</span>append<span class="token punctuation">(</span>name<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> name<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">polybius_decode</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"ADFGX"</span><span class="token punctuation">,</span> cheese_map<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    polybius decryption function    Example::        k = "abcd"        c = ['DF', 'AX', 'FA', 'FA', 'FG', 'XD', 'FG', 'GD', 'FA', 'AG']        print(polybius_decode(c, k))    prints::        HELLOWORLD    """</span>    <span class="token keyword">assert</span> k <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">or</span> cheese_map <span class="token operator">!=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> cheese_map <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> gen_cheese_map<span class="token punctuation">(</span>k<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token builtin">map</span> <span class="token operator">=</span> cheese_map    r <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> c<span class="token punctuation">:</span>        i <span class="token operator">=</span> name<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        j <span class="token operator">=</span> name<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        r <span class="token operator">+=</span> <span class="token builtin">map</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>    <span class="token keyword">return</span> r<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大雾实验报告(持续更新)</title>
      <link href="2021/040745361.html"/>
      <url>2021/040745361.html</url>
      
        <content type="html"><![CDATA[<h2 id="latex模板"><a href="#latex模板" class="headerlink" title="latex模板"></a>latex模板</h2><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>UTF8<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token keyword">ctexart</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">amsmath</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">amsfonts</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">amssymb</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">ctex</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">gensymb</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">fancyhdr</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">graphicx</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">subfigure</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">float</span><span class="token punctuation">&#125;</span><span class="token function selector">\usepackage</span><span class="token punctuation">&#123;</span><span class="token keyword">geometry</span><span class="token punctuation">&#125;</span><span class="token function selector">\geometry</span><span class="token punctuation">&#123;</span>left=2.5cm,right=2.5cm,headsep=2cm<span class="token punctuation">&#125;</span><span class="token function selector">\pagestyle</span><span class="token punctuation">&#123;</span>fancy<span class="token punctuation">&#125;</span><span class="token function selector">\fancyfoot</span><span class="token punctuation">[</span>C<span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token function selector">\thepage</span><span class="token punctuation">&#125;</span><span class="token function selector">\fancyhead</span><span class="token punctuation">[</span>L<span class="token punctuation">]</span><span class="token punctuation">&#123;</span>11系20级3班<span class="token punctuation">&#125;</span><span class="token function selector">\fancyhead</span><span class="token punctuation">[</span>C<span class="token punctuation">]</span><span class="token punctuation">&#123;</span>    <span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">huge</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\textbf</span><span class="token punctuation">&#123;</span>实<span class="token function selector">\ </span><span class="token function selector">\ </span><span class="token function selector">\ </span>验<span class="token function selector">\ </span><span class="token function selector">\ </span><span class="token function selector">\ </span>报<span class="token function selector">\ </span><span class="token function selector">\ </span><span class="token function selector">\ </span>告<span class="token punctuation">&#125;</span>    <span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">huge</span><span class="token punctuation">&#125;</span><span class="token function selector">\\</span>    <span class="token function selector">\vspace</span><span class="token punctuation">&#123;</span>0.4cm<span class="token punctuation">&#125;</span>    Phoenix XXXXXXX<span class="token punctuation">&#125;</span><span class="token function selector">\fancyhead</span><span class="token punctuation">[</span>R<span class="token punctuation">]</span><span class="token punctuation">&#123;</span>2021年4月2日<span class="token punctuation">&#125;</span><span class="token function selector">\ctexset</span><span class="token punctuation">&#123;</span>    section=<span class="token punctuation">&#123;</span>        format+ = <span class="token function selector">\zihao</span><span class="token punctuation">&#123;</span>4<span class="token punctuation">&#125;</span> <span class="token function selector">\raggedright</span>,        number = <span class="token function selector">\chinese</span><span class="token punctuation">&#123;</span>section<span class="token punctuation">&#125;</span>,        name = <span class="token punctuation">&#123;</span>,、<span class="token punctuation">&#125;</span>,        aftername = <span class="token function selector">\hspace</span><span class="token punctuation">&#123;</span>2pt<span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function selector">\begin</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">实验题目</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">实验目的</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">实验原理</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">实验器材</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">实验设计</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">测量记录</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">分析与讨论</span><span class="token punctuation">&#125;</span>        <span class="token function selector">\subsection</span><span class="token punctuation">&#123;</span><span class="token headline class-name">数据处理</span><span class="token punctuation">&#125;</span>        <span class="token function selector">\subsection</span><span class="token punctuation">&#123;</span><span class="token headline class-name">误差分析</span><span class="token punctuation">&#125;</span>        <span class="token function selector">\subsection</span><span class="token punctuation">&#123;</span><span class="token headline class-name">实验讨论</span><span class="token punctuation">&#125;</span>    <span class="token function selector">\section</span><span class="token punctuation">&#123;</span><span class="token headline class-name">思考题</span><span class="token punctuation">&#125;</span><span class="token function selector">\end</span><span class="token punctuation">&#123;</span><span class="token keyword">document</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="单摆法测重力加速度"><a href="#单摆法测重力加速度" class="headerlink" title="单摆法测重力加速度"></a>单摆法测重力加速度</h2><p><img src="https://i.loli.net/2021/04/07/C52hZBsL1IUFqXS.png" alt="1.png"></p><h2 id="自由落体法测重力加速度"><a href="#自由落体法测重力加速度" class="headerlink" title="自由落体法测重力加速度"></a>自由落体法测重力加速度</h2><p><img src="https://i.loli.net/2021/04/07/OCdMnyVgXB69Eis.png" alt="2.png"></p>]]></content>
      
      
      <categories>
          
          <category> 大雾 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 实验报告 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>个人博客搭建指南</title>
      <link href="2021/04052690.html"/>
      <url>2021/04052690.html</url>
      
        <content type="html"><![CDATA[<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>折腾了一天半，这个个人博客也算大致搭建起来了，还是希望自己能坚持下去。</p><p>首先这个博客的整体搭建是参考这篇文章：<a href="https://godweiyang.com/2018/04/13/hexo-blog/">https://godweiyang.com/2018/04/13/hexo-blog/</a></p><p>前面的内容基本没问题，后面的个性化主题设置不建议看，因为很多都过时了。</p><p>这里讲几个注意点：</p><p>1.Node.js不要下最新版会有一些问题，最好下稳定版。</p><p>2.如果只是想搭个个人博客的话，域名不一定要买。</p><p>3.关于主题，下面详述（我只放我亲测过的东西）。</p><h1 id="Matery主题"><a href="#Matery主题" class="headerlink" title="Matery主题"></a>Matery主题</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>当你看到这里的时候，应该已经有一个自己的 <a href="https://hexo.io/zh-cn/">Hexo</a> 博客了。如果还没有的话，不妨使用 Hexo 和 <a href="https://www.appinn.com/markdown/">Markdown</a> 来写博客和文章。</p><p>点击 <a href="https://codeload.github.com/blinkfox/hexo-theme-matery/zip/master">这里</a> 下载 <code>master</code> 分支的最新稳定版的代码，解压缩后，将 <code>hexo-theme-matery</code> 的文件夹复制到你 Hexo 的 <code>themes</code> 文件夹中即可。</p><p>当然你也可以在你的 <code>themes</code> 文件夹下使用 <code>Git clone</code> 命令来下载:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/blinkfox/hexo-theme-matery.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="切换主题"><a href="#切换主题" class="headerlink" title="切换主题"></a>切换主题</h3><p>修改 Hexo 根目录下的 <code>_config.yml</code> 的 <code>theme</code> 的值：<code>theme: hexo-theme-matery</code></p><h4 id="config-yml-文件的其它修改建议"><a href="#config-yml-文件的其它修改建议" class="headerlink" title="_config.yml 文件的其它修改建议:"></a><code>_config.yml</code> 文件的其它修改建议:</h4><ul><li>请修改 <code>_config.yml</code> 的 <code>url</code> 的值为你的网站主 <code>URL</code>（如：<code>http://xxx.github.io</code>）。</li><li>建议修改两个 <code>per_page</code> 的分页条数值为 <code>6</code> 的倍数，如：<code>12</code>、<code>18</code> 等，这样文章列表在各个屏幕下都能较好的显示。</li><li>如果你是中文用户，则建议修改 <code>language</code> 的值为 <code>zh-CN</code>。</li></ul><h3 id="新建分类-categories-页"><a href="#新建分类-categories-页" class="headerlink" title="新建分类 categories 页"></a>新建分类 categories 页</h3><p><code>categories</code> 页是用来展示所有分类的页面，如果在你的博客 <code>source</code> 目录下还没有 <code>categories/index.md</code> 文件，那么你就需要新建一个，命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo new page <span class="token string">"categories"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编辑你刚刚新建的页面文件 <code>/source/categories/index.md</code>，至少需要以下内容：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> categories<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-04-03 19:00:00</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"categories"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"categories"</span><span class="token punctuation">---</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="新建标签-tags-页"><a href="#新建标签-tags-页" class="headerlink" title="新建标签 tags 页"></a>新建标签 tags 页</h3><p><code>tags</code> 页是用来展示所有标签的页面，如果在你的博客 <code>source</code> 目录下还没有 <code>tags/index.md</code> 文件，那么你就需要新建一个，命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo new page <span class="token string">"tags"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编辑你刚刚新建的页面文件 <code>/source/tags/index.md</code>，至少需要以下内容：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> tags<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-04-03 19:00:00</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"tags"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"tags"</span><span class="token punctuation">---</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="新建关于我-about-页"><a href="#新建关于我-about-页" class="headerlink" title="新建关于我 about 页"></a>新建关于我 about 页</h3><p><code>about</code> 页是用来展示<strong>关于我和我的博客</strong>信息的页面，如果在你的博客 <code>source</code> 目录下还没有 <code>about/index.md</code> 文件，那么你就需要新建一个，命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo new page <span class="token string">"about"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编辑你刚刚新建的页面文件 <code>/source/about/index.md</code>，至少需要以下内容：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> about<span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-04-03 19:00:00</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"about"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"about"</span><span class="token punctuation">---</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="新建-404-页"><a href="#新建-404-页" class="headerlink" title="新建 404 页"></a>新建 404 页</h3><p>如果在你的博客 <code>source</code> 目录下还没有 <code>404.md</code> 文件，那么你就需要新建一个</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo new page <span class="token number">404</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编辑你刚刚新建的页面文件 <code>/source/404/index.md</code>，至少需要以下内容：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token number">404</span><span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-04-03 19:00:00</span><span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"404"</span><span class="token key atrule">layout</span><span class="token punctuation">:</span> <span class="token string">"404"</span><span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"Oops～，我崩溃了！找不到你想要的页面 :("</span><span class="token punctuation">---</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="菜单导航配置"><a href="#菜单导航配置" class="headerlink" title="菜单导航配置"></a>菜单导航配置</h3><h4 id="配置基本菜单导航的名称、路径url和图标icon"><a href="#配置基本菜单导航的名称、路径url和图标icon" class="headerlink" title="配置基本菜单导航的名称、路径url和图标icon."></a>配置基本菜单导航的名称、路径url和图标icon.</h4><p>1.菜单导航名称可以是中文也可以是英文(如：<code>Index</code>或<code>主页</code>)<br>2.图标icon 可以在<a href="https://fontawesome.com/icons">Font Awesome</a> 中查找   </p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">menu</span><span class="token punctuation">:</span>  <span class="token key atrule">Index</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>home  <span class="token key atrule">Tags</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /tags    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>tags  <span class="token key atrule">Categories</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /categories    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>bookmark  <span class="token key atrule">Archives</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /archives    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>archive  <span class="token key atrule">About</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /about    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>user<span class="token punctuation">-</span>circle  <span class="token key atrule">Friends</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /friends    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>address<span class="token punctuation">-</span>book<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="二级菜单配置方法"><a href="#二级菜单配置方法" class="headerlink" title="二级菜单配置方法"></a>二级菜单配置方法</h4><p>如果你需要二级菜单则可以在原基本菜单导航的基础上如下操作</p><ol><li>在需要添加二级菜单的一级菜单下添加<code>children</code>关键字(如:<code>About</code>菜单下添加<code>children</code>)     </li><li>在<code>children</code>下创建二级菜单的 名称name,路径url和图标icon.      </li><li>注意每个二级菜单模块前要加 <code>-</code>.     </li><li>注意缩进格式  </li></ol><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">menu</span><span class="token punctuation">:</span>  <span class="token key atrule">Index</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>home  <span class="token key atrule">Tags</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /tags    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>tags  <span class="token key atrule">Categories</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /categories    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>bookmark  <span class="token key atrule">Archives</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /archives    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>archive  <span class="token key atrule">About</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /about    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>user<span class="token punctuation">-</span>circle<span class="token punctuation">-</span>o  <span class="token key atrule">Friends</span><span class="token punctuation">:</span>    <span class="token key atrule">url</span><span class="token punctuation">:</span> /friends    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>address<span class="token punctuation">-</span>book  <span class="token key atrule">Medias</span><span class="token punctuation">:</span>    <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>list    <span class="token key atrule">children</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Music        <span class="token key atrule">url</span><span class="token punctuation">:</span> /music        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>music      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Movies        <span class="token key atrule">url</span><span class="token punctuation">:</span> /movies        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>film      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Books        <span class="token key atrule">url</span><span class="token punctuation">:</span> /books        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>book      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Galleries        <span class="token key atrule">url</span><span class="token punctuation">:</span> /galleries        <span class="token key atrule">icon</span><span class="token punctuation">:</span> fas fa<span class="token punctuation">-</span>image<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>执行 <code>hexo clean &amp;&amp; hexo g</code> 重新生成博客文件，然后就可以在文章中对应位置看到你用<code>emoji</code>语法写的表情了。</p><h3 id="代码高亮"><a href="#代码高亮" class="headerlink" title="代码高亮"></a>代码高亮</h3><p>从 Hexo5.0 版本开始自带了 <code>prismjs</code> 代码语法高亮的支持，本主题对此进行了改造支持。</p><p>如果你的博客中曾经安装过 <code>hexo-prism-plugin</code> 的插件，那么你须要执行 <code>npm uninstall hexo-prism-plugin</code> 来卸载掉它，否则生成的代码中会有 <code>&amp;#123;</code> 和 <code>&amp;#125;</code> 的转义字符。</p><p>然后，修改 Hexo 根目录下 <code>_config.yml</code> 文件中 <code>highlight.enable</code> 的值为 <code>false</code>，并将 <code>prismjs.enable</code> 的值设置为 <code>true</code>，主要配置如下：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">auto_detect</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span>  <span class="token key atrule">wrap</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">hljs</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">prismjs</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">preprocess</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">tab_replace</span><span class="token punctuation">:</span> <span class="token string">''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>主题中默认的 <code>prismjs</code> 主题是 <code>Tomorrow Night</code>，如果你想定制自己的主题，可以前往 <a href="https://prismjs.com/download.html">prismjs 下载页面</a> 定制下载自己喜欢的主题 <code>css</code> 文件，然后将此 css 主题文件取名为 <code>prism.css</code>，替换掉 <code>hexo-theme-matery</code> 主题文件夹中的 <code>source/libs/prism/prism.css</code> 文件即可。</p><p>注意按照以上步骤只能支持部分语言的代码高亮，建议在刚才那个下载界面勾选自己所需的语言，下载js文件，将prism.js放到<code>hexo-theme-matery</code> 主题文件夹中的 <code>source/js</code> 中，再在<code>source/layout/layout.ejs</code>文件中加上一段代码即可。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"/js/prism.js"</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><p>本主题中还使用到了 <a href="https://github.com/wzpan/hexo-generator-search">hexo-generator-search</a> 的 Hexo 插件来做内容搜索，安装命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-search --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在 Hexo 根目录下的 <code>_config.yml</code> 文件中，新增以下的配置项：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">search</span><span class="token punctuation">:</span>  <span class="token key atrule">path</span><span class="token punctuation">:</span> search.xml  <span class="token key atrule">field</span><span class="token punctuation">:</span> post<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="中文链接转拼音（可选的）"><a href="#中文链接转拼音（可选的）" class="headerlink" title="中文链接转拼音（可选的）"></a>中文链接转拼音（可选的）</h3><p>如果你的文章名称是中文的，那么 Hexo 默认生成的永久链接也会有中文，这样不利于 <code>SEO</code>，且 <code>gitment</code> 评论对中文链接也不支持。我们可以用 <a href="https://github.com/viko16/hexo-permalink-pinyin">hexo-permalink-pinyin</a> Hexo 插件使在生成文章时生成中文拼音的永久链接。</p><p>安装命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> i hexo-permalink-pinyin --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在 Hexo 根目录下的 <code>_config.yml</code> 文件中，新增以下的配置项：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">permalink_pinyin</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">separator</span><span class="token punctuation">:</span> <span class="token string">'-'</span> <span class="token comment"># default: '-'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>注</strong>：除了此插件外，<a href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a> 插件也可以生成非中文的链接。</p></blockquote><h3 id="文章字数统计插件（可选的）"><a href="#文章字数统计插件（可选的）" class="headerlink" title="文章字数统计插件（可选的）"></a>文章字数统计插件（可选的）</h3><p>如果你想要在文章中显示文章字数、阅读时长信息，可以安装 <a href="https://github.com/willin/hexo-wordcount">hexo-wordcount</a>插件。</p><p>安装命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> i --save hexo-wordcount<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后只需在本主题下的 <code>_config.yml</code> 文件中，激活以下配置项即可：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">wordCount</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 将这个值设置为 true 即可.</span>  <span class="token key atrule">postWordCount</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">min2read</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">totalCount</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="添加-RSS-订阅支持（可选的）"><a href="#添加-RSS-订阅支持（可选的）" class="headerlink" title="添加 RSS 订阅支持（可选的）"></a>添加 RSS 订阅支持（可选的）</h3><p>本主题中还使用到了 <a href="https://github.com/hexojs/hexo-generator-feed">hexo-generator-feed</a> 的 Hexo 插件来做 <code>RSS</code>，安装命令如下：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-feed --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在 Hexo 根目录下的 <code>_config.yml</code> 文件中，新增以下的配置项：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">feed</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> atom  <span class="token key atrule">path</span><span class="token punctuation">:</span> atom.xml  <span class="token key atrule">limit</span><span class="token punctuation">:</span> <span class="token number">20</span>  <span class="token key atrule">hub</span><span class="token punctuation">:</span>  <span class="token key atrule">content</span><span class="token punctuation">:</span>  <span class="token key atrule">content_limit</span><span class="token punctuation">:</span> <span class="token number">140</span>  <span class="token key atrule">content_limit_delim</span><span class="token punctuation">:</span> <span class="token string">' '</span>  <span class="token key atrule">order_by</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>date<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>执行 <code>hexo clean &amp;&amp; hexo g</code> 重新生成博客文件，然后在 <code>public</code> 文件夹中即可看到 <code>atom.xml</code> 文件，说明你已经安装成功了。</p><h3 id="修改页脚"><a href="#修改页脚" class="headerlink" title="修改页脚"></a>修改页脚</h3><p>页脚信息可能需要做定制化修改，而且它不便于做成配置信息，所以可能需要你自己去再修改和加工。修改的地方在主题文件的 <code>/layout/_partial/footer.ejs</code> 文件中，包括站点、使用的主题、访问量等。</p><h3 id="修改社交链接"><a href="#修改社交链接" class="headerlink" title="修改社交链接"></a>修改社交链接</h3><p>在主题的 <code>_config.yml</code> 文件中，默认支持 <code>QQ</code>、<code>GitHub</code> 和邮箱的配置，你可以在主题文件的 <code>/layout/_partial/social-link.ejs</code> 文件中，新增、修改你需要的社交链接地址，增加链接可参考如下代码：</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://github.com/blinkfox<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tooltipped<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token attr-name">data-tooltip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>访问我的GitHub<span class="token punctuation">"</span></span> <span class="token attr-name">data-position</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>top<span class="token punctuation">"</span></span> <span class="token attr-name">data-delay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fa fa-github<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>其中，社交图标（如：<code>fa-github</code>）你可以在 <a href="https://fontawesome.com/icons">Font Awesome</a> 中搜索找到。以下是常用社交图标的标识，供你参考：</p><ul><li>Facebook: <code>fa-facebook</code></li><li>Twitter: <code>fa-twitter</code></li><li>Google-plus: <code>fa-google-plus</code></li><li>Linkedin: <code>fa-linkedin</code></li><li>Tumblr: <code>fa-tumblr</code></li><li>Medium: <code>fa-medium</code></li><li>Slack: <code>fa-slack</code></li><li>新浪微博: <code>fa-weibo</code></li><li>微信: <code>fa-wechat</code></li><li>QQ: <code>fa-qq</code></li></ul><blockquote><p><strong>注意</strong>: 本主题中使用的 <code>Font Awesome</code> 版本为 <code>4.7.0</code>。</p></blockquote><h3 id="修改打赏的二维码图片"><a href="#修改打赏的二维码图片" class="headerlink" title="修改打赏的二维码图片"></a>修改打赏的二维码图片</h3><p>在主题文件的 <code>source/medias/reward</code> 文件中，你可以替换成你的的微信和支付宝的打赏二维码图片。</p><h3 id="配置音乐播放器（可选的）"><a href="#配置音乐播放器（可选的）" class="headerlink" title="配置音乐播放器（可选的）"></a>配置音乐播放器（可选的）</h3><p>要支持音乐播放，就必须开启音乐的播放配置和音乐数据的文件。</p><p>首先，在你的博客 <code>source</code> 目录下的 <code>_data</code> 目录（没有的话就新建一个）中新建 <code>musics.json</code> 文件，文件内容如下所示：</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"五月雨变奏电音"</span><span class="token punctuation">,</span>    <span class="token property">"artist"</span><span class="token operator">:</span> <span class="token string">"AnimeVibe"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://xxx.com/music1.mp3"</span><span class="token punctuation">,</span>    <span class="token property">"cover"</span><span class="token operator">:</span> <span class="token string">"http://xxx.com/music-cover1.png"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Take me hand"</span><span class="token punctuation">,</span>    <span class="token property">"artist"</span><span class="token operator">:</span> <span class="token string">"DAISHI DANCE,Cecile Corbel"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"/medias/music/music2.mp3"</span><span class="token punctuation">,</span>    <span class="token property">"cover"</span><span class="token operator">:</span> <span class="token string">"/medias/music/cover2.png"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Shape of You"</span><span class="token punctuation">,</span>    <span class="token property">"artist"</span><span class="token operator">:</span> <span class="token string">"J.Fla"</span><span class="token punctuation">,</span>    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://xxx.com/music3.mp3"</span><span class="token punctuation">,</span>    <span class="token property">"cover"</span><span class="token operator">:</span> <span class="token string">"http://xxx.com/music-cover3.png"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>注</strong>：以上 JSON 中的属性：<code>name</code>、<code>artist</code>、<code>url</code>、<code>cover</code> 分别表示音乐的名称、作者、音乐文件地址、音乐封面。</p></blockquote><p>然后，在主题的 <code>_config.yml</code> 配置文件中激活配置即可：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># 是否在首页显示音乐.</span><span class="token key atrule">music</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">showTitle</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token key atrule">title</span><span class="token punctuation">:</span> 听听音乐  <span class="token key atrule">fixed</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 是否开启吸底模式</span>  <span class="token key atrule">autoplay</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 是否自动播放</span>  <span class="token key atrule">theme</span><span class="token punctuation">:</span> <span class="token string">'#42b983'</span>  <span class="token key atrule">loop</span><span class="token punctuation">:</span> <span class="token string">'all'</span> <span class="token comment"># 音频循环播放, 可选值: 'all', 'one', 'none'</span>  <span class="token key atrule">order</span><span class="token punctuation">:</span> <span class="token string">'list'</span> <span class="token comment"># 音频循环顺序, 可选值: 'list', 'random'</span>  <span class="token key atrule">preload</span><span class="token punctuation">:</span> <span class="token string">'auto'</span> <span class="token comment"># 预加载，可选值: 'none', 'metadata', 'auto'</span>  <span class="token key atrule">volume</span><span class="token punctuation">:</span> <span class="token number">0.7</span> <span class="token comment"># 默认音量，请注意播放器会记忆用户设置，用户手动设置音量后默认音量即失效</span>  <span class="token key atrule">listFolded</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 列表默认折叠</span>  <span class="token key atrule">listMaxHeight</span><span class="token punctuation">:</span> <span class="token comment"># 列表最大高度</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="文章-Front-matter-介绍"><a href="#文章-Front-matter-介绍" class="headerlink" title="文章 Front-matter 介绍"></a>文章 Front-matter 介绍</h2><h3 id="Front-matter-选项详解"><a href="#Front-matter-选项详解" class="headerlink" title="Front-matter 选项详解"></a>Front-matter 选项详解</h3><p><code>Front-matter</code> 选项中的所有内容均为<strong>非必填</strong>的。但我仍然建议至少填写 <code>title</code> 和 <code>date</code> 的值。</p><table><thead><tr><th align="left">配置选项</th><th align="left">默认值</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">title</td><td align="left"><code>Markdown</code> 的文件标题</td><td align="left">文章标题，强烈建议填写此选项</td></tr><tr><td align="left">date</td><td align="left">文件创建时的日期时间</td><td align="left">发布时间，强烈建议填写此选项，且最好保证全局唯一</td></tr><tr><td align="left">author</td><td align="left">根 <code>_config.yml</code> 中的 <code>author</code></td><td align="left">文章作者</td></tr><tr><td align="left">img</td><td align="left"><code>featureImages</code> 中的某个值</td><td align="left">文章特征图，推荐使用图床(腾讯云、七牛云、又拍云等)来做图片的路径.如: <code>http://xxx.com/xxx.jpg</code></td></tr><tr><td align="left">top</td><td align="left"><code>true</code></td><td align="left">推荐文章（文章是否置顶），如果 <code>top</code> 值为 <code>true</code>，则会作为首页推荐文章</td></tr><tr><td align="left">cover</td><td align="left"><code>false</code></td><td align="left"><code>v1.0.2</code>版本新增，表示该文章是否需要加入到首页轮播封面中</td></tr><tr><td align="left">coverImg</td><td align="left">无</td><td align="left"><code>v1.0.2</code>版本新增，表示该文章在首页轮播封面需要显示的图片路径，如果没有，则默认使用文章的特色图片</td></tr><tr><td align="left">password</td><td align="left">无</td><td align="left">文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 <code>password</code> 的值，该值必须是用 <code>SHA256</code> 加密后的密码，防止被他人识破。前提是在主题的 <code>config.yml</code> 中激活了 <code>verifyPassword</code> 选项</td></tr><tr><td align="left">toc</td><td align="left"><code>true</code></td><td align="left">是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 <code>config.yml</code> 中激活了 <code>toc</code> 选项</td></tr><tr><td align="left">mathjax</td><td align="left"><code>false</code></td><td align="left">是否开启数学公式支持 ，本文章是否开启 <code>mathjax</code>，且需要在主题的 <code>_config.yml</code> 文件中也需要开启才行</td></tr><tr><td align="left">summary</td><td align="left">无</td><td align="left">文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要</td></tr><tr><td align="left">categories</td><td align="left">无</td><td align="left">文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类</td></tr><tr><td align="left">tags</td><td align="left">无</td><td align="left">文章标签，一篇文章可以多个标签</td></tr></tbody></table><blockquote><p><strong>注意</strong>:</p><ol><li>如果 <code>img</code> 属性不填写的话，文章特色图会根据文章标题的 <code>hashcode</code> 的值取余，然后选取主题中对应的特色图片，从而达到让所有文章都的特色图<strong>各有特色</strong>，其中当前路径是主题下的source文件夹，也就是images与medias文件夹同级。</li><li><code>date</code> 的值尽量保证每篇文章是唯一的，因为本主题中 <code>Gitalk</code> 和 <code>Gitment</code> 识别 <code>id</code> 是通过 <code>date</code> 的值来作为唯一标识的。</li><li>如果要对文章设置阅读验证密码的功能，不仅要在 Front-matter 中设置采用了 SHA256 加密的 password 的值，还需要在主题的 <code>_config.yml</code> 中激活了配置。有些在线的 SHA256 加密的地址，可供你使用：<a href="http://tool.oschina.net/encrypt?type=2">开源中国在线工具</a>、<a href="http://encode.chahuo.com/">chahuo</a>、<a href="http://tool.chinaz.com/tools/hash.aspx">站长工具</a>。</li></ol></blockquote><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">---</span><span class="token key atrule">title</span><span class="token punctuation">:</span> c_week4<span class="token key atrule">top</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">cover</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">toc</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">mathjax</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">abbrlink</span><span class="token punctuation">:</span> <span class="token number">38539</span><span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-04-04 20:23:10</span><span class="token key atrule">password</span><span class="token punctuation">:</span><span class="token key atrule">summary</span><span class="token punctuation">:</span><span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'c/c++'</span><span class="token punctuation">]</span><span class="token key atrule">categories</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'程序设计'</span><span class="token punctuation">]</span><span class="token key atrule">img</span><span class="token punctuation">:</span> /images/b.jpg<span class="token punctuation">---</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="个人喜好配置"><a href="#个人喜好配置" class="headerlink" title="个人喜好配置"></a>个人喜好配置</h2><h3 id="修改主题颜色"><a href="#修改主题颜色" class="headerlink" title="修改主题颜色"></a>修改主题颜色</h3><p>在主题文件的 <code>/source/css/matery.css</code> 文件中，搜索 <code>.bg-color</code> 来修改背景颜色：</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 整体背景颜色，包括导航、移动端的导航、页尾、标签页等的背景颜色. */</span><span class="token selector">.bg-color</span> <span class="token punctuation">&#123;</span>    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span> #4cbf30 0%<span class="token punctuation">,</span> #0f9d58 100%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token atrule"><span class="token rule">@-webkit-keyframes</span> rainbow</span> <span class="token punctuation">&#123;</span>   <span class="token comment">/* 动态切换背景颜色. */</span><span class="token punctuation">&#125;</span><span class="token atrule"><span class="token rule">@keyframes</span> rainbow</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* 动态切换背景颜色. */</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="修改-banner-图和文章特色图"><a href="#修改-banner-图和文章特色图" class="headerlink" title="修改 banner 图和文章特色图"></a>修改 banner 图和文章特色图</h3><p>你可以直接在 <code>/source/medias/banner</code> 文件夹中更换你喜欢的 <code>banner</code> 图片，主题代码中是每天动态切换一张，只需 <code>7</code> 张即可。如果你会 <code>JavaScript</code> 代码，可以修改成你自己喜欢切换逻辑，如：随机切换等，<code>banner</code> 切换的代码位置在 <code>/layout/_partial/bg-cover-content.ejs</code> 文件的 <code>&lt;script&gt;&lt;/script&gt;</code> 代码中：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.bg-cover'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background-image'</span><span class="token punctuation">,</span> <span class="token string">'url(/medias/banner/'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.jpg)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在 <code>/source/medias/featureimages</code> 文件夹中默认有 24 张特色图片，你可以再增加或者减少，并需要在 <code>_config.yml</code> 做同步修改。</p><h3 id="取消主题的背景图遮罩颜色"><a href="#取消主题的背景图遮罩颜色" class="headerlink" title="取消主题的背景图遮罩颜色"></a>取消主题的背景图遮罩颜色</h3><p>定位到<code>themes\hexo-theme-matery\source\css</code>中一个叫matery.css文件的大约600行代码，如下：</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.bg-cover:before,.bg-cover:after</span> <span class="token punctuation">&#123;</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>只要将content属性注释掉即可，如下：</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.bg-cover:before,.bg-cover:after</span> <span class="token punctuation">&#123;</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token comment">/* content: ""; */</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="增加看板娘"><a href="#增加看板娘" class="headerlink" title="增加看板娘"></a>增加看板娘</h3><p>在<code>source/layout/layout.ejs</code>文件中加上三行代码即可。</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"</span><span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="樱花特效"><a href="#樱花特效" class="headerlink" title="樱花特效"></a>樱花特效</h3><p>在 <code>themes/matery/source/js</code> 目录下新建 <code>sakura.js</code> 文件，打开这个网址<a href="https://cdn.jsdelivr.net/gh/Yafine/cdn@3.2.7/source/js/sakura.js">传送门</a>，将内容复制粘贴到 sakura.js 即可。</p><p>然后再 <code>themes/matery/layout/layout.ejs</code> 文件内添加1行代码：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"/js/sakura.js"</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="动态标题"><a href="#动态标题" class="headerlink" title="动态标题"></a>动态标题</h3><p>直接在<code>themes/matery/layout/layout.ejs</code>文件中添加如下代码：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span>    <span class="token keyword">var</span> OriginTitile<span class="token operator">=</span>document<span class="token punctuation">.</span>title<span class="token punctuation">,</span>st<span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"visibilitychange"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        document<span class="token punctuation">.</span>hidden<span class="token operator">?</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>title<span class="token operator">=</span><span class="token string">"ヽ(●-`Д´-)ノ你要玩捉迷藏嘛"</span><span class="token punctuation">,</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>title<span class="token operator">=</span><span class="token string">"(Ő∀Ő3)ノ好哦！"</span><span class="token punctuation">,</span>st<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>document<span class="token punctuation">.</span>title<span class="token operator">=</span>OriginTitile<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">3e3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="添加动态诗词"><a href="#添加动态诗词" class="headerlink" title="添加动态诗词"></a>添加动态诗词</h3><p>采用的是今日诗词，每次返回一句诗词，根据时间、地点、天气、事件智能推荐。官网有API文档，可以去看一下，有多种安装方式，最简单的方式就是从官网获取代码，在<code>themes/matery/layout/_partial/head.ejs</code>添加下面的一行代码：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://sdk.jinrishici.com/v2/browser/jinrishici.js"</span> charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后再将<code>themes/matery/layout/_partial/bg-cover-content.ejs</code>中的&lt;%= config.description %&gt;修改为</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;%- '<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jinrishici-sentence<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>正在加载今日诗词....<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>' %><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这个使用前提是将主题配置文件的subtitle的值改为false。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>其实搭建个人博客不必急于求成，个人感受如果能够在摸一遍前端之后再回过头来说不定会发现也就这么回事。网络上其实也并不缺少教程，但是很多教程都过时了，因此还需自己慢慢探索。</p>]]></content>
      
      
      <categories>
          
          <category> 指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 备份 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>c_week4</title>
      <link href="2021/040438539.html"/>
      <url>2021/040438539.html</url>
      
        <content type="html"><![CDATA[<h1 id="程设作业-week-4"><a href="#程设作业-week-4" class="headerlink" title="程设作业(week 4)"></a>程设作业(week 4)</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这可以说是正经发的第一篇博客，就拿程设作业来试试水。其实这是上周作业，但是前两天助教发了一个程序设计规范，我不得不对代码进行重构，sigh！</p><h2 id="A-浮点数的幂"><a href="#A-浮点数的幂" class="headerlink" title="A.浮点数的幂"></a>A.浮点数的幂</h2><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><table><thead><tr><th>Time limit: 10000 ms</th></tr></thead><tbody><tr><td>Memory limit: 256 MB</td></tr><tr><td>Standard I/O</td></tr></tbody></table><p>给定一个 <strong>正浮点数F</strong> 和一个 <strong>正整数n</strong> ，其中：</p><ol><li>F包括小数点固定有“六位”，它会被写成0.1234或 .12300或 00123. 的形式；小数点一定存在，允许前导零、后导零、前导或后导小数点的存在，数值位不会全零。</li><li>n取值范围为1到10（含边界）。<br>求F的n次方的精确值。</li></ol><h4 id="输入描述"><a href="#输入描述" class="headerlink" title="输入描述"></a>输入描述</h4><p>输入有若干行（不给出具体数目），每行依次包含：</p><ol><li>F，占6列；</li><li>一个空格；</li><li>n，占两列，右对齐，数值不足两列（1到9）用空格补充。</li></ol><h4 id="输出描述"><a href="#输出描述" class="headerlink" title="输出描述"></a>输出描述</h4><p>输出包括若干行，每行包括一个F的n次方的精确值，但：</p><ol><li>前导零和后导零应被清除，如012.340应以12.34输出；但0.0123应以.0123输出。</li><li>后导小数点应被清除，如12. 应以12输出；但前导小数点，如 .12，必须保留。</li></ol><p><strong>【数据说明】</strong><br>你将被测试所有的输入组合，祝你好运。<br>这里我们强烈建议你使用C的输入输出函数，特别是逐字符输入输出，而非C++的流输入输出。 <strong>你将被分配每个数据点10s的运行时间。</strong><br>函数：</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">#include&lt;stdio.h&gt;int getchar(void);int putchar(int);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>可以逐字符从stdin读取/向stdout输出字符，一般来讲，它比我们常用的scanf要快。但本题的时限应该足以让你使用scanf通过。</p><p>在未知数据组数时如何依次读取：</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">char str[10];int n;while (scanf(&quot;%s%d&quot;, str, &amp;n) &#x3D;&#x3D; 2)&#123;    solve();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>或者：</p><pre class="line-numbers language-CPP" data-language="CPP"><code class="language-CPP">char ch;while ((ch &#x3D; getchar()) !&#x3D; EOF)&#123;    ......&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>请在 <a href="https://zh.cppreference.com/w/c">https://zh.cppreference.com/w/c</a> 查阅关于scanf或getchar返回值的信息，以及宏定义EOF。对于后一种使用getchar()的代码，小心每行的回车符。</p><h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><pre class="line-numbers language-none"><code class="language-none">6.7592  998.999 1000001.  4.00001  4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h4><pre class="line-numbers language-none"><code class="language-none">29448126.76412102161816443020690903717327667290429072743629540498.1075960194566517745610440100011.00000000000000000001<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h4><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstdio></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring></span></span><span class="token keyword">int</span> cnt_dot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">;</span><span class="token keyword">int</span> num<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cnt_dot <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token operator">++</span>cnt_dot<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// find the decimal place</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> i <span class="token operator">></span> cnt_dot<span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span>        num<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cnt_dot<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        num<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>    cnt_dot <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">-</span> cnt_dot<span class="token punctuation">;</span>    cnt_dot <span class="token operator">*=</span> n<span class="token punctuation">;</span><span class="token comment">// cnt_dot is the decimal places of the final result</span>    ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> ans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ans[0] is the length,store from ans[1]</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// multiply a and b, result is stored in b</span>    <span class="token function">memset</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len_tmp<span class="token punctuation">,</span> len <span class="token operator">=</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    len_tmp <span class="token operator">=</span> len <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>            tmp<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> len_tmp<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//Processing carry</span>        tmp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>        tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">%=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>len_tmp<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> len_tmp <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">--</span>len_tmp<span class="token punctuation">;</span>    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> len_tmp<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> len_tmp<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> exp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// a^exp,the result is stored in ans</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>exp<span class="token operator">--</span><span class="token punctuation">)</span><span class="token function">mul</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> i <span class="token operator">></span> cnt_dot<span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token comment">//print integer part</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>ans<span class="token punctuation">[</span><span class="token operator">++</span>start<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> cnt_dot<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// print decimal part</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> cnt_dot<span class="token punctuation">;</span> i <span class="token operator">>=</span> start<span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s %d"</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">pow</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>这题大致思路是将浮点数的幂转化为高精度乘法，关键是对小数点的处理，以及前缀和后缀的0的输出处理。我并未对这个代码进行任何优化，OJ上跑的时间是13s（毕竟所有数据全输出来也有几十兆）。实际上还是有一些优化思路的，比如说高精压位和快速幂。说到这里就不得不提到课程群里的一些大佬用一些高超的技巧（如FFT(快速傅里叶变换)，手写int128等）对这题进行面向数据（自行体会）编程，最终一位大佬极限的速度是653ms，计科中人竟恐怖如斯！</p><p>为什么代码中会有塑料英语呢，这一点后面会解释。（捂脸）</p><h2 id="B-函数：统计字符串出现次数"><a href="#B-函数：统计字符串出现次数" class="headerlink" title="B.函数：统计字符串出现次数"></a>B.函数：统计字符串出现次数</h2><h4 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h4><p>输出每行出现某字符串的次数 每行最多50个字符。</p><h4 id="输入描述-1"><a href="#输入描述-1" class="headerlink" title="输入描述"></a>输入描述</h4><p>输入n（n&gt;=2）行，第一行为要统计的目标字符串，剩下的n-1行为需要对其进行统计的多行字符串.</p><h4 id="输出描述-1"><a href="#输出描述-1" class="headerlink" title="输出描述"></a>输出描述</h4><p>输出该字符串在每行出现的次数。</p><h4 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h4><pre class="line-numbers language-none"><code class="language-none">ababcabaabab qekgd aba<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h4><pre class="line-numbers language-none"><code class="language-none">23<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h4><pre class="line-numbers language-none"><code class="language-none">aaaaaaaaaaa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h4><pre class="line-numbers language-none"><code class="language-none">34<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstdio></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring></span></span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">,</span> word<span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> len_w <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> all_end <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> line_end <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// read one word</span>    <span class="token keyword">char</span> c<span class="token punctuation">;</span>    len_w <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">' '</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">!=</span> <span class="token string">'\n'</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span>        word<span class="token punctuation">[</span>len_w<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>    word<span class="token punctuation">[</span>len_w<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>line_end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token constant">EOF</span><span class="token punctuation">)</span>line_end <span class="token operator">=</span> all_end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len_s <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>all_end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        line_end <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>line_end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> len_w <span class="token operator">-</span> len_s<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// count the number of occurrences</span>                <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len_s<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>word<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">!=</span> str<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// not the same</span>                        <span class="token keyword">break</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>cnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>all_end<span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> cnt<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h4><p>我为什么会写出这么屑的代码呢，一个是OJ比较屑，gets都用不了，另一个原因是寒假也没碰过c/c++，吃饭的手艺还是不能忘啊。下面放上代码评分规范。</p><h2 id="代码规范评分标准"><a href="#代码规范评分标准" class="headerlink" title="代码规范评分标准"></a>代码规范评分标准</h2><h3 id="总则"><a href="#总则" class="headerlink" title="总则"></a>总则</h3><h4 id="1-1适用范围"><a href="#1-1适用范围" class="headerlink" title="1.1适用范围"></a>1.1适用范围</h4><p>本标准仅适用于C或C++ 语言的编程形式的作业。学生的上机题和大作业等一切编程形式的作业均计入代码规范的考核。</p><h4 id="1-2-分数占比"><a href="#1-2-分数占比" class="headerlink" title="1.2 分数占比"></a>1.2 分数占比</h4><p>学生的代码规范成绩，共占并独占总评的5/100分。</p><h4 id="1-3-计算方法"><a href="#1-3-计算方法" class="headerlink" title="1.3 计算方法"></a>1.3 计算方法</h4><p>1）对代码风格的评价以题目为单位。<br>2）只要有AC提交的题目，不论是否超出该章节的最高满分，均进行考核；未有AC(Accepted)提交的题目，不做评分。<br>（比如，某章上机满分20分，共“A、B、C、D”4题，一题10分；某学生AC过A、C、D题，B题有过提交但没有AC，则他的A、C、D题会进行代码风格的评分）<br>3）对于单个题目的多次AC提交代码，选择代码风格最好的一个，作为该题目的风格得分。<br>学生最后的代码规范成绩，为所有被考核的“题目”的代码风格分平均。学生每个题目的代码风格成绩取0 ~ 5（含边界）的整数，单个题目满分5分，每个细则项可得0或1分；总分为题目得分的平均，满分5分，以精确小数值加入总评的计算。<br>（比如，某学生一学期的题目提交情况与代码风格成绩如下表，空单元格代表未AC：</p><table><thead><tr><th align="center">第一章</th><th></th><th></th><th>第二章</th><th></th><th>第三章</th><th></th><th></th><th></th><th>总分</th></tr></thead><tbody><tr><td align="center">A</td><td>B</td><td>C</td><td>A</td><td>B</td><td>A</td><td>B</td><td>C</td><td>D</td><td></td></tr><tr><td align="center">5</td><td></td><td>4</td><td>3</td><td></td><td>3</td><td>4</td><td></td><td></td><td>3.8</td></tr></tbody></table><p>总分3.8分等于(5+4+3+3+4)÷5，空值不计入平均计算。）</p><h4 id="1-4-评分原则"><a href="#1-4-评分原则" class="headerlink" title="1.4 评分原则"></a>1.4 评分原则</h4><p>为严格要求和引导学生养成良好的编程习惯，同时为成绩评价留有一定的宽松，对每个评分小点，既要严格要求其达到的效果，又对学生的学习过程留有循序渐进的余地；代码风格评判会在严格的评价标准上，结合题目实际，合情合理要求。</p><h3 id="2-评分细则"><a href="#2-评分细则" class="headerlink" title="2.评分细则"></a>2.评分细则</h3><p>关于本细则涉及的语言要求（只能使用英语命名和注释），学生可以从任何程度上借鉴翻译引擎的结果，在保证表意清晰的前提下，允许英语用词和用句的不规范。<br>关于本细则的格式要求，学生可以借鉴IDE等代码编辑器自带的自动格式化工具。</p><h4 id="2-1-缩进、括号、分行与空格（1分）"><a href="#2-1-缩进、括号、分行与空格（1分）" class="headerlink" title="2.1 缩进、括号、分行与空格（1分）"></a>2.1 缩进、括号、分行与空格（1分）</h4><p>以下细则，以学生每部分、每条代码语句的美观性，代码结构的工整性，作为根本评价依据；在每个方面的整体上符合、关键原则上符合、细节上不完全符合，但代码美观性和工整得到保障的，可以得分。<br>对于应当划在本方面的未尽条目，均以美观和工整的要求酌情评判。</p><h5 id="2-1-1-缩进与大括号"><a href="#2-1-1-缩进与大括号" class="headerlink" title="2.1.1 缩进与大括号"></a>2.1.1 缩进与大括号</h5><p>1）学生的代码应以4个空格（或显示为4个字符缩进量的制表符tab）进行缩进。凡是以大括号（{，}）括起的代码块均需缩进。<br>2）分割代码块、函数体、结构体的大括号（{，}），前大括号允许单独分行或紧接块代码之后，二者择一适用；后大括号单独成行。单独分行的前或后大括号自身必须与前一代码块的缩进一致。<br>即，或者使用格式：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"YES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>     <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>或者使用格式：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"YES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"NO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>两种格式在同一代码不得混用。<br>3）if-else分支结构，由于受“最近匹配”原则所可能引起的歧义，只要有if{if-else}else类型的嵌套的，无论下含几条语句，外层均必须使用大括号；switch-case分支结构，case后的处理语句必须缩进，建议添加大括号（下面的例子也可以使用另一种大括号的换行方式）：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span>score <span class="token operator">!=</span> s2<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// this parentheses is critical</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span>score <span class="token operator">></span> s2<span class="token punctuation">.</span>score<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span>id <span class="token operator">!=</span> s2<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// so does this</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span>id <span class="token operator">></span> s2<span class="token punctuation">.</span>id<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">switch</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Other"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-1-2-分行"><a href="#2-1-2-分行" class="headerlink" title="2.1.2 分行"></a>2.1.2 分行</h5><p>对于较长的行、表达式等，应以分行的方式书写每个部分；典型的如条件表达式和选择（? : ）表达式：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'a'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'z'</span> <span class="token operator">||</span>    ch <span class="token operator">>=</span> <span class="token string">'A'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'Z'</span> <span class="token operator">||</span>    ch <span class="token operator">>=</span> <span class="token string">'0'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ch <span class="token operator">=</span> <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'a'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token operator">?</span> ch <span class="token operator">:</span> <span class="token punctuation">(</span>         <span class="token punctuation">(</span>ch <span class="token operator">>=</span> <span class="token string">'A'</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token operator">?</span> ch <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">:</span>        <span class="token comment">/*ch >= '0' &amp;&amp; ch &lt;= '9'*/</span>  ch<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-1-3-小括号"><a href="#2-1-3-小括号" class="headerlink" title="2.1.3 小括号"></a>2.1.3 小括号</h5><p>对于多算符混合使用在同一表达式（包括运算、大小比较、逻辑连接、位运算、赋值、指针引用和解除引用等），除了特别明显、符合数学常识的，有运算次序的组合（与、或、非混用，加减和乘除混用），可以不用括号括起来，其他的均要有括号标识运算顺序和逻辑组合，包括但不限于：<br>1）位运算（&lt;&lt;，&gt;&gt;，&amp;，|，<del>，^）与加减乘除运算混合<br>2）位运算（&lt;&lt;，&gt;&gt;，&amp;，|，</del>，^）与逻辑运算（||,&amp;&amp;,!,!=,==）混合<br>3）赋值（=,+=,-=等）与逻辑运算（||,&amp;&amp;,!,!=,==）混合，比如</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4）指针引用、解引用，结构体成员算符(-&gt;，.)与逻辑运算、递增递减运算（++，–）等混合。虽然：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>cur<span class="token operator">++</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>是常用的组合，但是不如写成：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>cur<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>5）指针引用、解引用与结构体成员算符（-&gt;，.）混合<br>6）选择运算符（? : ）<br>总之，在不能明确表明计算顺序的地方，都要有括号。</p><h5 id="2-1-4-空格"><a href="#2-1-4-空格" class="headerlink" title="2.1.4 空格"></a>2.1.4 空格</h5><p>在算符，逗号等，应使用一个空格分开，保证显示的工整与美观。（for、if等关键字之后，不单独分行的大括号之前等，也建议添加空格）<br>除非，对于诸如长表达式的多级运算符混用时，（在添加了括号的前提下）为了展现运算符优先级结合而选择部分紧凑（如下x=表达式，?:表达式）,然而我们依旧建议添加全部的空格。学生可以借鉴编辑器自带的格式化工具的结果。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// there is a space before '&#123;'</span>    <span class="token keyword">int</span>  x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> c<span class="token punctuation">,</span> t<span class="token punctuation">;</span> <span class="token comment">// As problem description indicates</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> t<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// there are spaces after for and before &#123;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>        x <span class="token operator">=</span> x<span class="token operator">*</span>y <span class="token operator">+</span> y<span class="token operator">*</span>c <span class="token operator">-</span> c<span class="token operator">/</span>t<span class="token punctuation">;</span>        y <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;&amp;</span> c <span class="token operator">||</span> x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token punctuation">(</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// spaces before and after ?: are optional, as there are brackets.</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"yes?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-函数头与结构体注释（1分）"><a href="#2-2-函数头与结构体注释（1分）" class="headerlink" title="2.2 函数头与结构体注释（1分）"></a>2.2 函数头与结构体注释（1分）</h4><p>本条目，以是否充分说明函数参数、返回值与结构体成员的意义，作为根本评判依据。意义和用途，（返回值的）一般情况和特殊情况都有涉及，基本可以理解的，可以得分。<br>对于应当划在本方面的未尽条目，均以意义说明完整、明确、规范与充分的要求酌情评判。</p><h5 id="2-2-1-首要原则"><a href="#2-2-1-首要原则" class="headerlink" title="2.2.1 首要原则"></a>2.2.1 首要原则</h5><p>凡是违反本条目下子条目的，扣除本大项的1分：<br>1）注释不允许除英文、伪代码和C表达式以外的其他任何表述方式！包括但不限于汉字、汉语拼音、法语等除英语以外的外语。<br>2）大量充斥着下面明确说明过不应写出的、从代码上可以显然易见的内容。</p><h5 id="2-2-2-函数头注释"><a href="#2-2-2-函数头注释" class="headerlink" title="2.2.2 函数头注释"></a>2.2.2 函数头注释</h5><p>函数头注释应当：<br>1）针对函数的目的，描述函数的作用、副作用和效果。副作用如哪些参数在函数内的改变会影响到函数外（“交换”、“插入”等同类词语也可），如会输出什么等。</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/* * function: insert data with DATATYPE into a single-linking head-noded L, *           and the new node appears just after header-node. * return value: a pointer to the new node. */</span><span class="token keyword">struct</span> <span class="token class-name">link_node</span><span class="token operator">*</span> <span class="token function">link_insert</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">link</span><span class="token operator">*</span> L<span class="token punctuation">,</span> DATATYPE data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">struct</span> <span class="token class-name">link_node</span><span class="token operator">*</span> new_node <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">link_node</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    new_node<span class="token operator">-></span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>    new_node<span class="token operator">-></span>next <span class="token operator">=</span> L<span class="token operator">-></span>head<span class="token operator">-></span>next<span class="token punctuation">;</span>    L<span class="token operator">-></span>head<span class="token operator">-></span>next <span class="token operator">=</span> new_node<span class="token punctuation">;</span>    <span class="token keyword">return</span> new_node<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2）在返回值不是void时，描述函数返回值的可能性及其对应的含义。同时建议但不强求：对于可能出现的“错误”(内存不足、读取文件尾)会导致什么返回值或其他“标志变量”的设置，也一并注释。（对于返回值应当说明什么，参阅<a href="https://en.cppreference.com/w/c">https://en.cppreference.com/w/c</a> 中对标准库函数的说明。）<br>（比如，strcmp在返回正数、零和负数时分别表示前一字符串大于、等于、小于后一字符串；scanf在返回非负整数时表示正常读取了多少个变量，返回EOF表示在成功读取任何参数之前遇到了文件尾；只要遇到文件尾，feof、ferror会被设置。）<br>3）必要时，如函数头的参数类型与实际使用的类型不同时，补充说明参数变量的实际意义；但在函数定义中可以直接看出的内容，如参数类型、返回值类型、函数名称等，不应出现在注释里。<br>（比如，用于qsort的comp函数的参数是void*类型，但被使用为指向自定义的struct的指针；泛化的定义被局限在特定的使用，需要注释说明）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">comp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span> p1<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span> p2<span class="token punctuation">)</span><span class="token comment">/** * Introduction:  * Compares two Student objects by score and id. Higher score means "smaller" and vice versa.  * When two student share scores, "smaller" id means "smaller" and vice versa.  * Two Student objects are "equal" only when they share both scores and ids.  *  * Parameters:  * const void * p1, const void * p2, two pointers to Student objects to be compared.  *  * Return value:  * -1 if *p1 is "smaller than" *p2 * 0 if *p1 "equals to" *p2  * 1 if *p2 is "smaller than" *p1 */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4）必要时，对参数有一定假设的，补充说明该假设；并说明假设不被满足时，会有什么后果。<br>（比如，memcpy要求两个内存范围没有实际的重叠，也不会检查是否重叠；如果重叠了，效果是未定义的，而一般会产生错误）</p><h5 id="2-2-3-结构体注释"><a href="#2-2-3-结构体注释" class="headerlink" title="2.2.3 结构体注释"></a>2.2.3 结构体注释</h5><p>结构体的注释应当表明：<br>1）结构体的用途（如，链表的结点结构体）<br>2）当归属于某一大类数据结构时，属于哪一特定的种类（链表是单链表还是循环链表、是双向链表还是双向循环链表）<br>3）结构体成员的意义（链表的头结点）；即使是OJ题目描述暗示的命名，也应当有所叙述。<br>4）必要时，说明对成员取值范围或其他类型的假定；并说明假定不能满足时的后果。（如，成绩score成员的取值是0到100）</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">student</span> DATATYPE<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">link_node</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/*     * node type of linking list,     * with DATATYPE as datatype.     */</span>    DATATYPE data<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">link_node</span><span class="token operator">*</span> next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">link</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/*     * single linking link list,     * with header node BUT without tail node.     */</span>    <span class="token keyword">struct</span> <span class="token class-name">link_node</span><span class="token operator">*</span> head<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">student</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/*     * information of students.     * member:     *   name: as problem description indicates     *   id: as problem description indicates     *   score: from 0 to 100     */</span>    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> id<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> score<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但结构体的注释不应当包含成员名称、成员数据类型等从代码显而易见的内容。</p><h4 id="2-3函数、变量、常量与结构体及其成员的命名（1分）"><a href="#2-3函数、变量、常量与结构体及其成员的命名（1分）" class="headerlink" title="2.3函数、变量、常量与结构体及其成员的命名（1分）"></a>2.3函数、变量、常量与结构体及其成员的命名（1分）</h4><p>本条目，以是否满足命名风格（格式）的要求，且是否足够“望文生义”，作为根本评判依据。命名格式按下述条目严格要求；意义是否清晰应当结合变量命名与相关注释，一并评价。<br>对于应当划在本方面的未尽条目，均以含义显然、格式规范的要求酌情评判。</p><h5 id="2-3-1-命名格式"><a href="#2-3-1-命名格式" class="headerlink" title="2.3.1 命名格式"></a>2.3.1 命名格式</h5><p>1）常量命名，包括 #define和const两种常量，均只能使用“大写单词（缩写）+下划线”的形式，如：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_STUD_NUM</span> <span class="token expression"><span class="token number">200000</span></span></span><span class="token keyword">const</span> <span class="token keyword">double</span> PI <span class="token operator">=</span> <span class="token number">3.14159</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2）变量、结构体、结构体成员和函数命名，推荐使用“纯小写单词（缩写）+下划线”格式（Linux格式）：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> stud_score<span class="token punctuation">;</span><span class="token keyword">char</span> stud_id<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>也可以使用（大/小）驼峰命名：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> studScore<span class="token punctuation">;</span> <span class="token comment">// 小驼峰</span><span class="token keyword">char</span> StudId<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 大驼峰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>3）允许以下划线开头并紧跟着以大写字母开头单词的形式命名结构体，并在随后使用typedef：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_Student</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> score<span class="token punctuation">;</span>    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> id<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> Student<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-3-2-命名含义"><a href="#2-3-2-命名含义" class="headerlink" title="2.3.2 命名含义"></a>2.3.2 命名含义</h5><p>任何变量、常量、函数、结构体及其成员的名称都应可以直接或比较明白地反映其用途、含义。对于使用单词缩写进行命名的，应当使用适当的注释表明整体意义：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> stud_score<span class="token punctuation">;</span> <span class="token comment">// student score</span><span class="token keyword">char</span> StudId<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// student identification number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>使用缩写但意义显露不充分，且没有注释的，酌情处理。<br>绝不被允许的命名行为包括：<br>1）使用汉语拼音的命名<br>2）单个字母一类的命名，如a2、b1、c、d等。但如果为了表达常见的数学意义（如x、y、x1），或为了与题目描述一致，或是短小函数或代码段内的常见命名（如使用s指字符串，数值函数的参数x和y，或比较函数的参数a和b），只要是有任何形式的相关注释注解的，可以允许。<br>3）在上一条目的基础上，单个字母变量用于循环迭代的，限定在i、j、k三层；循环多层的，应对每个循环变量的含义予以说明。<br>此外，本细则不强制要求，但推荐使用英文短单词（单音节）的缩写而非全拼（如index，open），推荐不使用下划线甚至双下划线开头的变量命名；因为上述命名时常与C库函数、宏重名。这类变量名一般较为庞杂，初学者不易记忆，暂不规定。<br>对于这类短单词缩写，常见的如ind代index，tot代total，num代number；更推荐的命名方式为与其他含义结合，如stud_num（number of students）等。</p><h4 id="2-4-代码模块化与逻辑注释（1分）"><a href="#2-4-代码模块化与逻辑注释（1分）" class="headerlink" title="2.4 代码模块化与逻辑注释（1分）"></a>2.4 代码模块化与逻辑注释（1分）</h4><p>本条目，以是否清晰展现代码的内在逻辑、执行意义和过程，作为根本评判标准。对于较为短小、步骤较少的代码，在注释、模块划分、使用多种函数等方面不够完美的，只要其逻辑表述充分、运算的目的清楚说明了的，不必深究。对于较长的代码块，有注释注解代码流程，基本清楚的，可以得分。<br>以下各条目应从代码逻辑的易懂性来直观评判，代码易懂的，可以得分；代码不易理解的，可以酌情扣分。<br>对于应当划在本方面的未尽条目，均以代码逻辑清晰与否，酌情评判。</p><h5 id="2-4-1-代码块逻辑"><a href="#2-4-1-代码块逻辑" class="headerlink" title="2.4.1 代码块逻辑"></a>2.4.1 代码块逻辑</h5><p>对于较长的代码/函数段，应使用分行、单行与多行注释等形式，进行划分，并注明代码块的执行过程、目的等。</p><h5 id="2-4-2-循环逻辑"><a href="#2-4-2-循环逻辑" class="headerlink" title="2.4.2 循环逻辑"></a>2.4.2 循环逻辑</h5><p>循环的进入、成功迭代、失败迭代，每次迭代所做的工作等，应有注释予以解释。</p><h5 id="2-4-3-分支逻辑"><a href="#2-4-3-分支逻辑" class="headerlink" title="2.4.3 分支逻辑"></a>2.4.3 分支逻辑</h5><p>以何种情况进入分支，进入分支对应怎样的变量取值行为，及其对应的实际意义。</p><h5 id="2-4-4-运算逻辑"><a href="#2-4-4-运算逻辑" class="headerlink" title="2.4.4 运算逻辑"></a>2.4.4 运算逻辑</h5><p>对于冗长的表达式，包括逻辑判断表达式（if内或while内），运算和赋值表达式，其所要运算或判断的内容，不显然的，应予以说明。</p><h5 id="2-4-5-变量使用逻辑"><a href="#2-4-5-变量使用逻辑" class="headerlink" title="2.4.5 变量使用逻辑"></a>2.4.5 变量使用逻辑</h5><p>对于变量，特别是布尔标志变量（flag等），数组变量（特别是在其某个元素拥有不同的职能，比如将字符串存储为下标从1开始，而下标0的元素存储长度信息），结构体成员；其以什么含义来进行使用，在何种情况下有怎样可能的值的变化的，应在注释里无所不谈。</p><h4 id="2-5-变量、常数与函数的使用（1分）"><a href="#2-5-变量、常数与函数的使用（1分）" class="headerlink" title="2.5 变量、常数与函数的使用（1分）"></a>2.5 变量、常数与函数的使用（1分）</h4><p>本细则涉及变量、常数的使用中应当避免的做法，以及函数编写时应当避免的写法。这些写法或者使得程序出现未定义的危险行为，或者使得程序易错。<br>由于这里的诸多条目与程序的正确性息息相关，而评判的程序为正确程序，故在“规范性”上划分为“可限制”和“不允许”两种。凡是出现“不允许”的代码写法，均扣分；凡是出现“可限制”写法较多的，才考虑扣分；出现大量需要引起注意的写法时，学生应自行考虑其对程序正确性的影响。</p><h5 id="2-5-1-不允许的写法"><a href="#2-5-1-不允许的写法" class="headerlink" title="2.5.1 不允许的写法"></a>2.5.1 不允许的写法</h5><p>1）对任何指针变量的定义处不立即，或邻近语句处不立即初始化的<br>2）类型不同的浮点数（任何不明确指出类型的浮点常量都是double类型）相互进行大小比较的<br>3）非void返回值的函数，可以到达无return值的语句分支的（main函数返回0除外，这是C的标准所规定的）</p><h5 id="2-5-2-可限制的写法"><a href="#2-5-2-可限制的写法" class="headerlink" title="2.5.2 可限制的写法"></a>2.5.2 可限制的写法</h5><p>1）对同类型浮点数使用 ==，&gt;=，&lt;= 等比较运算符的（推荐使用fabs(x-y)&lt;epsilon一类的写法判断浮点数的相等）<br>2）在多个函数之间滥用全局变量交换信息的（递归函数可以视情况例外，但较大的全局数组依旧建议以指针参数的形式传递给函数）<br>3）使用goto语句的（用于一次性跳出多层循环的除外）</p><h5 id="2-5-3-不作为扣分点，但需要引起注意的写法"><a href="#2-5-3-不作为扣分点，但需要引起注意的写法" class="headerlink" title="2.5.3 不作为扣分点，但需要引起注意的写法"></a>2.5.3 不作为扣分点，但需要引起注意的写法</h5><p>1）在指明变量大小（sizeof）处使用数值常量的。（如malloc(n<em>sizeof(int))就不能写成malloc(n</em>4)），这会影响学生代码的可移植性。<br>2）有符号整数的负数取值与无符号整数之间混合运算的<br>3）函数形式参数与实际参数类型不匹配的；特别是对于scanf、printf等可变参数函数，以及涉及不同种指针类型的参数的（将void*指针与其它类型的指针相互赋值除外）。（关于库函数的参数类型，以及类型与scanf格式化字符串对照写法，请参阅<a href="https://en.cppreference.com/w/c%EF%BC%89">https://en.cppreference.com/w/c）</a><br>4）非指针变量的定义处，作为累加用不初始化的，或临近语句处不立即赋初始值的，或变量的定义距离其使用过远的。（C允许在任何代码块定义局部变量，包括for (int i = 0; i &lt; n; i++)）</p>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c/c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>introduction</title>
      <link href="2021/04036818.html"/>
      <url>2021/04036818.html</url>
      
        <content type="html"><![CDATA[<h1 id="微速前进"><a href="#微速前进" class="headerlink" title="微速前进"></a>微速前进</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>搭建这个博客可以说是一时兴起，也不知道能坚持多久，但是我会把这里当成一个家，记录下奋斗过的足迹。</p><h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>更新内容包括但不限于CTF知识、工具（脚本）、题解，本科课程相关题解、杂文、随笔等（比如大物实验报告？大作业开源？）。</p>]]></content>
      
      
      <categories>
          
          <category> 总览 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 综述 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
